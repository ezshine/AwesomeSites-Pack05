!function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=123)}([function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},function(e,t,n){/*!
@fileoverview gl-matrix - High performance matrix and vector operations
@author Brandon Jones
@author Colin MacKenzie IV
@version 2.7.0

Copyright (c) 2015-2018, Brandon Jones, Colin MacKenzie IV.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

*/
!function(t,n){e.exports=n()}("undefined"!=typeof self&&self,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var i in e)t.d(r,i,function(t){return e[t]}.bind(null,i));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=10)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setMatrixArrayType=function(e){t.ARRAY_TYPE=e},t.toRadian=function(e){return e*i},t.equals=function(e,t){return Math.abs(e-t)<=r*Math.max(1,Math.abs(e),Math.abs(t))};var r=t.EPSILON=1e-6;t.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,t.RANDOM=Math.random;var i=Math.PI/180},function(e,t,n){"use strict";function r(){var e=new f.ARRAY_TYPE(4);return f.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function i(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e}function o(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e[3]=t[3]*n[3],e}function a(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e[3]=t[3]/n[3],e}function s(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2],o=t[3]-e[3];return Math.sqrt(n*n+r*r+i*i+o*o)}function u(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2],o=t[3]-e[3];return n*n+r*r+i*i+o*o}function l(e){var t=e[0],n=e[1],r=e[2],i=e[3];return Math.sqrt(t*t+n*n+r*r+i*i)}function c(e){var t=e[0],n=e[1],r=e[2],i=e[3];return t*t+n*n+r*r+i*i}Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=t.sqrLen=t.len=t.sqrDist=t.dist=t.div=t.mul=t.sub=void 0,t.create=r,t.clone=function(e){var t=new f.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},t.fromValues=function(e,t,n,r){var i=new f.ARRAY_TYPE(4);return i[0]=e,i[1]=t,i[2]=n,i[3]=r,i},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},t.set=function(e,t,n,r,i){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e},t.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e},t.subtract=i,t.multiply=o,t.divide=a,t.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e},t.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e},t.min=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e[3]=Math.min(t[3],n[3]),e},t.max=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e[3]=Math.max(t[3],n[3]),e},t.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e},t.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e},t.scaleAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e},t.distance=s,t.squaredDistance=u,t.length=l,t.squaredLength=c,t.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},t.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},t.normalize=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n*n+r*r+i*i+o*o;return a>0&&(a=1/Math.sqrt(a),e[0]=n*a,e[1]=r*a,e[2]=i*a,e[3]=o*a),e},t.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},t.lerp=function(e,t,n,r){var i=t[0],o=t[1],a=t[2],s=t[3];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e[2]=a+r*(n[2]-a),e[3]=s+r*(n[3]-s),e},t.random=function(e,t){var n,r,i,o,a,s;t=t||1;do{n=2*f.RANDOM()-1,r=2*f.RANDOM()-1,a=n*n+r*r}while(a>=1);do{i=2*f.RANDOM()-1,o=2*f.RANDOM()-1,s=i*i+o*o}while(s>=1);var u=Math.sqrt((1-a)/s);return e[0]=t*n,e[1]=t*r,e[2]=t*i*u,e[3]=t*o*u,e},t.transformMat4=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3];return e[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,e[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,e[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,e[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,e},t.transformQuat=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],s=n[1],u=n[2],l=n[3],c=l*r+s*o-u*i,f=l*i+u*r-a*o,d=l*o+a*i-s*r,h=-a*r-s*i-u*o;return e[0]=c*l+h*-a+f*-u-d*-s,e[1]=f*l+h*-s+d*-a-c*-u,e[2]=d*l+h*-u+c*-s-f*-a,e[3]=t[3],e},t.str=function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},t.equals=function(e,t){var n=e[0],r=e[1],i=e[2],o=e[3],a=t[0],s=t[1],u=t[2],l=t[3];return Math.abs(n-a)<=f.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-s)<=f.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-u)<=f.EPSILON*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-l)<=f.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))};var f=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0));t.sub=i,t.mul=o,t.div=a,t.dist=s,t.sqrDist=u,t.len=l,t.sqrLen=c,t.forEach=function(){var e=r();return function(t,n,r,i,o,a){var s=void 0,u=void 0;for(n||(n=4),r||(r=0),u=i?Math.min(i*n+r,t.length):t.length,s=r;s<u;s+=n)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],e[3]=t[s+3],o(e,e,a),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2],t[s+3]=e[3];return t}}()},function(e,t,n){"use strict";function r(){var e=new p.ARRAY_TYPE(3);return p.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function i(e){var t=e[0],n=e[1],r=e[2];return Math.sqrt(t*t+n*n+r*r)}function o(e,t,n){var r=new p.ARRAY_TYPE(3);return r[0]=e,r[1]=t,r[2]=n,r}function a(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}function s(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e}function u(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e}function l(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(n*n+r*r+i*i)}function c(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return n*n+r*r+i*i}function f(e){var t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r}function d(e,t){var n=t[0],r=t[1],i=t[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o),e}function h(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=t.sqrLen=t.len=t.sqrDist=t.dist=t.div=t.mul=t.sub=void 0,t.create=r,t.clone=function(e){var t=new p.ARRAY_TYPE(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},t.length=i,t.fromValues=o,t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},t.set=function(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e},t.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e},t.subtract=a,t.multiply=s,t.divide=u,t.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e},t.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e},t.min=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e},t.max=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e},t.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e},t.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e},t.scaleAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e},t.distance=l,t.squaredDistance=c,t.squaredLength=f,t.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},t.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e},t.normalize=d,t.dot=h,t.cross=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],s=n[1],u=n[2];return e[0]=i*u-o*s,e[1]=o*a-r*u,e[2]=r*s-i*a,e},t.lerp=function(e,t,n,r){var i=t[0],o=t[1],a=t[2];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e[2]=a+r*(n[2]-a),e},t.hermite=function(e,t,n,r,i,o){var a=o*o,s=a*(2*o-3)+1,u=a*(o-2)+o,l=a*(o-1),c=a*(3-2*o);return e[0]=t[0]*s+n[0]*u+r[0]*l+i[0]*c,e[1]=t[1]*s+n[1]*u+r[1]*l+i[1]*c,e[2]=t[2]*s+n[2]*u+r[2]*l+i[2]*c,e},t.bezier=function(e,t,n,r,i,o){var a=1-o,s=a*a,u=o*o,l=s*a,c=3*o*s,f=3*u*a,d=u*o;return e[0]=t[0]*l+n[0]*c+r[0]*f+i[0]*d,e[1]=t[1]*l+n[1]*c+r[1]*f+i[1]*d,e[2]=t[2]*l+n[2]*c+r[2]*f+i[2]*d,e},t.random=function(e,t){t=t||1;var n=2*p.RANDOM()*Math.PI,r=2*p.RANDOM()-1,i=Math.sqrt(1-r*r)*t;return e[0]=Math.cos(n)*i,e[1]=Math.sin(n)*i,e[2]=r*t,e},t.transformMat4=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[3]*r+n[7]*i+n[11]*o+n[15];return a=a||1,e[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/a,e[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/a,e[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/a,e},t.transformMat3=function(e,t,n){var r=t[0],i=t[1],o=t[2];return e[0]=r*n[0]+i*n[3]+o*n[6],e[1]=r*n[1]+i*n[4]+o*n[7],e[2]=r*n[2]+i*n[5]+o*n[8],e},t.transformQuat=function(e,t,n){var r=n[0],i=n[1],o=n[2],a=n[3],s=t[0],u=t[1],l=t[2],c=i*l-o*u,f=o*s-r*l,d=r*u-i*s,h=i*d-o*f,p=o*c-r*d,v=r*f-i*c,m=2*a;return c*=m,f*=m,d*=m,h*=2,p*=2,v*=2,e[0]=s+c+h,e[1]=u+f+p,e[2]=l+d+v,e},t.rotateX=function(e,t,n,r){var i=[],o=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e},t.rotateY=function(e,t,n,r){var i=[],o=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e},t.rotateZ=function(e,t,n,r){var i=[],o=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e},t.angle=function(e,t){var n=o(e[0],e[1],e[2]),r=o(t[0],t[1],t[2]);d(n,n),d(r,r);var i=h(n,r);return i>1?0:i<-1?Math.PI:Math.acos(i)},t.str=function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},t.equals=function(e,t){var n=e[0],r=e[1],i=e[2],o=t[0],a=t[1],s=t[2];return Math.abs(n-o)<=p.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-a)<=p.EPSILON*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-s)<=p.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))};var p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0));t.sub=a,t.mul=s,t.div=u,t.dist=l,t.sqrDist=c,t.len=i,t.sqrLen=f,t.forEach=function(){var e=r();return function(t,n,r,i,o,a){var s=void 0,u=void 0;for(n||(n=3),r||(r=0),u=i?Math.min(i*n+r,t.length):t.length,s=r;s<u;s+=n)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],o(e,e,a),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2];return t}}()},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(){var e=new l.ARRAY_TYPE(4);return l.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function o(e,t,n){n*=.5;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e}function a(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=n[0],u=n[1],l=n[2],c=n[3];return e[0]=r*c+a*s+i*l-o*u,e[1]=i*c+a*u+o*s-r*l,e[2]=o*c+a*l+r*u-i*s,e[3]=a*c-r*s-i*u-o*l,e}function s(e,t,n,r){var i=t[0],o=t[1],a=t[2],s=t[3],u=n[0],c=n[1],f=n[2],d=n[3],h=void 0,p=void 0,v=void 0,m=void 0,g=void 0;return(p=i*u+o*c+a*f+s*d)<0&&(p=-p,u=-u,c=-c,f=-f,d=-d),1-p>l.EPSILON?(h=Math.acos(p),v=Math.sin(h),m=Math.sin((1-r)*h)/v,g=Math.sin(r*h)/v):(m=1-r,g=r),e[0]=m*i+g*u,e[1]=m*o+g*c,e[2]=m*a+g*f,e[3]=m*s+g*d,e}function u(e,t){var n=t[0]+t[4]+t[8],r=void 0;if(n>0)r=Math.sqrt(n+1),e[3]=.5*r,r=.5/r,e[0]=(t[5]-t[7])*r,e[1]=(t[6]-t[2])*r,e[2]=(t[1]-t[3])*r;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[3*i+i]&&(i=2);var o=(i+1)%3,a=(i+2)%3;r=Math.sqrt(t[3*i+i]-t[3*o+o]-t[3*a+a]+1),e[i]=.5*r,r=.5/r,e[3]=(t[3*o+a]-t[3*a+o])*r,e[o]=(t[3*o+i]+t[3*i+o])*r,e[a]=(t[3*a+i]+t[3*i+a])*r}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.setAxes=t.sqlerp=t.rotationTo=t.equals=t.exactEquals=t.normalize=t.sqrLen=t.squaredLength=t.len=t.length=t.lerp=t.dot=t.scale=t.mul=t.add=t.set=t.copy=t.fromValues=t.clone=void 0,t.create=i,t.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},t.setAxisAngle=o,t.getAxisAngle=function(e,t){var n=2*Math.acos(t[3]),r=Math.sin(n/2);return r>l.EPSILON?(e[0]=t[0]/r,e[1]=t[1]/r,e[2]=t[2]/r):(e[0]=1,e[1]=0,e[2]=0),n},t.multiply=a,t.rotateX=function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(n),u=Math.cos(n);return e[0]=r*u+a*s,e[1]=i*u+o*s,e[2]=o*u-i*s,e[3]=a*u-r*s,e},t.rotateY=function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(n),u=Math.cos(n);return e[0]=r*u-o*s,e[1]=i*u+a*s,e[2]=o*u+r*s,e[3]=a*u-i*s,e},t.rotateZ=function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(n),u=Math.cos(n);return e[0]=r*u+i*s,e[1]=i*u-r*s,e[2]=o*u+a*s,e[3]=a*u-o*s,e},t.calculateW=function(e,t){var n=t[0],r=t[1],i=t[2];return e[0]=n,e[1]=r,e[2]=i,e[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),e},t.slerp=s,t.random=function(e){var t=l.RANDOM(),n=l.RANDOM(),r=l.RANDOM(),i=Math.sqrt(1-t),o=Math.sqrt(t);return e[0]=i*Math.sin(2*Math.PI*n),e[1]=i*Math.cos(2*Math.PI*n),e[2]=o*Math.sin(2*Math.PI*r),e[3]=o*Math.cos(2*Math.PI*r),e},t.invert=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n*n+r*r+i*i+o*o,s=a?1/a:0;return e[0]=-n*s,e[1]=-r*s,e[2]=-i*s,e[3]=o*s,e},t.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},t.fromMat3=u,t.fromEuler=function(e,t,n,r){var i=.5*Math.PI/180;t*=i,n*=i,r*=i;var o=Math.sin(t),a=Math.cos(t),s=Math.sin(n),u=Math.cos(n),l=Math.sin(r),c=Math.cos(r);return e[0]=o*u*c-a*s*l,e[1]=a*s*c+o*u*l,e[2]=a*u*l-o*s*c,e[3]=a*u*c+o*s*l,e},t.str=function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"};var l=r(n(0)),c=r(n(5)),f=r(n(2)),d=r(n(1));t.clone=d.clone,t.fromValues=d.fromValues,t.copy=d.copy,t.set=d.set,t.add=d.add,t.mul=a,t.scale=d.scale,t.dot=d.dot,t.lerp=d.lerp;var h=t.length=d.length,p=(t.len=h,t.squaredLength=d.squaredLength),v=(t.sqrLen=p,t.normalize=d.normalize);t.exactEquals=d.exactEquals,t.equals=d.equals,t.rotationTo=function(){var e=f.create(),t=f.fromValues(1,0,0),n=f.fromValues(0,1,0);return function(r,i,a){var s=f.dot(i,a);return s<-.999999?(f.cross(e,t,i),f.len(e)<1e-6&&f.cross(e,n,i),f.normalize(e,e),o(r,e,Math.PI),r):s>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(f.cross(e,i,a),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=1+s,v(r,r))}}(),t.sqlerp=function(){var e=i(),t=i();return function(n,r,i,o,a,u){return s(e,r,a,u),s(t,i,o,u),s(n,e,t,2*u*(1-u)),n}}(),t.setAxes=function(){var e=c.create();return function(t,n,r,i){return e[0]=r[0],e[3]=r[1],e[6]=r[2],e[1]=i[0],e[4]=i[1],e[7]=i[2],e[2]=-n[0],e[5]=-n[1],e[8]=-n[2],v(t,u(t,e))}}()},function(e,t,n){"use strict";function r(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function i(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],l=t[6],c=t[7],f=t[8],d=t[9],h=t[10],p=t[11],v=t[12],m=t[13],g=t[14],_=t[15],y=n[0],b=n[1],w=n[2],M=n[3];return e[0]=y*r+b*s+w*f+M*v,e[1]=y*i+b*u+w*d+M*m,e[2]=y*o+b*l+w*h+M*g,e[3]=y*a+b*c+w*p+M*_,y=n[4],b=n[5],w=n[6],M=n[7],e[4]=y*r+b*s+w*f+M*v,e[5]=y*i+b*u+w*d+M*m,e[6]=y*o+b*l+w*h+M*g,e[7]=y*a+b*c+w*p+M*_,y=n[8],b=n[9],w=n[10],M=n[11],e[8]=y*r+b*s+w*f+M*v,e[9]=y*i+b*u+w*d+M*m,e[10]=y*o+b*l+w*h+M*g,e[11]=y*a+b*c+w*p+M*_,y=n[12],b=n[13],w=n[14],M=n[15],e[12]=y*r+b*s+w*f+M*v,e[13]=y*i+b*u+w*d+M*m,e[14]=y*o+b*l+w*h+M*g,e[15]=y*a+b*c+w*p+M*_,e}function o(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=r+r,u=i+i,l=o+o,c=r*s,f=r*u,d=r*l,h=i*u,p=i*l,v=o*l,m=a*s,g=a*u,_=a*l;return e[0]=1-(h+v),e[1]=f+_,e[2]=d-g,e[3]=0,e[4]=f-_,e[5]=1-(c+v),e[6]=p+m,e[7]=0,e[8]=d+g,e[9]=p-m,e[10]=1-(c+h),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function a(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e[9]=t[9]-n[9],e[10]=t[10]-n[10],e[11]=t[11]-n[11],e[12]=t[12]-n[12],e[13]=t[13]-n[13],e[14]=t[14]-n[14],e[15]=t[15]-n[15],e}Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=function(){var e=new s.ARRAY_TYPE(16);return s.ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},t.clone=function(e){var t=new s.ARRAY_TYPE(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.fromValues=function(e,t,n,r,i,o,a,u,l,c,f,d,h,p,v,m){var g=new s.ARRAY_TYPE(16);return g[0]=e,g[1]=t,g[2]=n,g[3]=r,g[4]=i,g[5]=o,g[6]=a,g[7]=u,g[8]=l,g[9]=c,g[10]=f,g[11]=d,g[12]=h,g[13]=p,g[14]=v,g[15]=m,g},t.set=function(e,t,n,r,i,o,a,s,u,l,c,f,d,h,p,v,m){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=o,e[5]=a,e[6]=s,e[7]=u,e[8]=l,e[9]=c,e[10]=f,e[11]=d,e[12]=h,e[13]=p,e[14]=v,e[15]=m,e},t.identity=r,t.transpose=function(e,t){if(e===t){var n=t[1],r=t[2],i=t[3],o=t[6],a=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=o,e[11]=t[14],e[12]=i,e[13]=a,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e},t.invert=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],l=t[7],c=t[8],f=t[9],d=t[10],h=t[11],p=t[12],v=t[13],m=t[14],g=t[15],_=n*s-r*a,y=n*u-i*a,b=n*l-o*a,w=r*u-i*s,M=r*l-o*s,x=i*l-o*u,S=c*v-f*p,P=c*m-d*p,C=c*g-h*p,T=f*m-d*v,A=f*g-h*v,O=d*g-h*m,I=_*O-y*A+b*T+w*C-M*P+x*S;return I?(I=1/I,e[0]=(s*O-u*A+l*T)*I,e[1]=(i*A-r*O-o*T)*I,e[2]=(v*x-m*M+g*w)*I,e[3]=(d*M-f*x-h*w)*I,e[4]=(u*C-a*O-l*P)*I,e[5]=(n*O-i*C+o*P)*I,e[6]=(m*b-p*x-g*y)*I,e[7]=(c*x-d*b+h*y)*I,e[8]=(a*A-s*C+l*S)*I,e[9]=(r*C-n*A-o*S)*I,e[10]=(p*M-v*b+g*_)*I,e[11]=(f*b-c*M-h*_)*I,e[12]=(s*P-a*T-u*S)*I,e[13]=(n*T-r*P+i*S)*I,e[14]=(v*y-p*w-m*_)*I,e[15]=(c*w-f*y+d*_)*I,e):null},t.adjoint=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],l=t[7],c=t[8],f=t[9],d=t[10],h=t[11],p=t[12],v=t[13],m=t[14],g=t[15];return e[0]=s*(d*g-h*m)-f*(u*g-l*m)+v*(u*h-l*d),e[1]=-(r*(d*g-h*m)-f*(i*g-o*m)+v*(i*h-o*d)),e[2]=r*(u*g-l*m)-s*(i*g-o*m)+v*(i*l-o*u),e[3]=-(r*(u*h-l*d)-s*(i*h-o*d)+f*(i*l-o*u)),e[4]=-(a*(d*g-h*m)-c*(u*g-l*m)+p*(u*h-l*d)),e[5]=n*(d*g-h*m)-c*(i*g-o*m)+p*(i*h-o*d),e[6]=-(n*(u*g-l*m)-a*(i*g-o*m)+p*(i*l-o*u)),e[7]=n*(u*h-l*d)-a*(i*h-o*d)+c*(i*l-o*u),e[8]=a*(f*g-h*v)-c*(s*g-l*v)+p*(s*h-l*f),e[9]=-(n*(f*g-h*v)-c*(r*g-o*v)+p*(r*h-o*f)),e[10]=n*(s*g-l*v)-a*(r*g-o*v)+p*(r*l-o*s),e[11]=-(n*(s*h-l*f)-a*(r*h-o*f)+c*(r*l-o*s)),e[12]=-(a*(f*m-d*v)-c*(s*m-u*v)+p*(s*d-u*f)),e[13]=n*(f*m-d*v)-c*(r*m-i*v)+p*(r*d-i*f),e[14]=-(n*(s*m-u*v)-a*(r*m-i*v)+p*(r*u-i*s)),e[15]=n*(s*d-u*f)-a*(r*d-i*f)+c*(r*u-i*s),e},t.determinant=function(e){var t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],u=e[7],l=e[8],c=e[9],f=e[10],d=e[11],h=e[12],p=e[13],v=e[14],m=e[15];return(t*a-n*o)*(f*m-d*v)-(t*s-r*o)*(c*m-d*p)+(t*u-i*o)*(c*v-f*p)+(n*s-r*a)*(l*m-d*h)-(n*u-i*a)*(l*v-f*h)+(r*u-i*s)*(l*p-c*h)},t.multiply=i,t.translate=function(e,t,n){var r=n[0],i=n[1],o=n[2],a=void 0,s=void 0,u=void 0,l=void 0,c=void 0,f=void 0,d=void 0,h=void 0,p=void 0,v=void 0,m=void 0,g=void 0;return t===e?(e[12]=t[0]*r+t[4]*i+t[8]*o+t[12],e[13]=t[1]*r+t[5]*i+t[9]*o+t[13],e[14]=t[2]*r+t[6]*i+t[10]*o+t[14],e[15]=t[3]*r+t[7]*i+t[11]*o+t[15]):(a=t[0],s=t[1],u=t[2],l=t[3],c=t[4],f=t[5],d=t[6],h=t[7],p=t[8],v=t[9],m=t[10],g=t[11],e[0]=a,e[1]=s,e[2]=u,e[3]=l,e[4]=c,e[5]=f,e[6]=d,e[7]=h,e[8]=p,e[9]=v,e[10]=m,e[11]=g,e[12]=a*r+c*i+p*o+t[12],e[13]=s*r+f*i+v*o+t[13],e[14]=u*r+d*i+m*o+t[14],e[15]=l*r+h*i+g*o+t[15]),e},t.scale=function(e,t,n){var r=n[0],i=n[1],o=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.rotate=function(e,t,n,r){var i=r[0],o=r[1],a=r[2],u=Math.sqrt(i*i+o*o+a*a),l=void 0,c=void 0,f=void 0,d=void 0,h=void 0,p=void 0,v=void 0,m=void 0,g=void 0,_=void 0,y=void 0,b=void 0,w=void 0,M=void 0,x=void 0,S=void 0,P=void 0,C=void 0,T=void 0,A=void 0,O=void 0,I=void 0,E=void 0,D=void 0;return u<s.EPSILON?null:(i*=u=1/u,o*=u,a*=u,l=Math.sin(n),c=Math.cos(n),f=1-c,d=t[0],h=t[1],p=t[2],v=t[3],m=t[4],g=t[5],_=t[6],y=t[7],b=t[8],w=t[9],M=t[10],x=t[11],S=i*i*f+c,P=o*i*f+a*l,C=a*i*f-o*l,T=i*o*f-a*l,A=o*o*f+c,O=a*o*f+i*l,I=i*a*f+o*l,E=o*a*f-i*l,D=a*a*f+c,e[0]=d*S+m*P+b*C,e[1]=h*S+g*P+w*C,e[2]=p*S+_*P+M*C,e[3]=v*S+y*P+x*C,e[4]=d*T+m*A+b*O,e[5]=h*T+g*A+w*O,e[6]=p*T+_*A+M*O,e[7]=v*T+y*A+x*O,e[8]=d*I+m*E+b*D,e[9]=h*I+g*E+w*D,e[10]=p*I+_*E+M*D,e[11]=v*I+y*E+x*D,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)},t.rotateX=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[4],a=t[5],s=t[6],u=t[7],l=t[8],c=t[9],f=t[10],d=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*i+l*r,e[5]=a*i+c*r,e[6]=s*i+f*r,e[7]=u*i+d*r,e[8]=l*i-o*r,e[9]=c*i-a*r,e[10]=f*i-s*r,e[11]=d*i-u*r,e},t.rotateY=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[0],a=t[1],s=t[2],u=t[3],l=t[8],c=t[9],f=t[10],d=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i-l*r,e[1]=a*i-c*r,e[2]=s*i-f*r,e[3]=u*i-d*r,e[8]=o*r+l*i,e[9]=a*r+c*i,e[10]=s*r+f*i,e[11]=u*r+d*i,e},t.rotateZ=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[0],a=t[1],s=t[2],u=t[3],l=t[4],c=t[5],f=t[6],d=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i+l*r,e[1]=a*i+c*r,e[2]=s*i+f*r,e[3]=u*i+d*r,e[4]=l*i-o*r,e[5]=c*i-a*r,e[6]=f*i-s*r,e[7]=d*i-u*r,e},t.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromRotation=function(e,t,n){var r=n[0],i=n[1],o=n[2],a=Math.sqrt(r*r+i*i+o*o),u=void 0,l=void 0,c=void 0;return a<s.EPSILON?null:(r*=a=1/a,i*=a,o*=a,u=Math.sin(t),l=Math.cos(t),c=1-l,e[0]=r*r*c+l,e[1]=i*r*c+o*u,e[2]=o*r*c-i*u,e[3]=0,e[4]=r*i*c-o*u,e[5]=i*i*c+l,e[6]=o*i*c+r*u,e[7]=0,e[8]=r*o*c+i*u,e[9]=i*o*c-r*u,e[10]=o*o*c+l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)},t.fromXRotation=function(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromYRotation=function(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromZRotation=function(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromRotationTranslation=o,t.fromQuat2=function(e,t){var n=new s.ARRAY_TYPE(3),r=-t[0],i=-t[1],a=-t[2],u=t[3],l=t[4],c=t[5],f=t[6],d=t[7],h=r*r+i*i+a*a+u*u;return h>0?(n[0]=2*(l*u+d*r+c*a-f*i)/h,n[1]=2*(c*u+d*i+f*r-l*a)/h,n[2]=2*(f*u+d*a+l*i-c*r)/h):(n[0]=2*(l*u+d*r+c*a-f*i),n[1]=2*(c*u+d*i+f*r-l*a),n[2]=2*(f*u+d*a+l*i-c*r)),o(e,t,n),e},t.getTranslation=function(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e},t.getScaling=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[4],a=t[5],s=t[6],u=t[8],l=t[9],c=t[10];return e[0]=Math.sqrt(n*n+r*r+i*i),e[1]=Math.sqrt(o*o+a*a+s*s),e[2]=Math.sqrt(u*u+l*l+c*c),e},t.getRotation=function(e,t){var n=t[0]+t[5]+t[10],r=0;return n>0?(r=2*Math.sqrt(n+1),e[3]=.25*r,e[0]=(t[6]-t[9])/r,e[1]=(t[8]-t[2])/r,e[2]=(t[1]-t[4])/r):t[0]>t[5]&&t[0]>t[10]?(r=2*Math.sqrt(1+t[0]-t[5]-t[10]),e[3]=(t[6]-t[9])/r,e[0]=.25*r,e[1]=(t[1]+t[4])/r,e[2]=(t[8]+t[2])/r):t[5]>t[10]?(r=2*Math.sqrt(1+t[5]-t[0]-t[10]),e[3]=(t[8]-t[2])/r,e[0]=(t[1]+t[4])/r,e[1]=.25*r,e[2]=(t[6]+t[9])/r):(r=2*Math.sqrt(1+t[10]-t[0]-t[5]),e[3]=(t[1]-t[4])/r,e[0]=(t[8]+t[2])/r,e[1]=(t[6]+t[9])/r,e[2]=.25*r),e},t.fromRotationTranslationScale=function(e,t,n,r){var i=t[0],o=t[1],a=t[2],s=t[3],u=i+i,l=o+o,c=a+a,f=i*u,d=i*l,h=i*c,p=o*l,v=o*c,m=a*c,g=s*u,_=s*l,y=s*c,b=r[0],w=r[1],M=r[2];return e[0]=(1-(p+m))*b,e[1]=(d+y)*b,e[2]=(h-_)*b,e[3]=0,e[4]=(d-y)*w,e[5]=(1-(f+m))*w,e[6]=(v+g)*w,e[7]=0,e[8]=(h+_)*M,e[9]=(v-g)*M,e[10]=(1-(f+p))*M,e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e},t.fromRotationTranslationScaleOrigin=function(e,t,n,r,i){var o=t[0],a=t[1],s=t[2],u=t[3],l=o+o,c=a+a,f=s+s,d=o*l,h=o*c,p=o*f,v=a*c,m=a*f,g=s*f,_=u*l,y=u*c,b=u*f,w=r[0],M=r[1],x=r[2],S=i[0],P=i[1],C=i[2],T=(1-(v+g))*w,A=(h+b)*w,O=(p-y)*w,I=(h-b)*M,E=(1-(d+g))*M,D=(m+_)*M,k=(p+y)*x,R=(m-_)*x,N=(1-(d+v))*x;return e[0]=T,e[1]=A,e[2]=O,e[3]=0,e[4]=I,e[5]=E,e[6]=D,e[7]=0,e[8]=k,e[9]=R,e[10]=N,e[11]=0,e[12]=n[0]+S-(T*S+I*P+k*C),e[13]=n[1]+P-(A*S+E*P+R*C),e[14]=n[2]+C-(O*S+D*P+N*C),e[15]=1,e},t.fromQuat=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n+n,s=r+r,u=i+i,l=n*a,c=r*a,f=r*s,d=i*a,h=i*s,p=i*u,v=o*a,m=o*s,g=o*u;return e[0]=1-f-p,e[1]=c+g,e[2]=d-m,e[3]=0,e[4]=c-g,e[5]=1-l-p,e[6]=h+v,e[7]=0,e[8]=d+m,e[9]=h-v,e[10]=1-l-f,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.frustum=function(e,t,n,r,i,o,a){var s=1/(n-t),u=1/(i-r),l=1/(o-a);return e[0]=2*o*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*o*u,e[6]=0,e[7]=0,e[8]=(n+t)*s,e[9]=(i+r)*u,e[10]=(a+o)*l,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*o*2*l,e[15]=0,e},t.perspective=function(e,t,n,r,i){var o=1/Math.tan(t/2),a=void 0;return e[0]=o/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0?(a=1/(r-i),e[10]=(i+r)*a,e[14]=2*i*r*a):(e[10]=-1,e[14]=-2*r),e},t.perspectiveFromFieldOfView=function(e,t,n,r){var i=Math.tan(t.upDegrees*Math.PI/180),o=Math.tan(t.downDegrees*Math.PI/180),a=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),u=2/(a+s),l=2/(i+o);return e[0]=u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=l,e[6]=0,e[7]=0,e[8]=-(a-s)*u*.5,e[9]=(i-o)*l*.5,e[10]=r/(n-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*n/(n-r),e[15]=0,e},t.ortho=function(e,t,n,r,i,o,a){var s=1/(t-n),u=1/(r-i),l=1/(o-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*l,e[11]=0,e[12]=(t+n)*s,e[13]=(i+r)*u,e[14]=(a+o)*l,e[15]=1,e},t.lookAt=function(e,t,n,i){var o=void 0,a=void 0,u=void 0,l=void 0,c=void 0,f=void 0,d=void 0,h=void 0,p=void 0,v=void 0,m=t[0],g=t[1],_=t[2],y=i[0],b=i[1],w=i[2],M=n[0],x=n[1],S=n[2];return Math.abs(m-M)<s.EPSILON&&Math.abs(g-x)<s.EPSILON&&Math.abs(_-S)<s.EPSILON?r(e):(d=m-M,h=g-x,p=_-S,v=1/Math.sqrt(d*d+h*h+p*p),o=b*(p*=v)-w*(h*=v),a=w*(d*=v)-y*p,u=y*h-b*d,(v=Math.sqrt(o*o+a*a+u*u))?(o*=v=1/v,a*=v,u*=v):(o=0,a=0,u=0),l=h*u-p*a,c=p*o-d*u,f=d*a-h*o,(v=Math.sqrt(l*l+c*c+f*f))?(l*=v=1/v,c*=v,f*=v):(l=0,c=0,f=0),e[0]=o,e[1]=l,e[2]=d,e[3]=0,e[4]=a,e[5]=c,e[6]=h,e[7]=0,e[8]=u,e[9]=f,e[10]=p,e[11]=0,e[12]=-(o*m+a*g+u*_),e[13]=-(l*m+c*g+f*_),e[14]=-(d*m+h*g+p*_),e[15]=1,e)},t.targetTo=function(e,t,n,r){var i=t[0],o=t[1],a=t[2],s=r[0],u=r[1],l=r[2],c=i-n[0],f=o-n[1],d=a-n[2],h=c*c+f*f+d*d;h>0&&(h=1/Math.sqrt(h),c*=h,f*=h,d*=h);var p=u*d-l*f,v=l*c-s*d,m=s*f-u*c;return(h=p*p+v*v+m*m)>0&&(h=1/Math.sqrt(h),p*=h,v*=h,m*=h),e[0]=p,e[1]=v,e[2]=m,e[3]=0,e[4]=f*m-d*v,e[5]=d*p-c*m,e[6]=c*v-f*p,e[7]=0,e[8]=c,e[9]=f,e[10]=d,e[11]=0,e[12]=i,e[13]=o,e[14]=a,e[15]=1,e},t.str=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))},t.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e[9]=t[9]+n[9],e[10]=t[10]+n[10],e[11]=t[11]+n[11],e[12]=t[12]+n[12],e[13]=t[13]+n[13],e[14]=t[14]+n[14],e[15]=t[15]+n[15],e},t.subtract=a,t.multiplyScalar=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e[9]=t[9]*n,e[10]=t[10]*n,e[11]=t[11]*n,e[12]=t[12]*n,e[13]=t[13]*n,e[14]=t[14]*n,e[15]=t[15]*n,e},t.multiplyScalarAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e[9]=t[9]+n[9]*r,e[10]=t[10]+n[10]*r,e[11]=t[11]+n[11]*r,e[12]=t[12]+n[12]*r,e[13]=t[13]+n[13]*r,e[14]=t[14]+n[14]*r,e[15]=t[15]+n[15]*r,e},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]},t.equals=function(e,t){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],u=e[5],l=e[6],c=e[7],f=e[8],d=e[9],h=e[10],p=e[11],v=e[12],m=e[13],g=e[14],_=e[15],y=t[0],b=t[1],w=t[2],M=t[3],x=t[4],S=t[5],P=t[6],C=t[7],T=t[8],A=t[9],O=t[10],I=t[11],E=t[12],D=t[13],k=t[14],R=t[15];return Math.abs(n-y)<=s.EPSILON*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(r-b)<=s.EPSILON*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(i-w)<=s.EPSILON*Math.max(1,Math.abs(i),Math.abs(w))&&Math.abs(o-M)<=s.EPSILON*Math.max(1,Math.abs(o),Math.abs(M))&&Math.abs(a-x)<=s.EPSILON*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(u-S)<=s.EPSILON*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(l-P)<=s.EPSILON*Math.max(1,Math.abs(l),Math.abs(P))&&Math.abs(c-C)<=s.EPSILON*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(f-T)<=s.EPSILON*Math.max(1,Math.abs(f),Math.abs(T))&&Math.abs(d-A)<=s.EPSILON*Math.max(1,Math.abs(d),Math.abs(A))&&Math.abs(h-O)<=s.EPSILON*Math.max(1,Math.abs(h),Math.abs(O))&&Math.abs(p-I)<=s.EPSILON*Math.max(1,Math.abs(p),Math.abs(I))&&Math.abs(v-E)<=s.EPSILON*Math.max(1,Math.abs(v),Math.abs(E))&&Math.abs(m-D)<=s.EPSILON*Math.max(1,Math.abs(m),Math.abs(D))&&Math.abs(g-k)<=s.EPSILON*Math.max(1,Math.abs(g),Math.abs(k))&&Math.abs(_-R)<=s.EPSILON*Math.max(1,Math.abs(_),Math.abs(R))};var s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0));t.mul=i,t.sub=a},function(e,t,n){"use strict";function r(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],l=t[6],c=t[7],f=t[8],d=n[0],h=n[1],p=n[2],v=n[3],m=n[4],g=n[5],_=n[6],y=n[7],b=n[8];return e[0]=d*r+h*a+p*l,e[1]=d*i+h*s+p*c,e[2]=d*o+h*u+p*f,e[3]=v*r+m*a+g*l,e[4]=v*i+m*s+g*c,e[5]=v*o+m*u+g*f,e[6]=_*r+y*a+b*l,e[7]=_*i+y*s+b*c,e[8]=_*o+y*u+b*f,e}function i(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e}Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=function(){var e=new o.ARRAY_TYPE(9);return o.ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},t.fromMat4=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},t.clone=function(e){var t=new o.ARRAY_TYPE(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},t.fromValues=function(e,t,n,r,i,a,s,u,l){var c=new o.ARRAY_TYPE(9);return c[0]=e,c[1]=t,c[2]=n,c[3]=r,c[4]=i,c[5]=a,c[6]=s,c[7]=u,c[8]=l,c},t.set=function(e,t,n,r,i,o,a,s,u,l){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=o,e[5]=a,e[6]=s,e[7]=u,e[8]=l,e},t.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},t.transpose=function(e,t){if(e===t){var n=t[1],r=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=r,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},t.invert=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],l=t[7],c=t[8],f=c*a-s*l,d=-c*o+s*u,h=l*o-a*u,p=n*f+r*d+i*h;return p?(p=1/p,e[0]=f*p,e[1]=(-c*r+i*l)*p,e[2]=(s*r-i*a)*p,e[3]=d*p,e[4]=(c*n-i*u)*p,e[5]=(-s*n+i*o)*p,e[6]=h*p,e[7]=(-l*n+r*u)*p,e[8]=(a*n-r*o)*p,e):null},t.adjoint=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],l=t[7],c=t[8];return e[0]=a*c-s*l,e[1]=i*l-r*c,e[2]=r*s-i*a,e[3]=s*u-o*c,e[4]=n*c-i*u,e[5]=i*o-n*s,e[6]=o*l-a*u,e[7]=r*u-n*l,e[8]=n*a-r*o,e},t.determinant=function(e){var t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],u=e[7],l=e[8];return t*(l*o-a*u)+n*(-l*i+a*s)+r*(u*i-o*s)},t.multiply=r,t.translate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],l=t[6],c=t[7],f=t[8],d=n[0],h=n[1];return e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=u,e[6]=d*r+h*a+l,e[7]=d*i+h*s+c,e[8]=d*o+h*u+f,e},t.rotate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],l=t[6],c=t[7],f=t[8],d=Math.sin(n),h=Math.cos(n);return e[0]=h*r+d*a,e[1]=h*i+d*s,e[2]=h*o+d*u,e[3]=h*a-d*r,e[4]=h*s-d*i,e[5]=h*u-d*o,e[6]=l,e[7]=c,e[8]=f,e},t.scale=function(e,t,n){var r=n[0],i=n[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},t.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e},t.fromRotation=function(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=-n,e[4]=r,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},t.fromMat2d=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e},t.fromQuat=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n+n,s=r+r,u=i+i,l=n*a,c=r*a,f=r*s,d=i*a,h=i*s,p=i*u,v=o*a,m=o*s,g=o*u;return e[0]=1-f-p,e[3]=c-g,e[6]=d+m,e[1]=c+g,e[4]=1-l-p,e[7]=h-v,e[2]=d-m,e[5]=h+v,e[8]=1-l-f,e},t.normalFromMat4=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],l=t[7],c=t[8],f=t[9],d=t[10],h=t[11],p=t[12],v=t[13],m=t[14],g=t[15],_=n*s-r*a,y=n*u-i*a,b=n*l-o*a,w=r*u-i*s,M=r*l-o*s,x=i*l-o*u,S=c*v-f*p,P=c*m-d*p,C=c*g-h*p,T=f*m-d*v,A=f*g-h*v,O=d*g-h*m,I=_*O-y*A+b*T+w*C-M*P+x*S;return I?(I=1/I,e[0]=(s*O-u*A+l*T)*I,e[1]=(u*C-a*O-l*P)*I,e[2]=(a*A-s*C+l*S)*I,e[3]=(i*A-r*O-o*T)*I,e[4]=(n*O-i*C+o*P)*I,e[5]=(r*C-n*A-o*S)*I,e[6]=(v*x-m*M+g*w)*I,e[7]=(m*b-p*x-g*y)*I,e[8]=(p*M-v*b+g*_)*I,e):null},t.projection=function(e,t,n){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/n,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e},t.str=function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))},t.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e},t.subtract=i,t.multiplyScalar=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e},t.multiplyScalarAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},t.equals=function(e,t){var n=e[0],r=e[1],i=e[2],a=e[3],s=e[4],u=e[5],l=e[6],c=e[7],f=e[8],d=t[0],h=t[1],p=t[2],v=t[3],m=t[4],g=t[5],_=t[6],y=t[7],b=t[8];return Math.abs(n-d)<=o.EPSILON*Math.max(1,Math.abs(n),Math.abs(d))&&Math.abs(r-h)<=o.EPSILON*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(i-p)<=o.EPSILON*Math.max(1,Math.abs(i),Math.abs(p))&&Math.abs(a-v)<=o.EPSILON*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(s-m)<=o.EPSILON*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(u-g)<=o.EPSILON*Math.max(1,Math.abs(u),Math.abs(g))&&Math.abs(l-_)<=o.EPSILON*Math.max(1,Math.abs(l),Math.abs(_))&&Math.abs(c-y)<=o.EPSILON*Math.max(1,Math.abs(c),Math.abs(y))&&Math.abs(f-b)<=o.EPSILON*Math.max(1,Math.abs(f),Math.abs(b))};var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0));t.mul=r,t.sub=i},function(e,t,n){"use strict";function r(){var e=new f.ARRAY_TYPE(2);return f.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0),e}function i(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e}function o(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e}function a(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e}function s(e,t){var n=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(n*n+r*r)}function u(e,t){var n=t[0]-e[0],r=t[1]-e[1];return n*n+r*r}function l(e){var t=e[0],n=e[1];return Math.sqrt(t*t+n*n)}function c(e){var t=e[0],n=e[1];return t*t+n*n}Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=t.sqrLen=t.sqrDist=t.dist=t.div=t.mul=t.sub=t.len=void 0,t.create=r,t.clone=function(e){var t=new f.ARRAY_TYPE(2);return t[0]=e[0],t[1]=e[1],t},t.fromValues=function(e,t){var n=new f.ARRAY_TYPE(2);return n[0]=e,n[1]=t,n},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e},t.set=function(e,t,n){return e[0]=t,e[1]=n,e},t.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e},t.subtract=i,t.multiply=o,t.divide=a,t.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e},t.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e},t.min=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e},t.max=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e},t.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e},t.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e},t.scaleAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e},t.distance=s,t.squaredDistance=u,t.length=l,t.squaredLength=c,t.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e},t.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e},t.normalize=function(e,t){var n=t[0],r=t[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i),e[0]=t[0]*i,e[1]=t[1]*i),e},t.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},t.cross=function(e,t,n){var r=t[0]*n[1]-t[1]*n[0];return e[0]=e[1]=0,e[2]=r,e},t.lerp=function(e,t,n,r){var i=t[0],o=t[1];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e},t.random=function(e,t){t=t||1;var n=2*f.RANDOM()*Math.PI;return e[0]=Math.cos(n)*t,e[1]=Math.sin(n)*t,e},t.transformMat2=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[2]*i,e[1]=n[1]*r+n[3]*i,e},t.transformMat2d=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[2]*i+n[4],e[1]=n[1]*r+n[3]*i+n[5],e},t.transformMat3=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[3]*i+n[6],e[1]=n[1]*r+n[4]*i+n[7],e},t.transformMat4=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[4]*i+n[12],e[1]=n[1]*r+n[5]*i+n[13],e},t.rotate=function(e,t,n,r){var i=t[0]-n[0],o=t[1]-n[1],a=Math.sin(r),s=Math.cos(r);return e[0]=i*s-o*a+n[0],e[1]=i*a+o*s+n[1],e},t.angle=function(e,t){var n=e[0],r=e[1],i=t[0],o=t[1],a=n*n+r*r;a>0&&(a=1/Math.sqrt(a));var s=i*i+o*o;s>0&&(s=1/Math.sqrt(s));var u=(n*i+r*o)*a*s;return u>1?0:u<-1?Math.PI:Math.acos(u)},t.str=function(e){return"vec2("+e[0]+", "+e[1]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]},t.equals=function(e,t){var n=e[0],r=e[1],i=t[0],o=t[1];return Math.abs(n-i)<=f.EPSILON*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-o)<=f.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))};var f=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0));t.len=l,t.sub=i,t.mul=o,t.div=a,t.dist=s,t.sqrDist=u,t.sqrLen=c,t.forEach=function(){var e=r();return function(t,n,r,i,o,a){var s=void 0,u=void 0;for(n||(n=2),r||(r=0),u=i?Math.min(i*n+r,t.length):t.length,s=r;s<u;s+=n)e[0]=t[s],e[1]=t[s+1],o(e,e,a),t[s]=e[0],t[s+1]=e[1];return t}}()},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e,t,n){var r=.5*n[0],i=.5*n[1],o=.5*n[2],a=t[0],s=t[1],u=t[2],l=t[3];return e[0]=a,e[1]=s,e[2]=u,e[3]=l,e[4]=r*l+i*u-o*s,e[5]=i*l+o*a-r*u,e[6]=o*l+r*s-i*a,e[7]=-r*a-i*s-o*u,e}function o(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function a(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=n[4],u=n[5],l=n[6],c=n[7],f=t[4],d=t[5],h=t[6],p=t[7],v=n[0],m=n[1],g=n[2],_=n[3];return e[0]=r*_+a*v+i*g-o*m,e[1]=i*_+a*m+o*v-r*g,e[2]=o*_+a*g+r*m-i*v,e[3]=a*_-r*v-i*m-o*g,e[4]=r*c+a*s+i*l-o*u+f*_+p*v+d*g-h*m,e[5]=i*c+a*u+o*s-r*l+d*_+p*m+h*v-f*g,e[6]=o*c+a*l+r*u-i*s+h*_+p*g+f*m-d*v,e[7]=a*c-r*s-i*u-o*l+p*_-f*v-d*m-h*g,e}Object.defineProperty(t,"__esModule",{value:!0}),t.sqrLen=t.squaredLength=t.len=t.length=t.dot=t.mul=t.setReal=t.getReal=void 0,t.create=function(){var e=new s.ARRAY_TYPE(8);return s.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0),e[3]=1,e},t.clone=function(e){var t=new s.ARRAY_TYPE(8);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t},t.fromValues=function(e,t,n,r,i,o,a,u){var l=new s.ARRAY_TYPE(8);return l[0]=e,l[1]=t,l[2]=n,l[3]=r,l[4]=i,l[5]=o,l[6]=a,l[7]=u,l},t.fromRotationTranslationValues=function(e,t,n,r,i,o,a){var u=new s.ARRAY_TYPE(8);u[0]=e,u[1]=t,u[2]=n,u[3]=r;var l=.5*i,c=.5*o,f=.5*a;return u[4]=l*r+c*n-f*t,u[5]=c*r+f*e-l*n,u[6]=f*r+l*t-c*e,u[7]=-l*e-c*t-f*n,u},t.fromRotationTranslation=i,t.fromTranslation=function(e,t){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=.5*t[0],e[5]=.5*t[1],e[6]=.5*t[2],e[7]=0,e},t.fromRotation=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=0,e[5]=0,e[6]=0,e[7]=0,e},t.fromMat4=function(e,t){var n=u.create();l.getRotation(n,t);var r=new s.ARRAY_TYPE(3);return l.getTranslation(r,t),i(e,n,r),e},t.copy=o,t.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e},t.set=function(e,t,n,r,i,o,a,s,u){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=o,e[5]=a,e[6]=s,e[7]=u,e},t.getDual=function(e,t){return e[0]=t[4],e[1]=t[5],e[2]=t[6],e[3]=t[7],e},t.setDual=function(e,t){return e[4]=t[0],e[5]=t[1],e[6]=t[2],e[7]=t[3],e},t.getTranslation=function(e,t){var n=t[4],r=t[5],i=t[6],o=t[7],a=-t[0],s=-t[1],u=-t[2],l=t[3];return e[0]=2*(n*l+o*a+r*u-i*s),e[1]=2*(r*l+o*s+i*a-n*u),e[2]=2*(i*l+o*u+n*s-r*a),e},t.translate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=.5*n[0],u=.5*n[1],l=.5*n[2],c=t[4],f=t[5],d=t[6],h=t[7];return e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=a*s+i*l-o*u+c,e[5]=a*u+o*s-r*l+f,e[6]=a*l+r*u-i*s+d,e[7]=-r*s-i*u-o*l+h,e},t.rotateX=function(e,t,n){var r=-t[0],i=-t[1],o=-t[2],a=t[3],s=t[4],l=t[5],c=t[6],f=t[7],d=s*a+f*r+l*o-c*i,h=l*a+f*i+c*r-s*o,p=c*a+f*o+s*i-l*r,v=f*a-s*r-l*i-c*o;return u.rotateX(e,t,n),r=e[0],i=e[1],o=e[2],a=e[3],e[4]=d*a+v*r+h*o-p*i,e[5]=h*a+v*i+p*r-d*o,e[6]=p*a+v*o+d*i-h*r,e[7]=v*a-d*r-h*i-p*o,e},t.rotateY=function(e,t,n){var r=-t[0],i=-t[1],o=-t[2],a=t[3],s=t[4],l=t[5],c=t[6],f=t[7],d=s*a+f*r+l*o-c*i,h=l*a+f*i+c*r-s*o,p=c*a+f*o+s*i-l*r,v=f*a-s*r-l*i-c*o;return u.rotateY(e,t,n),r=e[0],i=e[1],o=e[2],a=e[3],e[4]=d*a+v*r+h*o-p*i,e[5]=h*a+v*i+p*r-d*o,e[6]=p*a+v*o+d*i-h*r,e[7]=v*a-d*r-h*i-p*o,e},t.rotateZ=function(e,t,n){var r=-t[0],i=-t[1],o=-t[2],a=t[3],s=t[4],l=t[5],c=t[6],f=t[7],d=s*a+f*r+l*o-c*i,h=l*a+f*i+c*r-s*o,p=c*a+f*o+s*i-l*r,v=f*a-s*r-l*i-c*o;return u.rotateZ(e,t,n),r=e[0],i=e[1],o=e[2],a=e[3],e[4]=d*a+v*r+h*o-p*i,e[5]=h*a+v*i+p*r-d*o,e[6]=p*a+v*o+d*i-h*r,e[7]=v*a-d*r-h*i-p*o,e},t.rotateByQuatAppend=function(e,t,n){var r=n[0],i=n[1],o=n[2],a=n[3],s=t[0],u=t[1],l=t[2],c=t[3];return e[0]=s*a+c*r+u*o-l*i,e[1]=u*a+c*i+l*r-s*o,e[2]=l*a+c*o+s*i-u*r,e[3]=c*a-s*r-u*i-l*o,s=t[4],u=t[5],l=t[6],c=t[7],e[4]=s*a+c*r+u*o-l*i,e[5]=u*a+c*i+l*r-s*o,e[6]=l*a+c*o+s*i-u*r,e[7]=c*a-s*r-u*i-l*o,e},t.rotateByQuatPrepend=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=n[0],u=n[1],l=n[2],c=n[3];return e[0]=r*c+a*s+i*l-o*u,e[1]=i*c+a*u+o*s-r*l,e[2]=o*c+a*l+r*u-i*s,e[3]=a*c-r*s-i*u-o*l,s=n[4],u=n[5],l=n[6],c=n[7],e[4]=r*c+a*s+i*l-o*u,e[5]=i*c+a*u+o*s-r*l,e[6]=o*c+a*l+r*u-i*s,e[7]=a*c-r*s-i*u-o*l,e},t.rotateAroundAxis=function(e,t,n,r){if(Math.abs(r)<s.EPSILON)return o(e,t);var i=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);r*=.5;var a=Math.sin(r),u=a*n[0]/i,l=a*n[1]/i,c=a*n[2]/i,f=Math.cos(r),d=t[0],h=t[1],p=t[2],v=t[3];e[0]=d*f+v*u+h*c-p*l,e[1]=h*f+v*l+p*u-d*c,e[2]=p*f+v*c+d*l-h*u,e[3]=v*f-d*u-h*l-p*c;var m=t[4],g=t[5],_=t[6],y=t[7];return e[4]=m*f+y*u+g*c-_*l,e[5]=g*f+y*l+_*u-m*c,e[6]=_*f+y*c+m*l-g*u,e[7]=y*f-m*u-g*l-_*c,e},t.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e},t.multiply=a,t.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e},t.lerp=function(e,t,n,r){var i=1-r;return c(t,n)<0&&(r=-r),e[0]=t[0]*i+n[0]*r,e[1]=t[1]*i+n[1]*r,e[2]=t[2]*i+n[2]*r,e[3]=t[3]*i+n[3]*r,e[4]=t[4]*i+n[4]*r,e[5]=t[5]*i+n[5]*r,e[6]=t[6]*i+n[6]*r,e[7]=t[7]*i+n[7]*r,e},t.invert=function(e,t){var n=d(t);return e[0]=-t[0]/n,e[1]=-t[1]/n,e[2]=-t[2]/n,e[3]=t[3]/n,e[4]=-t[4]/n,e[5]=-t[5]/n,e[6]=-t[6]/n,e[7]=t[7]/n,e},t.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e[4]=-t[4],e[5]=-t[5],e[6]=-t[6],e[7]=t[7],e},t.normalize=function(e,t){var n=d(t);if(n>0){n=Math.sqrt(n);var r=t[0]/n,i=t[1]/n,o=t[2]/n,a=t[3]/n,s=t[4],u=t[5],l=t[6],c=t[7],f=r*s+i*u+o*l+a*c;e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=(s-r*f)/n,e[5]=(u-i*f)/n,e[6]=(l-o*f)/n,e[7]=(c-a*f)/n}return e},t.str=function(e){return"quat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+")"},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]},t.equals=function(e,t){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],u=e[5],l=e[6],c=e[7],f=t[0],d=t[1],h=t[2],p=t[3],v=t[4],m=t[5],g=t[6],_=t[7];return Math.abs(n-f)<=s.EPSILON*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(r-d)<=s.EPSILON*Math.max(1,Math.abs(r),Math.abs(d))&&Math.abs(i-h)<=s.EPSILON*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(o-p)<=s.EPSILON*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(a-v)<=s.EPSILON*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(u-m)<=s.EPSILON*Math.max(1,Math.abs(u),Math.abs(m))&&Math.abs(l-g)<=s.EPSILON*Math.max(1,Math.abs(l),Math.abs(g))&&Math.abs(c-_)<=s.EPSILON*Math.max(1,Math.abs(c),Math.abs(_))};var s=r(n(0)),u=r(n(3)),l=r(n(4));t.getReal=u.copy,t.setReal=u.copy,t.mul=a;var c=t.dot=u.dot,f=t.length=u.length,d=(t.len=f,t.squaredLength=u.squaredLength);t.sqrLen=d},function(e,t,n){"use strict";function r(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],l=n[0],c=n[1],f=n[2],d=n[3],h=n[4],p=n[5];return e[0]=r*l+o*c,e[1]=i*l+a*c,e[2]=r*f+o*d,e[3]=i*f+a*d,e[4]=r*h+o*p+s,e[5]=i*h+a*p+u,e}function i(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e}Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=function(){var e=new o.ARRAY_TYPE(6);return o.ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0,e[4]=0,e[5]=0),e[0]=1,e[3]=1,e},t.clone=function(e){var t=new o.ARRAY_TYPE(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},t.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},t.fromValues=function(e,t,n,r,i,a){var s=new o.ARRAY_TYPE(6);return s[0]=e,s[1]=t,s[2]=n,s[3]=r,s[4]=i,s[5]=a,s},t.set=function(e,t,n,r,i,o,a){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=o,e[5]=a,e},t.invert=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=n*o-r*i;return u?(u=1/u,e[0]=o*u,e[1]=-r*u,e[2]=-i*u,e[3]=n*u,e[4]=(i*s-o*a)*u,e[5]=(r*a-n*s)*u,e):null},t.determinant=function(e){return e[0]*e[3]-e[1]*e[2]},t.multiply=r,t.rotate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],l=Math.sin(n),c=Math.cos(n);return e[0]=r*c+o*l,e[1]=i*c+a*l,e[2]=r*-l+o*c,e[3]=i*-l+a*c,e[4]=s,e[5]=u,e},t.scale=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],l=n[0],c=n[1];return e[0]=r*l,e[1]=i*l,e[2]=o*c,e[3]=a*c,e[4]=s,e[5]=u,e},t.translate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],l=n[0],c=n[1];return e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=r*l+o*c+s,e[5]=i*l+a*c+u,e},t.fromRotation=function(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=-n,e[3]=r,e[4]=0,e[5]=0,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e},t.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e},t.str=function(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+1)},t.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e},t.subtract=i,t.multiplyScalar=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e},t.multiplyScalarAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]},t.equals=function(e,t){var n=e[0],r=e[1],i=e[2],a=e[3],s=e[4],u=e[5],l=t[0],c=t[1],f=t[2],d=t[3],h=t[4],p=t[5];return Math.abs(n-l)<=o.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(r-c)<=o.EPSILON*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(i-f)<=o.EPSILON*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(a-d)<=o.EPSILON*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(s-h)<=o.EPSILON*Math.max(1,Math.abs(s),Math.abs(h))&&Math.abs(u-p)<=o.EPSILON*Math.max(1,Math.abs(u),Math.abs(p))};var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0));t.mul=r,t.sub=i},function(e,t,n){"use strict";function r(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=n[0],u=n[1],l=n[2],c=n[3];return e[0]=r*s+o*u,e[1]=i*s+a*u,e[2]=r*l+o*c,e[3]=i*l+a*c,e}function i(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e}Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=function(){var e=new o.ARRAY_TYPE(4);return o.ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},t.clone=function(e){var t=new o.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},t.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},t.fromValues=function(e,t,n,r){var i=new o.ARRAY_TYPE(4);return i[0]=e,i[1]=t,i[2]=n,i[3]=r,i},t.set=function(e,t,n,r,i){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e},t.transpose=function(e,t){if(e===t){var n=t[1];e[1]=t[2],e[2]=n}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e},t.invert=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n*o-i*r;return a?(a=1/a,e[0]=o*a,e[1]=-r*a,e[2]=-i*a,e[3]=n*a,e):null},t.adjoint=function(e,t){var n=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=n,e},t.determinant=function(e){return e[0]*e[3]-e[2]*e[1]},t.multiply=r,t.rotate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(n),u=Math.cos(n);return e[0]=r*u+o*s,e[1]=i*u+a*s,e[2]=r*-s+o*u,e[3]=i*-s+a*u,e},t.scale=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=n[0],u=n[1];return e[0]=r*s,e[1]=i*s,e[2]=o*u,e[3]=a*u,e},t.fromRotation=function(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=-n,e[3]=r,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e},t.str=function(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2))},t.LDU=function(e,t,n,r){return e[2]=r[2]/r[0],n[0]=r[0],n[1]=r[1],n[3]=r[3]-e[2]*n[1],[e,t,n]},t.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e},t.subtract=i,t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},t.equals=function(e,t){var n=e[0],r=e[1],i=e[2],a=e[3],s=t[0],u=t[1],l=t[2],c=t[3];return Math.abs(n-s)<=o.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-u)<=o.EPSILON*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(i-l)<=o.EPSILON*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(a-c)<=o.EPSILON*Math.max(1,Math.abs(a),Math.abs(c))},t.multiplyScalar=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e},t.multiplyScalarAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e};var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0));t.mul=r,t.sub=i},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.vec4=t.vec3=t.vec2=t.quat2=t.quat=t.mat4=t.mat3=t.mat2d=t.mat2=t.glMatrix=void 0;var i=r(n(0)),o=r(n(9)),a=r(n(8)),s=r(n(5)),u=r(n(4)),l=r(n(3)),c=r(n(7)),f=r(n(6)),d=r(n(2)),h=r(n(1));t.glMatrix=i,t.mat2=o,t.mat2d=a,t.mat3=s,t.mat4=u,t.quat=l,t.quat2=c,t.vec2=f,t.vec3=d,t.vec4=h}])})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(36),o=r(i),a=n(37),s=r(a);t.default={bind:o.default,mixin:s.default},e.exports=t.default},function(e,t){var n=function(e){var t="";return t+='#define GLSLIFY 1\n#ifndef _H_SAMPLE_SH_\n#define _H_SAMPLE_SH_\n// ================================\n// compute Spherical Harmonics\n// ================================\n//\n// "Stupid Spherical Harmonics (SH) Tricks"\n// http://www.ppsloan.org/publications/StupidSH36.pdf\n//\n//\nvec3 SampleSH( vec3 Normal, vec4 shCoefs[7] )\n{\n  Normal.xz = Normal.zx;\n  vec4 NormalVector = vec4(Normal, 1.0);\n\n  // todo transpose coeffs directly\n  // NormalVector.xyz = NormalVector.zyx;\n\n  vec3 X0, X1, X2;\n  X0.x = dot( shCoefs[0].xyz, Normal) + shCoefs[0].w;\n  X0.y = dot( shCoefs[1].xyz, Normal) + shCoefs[1].w;\n  X0.z = dot( shCoefs[2].xyz, Normal) + shCoefs[2].w;\n\n  vec4 vB = NormalVector.zyxx * NormalVector.yxxz;\n  X1.x = dot( shCoefs[3].xyz, vB.xyz) + (shCoefs[3].w * vB.w);\n  X1.y = dot( shCoefs[4].xyz, vB.xyz) + (shCoefs[4].w * vB.w);\n  X1.z = dot( shCoefs[5].xyz, vB.xyz) + (shCoefs[5].w * vB.w);\n\n  float vC = NormalVector.z * NormalVector.z - NormalVector.y * NormalVector.y;\n  X2 =  shCoefs[6].xyz * vC;\n\n  return ( X0 + X1 + X2 );\n//  return max( vec3(0.0) , X0 + X1 + X2 );\n}\n\n#endif\n'};n.toString=n,e.exports=n},function(e,t,n){function r(){this.position=s.create(),this.rotation=u.create(),this.scale=s.fromValues(1,1,1),this._matrix=o.create(),this._wmatrix=o.create(),this._wposition=new Float32Array(this._wmatrix.buffer,48,3),this._parent=null,this._children=[],this._invalidM=!0,this._invalidW=!0}var i=n(127),o=n(129),a=n(68),s=n(87),u=n(86),l=a.create(),c=new Float32Array(l.buffer,0,3),f=new Float32Array(l.buffer,12,3),d=new Float32Array(l.buffer,24,3);VUP=s.fromValues(0,1,0),r.prototype={rotateX:function(e){u.rotateX(this.rotation,this.rotation,e),this.invalidate()},rotateY:function(e){u.rotateY(this.rotation,this.rotation,e),this.invalidate()},rotateZ:function(e){u.rotateZ(this.rotation,this.rotation,e),this.invalidate()},set x(e){this.position[0]=e,this.invalidate()},set y(e){this.position[1]=e,this.invalidate()},set z(e){this.position[2]=e,this.invalidate()},get x(){return this.position[0]},get y(){return this.position[1]},get z(){return this.position[2]},setScale:function(e){this.scale[0]=this.scale[1]=this.scale[2]=e,this.invalidate()},lookAt:function(e){s.subtract(d,this.position,e),s.normalize(d,d),s.cross(c,VUP,d),s.normalize(c,c),s.cross(f,d,c),u.fromMat3(this.rotation,l),this.invalidate()},setMatrix:function(e){o.copy(this._matrix,e),i.decomposeMat4(e,this.position,this.rotation,this.scale),this._invalidM=!1,this._invalidW=!0},add:function(e){-1===this._children.indexOf(e)&&(null!==e._parent&&e._parent.remove(e),this._children.push(e),e._parent=this)},remove:function(e){var t=this._children.indexOf(e);t>-1&&(this._children.splice(t,1),e._parent=null)},invalidate:function(){this._invalidM=!0,this._invalidW=!0},updateMatrix:function(){this._invalidM&&(o.fromRotationTranslationScale(this._matrix,this.rotation,this.position,this.scale),this._invalidM=!1)},updateWorldMatrix:function(e){e=!!e,this.updateMatrix();var t=this._hasInvalidWorldMatrix(e);t&&this._computeWorldMatrix(e);for(var n=0;n<this._children.length;n++){var r=this._children[n];r._invalidW=r._invalidW||t,r.updateWorldMatrix(!0)}},_computeWorldMatrix:function(e){var t=this._parent;null!==t?(!e&&t._hasInvalidWorldMatrix(!1)&&(t.updateMatrix(),t._computeWorldMatrix(!1)),o.multiply(this._wmatrix,t._wmatrix,this._matrix)):o.copy(this._wmatrix,this._matrix),this._invalidW=!1},_hasInvalidWorldMatrix:function(e){return this._invalidW||!e&&null!==this._parent&&this._parent._hasInvalidWorldMatrix(!1)}},e.exports=r},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";function r(e,t){var n=e.length;if(n===t)return e;if(n>t)return e.substr(0,t);for(var r=e[n-1];e.length<t;)e+=r;return e}function i(e){return e.toPrecision(8)}function o(e,t,n){0!=(t&p)&&e.add("f",n),0!=(t&v)&&e.add("v",n)}function a(e,t,n){0!=(t&p)&&e.add("pf",n),0!=(t&v)&&e.add("pv",n)}function s(e,t,n){d.call(this,!0,!1),this.name=e,this.size=t,this.param=null,this.comps=r("rgba",t),this.shader=n||p}function u(e,t){d.call(this,!0,!0),this._input=null,this.name=e,this.texCoords=t,this._tex=null,this.size=4,this._linkAttrib=t instanceof c,this._linkAttrib?(this.add(t),this.uvsToken=this.texCoords.token):this.uvsToken=this.texCoords,this.token="VAL_"+this.name+this.uvsToken}function l(e,t){d.call(this,!0,!0),this._input=null,this.name=e,this.size=t,this._value=new Float32Array(t),this.token=this.name}function c(e,t){d.call(this,!0,!1),this._input=null,this.name=e,this.size=t,this.token="v_"+this.name}function f(e){d.call(this,!0,!1),this._input=null,this.name="CONST_"+(0|2147483647*Math.random()).toString(16),Array.isArray(e)?this.size=e.length:this.size=1,this.value=e,this.token="VAR_"+this.name}var d=n(28),h=[null,"float","vec2","vec3","vec4"],p=1,v=2;s.prototype=Object.create(d.prototype),s.prototype.constructor=s,s.prototype.attach=function(e,t){this.param&&this.remove(this.param),e._input=this,this.param=e,this.add(e),void 0===t&&(t="rgba"),this.comps=r(t,this.size)},s.prototype.detach=function(){this.param&&(this.param._input=null,this.remove(this.param)),this.param=null},s.prototype.attachSampler=function(e,t,n){var r=new u(e,t);return this.attach(r,n),r},s.prototype.attachUniform=function(e,t,n){var r=new l(e,t||this.size);return this.attach(r,n),r},s.prototype.attachAttribute=function(e,t,n){var r=new c(e,t||this.size);return this.attach(r,n),r},s.prototype.attachConstant=function(e,t){var n=new f(e);return this.attach(n,t),n},s.prototype.getHash=function(){return this.size+"-"+this.comps+"-"+this.name},s.prototype.genCode=function(e){if(this.genAvailable(e),null!==this.param){var t="#define "+this.name+"(k) "+this.param.token;this.param.size>1&&(t+="."+this.comps),a(e,this.shader,t)}},s.prototype.genAvailable=function(e){var t=null===this.param?"0":"1",n="#define HAS_"+this.name+" "+t+"\n";e.add("pv",n),e.add("pf",n)},u.prototype=Object.create(d.prototype),u.prototype.constructor=u,u.prototype.set=function(e){this._tex=e},u.prototype.genCode=function(e){var t,n=this.name;t="uniform sampler2D "+n+";\n",a(e,this._input.shader,t),t="vec4 "+this.token+" = texture2D( "+n+", "+this.uvsToken+");\n",o(e,this._input.shader,t)},u.prototype.setup=function(e){e[this.name](this._tex)},u.prototype.getHash=function(){return(this._linkAttrib?"":this.texCoords)+"-"+this.name},l.prototype=Object.create(d.prototype),l.prototype.constructor=l,l.prototype.set=function(){for(var e=0;e<arguments.length;e++)this._value[e]=arguments[e];this._invalid=!0},l.prototype.genCode=function(e){var t;t="uniform "+h[this.size]+" "+this.token+";\n",a(e,this._input.shader,t)},l.prototype.setup=function(e){e[this.name](this._value),this._invalid=!1},l.prototype.getHash=function(){return this.size+"-"+this.name},c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.prototype.genCode=function(e){var t;t="varying "+h[this.size]+" "+this.token+";\n",e.add("pf",t),t="attribute "+h[this.size]+" "+this.name+";\n",t+="varying   "+h[this.size]+" "+this.token+";\n",e.add("pv",t),t=this.token+" = "+this.name+";\n",e.add("v",t)},c.prototype.getHash=function(){return this.size+"-"+this.name},f.prototype=Object.create(d.prototype),f.prototype.constructor=f,f.prototype.genCode=function(e){var t;t="#define "+this.token+" "+h[this.size]+"("+this._stringifyValue()+")\n",a(e,this._input.shader,t)},f.prototype._stringifyValue=function(){return 1===this.size?this.value.toString():this.value.map(i).join(",")},f.prototype.getHash=function(){return this._stringifyValue()+"-"+this.size+"-"},s.Sampler=u,s.Uniform=l,s.Attribute=c,s.Constant=f,s.FRAGMENT=p,s.VERTEX=v,s.ALL=v|p,e.exports=s},function(e,t,n){"use strict";function r(e,t){i.call(this,!0,!1),this.name=e,this.values=t,this._val=t[0]}var i=n(28);r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.set=function(e){if(this._val!==e){if(null!==e&&-1===this.values.indexOf(e))throw new Error("invalide Enum value :"+e);this._val=e,this.invalidate()}},r.prototype.genCode=function(e){for(var t="",n=0;n<this.values.length;n++)t+="#define "+this.values[n]+" "+(n+1)+"\n";t+="#define VAL_"+this.name+" "+this._val+"\n",t+="#define "+this.name+"(k) VAL_"+this.name+" == k\n",e.add("pf",t),e.add("pv",t)},r.prototype.getHash=function(){return this.values.indexOf(this._val)+"/"+this.name},e.exports=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(17),s=r(a),u=n(1),l=n(94),c=r(l),f=n(93),d=r(f),h=n(92),p=r(h),v=n(20),m=r(v),g=n(59),_=u.mat4.create(),y=function(){function e(t){i(this,e),this.gl=t,this.ibl=null,this.lSetup=null,this.prg=null,this.morphSetup=null,this.renderMode=g.RENDER_MODES.DISABLED,this.isVisible=!0,this.inputs=new c.default,this.config=new s.default,this._prgcache=d.default.getCache(t),this.version=void 0!==t.texImage3D?"300 es":void 0,this._precision="highp",this._mask=m.default.OPAQUE}return o(e,[{key:"setIBL",value:function(e){this.ibl=e}},{key:"setLightSetup",value:function(e){this.lSetup=e,this.inputs.addChunks(e.getChunks()),this.depthPass&&this.depthPass.setLightSetup(e)}},{key:"enableDither",value:function(e){null===this.iLodDither.param&&e?this.iLodDither.attach(this.lodDitherUniform):null===this.iLodDither.param||e||this.iLodDither.detach()}},{key:"setSkinSetup",value:function(e){if(this.skinSetup)throw new Error("material already have skin setup");this.skinSetup=e,this.inputs.addChunks(e.getChunks()),void 0===this.depthpass&&(this.depthPass=new p.default(this.gl)),this.depthPass.setSkinSetup(e),null!=this.lSetup&&this.depthPass.setLightSetup(this.lSetup)}},{key:"setMorphSetup",value:function(e){if(this.morphSetup)throw new Error("material already have morph setup");this.morphSetup=e,this.inputs.addChunks(e.getChunks()),void 0===this.depthpass&&(this.depthPass=new p.default(this.gl)),this.depthPass.setMorphSetup(e),null!=this.lSetup&&this.depthPass.setLightSetup(this.lSetup)}},{key:"prepare",value:function(e,t){this._isDirty()&&this.compile();var n=this.prg;n.use(),n.setupInputs(this),this.ibl&&this.ibl.setupProgram(n),t.modelViewProjectionMatrix(_,e._wmatrix),n.uMVP&&n.uMVP(_),n.uWorldMatrix&&n.uWorldMatrix(e._wmatrix),n.uCameraPosition&&n.uCameraPosition(t._wposition),this.renderMode!==g.RENDER_MODES.DISABLED&&n.uRenderMode(this.renderMode)}},{key:"_isDirty",value:function(){return!(null!==this.prg&&!this.inputs._isDirty)}},{key:"compile",value:function(){null!==this.prg&&this._prgcache.release(this.prg),this.prg=this._prgcache.compile(this)}}]),e}();y.RENDER_MODES=g.RENDER_MODES,t.default=y,e.exports=t.default},,function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function i(e){if(c===setTimeout)return setTimeout(e,0);if((c===n||!c)&&setTimeout)return c=setTimeout,setTimeout(e,0);try{return c(e,0)}catch(t){try{return c.call(null,e,0)}catch(t){return c.call(this,e,0)}}}function o(e){if(f===clearTimeout)return clearTimeout(e);if((f===r||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(e);try{return f(e)}catch(t){try{return f.call(null,e)}catch(t){return f.call(this,e)}}}function a(){v&&h&&(v=!1,h.length?p=h.concat(p):m=-1,p.length&&s())}function s(){if(!v){var e=i(a);v=!0;for(var t=p.length;t;){for(h=p,p=[];++m<t;)h&&h[m].run();m=-1,t=p.length}h=null,v=!1,o(e)}}function u(e,t){this.fun=e,this.array=t}function l(){}var c,f,d=e.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:n}catch(e){c=n}try{f="function"==typeof clearTimeout?clearTimeout:r}catch(e){f=r}}();var h,p=[],v=!1,m=-1;d.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];p.push(new u(e,t)),1!==p.length||v||i(s)},u.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=l,d.addListener=l,d.once=l,d.off=l,d.removeListener=l,d.removeAllListeners=l,d.emit=l,d.prependListener=l,d.prependOnceListener=l,d.listeners=function(e){return[]},d.binding=function(e){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(e){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},function(e,t,n){var r;/** @license MIT License (c) copyright 2010-2014 original author or authors */
!function(i){"use strict";void 0!==(r=function(e){function t(e,t,n,r){var i=S.resolve(e);return arguments.length<2?i:i.then(t,n,r)}function r(e){return new S(e)}function i(e){return function(){for(var t=0,n=arguments.length,r=new Array(n);t<n;++t)r[t]=arguments[t];return P(e,this,r)}}function o(e){for(var t=0,n=arguments.length-1,r=new Array(n);t<n;++t)r[t]=arguments[t+1];return P(e,this,r)}function a(){return new s}function s(){function e(e){r._handler.resolve(e)}function t(e){r._handler.reject(e)}function n(e){r._handler.notify(e)}var r=S._defer();this.promise=r,this.resolve=e,this.reject=t,this.notify=n,this.resolver={resolve:e,reject:t,notify:n}}function u(e){return e&&"function"==typeof e.then}function l(){return S.all(arguments)}function c(e){return t(e,S.all)}function f(e){return t(e,S.settle)}function d(e,n){return t(e,function(e){return S.map(e,n)})}function h(e,n){return t(e,function(e){return S.filter(e,n)})}var p=n(43),v=n(44),m=n(45),g=n(46),_=n(47),y=n(48),b=n(49),w=n(50),M=n(31),x=n(22),S=[v,m,g,y,b,_,w,p,M].reduce(function(e,t){return t(e)},n(32)),P=n(24)(S);return t.promise=r,t.resolve=S.resolve,t.reject=S.reject,t.lift=i,t.try=o,t.attempt=o,t.iterate=S.iterate,t.unfold=S.unfold,t.join=l,t.all=c,t.settle=f,t.any=i(S.any),t.some=i(S.some),t.race=i(S.race),t.map=d,t.filter=h,t.reduce=i(S.reduce),t.reduceRight=i(S.reduceRight),t.isPromiseLike=u,t.Promise=S,t.defer=a,t.TimeoutError=x,t}.call(t,n,t,e))&&(e.exports=r)}(n(0))},function(e,t,n){var r=function(e){var t="";return t+="#define GLSLIFY 1\n#ifndef _H_SPECULAR_IBL_\n#define _H_SPECULAR_IBL_\n\n"+n(95)()+"\n"+n(96)()+"\n\nconst vec2 _IBL_UVM = vec2(\n  0.25*(254.0/256.0),\n  0.125*0.5*(254.0/256.0)\n);\n\nvec3 SpecularIBL( sampler2D tEnv, vec3 skyDir, float roughness)\n{\n\n  vec2 uvA = octwrapDecode( skyDir );\n\n  float r7   = 7.0*roughness;\n  float frac = fract(r7);\n\n  uvA = uvA * _IBL_UVM + vec2(\n      0.5,\n      0.125*0.5 + 0.125 * ( r7 - frac )\n    );\n\n  #if glossNearest\n\n    return decodeRGBE( texture2D(tEnv,uvA) );\n\n  #else\n\n    vec2 uvB=uvA+vec2(0.0,0.125);\n    return  mix(\n      decodeRGBE( texture2D(tEnv,uvA) ),\n      decodeRGBE( texture2D(tEnv,uvB) ),\n      frac\n    );\n\n  #endif\n\n}\n\n#endif"};r.toString=r,e.exports=r},function(e,t,n){(function(r){var i;/** @license MIT License (c) copyright 2010-2014 original author or authors */
!function(o){"use strict";void 0!==(i=function(e){var t,i="undefined"!=typeof setTimeout&&setTimeout,o=function(e,t){return setTimeout(e,t)},a=function(e){return clearTimeout(e)},s=function(e){return i(e,0)};if(function(){return void 0!==r&&"[object process]"===Object.prototype.toString.call(r)}())s=function(e){return r.nextTick(e)};else if(t=function(){return"undefined"!=typeof MutationObserver&&MutationObserver||"undefined"!=typeof WebKitMutationObserver&&WebKitMutationObserver}())s=function(e){function t(){var e=n;n=void 0,e()}var n,r=document.createTextNode("");new e(t).observe(r,{characterData:!0});var i=0;return function(e){n=e,r.data=i^=1}}(t);else if(!i){var u=n(39);o=function(e,t){return u.setTimer(t,e)},a=u.cancelTimer,s=u.runOnLoop||u.runOnContext}return{setTimer:o,clearTimer:a,asap:s}}.call(t,n,t,e))&&(e.exports=i)}(n(0))}).call(t,n(10))},function(e,t,n){"use strict";function r(e,t){i.call(this,!0,!1),this.name=e,this._val=!!t}var i=n(28);r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.enable=function(){this.set(!0)},r.prototype.disable=function(){this.set(!1)},r.prototype.set=function(e){e=!!e,this._val!==e&&(this._val=e,this.invalidate())},r.prototype.genCode=function(e){var t;t="#define "+this.name+" "+~~this._val+"\n",e.add("pf",t),e.add("pv",t)},r.prototype.getHash=function(){return this.name+"-"+~~this._val},e.exports=r},function(e,t,n){"use strict";(function(r){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t,n,r,i){var o={};return Object.keys(r).forEach(function(e){o[e]=r[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}Object.defineProperty(t,"__esModule",{value:!0});var s,u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(30),c=i(l),f=n(72),d=i(f),h=n(73),p=i(h),v=n(79),m=i(v),g={resizeDebounceDelay:50},_=(s=function(){function e(){o(this,e),this._binded=!1,this.width=window.innerWidth,this.height=window.innerHeight,this.pixelRatio=this._getPixelRatio(),this.prWidth=this.width*this.pixelRatio,this.prHeight=this.height*this.pixelRatio,this.aspect=this._getAspectRatio(),this.isFocused=!0,this.visibility=(0,p.default)(),this.fullScreen=m.default,this._createSignals(),this.bind()}return u(e,[{key:"bind",value:function(){this._binded||(this._handleDebounceResize=(0,d.default)(this._handleResize,g.resizeDebounceDelay),window.addEventListener("resize",this._handleDebounceResize,!1),window.addEventListener("blur",this._handleBlur,!1),window.addEventListener("focus",this._handleFocus,!1),this._visibilityUnbind=this.visibility.onChange(this._onVisibilityChange),this.fullScreen.enabled&&this.fullScreen.on("change",this._onFullScreenChanged),this._binded=!0)}},{key:"unbind",value:function(){this._binded&&(window.removeEventListener("resize",this._handleDebounceResize,!1),window.removeEventListener("blur",this._handleBlur,!1),window.removeEventListener("focus",this._handleFocus,!1),this._visibilityUnbind(),this.fullScreen.enabled&&this.fullScreen.off("change",this._onFullScreenChanged),this._binded=!1)}},{key:"_createSignals",value:function(){this.resized=new c.default,this.blurred=new c.default,this.focused=new c.default,this.visibilityChanged=new c.default,this.fullScreenChanged=new c.default}},{key:"_getPixelRatio",value:function(){return Math.min(1.5,window.devicePixelRatio)}},{key:"_getAspectRatio",value:function(){return this.height>this.width?this.width/this.height:this.height/this.width}},{key:"_handleResize",value:function(e){this.pixelRatio=this._getPixelRatio(),this.width=window.innerWidth,this.height=window.innerHeight,this.prWidth=this.width*this.pixelRatio,this.prHeight=this.height*this.pixelRatio,this.aspect=this._getAspectRatio(),this.resized.dispatch(this.width,this.height,this.pixelRatio,this.aspect)}},{key:"_handleBlur",value:function(e){this.isFocused=!1,this.blurred.dispatch(e)}},{key:"_handleFocus",value:function(e){this.isFocused=!0,this.focused.dispatch(e)}},{key:"_onVisibilityChange",value:function(e){this.visibilityChanged.dispatch(e)}},{key:"_onFullScreenChanged",value:function(){this.fullScreenChanged.dispatch(this.fullScreen.isFullscreen)}}]),e}(),a(s.prototype,"_handleResize",[r],Object.getOwnPropertyDescriptor(s.prototype,"_handleResize"),s.prototype),a(s.prototype,"_handleBlur",[r],Object.getOwnPropertyDescriptor(s.prototype,"_handleBlur"),s.prototype),a(s.prototype,"_handleFocus",[r],Object.getOwnPropertyDescriptor(s.prototype,"_handleFocus"),s.prototype),a(s.prototype,"_onVisibilityChange",[r],Object.getOwnPropertyDescriptor(s.prototype,"_onVisibilityChange"),s.prototype),a(s.prototype,"_onFullScreenChanged",[r],Object.getOwnPropertyDescriptor(s.prototype,"_onFullScreenChanged"),s.prototype),s);t.default=new _,e.exports=t.default}).call(t,n(2).bind)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(30),a=function(e){return e&&e.__esModule?e:{default:e}}(o),s=function(){function e(){r(this,e),this._createSignals()}return i(e,[{key:"_createSignals",value:function(){this.app=this._generateGroup(["fade"]),this.engine=this._generateGroup(["loaded"]),this.views=this._generateGroup(["update","updated","reset","reseted","transitionUpdated"]),this.configs=this._generateGroup(["updated"]),this.library=this._generateGroup(["updated"]),this.module=this._generateGroup(["change","changed"]),this.car=this._generateGroup(["loaded"]),this.interior=this._generateGroup(["inside","outside"]),this.popup=this._generateGroup(["open","opened","closed"]),this.configurator=this._generateGroup(["transitionnedIn","lcs"]),this.experience1=this._generateGroup(["reset","reseted","tutorial"]),this.counter=this._generateGroup(["start","started","stop","stopped"]),this.pathDrawer=this._generateGroup(["pathCompleted","completed"]),this.experience2=this._generateGroup(["tutorial","ended"])}},{key:"_generateGroup",value:function(e){for(var t={},n=0,r=e.length;n<r;n++)t[e[n]]=new a.default;return t}}]),e}();t.default=new s,e.exports=t.default},function(e,t){!function(){function t(e){return e|(4096&e)>>>2|(2048&e)>>>2|(524288&e)>>>3|(1048576&e)>>>3|(2097152&e)>>>3}function n(e){return 0|Math.round(65535*e)}function r(e){return e/65535}function i(e){var t=(31744&e)>>10,n=1023&e;return(e>>15?-1:1)*(t?31===t?n?NaN:1/0:Math.pow(2,t-15)*(1+n/1024):n/1024*6103515625e-14)}function o(e){s[0]=e;var t=u[0],n=t>>31<<5,r=t>>23&255;return r=r-112&112-r>>4>>27,n=(n|r)<<10,n|=t>>13&1023}function a(){this._dat=new Uint16Array(51),this._set=0}var s=new Float32Array(1),u=new Uint32Array(s.buffer),l=[1,512,1024,1024,2048,4096,4096,4,8192,2,16384,32768,256,65536,65536,65536,262144,131072,131072,131072,524288,524288,524288,2097152,1048576,1048576,1048576,128,4194304,4194304,4194304,4194304,8,16,8388608,8388608,32,64,16777216,33554432,67108864,67108864,67108864,67108864,134217728,134217728,134217728,134217728,268435456,268435456,536870912],c=new Uint16Array([0,32774,0,1,0,0,0,0,513,0,1029,2305,0,519,0,65535,65535,7680,7680,7680,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,15,1,0,0,0,0,0,0,0,0,n(0),n(1),o(1)]),f=function(e,t){return e.getParameter(t)};a.DAT_MASKS=l,a.encodeHalf=function(e){return o(e)},a.decodeHalf=function(e){return i(e)},a.prototype={toDefault:function(){this._dat.set(c),this._set=935847839},clone:function(){var e=new a;return e._dat.set(this._dat),e._set=this._set,e},patch:function(e,n){for(var r,i=this._dat,o=this._set,a=e._dat,s=e._set,u=n._dat,c=0,f=0;51>f;f++)r=l[f],0!=(o&r)&&((0==(s&r)||i[f]!==a[f])&&(c|=r),a[f]=i[f]);u.set(a),e._set|=o,n._set=t(c)},setupGL:function(e){var t,n=this._set,o=this._dat;if(0!=(1&n)&&(o[0]?e.enable(3042):e.disable(3042)),t=2560&n,0!==t&&(2560===t?e.blendEquationSeparate(o[1],o[4]):e.blendEquation(o[1])),t=5120&n,0!==t&&(5120===t?e.blendFuncSeparate(o[3],o[2],o[6],o[5]):e.blendFunc(o[3],o[2])),0!=(4&n)&&(o[7]?e.enable(2929):e.disable(2929)),0!=(8192&n)&&e.depthFunc(o[8]),0!=(2&n)&&(o[9]?e.enable(2884):e.disable(2884)),0!=(16384&n)&&e.cullFace(o[10]),0!=(32768&n)&&e.frontFace(o[11]),0!=(536870912&n)&&e.lineWidth(i(o[50])),0!=(256&n)&&(o[12]?e.enable(2960):e.disable(2960)),t=589824&n,0!==t&&(589824===t?(e.stencilFuncSeparate(1028,o[13],o[14],o[15]),e.stencilFuncSeparate(1029,o[20],o[21],o[22])):e.stencilFunc(o[13],o[14],o[15])),t=1179648&n,0!==t&&(1179648===t?(e.stencilOpSeparate(1028,o[17],o[18],o[19]),e.stencilOpSeparate(1029,o[24],o[25],o[26])):e.stencilOp(o[17],o[18],o[19])),t=2359296&n,0!==t&&(2359296===t?(e.stencilMaskSeparate(1028,o[16]),e.stencilMaskSeparate(1029,o[23])):e.stencilMask(o[16])),0!=(16777216&n)){var a=o[38];e.colorMask(1==(1&a),2==(2&a),4==(4&a),8==(8&a))}0!=(33554432&n)&&e.depthMask(1===o[39]),0!=(67108864&n)&&e.blendColor(i(o[40]),i(o[41]),i(o[42]),i(o[43])),0!=(128&n)&&(o[27]?e.enable(3089):e.disable(3089)),0!=(4194304&n)&&e.scissor(o[28],o[29],o[30],o[31]),0!=(134217728&n)&&e.viewport(o[44],o[45],o[46],o[47]),0!=(16&n)&&(o[33]?e.enable(32823):e.disable(32823)),0!=(8388608&n)&&e.polygonOffset(i(o[34]),i(o[35])),0!=(268435456&n)&&e.depthRange(r(o[48]),r(o[49]))},fromGL:function(e){this._set=0;var t=f(e,3042),n=f(e,2884),r=f(e,2929),i=f(e,3024),o=f(e,32823),a=f(e,3089),s=f(e,2960),u=f(e,32969),l=f(e,32968),c=f(e,32971),d=f(e,32970),h=f(e,32777),p=f(e,34877),v=f(e,2962),m=f(e,2967),g=f(e,2963),_=f(e,2968),y=f(e,2964),b=f(e,2965),w=f(e,2966),M=f(e,34816),x=f(e,36003),S=f(e,36004),P=f(e,36005),C=f(e,34817),T=f(e,34818),A=f(e,34819),O=f(e,32824),I=f(e,10752),E=f(e,3088),D=f(e,3107),k=f(e,2930),R=f(e,32773),N=f(e,2978),F=f(e,2928),L=f(e,2849);this.enableBlend(t),u!==c||l!==d?this.blendFuncSeparate(u,l,c,d):this.blendFunc(u,l),h!==p?this.blendEquationSeparate(h,p):this.blendEquation(h),this.enableStencil(s),v!==M||m!==x||g!==S?this.stencilFuncSeparate(v,m,g,M,x,S):this.stencilFunc(v,m,g),y!==C||b!==T||w!==A?this.stencilOpSeparate(y,b,w,C,T,A):this.stencilOp(y,b,w),_!==P?this.stencilMaskSeparate(_,P):this.stencilMask(_),this.depthFunc(e.getParameter(2932)),this.enableDepthTest(r),this.cullFace(e.getParameter(2885)),this.enableCullface(n),this.frontFace(e.getParameter(2886)),this.enablePolygonOffset(o),this.polygonOffset(O,I),this.enableScissor(a),this.scissor(E[0],E[1],E[2],E[3]),this.enableDither(i),this.colorMask(D[0],D[1],D[2],D[3]),this.depthMask(k),this.blendColor(R[0],R[1],R[2],R[3]),this.viewport(N[0],N[1],N[2],N[3]),this.depthRange(F[0],F[1]),this.lineWidth(L)},enableBlend:function(e){return void 0===e&&(e=!0),this._dat[0]=0|e,this._set|=1,this},blendFunc:function(e,t){return this._dat[3]=e,this._dat[2]=t,this._set=-4097&this._set|1024,this},blendFuncSeparate:function(e,t,n,r){return this._dat[3]=e,this._dat[2]=t,this._dat[6]=n,this._dat[5]=r,this._set|=5120,this},blendEquation:function(e){return this._dat[1]=e,this._set=-2049&this._set|512,this},blendEquationSeparate:function(e,t){return this._dat[1]=e,this._dat[4]=t,this._set|=2560,this},blendColor:function(e,t,n,r){return this._dat[40]=o(e),this._dat[41]=o(t),this._dat[42]=o(n),this._dat[43]=o(r),this._set|=67108864,this},depthFunc:function(e){return this._dat[8]=e,this._set|=8192,this},enableDepthTest:function(e){return void 0===e&&(e=!0),this._dat[7]=0|e,this._set|=4,this},depthRange:function(e,t){return this._dat[48]=n(e),this._dat[49]=n(t),this._set|=268435456,this},lineWidth:function(e){return this._dat[50]=o(e),this._set|=536870912,this},cullFace:function(e){return this._dat[10]=e,this._set|=16384,this},enableCullface:function(e){return void 0===e&&(e=!0),this._dat[9]=0|e,this._set|=2,this},polygonOffset:function(e,t){return this._dat[34]=o(e),this._dat[35]=o(t),this._set|=8388608,this},enablePolygonOffset:function(e){return void 0===e&&(e=!0),this._dat[33]=0|e,this._set|=16,this},enableScissor:function(e){return void 0===e&&(e=!0),this._dat[27]=0|e,this._set|=128,this},scissor:function(e,t,n,r){return this._dat[28]=e,this._dat[29]=t,this._dat[30]=n,this._dat[31]=r,this._set|=4194304,this},viewport:function(e,t,n,r){return this._dat[44]=e,this._dat[45]=t,this._dat[46]=n,this._dat[47]=r,this._set|=134217728,this},enableDither:function(e){return void 0===e&&(e=!0),this._dat[32]=0|e,this._set|=8,this},depthMask:function(e){return this._dat[39]=0|e,this._set|=33554432,this},colorMask:function(e,t,n,r){var i=0|e|(0|t)<<1|(0|n)<<2|(0|r)<<3;return this._dat[38]=i,this._set|=16777216,this},frontFace:function(e){return this._dat[11]=e,this._set|=32768,this},enableStencil:function(e){return void 0===e&&(e=!0),this._dat[12]=0|e,this._set|=256,this},stencilFunc:function(e,t,n){return this._dat[13]=e,this._dat[14]=t,this._dat[15]=n,this._set=-524289&this._set|65536,this},stencilOp:function(e,t,n){return this._dat[17]=e,this._dat[18]=t,this._dat[19]=n,this._set=-1048577&this._set|131072,this},stencilMask:function(e){return this._dat[16]=e,this._set=-2097153&this._set|262144,this},stencilFuncSeparate:function(e,t,n,r,i,o){var a=this._dat;return a[13]=e,a[14]=t,a[15]=n,a[20]=r,a[21]=i,a[22]=o,this._set|=589824,this},stencilOpSeparate:function(e,t,n,r,i,o){var a=this._dat;return a[17]=e,a[18]=t,a[19]=n,a[24]=r,a[25]=i,a[26]=o,this._set|=1179648,this},stencilMaskSeparate:function(e,t){return this._dat[16]=e,this._dat[23]=t,this._set|=2359296,this}},e.exports=a}()},function(e,t,n){"use strict";function r(e){return Math.min(1,Math.max(0,e))}function i(e,t,n){return Math.min(n,Math.max(t,e))}function o(e){return e<0?-1:1}function a(e,t,n,r,i){return(e-t)/(n-t)*(i-r)+r}function s(e,t,n){return e*(1-n)+t*n}function u(e,t){return Math.floor(Math.random()*(t-e+1)+e)}function l(e,t){return Math.min(e+Math.random()*(t-e),t)}function c(e){for(;e>=D;)e-=D;for(;e<0;)e+=D;return e}function f(e,t,n,r){return s(e,t,1-Math.pow(1-r/60,60*n*100))}function d(e,t){var n=t-e,r=n-D,i=n+D;return Math.abs(r)<Math.abs(n)&&(n=r),Math.abs(i)<Math.abs(n)&&(n=i),e+n}function h(e,t){var n=e-t;return function(e,t){return(e%t+t)%t}(n+Math.PI,D)-Math.PI>0?1:-1}function p(e,t){var n=Math.abs(e-t)%D;return n>Math.PI?D-n:n}function v(e,t){return p(t,e)*h(t,e)+e}function m(e,t){C.vec3.normalize(I,t),C.vec3.cross(A,E,I),C.vec3.normalize(A,A),C.vec3.cross(O,I,A),e.set(T)}function g(e){return e*Math.PI/180}function _(e){return 180*e/Math.PI}function y(e,t,n,r,i){var o=t[n+0],a=t[n+1],s=t[n+2],u=t[n+3],l=t[r+0],c=t[r+1],f=t[r+2],d=t[r+3],h=void 0,p=void 0,v=void 0,m=void 0,g=void 0;return p=o*l+a*c+s*f+u*d,p<0&&(p=-p,l=-l,c=-c,f=-f,d=-d),1-p>1e-6?(h=Math.acos(p),v=Math.sin(h),m=Math.sin((1-i)*h)/v,g=Math.sin(i*h)/v):(m=1-i,g=i),e[0]=m*o+g*l,e[1]=m*a+g*c,e[2]=m*s+g*f,e[3]=m*u+g*d,e}function b(e){for(var t=1;t<e;)t<<=1;return t}function w(e,t){return e<0&&(e=t+e%t),e>=t?e%t:e}function M(e,t,n,r){var i=.5*Math.PI/180;t*=i,n*=i,r*=i;var o=Math.sin(t),a=Math.cos(t),s=Math.sin(n),u=Math.cos(n),l=Math.sin(r),c=Math.cos(r);return e[0]=o*u*c-a*s*l,e[1]=a*s*c+o*u*l,e[2]=a*u*l-o*s*c,e[3]=a*u*c+o*s*l,e}function x(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return t=Math.pow(10,t),Math.round(e*t)/t}function S(e,t,n){return t+(n-t)*e}function P(e,t,n,r){var i=e-n,o=t-r;return Math.sqrt(i*i+o*o)}Object.defineProperty(t,"__esModule",{value:!0});var C=n(1),T=C.mat3.create(),A=new Float32Array(T.buffer,0,3),O=new Float32Array(T.buffer,12,3),I=new Float32Array(T.buffer,24,3),E=C.vec3.fromValues(0,1,0),D=2*Math.PI;t.default={clampNorm:r,clamp:i,sign:o,map:a,mix:s,randomInt:u,randomFloat:l,normalizeAngle:c,damping:f,normalizeDeltaAngle:d,shortestAngle:v,mat3Lookat:m,toRadians:g,toDegrees:_,quatSlerp:y,nextPOT:b,modAbs:w,fromEuler:M,round:x,lerp:S,distance:P},e.exports=t.default},function(e,t,n){function r(e,t,n){this.gl=e,this.usage=n||e.STATIC_DRAW,this.buffer=e.createBuffer(),this.attribs=[],this.stride=0,this.byteLength=0,this.length=0,t&&this.data(t)}var i=n(90),o=34962;r.prototype={bind:function(){this.gl.bindBuffer(o,this.buffer)},attrib:function(e,t,n,r){return this.attribs.push({name:e,type:0|n,size:0|t,normalize:!!r,offset:this.stride}),this.stride+=i.getComponentSize(n)*t,this._computeLength(),this},data:function(e){var t=this.gl;t.bindBuffer(o,this.buffer),t.bufferData(o,e,this.usage),t.bindBuffer(o,null),this.byteLength=void 0===e.byteLength?e:e.byteLength,this._computeLength()},subData:function(e,t){var n=this.gl;n.bindBuffer(o,this.buffer),n.bufferSubData(o,t,e),n.bindBuffer(o,null)},attribPointer:function(e){var t=this.gl;t.bindBuffer(o,this.buffer);for(var n=0;n<this.attribs.length;n++){var r=this.attribs[n];if(void 0!==e[r.name]){var i=e[r.name]();t.enableVertexAttribArray(i),t.vertexAttribPointer(i,r.size,r.type,r.normalize,this.stride,r.offset)}}},draw:function(e,t,n){t=void 0===t?this.length:t,this.gl.drawArrays(e,n,0|t)},dispose:function(){this.gl.deleteBuffer(this.buffer),this.buffer=null,this.gl=null},_computeLength:function(){this.stride>0&&(this.length=this.byteLength/this.stride)}},i.Drawable(r.prototype),e.exports=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(){}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(92),u=r(s),l=n(58),c=r(l),f=n(174),d=r(f),h=function(){function e(t){i(this,e);var n=t.gl;this.scene=t,this.gl=n,this.materials={},this.matlist=[];var r=new u.default(n);r.setLightSetup(this.scene.lights.setup),this.depthPass=r,this.depthCfg=t.glstate.config().enableCullface(!1).enableDepthTest(!0).depthMask(!0)}return a(e,[{key:"dummy",value:function(){return{compile:o,prg:{use:o}}}},{key:"dispose",value:function(){this.gl=null,this.scene=null,this.materials=null,this.matlist=null}},{key:"createProvider",value:function(e){return new d.default(this,e)}},{key:"update",value:function(e){this.time+=e,this.uTime.set(this.time)}},{key:"registerMaterial",value:function(e,t){void 0===this.materials[t]&&(this.materials[t]=e,this.matlist.push(e))}},{key:"createBaseMaterial",value:function(){var e=new c.default(this.gl);return e._precision="highp",e.setIBL(this.scene.env.ibl),e.setLightSetup(this.scene.lights.setup),e.perVertexIrrad.disable(),e}},{key:"getMaterial",value:function(e){var t=this.materials[e];return void 0===t&&(t=this.defaultMaterial),t}},{key:"setOpaque",value:function(t){t._mask=e.OPAQUE,t.config.enableCullface(),t.config.enableDepthTest(),t.config.depthMask(!0)}},{key:"setGlass",value:function(t,n,r,i){t._mask=e.BLENDED,t.config.enableCullface(),t.config.enableDepthTest(),t.config.depthMask(!1),t.config.enableBlend(),t.config.blendFunc(this.gl.ONE,this.gl.CONSTANT_COLOR),t.config.blendColor(n,r,i,1)}},{key:"setTransparent",value:function(t){t._mask=e.BLENDED,t.config.enableCullface(),t.config.enableDepthTest(),t.config.depthMask(!1),t.config.enableBlend(),t.config.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA)}},{key:"compileAll",value:function(){this.matlist.forEach(function(e){e.compile(),e.prg.use()})}}]),e}();h.OPAQUE=1,h.BLENDED=2,t.default=h,e.exports=t.default},function(e,t,n){var r=function(e){var t="";return t+="#define GLSLIFY 1\n"+n(95)()+"\n"+n(96)()+"\n\nvec3 SampleEnvHi( sampler2D tEnv, vec3 skyDir ) {\n  vec2 uvA = octwrapDecode( skyDir );\n\n  uvA = vec2(\n    0.25*(254.0/256.0),\n    0.5 *(254.0/256.0)\n    ) * uvA + vec2(0.5,0.5);\n\n  return decodeRGBE( texture2D(tEnv, uvA) );\n}\n"};r.toString=r,e.exports=r},function(e,t,n){var r;/** @license MIT License (c) copyright 2010-2014 original author or authors */
!function(i){"use strict";void 0!==(r=function(){function e(t){Error.call(this),this.message=t,this.name=e.name,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,e)}return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}.call(t,n,t,e))&&(e.exports=r)}(n(0))},function(e,t,n){var r;/** @license MIT License (c) copyright 2010-2014 original author or authors */
!function(i){"use strict";void 0!==(r=function(){function e(){return{state:"pending"}}function t(e){return{state:"rejected",reason:e}}function n(e){return{state:"fulfilled",value:e}}function r(r){var i=r.state();return 0===i?e():i>0?n(r.value):t(r.value)}return{pending:e,fulfilled:n,rejected:t,inspect:r}}.call(t,n,t,e))&&(e.exports=r)}(n(0))},function(e,t,n){var r;/** @license MIT License (c) copyright 2010-2014 original author or authors */
!function(i){"use strict";void 0!==(r=function(){function e(e,n){function r(t,r,o){var a=e._defer(),s=o.length;return i({f:t,thisArg:r,args:o,params:new Array(s),i:s-1,call:n},a._handler),a}function i(t,r){if(t.i<0)return n(t.f,t.thisArg,t.params,r);e._handler(t.args[t.i]).fold(o,t,void 0,r)}function o(e,t,n){e.params[e.i]=t,e.i-=1,i(e,n)}return arguments.length<2&&(n=t),r}function t(e,t,n,r){try{r.resolve(e.apply(t,n))}catch(e){r.reject(e)}}return e.tryCatchResolve=t,e}.call(t,n,t,e))&&(e.exports=r)}(n(0))},function(e,t){var n=function(e){var t="";return t+="#define GLSLIFY 1\nuniform float uRenderMode;\n"};n.toString=n,e.exports=n},function(e,t){var n=function(e){var t="";return t+="#define GLSLIFY 1\nif(uRenderMode == 1.) {\n  float fogHeightFactor = max(0.0, vWorldPosition.y * 0.55);\n  fogHeightFactor = pow(exp2(-fogHeightFactor * fogHeightFactor), 16.0);\n\n  FragColor.xyz = mix(vec3(1.0), clamp(FragColor.xyz, 0.0, 1.0), fogHeightFactor);\n}\n"};n.toString=n,e.exports=n},function(e,t){function n(e,t,n,r){this.gl=e,this.program=e.createProgram(),this.vShader=e.createShader(e.VERTEX_SHADER),this.fShader=e.createShader(e.FRAGMENT_SHADER),this.dyns=[],this.ready=!1,e.attachShader(this.program,this.vShader),e.attachShader(this.program,this.fShader),this._uid=0|p++,this._cuid=0|p++,void 0!==t&&void 0!==n&&this.compile(t,n,r)}function r(e){console.warn(e)}function i(e,t){return v[String(t+1).length]+(t+1)+": "+e}function o(e){return e.split("\n").map(i).join("\n")}function a(e,t,i){return e.shaderSource(t,i),e.compileShader(t),!(n.debug&&!e.getShaderParameter(t,e.COMPILE_STATUS))||(r(e.getShaderInfoLog(t)),r(o(i)),!1)}function s(e){return e=String(e),"uniform"+m[e]}function u(e,t,n,r){switch(e){case n.FLOAT_MAT2:case n.FLOAT_MAT3:case n.FLOAT_MAT4:return c(e,t,n,r);case n.SAMPLER_2D:case n.SAMPLER_CUBE:case 35682:case 35679:return f(e,t,n,r);default:return l(e,t,n,r)}}function l(e,t,n,r){var i=s(e);return function(){return 1===arguments.length&&void 0!==arguments[0].length?n[i+"v"](t,arguments[0]):arguments.length>0&&n[i].apply(n,Array.prototype.concat.apply(t,arguments)),t}}function c(e,t,n,r){var i=s(e);return function(){if(arguments.length>0&&void 0!==arguments[0].length){var e=arguments.length>1&&!!arguments[1];n[i+"v"](t,e,arguments[0])}return t}}function f(e,t,n,r){var i=r.texIndex++;return function(){return 1===arguments.length&&(void 0!==arguments[0].bind?(arguments[0].bind(i),n.uniform1i(t,i)):n.uniform1i(t,arguments[0])),t}}function d(e,t,n){var r=n.ublockIndex++;return function(){return 1===arguments.length&&(arguments[0]instanceof WebGLBuffer?(t.uniformBlockBinding(this.program,e,r),t.bindBufferBase(t.UNIFORM_BUFFER,r,arguments[0])):t.uniformBlockBinding(this.program,e,arguments[0])),e}}function h(e){return function(){return e}}var p=0;n.debug=!0,n.prototype={use:function(){this.ready||this._grabParameters(),this.gl.useProgram(this.program)},compile:function(e,t,i){this.ready=!1,i=void 0===i?"":i+"\n";var o=this.gl;if(!a(o,this.fShader,i+t)||!a(o,this.vShader,i+e))return!1;if(o.linkProgram(this.program),n.debug&&!o.getProgramParameter(this.program,o.LINK_STATUS))return r(o.getProgramInfoLog(this.program)),!1;for(;this.dyns.length>0;)delete this[this.dyns.pop()];return this._cuid=0|p++,!0},dispose:function(){null!==this.gl&&(this.gl.deleteProgram(this.program),this.gl.deleteShader(this.fShader),this.gl.deleteShader(this.vShader),this.gl=null)},_grabParameters:function(){for(var e=this.gl,t=this.program,n={texIndex:0,ublockIndex:0},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),i=0;i<r;++i){var o=e.getActiveUniform(t,i);if(null!==o){var a=o.name,s=a.indexOf("[");s>=0&&(a=a.substring(0,s));var l=e.getUniformLocation(t,o.name);null!==l&&(this[a]=u(o.type,l,e,n),this.dyns.push(a))}else e.getError()}for(var c=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),f=0;f<c;++f){var p=e.getActiveAttrib(t,f).name,v=e.getAttribLocation(t,p);this[p]=h(v),this.dyns.push(p)}if(void 0!==e.ACTIVE_UNIFORM_BLOCKS)for(var m=e.getProgramParameter(t,e.ACTIVE_UNIFORM_BLOCKS),g=0;g<m;++g){var _=e.getActiveUniformBlockName(t,g);this[_]=d(g,e,n),this.dyns.push(_)}this.ready=!0}},n.prototype.bind=n.prototype.use;var v=["","   ","  "," ",""],m={};m[5126]="1f",m[35664]="2f",m[35665]="3f",m[35666]="4f",m[35670]=m[5124]=m[35678]=m[35680]="1i",m[35671]=m[35667]="2i",m[35672]=m[35668]="3i",m[35673]=m[35669]="4i",m[35674]="Matrix2f",m[35675]="Matrix3f",m[35676]="Matrix4f",e.exports=n},function(e,t,n){"use strict";function r(e,t){this.list=null,this.children=[],this.parent=null,this._hasCode=!!e,this._hasSetup=!!t,this._invalid=!0,this._proxies=[]}function i(e){r.call(this,e._hasCode,e._hasSetup),this._ref=e}r.prototype={genCode:function(e){return""},getHash:function(){return""},setup:function(e){},add:function(e){if(!(this.children.indexOf(e)>-1)){this.children.push(e),e.setList(this.list),e.parent=this;for(var t=0;t<this._proxies.length;t++)this._proxies[t].add(e.createProxy());return this.invalidate(),e}},remove:function(e){var t=this.children.indexOf(e);t>-1&&(this.children.splice(t,1),e.parent=null,e.removeProxies()),this.invalidate()},setList:function(e){this.list=e,this.invalidate();for(var t=0;t<this.children.length;t++)this.children[t].setList(e)},traverse:function(e,t,n){if(-1===n.indexOf(this)){for(var r=0;r<this.children.length;r++)this.children[r].traverse(e,t,n);this._hasSetup&&e.push(this),this._hasCode&&t.push(this),n.push(this)}},invalidate:function(){this.list&&(this.list._isDirty=!0);for(var e=0;e<this._proxies.length;e++)this._proxies[e].invalidate()},createProxy:function(){for(var e=new i(this),t=0;t<this.children.length;t++)e.add(this.children[t].createProxy());return this._proxies.push(e),e},releaseProxy:function(e){var t=this._proxies.indexOf(e);t>-1&&this._proxies.splice(t,1)},removeProxies:function(){for(var e=0;e<this._proxies.length;e++){var t=this._proxies[e];null!==t.parent&&t.parent.remove(t)}}},i.prototype=Object.create(r.prototype),i.prototype.constructor=i,i.prototype.genCode=function(e){this._ref.genCode(e)},i.prototype.getHash=function(){return this._ref.getHash()},i.prototype.setup=function(e){this._ref.setup(e)},i.prototype.release=function(){this._ref.releaseProxy(this),this._ref=null},r.Proxy=i,e.exports=r},function(e,t){function n(e,t,n){return 9728|+e|+t<<8|+(t&&n)<<1}function r(e,t,n,r){this._uid=i++,this.gl=e,this.id=e.createTexture(),this.width=0,this.height=0,this.setFormat(t,n,r),e.bindTexture(o,this.id),this.setFilter(!0)}var i=0,o=3553;r.prototype={setFormat:function(e,t,n){this.format=e||this.gl.RGB,this.internal=n||this.format,this.type=t||this.gl.UNSIGNED_BYTE},fromImage:function(e){var t=this.gl;this.width=e.width,this.height=e.height,t.bindTexture(o,this.id),t.texImage2D(o,0,this.internal,this.format,this.type,e)},fromData:function(e,t,n){var r=this.gl;this.width=e,this.height=t,n=n||null,r.bindTexture(o,this.id),r.texImage2D(o,0,this.internal,e,t,0,this.format,this.type,n)},bind:function(e){var t=this.gl;void 0!==e&&t.activeTexture(t.TEXTURE0+(0|e)),t.bindTexture(o,this.id)},dispose:function(){this.gl.deleteTexture(this.id),this.id=null,this.gl=null},setFilter:function(e,t,r){var i=this.gl,a=n(!!e,!!t,!!r);i.texParameteri(o,i.TEXTURE_MAG_FILTER,n(!!e,!1,!1)),i.texParameteri(o,i.TEXTURE_MIN_FILTER,a)},repeat:function(){this.wrap(this.gl.REPEAT)},clamp:function(){this.wrap(this.gl.CLAMP_TO_EDGE)},mirror:function(){this.wrap(this.gl.MIRRORED_REPEAT)},wrap:function(e){var t=this.gl;t.texParameteri(o,t.TEXTURE_WRAP_S,e),t.texParameteri(o,t.TEXTURE_WRAP_T,e)}},e.exports=r},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(){r(this,e),this._listeners=[],this._dispatchNb=0}return o(e,[{key:"add",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{priority:0,once:!1,context:this},n=i({context:this},t,{function:e});if("function"!=typeof n.function)throw new TypeError("Signal.add() : First argument must be a Function");if(-1!==this._getListernerIndex(n.function,n.context))throw new Error("Signal.add() : Listener already exists");return this._listeners.push(n),this._listeners.sort(function(e,t){return e.priority<t.priority}),this}},{key:"once",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.add(e,i({},t,{once:!0}))}},{key:"remove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;if("function"!=typeof e)throw new TypeError("Signal.remove() : First argument must be a Function");var n=this._getListernerIndex(e,t);return-1!==n&&this._listeners.splice(n,1),this}},{key:"removeAll",value:function(){return this._listeners=[],this}},{key:"dispatch",value:function(){this._dispatchNb++;for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0;r<this._listeners.length;r++){var i,o=this._listeners[r];o.once&&this._listeners.splice(r);if(!1===(i=o.function).call.apply(i,[o.context].concat(t)))break}return this}},{key:"has",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;return-1!==this._getListernerIndex(e,t)}},{key:"getListenersNb",value:function(){return this._listeners.length}},{key:"getDispatchNb",value:function(){return this._dispatchNb}},{key:"_getListernerIndex",value:function(e,t){for(var n=0,r=this._listeners.length;n<r;n++)if(this._listeners[n].function===e&&this._listeners[n].context===t)return n;return-1}}]),e}();t.default=a,e.exports=t.default},function(e,t,n){var r;/** @license MIT License (c) copyright 2010-2014 original author or authors */
!function(i){"use strict";void 0!==(r=function(e){function t(e){throw e}function r(){}var i=n(13).setTimer,o=n(40);return function(e){function n(e){e.handled||(h.push(e),c("Potentially unhandled rejection ["+e.id+"] "+o.formatError(e.value)))}function a(e){var t=h.indexOf(e);t>=0&&(h.splice(t,1),f("Handled previous rejection ["+e.id+"] "+o.formatObject(e.value)))}function s(e,t){d.push(e,t),null===p&&(p=i(u,0))}function u(){for(p=null;d.length>0;)d.shift()(d.shift())}var l,c=r,f=r;"undefined"!=typeof console&&(l=console,c=void 0!==l.error?function(e){l.error(e)}:function(e){l.log(e)},f=void 0!==l.info?function(e){l.info(e)}:function(e){l.log(e)}),e.onPotentiallyUnhandledRejection=function(e){s(n,e)},e.onPotentiallyUnhandledRejectionHandled=function(e){s(a,e)},e.onFatalRejection=function(e){s(t,e.value)};var d=[],h=[],p=null;return e}}.call(t,n,t,e))&&(e.exports=r)}(n(0))},function(e,t,n){var r;/** @license MIT License (c) copyright 2010-2014 original author or authors */
!function(i){"use strict";void 0!==(r=function(e){return n(41)({scheduler:new(n(42))(n(13).asap)})}.call(t,n,t,e))&&(e.exports=r)}(n(0))},function(e,t,n){"use strict";function r(e){function t(){r--,n.notify(1-r/e.length),0===r&&n.resolve(!0)}for(var n=p.default.defer(),r=e.length,i=0;i<e.length;i++)e[i].then(t,n.reject);return n.promise}function i(e,t){var n=p.default.defer(),r=p.default.defer(),i=Date.now(),o=0;e.then(null,null,function(e){o=e});var a=setInterval(function(){var e=Date.now()-i,a=Math.min(e/t,o);e>t&&r.resolve(),n.notify(a)},50);return p.default.all([e,r.promise]).then(function(){clearInterval(a),n.resolve(!0)},n.reject),n.promise}function o(e){return l(e,"").then(function(e){return JSON.parse(e)})}function a(e){return l(e,"arraybuffer")}function s(e){var t=p.default.defer(),n=new window.Image;return n.onload=function(){t.resolve(n)},n.onerror=function(){t.reject()},n.crossOrigin="anonymous",n.src=e,t.promise}function u(){for(var e=0;e<v.length;e++)v[e].xhr.abort(),v[e].defer.reject();m={},v.length=0}function l(e,t){return f(e,t).defer.promise.then(c)}function c(e){return e.xhr.response}function f(e,t){var n=void 0,r=void 0;n=p.default.defer(),r=new window.XMLHttpRequest;var i={xhr:r,id:g++,defer:n};return r.open("GET",e,!0),"arraybuffer"===t&&r.setRequestHeader("Accept","application/octet-stream"),r.responseType=t,r.onload=function(){return n.resolve(i)},r.error=function(e){return n.reject(i)},r.send(),v.push(i),m[i.id]=i,n.promise.then(d),i}function d(e){delete m[e.id];var t=v.indexOf(e);t>-1&&v.splice(t,1)}Object.defineProperty(t,"__esModule",{value:!0});var h=n(11),p=function(e){return e&&e.__esModule?e:{default:e}}(h),v=[],m={},g=0;t.default={loadJson:o,loadBytes:a,loadImage:s,whenAll:r,releaseAll:u,throttling:i},e.exports=t.default},function(e,t){var n=function(e){var t="";return t+="#define GLSLIFY 1\nconst float LOG2 = -1.442695;\n\nvec3 fogExp2(const float density, const vec3 color) {\n  float dist = gl_FragCoord.z / gl_FragCoord.w;\n  float d = density * dist;\n  return mix(FragColor.rgb, color, 1.0 - clamp(exp2(d * d * LOG2), 0.0, 1.0));\n}\n"};n.toString=n,e.exports=n},function(e,t){var n=function(e){var t="";return t+="#define GLSLIFY 1\nfloat fogDensity = 0.007;\nvec3 fogColor = vec3(1.0);\n\nFragColor.rgb = fogExp2(fogDensity, fogColor);\n"};n.toString=n,e.exports=n},function(e,t,n){"use strict";/**
 * Bind decorator.
 * @function bind
 *
 * @license {@link https://opensource.org/licenses/MIT|MIT}
 *
 * @author Patrick Heng <hengpatrick.pro@gmail.com>
 * @author Fabien Motte <contact@fabienmotte.com>
 *
 * @param {Object} target Target.
 * @param {string} key Target key.
 * @param {Object} descriptor Descriptor for the target being modified.
 * @param {function} descriptor.value Value.
 * @param {function} descriptor.configurable Configurable.
 * @param {function} descriptor.enumerable Enumerable.
 *
 * @throws {SyntaxError} Bind decorator can only be applied to a method.
 *
 * @returns {function} Bound function.
 */
function r(e,t,n){if(void 0===n||"function"!=typeof n.value)throw new SyntaxError("@bind decorator can only be applied to a method");var r=n.value;return{configurable:n.configurable,enumerable:n.enumerable,get:function(){if(this===e)return r;var n=r.bind(this);return Object.defineProperty(this,t,{configurable:!0,writable:!0,enumerable:!1,value:n}),n}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,e.exports=t.default},function(e,t,n){"use strict";/**
 * Mixin decorator.
 * @function mixin
 *
 * @license {@link https://opensource.org/licenses/MIT|MIT}
 *
 * @author Patrick Heng <hengpatrick.pro@gmail.com>
 * @author Fabien Motte <contact@fabienmotte.com>
 *
 * @param {...Object} mixins Mixin(s).
 *
 * @throws {SyntaxError} Mixin decorator requires at least one mixin.
 *
 * @returns {function} Wrapped target class.
 */
function r(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if("function"==typeof t[0])throw new SyntaxError("@mixin decorator '"+t[0].name+"' requires at least one mixin");return function(e){for(var n=e.prototype,r={},i=0,o=t.length;i<o;i++){var a=t[i];for(var s in a){var u=a[s];"function"==typeof u?(r[s]=r[s]||[],r[s].push(u)):n[s]=u}}for(var l in r)!function(e){var t=r[e],i=n[e];n[e]=function(){for(var e=void 0,n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];for(var a=0,s=t.length;a<s;a++){e=t[a].apply(this,r)}return"function"==typeof i&&(e=i.apply(this,r)),e}}(l)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,e.exports=t.default},function(e,t){var n={};n.EPSILON=1e-6,n.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,n.RANDOM=Math.random,n.setMatrixArrayType=function(e){GLMAT_ARRAY_TYPE=e};var r=Math.PI/180;n.toRadian=function(e){return e*r},e.exports=n},function(e,t){},function(e,t,n){var r;/** @license MIT License (c) copyright 2010-2014 original author or authors */
!function(i){"use strict";void 0!==(r=function(){function e(e){var n="object"==typeof e&&null!==e&&(e.stack||e.message)?e.stack||e.message:t(e);return e instanceof Error?n:n+" (WARNING: non-Error used)"}function t(e){var t=String(e);return"[object Object]"===t&&"undefined"!=typeof JSON&&(t=n(e,t)),t}function n(e,t){try{return JSON.stringify(e)}catch(e){return t}}return{formatError:e,formatObject:t,tryStringify:n}}.call(t,n,t,e))&&(e.exports=r)}(n(0))},function(e,t,n){(function(r){var i;/** @license MIT License (c) copyright 2010-2014 original author or authors */
!function(o){"use strict";void 0!==(i=function(){return function(e){function t(e,t){this._handler=e===b?t:n(e)}function n(e){function t(e){i.resolve(e)}function n(e){i.reject(e)}function r(e){i.notify(e)}var i=new M;try{e(t,n,r)}catch(e){n(e)}return i}function i(e){return N(e)?e:new t(b,new x(g(e)))}function o(e){return new t(b,new x(new C(e)))}function a(){return te}function s(){return new t(b,new M)}function u(e,t){return new t(b,new M(e.receiver,e.join().context))}function l(e){return f(W,null,e)}function c(e,t){return f(B,e,t)}function f(e,n,r){function i(t,i,a){a.resolved||d(r,o,t,e(n,i,t),a)}function o(e,t,n){c[e]=t,0==--l&&n.become(new P(c))}for(var a,s="function"==typeof n?i:o,u=new M,l=r.length>>>0,c=new Array(l),f=0;f<r.length&&!u.resolved;++f)a=r[f],void 0!==a||f in r?d(r,s,f,a,u):--l;return 0===l&&u.become(new P(c)),new t(b,u)}function d(e,t,n,r,i){if(F(r)){var o=_(r),a=o.state();0===a?o.fold(t,n,void 0,i):a>0?t(n,o.value,i):(i.become(o),h(e,n+1,o))}else t(n,r,i)}function h(e,t,n){for(var r=t;r<e.length;++r)p(g(e[r]),n)}function p(e,t){if(e!==t){var n=e.state();0===n?e.visit(e,void 0,e._unreport):n<0&&e._unreport()}}function v(e){return"object"!=typeof e||null===e?o(new TypeError("non-iterable passed to race()")):0===e.length?a():1===e.length?i(e[0]):m(e)}function m(e){var n,r,i,o=new M;for(n=0;n<e.length;++n)if(void 0!==(r=e[n])||n in e){if(i=g(r),0!==i.state()){o.become(i),h(e,n+1,i);break}i.visit(o,o.resolve,o.reject)}return new t(b,o)}function g(e){return N(e)?e._handler.join():F(e)?y(e):new P(e)}function _(e){return N(e)?e._handler.join():y(e)}function y(e){try{var t=e.then;return"function"==typeof t?new S(t,e):new P(e)}catch(e){return new C(e)}}function b(){}function w(){}function M(e,n){t.createContext(this,n),this.consumers=void 0,this.receiver=e,this.handler=void 0,this.resolved=!1}function x(e){this.handler=e}function S(e,t){M.call(this),Q.enqueue(new D(e,t,this))}function P(e){t.createContext(this),this.value=e}function C(e){t.createContext(this),this.id=++$,this.value=e,this.handled=!1,this.reported=!1,this._report()}function T(e,t){this.rejection=e,this.context=t}function A(e){this.rejection=e}function O(){return new C(new TypeError("Promise cycle"))}function I(e,t){this.continuation=e,this.handler=t}function E(e,t){this.handler=t,this.value=e}function D(e,t,n){this._then=e,this.thenable=t,this.resolver=n}function k(e,t,n,r,i){try{e.call(t,n,r,i)}catch(e){r(e)}}function R(e,t,n,r){this.f=e,this.z=t,this.c=n,this.to=r,this.resolver=J,this.receiver=this}function N(e){return e instanceof t}function F(e){return("object"==typeof e||"function"==typeof e)&&null!==e}function L(e,n,r,i){if("function"!=typeof e)return i.become(n);t.enterContext(n),G(e,n.value,r,i),t.exitContext()}function j(e,n,r,i,o){if("function"!=typeof e)return o.become(r);t.enterContext(r),z(e,n,r.value,i,o),t.exitContext()}function V(e,n,r,i,o){if("function"!=typeof e)return o.notify(n);t.enterContext(r),H(e,n,i,o),t.exitContext()}function B(e,t,n){try{return e(t,n)}catch(e){return o(e)}}function G(e,t,n,r){try{r.become(g(e.call(n,t)))}catch(e){r.become(new C(e))}}function z(e,t,n,r,i){try{e.call(r,t,n,i)}catch(e){i.become(new C(e))}}function H(e,t,n,r){try{r.notify(e.call(n,t))}catch(e){r.notify(e)}}function U(e,t){t.prototype=Z(e.prototype),t.prototype.constructor=t}function W(e,t){return t}function q(){}function X(){if("function"==typeof CustomEvent)try{return new CustomEvent("unhandledRejection")instanceof CustomEvent}catch(e){}return!1}function Y(){if("undefined"!=typeof document&&"function"==typeof document.createEvent)try{return document.createEvent("CustomEvent").initCustomEvent("eventType",!1,!0,{}),!0}catch(e){}return!1}var Q=e.scheduler,K=function(){return void 0!==r&&null!==r&&"function"==typeof r.emit?function(e,t){return"unhandledRejection"===e?r.emit(e,t.value,t):r.emit(e,t)}:"undefined"!=typeof self&&X()?function(e,t){return function(n,r){var i=new t(n,{detail:{reason:r.value,key:r},bubbles:!1,cancelable:!0});return!e.dispatchEvent(i)}}(self,CustomEvent):"undefined"!=typeof self&&Y()?function(e,t){return function(n,r){var i=t.createEvent("CustomEvent");return i.initCustomEvent(n,!1,!0,{reason:r.value,key:r}),!e.dispatchEvent(i)}}(self,document):q}(),Z=Object.create||function(e){function t(){}return t.prototype=e,new t};t.resolve=i,t.reject=o,t.never=a,t._defer=s,t._handler=g,t.prototype.then=function(e,t,n){var r=this._handler,i=r.join().state();if("function"!=typeof e&&i>0||"function"!=typeof t&&i<0)return new this.constructor(b,r);var o=this._beget(),a=o._handler;return r.chain(a,r.receiver,e,t,n),o},t.prototype.catch=function(e){return this.then(void 0,e)},t.prototype._beget=function(){return u(this._handler,this.constructor)},t.all=l,t.race=v,t._traverse=c,t._visitRemaining=h,b.prototype.when=b.prototype.become=b.prototype.notify=b.prototype.fail=b.prototype._unreport=b.prototype._report=q,b.prototype._state=0,b.prototype.state=function(){return this._state},b.prototype.join=function(){for(var e=this;void 0!==e.handler;)e=e.handler;return e},b.prototype.chain=function(e,t,n,r,i){this.when({resolver:e,receiver:t,fulfilled:n,rejected:r,progress:i})},b.prototype.visit=function(e,t,n,r){this.chain(J,e,t,n,r)},b.prototype.fold=function(e,t,n,r){this.when(new R(e,t,n,r))},U(b,w),w.prototype.become=function(e){e.fail()};var J=new w;U(b,M),M.prototype._state=0,M.prototype.resolve=function(e){this.become(g(e))},M.prototype.reject=function(e){this.resolved||this.become(new C(e))},M.prototype.join=function(){if(!this.resolved)return this;for(var e=this;void 0!==e.handler;)if((e=e.handler)===this)return this.handler=O();return e},M.prototype.run=function(){var e=this.consumers,t=this.handler;this.handler=this.handler.join(),this.consumers=void 0;for(var n=0;n<e.length;++n)t.when(e[n])},M.prototype.become=function(e){this.resolved||(this.resolved=!0,this.handler=e,void 0!==this.consumers&&Q.enqueue(this),void 0!==this.context&&e._report(this.context))},M.prototype.when=function(e){this.resolved?Q.enqueue(new I(e,this.handler)):void 0===this.consumers?this.consumers=[e]:this.consumers.push(e)},M.prototype.notify=function(e){this.resolved||Q.enqueue(new E(e,this))},M.prototype.fail=function(e){var t=void 0===e?this.context:e;this.resolved&&this.handler.join().fail(t)},M.prototype._report=function(e){this.resolved&&this.handler.join()._report(e)},M.prototype._unreport=function(){this.resolved&&this.handler.join()._unreport()},U(b,x),x.prototype.when=function(e){Q.enqueue(new I(e,this))},x.prototype._report=function(e){this.join()._report(e)},x.prototype._unreport=function(){this.join()._unreport()},U(M,S),U(b,P),P.prototype._state=1,P.prototype.fold=function(e,t,n,r){j(e,t,this,n,r)},P.prototype.when=function(e){L(e.fulfilled,this,e.receiver,e.resolver)};var $=0;U(b,C),C.prototype._state=-1,C.prototype.fold=function(e,t,n,r){r.become(this)},C.prototype.when=function(e){"function"==typeof e.rejected&&this._unreport(),L(e.rejected,this,e.receiver,e.resolver)},C.prototype._report=function(e){Q.afterQueue(new T(this,e))},C.prototype._unreport=function(){this.handled||(this.handled=!0,Q.afterQueue(new A(this)))},C.prototype.fail=function(e){this.reported=!0,K("unhandledRejection",this),t.onFatalRejection(this,void 0===e?this.context:e)},T.prototype.run=function(){this.rejection.handled||this.rejection.reported||(this.rejection.reported=!0,K("unhandledRejection",this.rejection)||t.onPotentiallyUnhandledRejection(this.rejection,this.context))},A.prototype.run=function(){this.rejection.reported&&(K("rejectionHandled",this.rejection)||t.onPotentiallyUnhandledRejectionHandled(this.rejection))},t.createContext=t.enterContext=t.exitContext=t.onPotentiallyUnhandledRejection=t.onPotentiallyUnhandledRejectionHandled=t.onFatalRejection=q;var ee=new b,te=new t(b,ee);return I.prototype.run=function(){this.handler.join().when(this.continuation)},E.prototype.run=function(){var e=this.handler.consumers;if(void 0!==e)for(var t,n=0;n<e.length;++n)t=e[n],V(t.progress,this.value,this.handler,t.receiver,t.resolver)},D.prototype.run=function(){function e(e){r.resolve(e)}function t(e){r.reject(e)}function n(e){r.notify(e)}var r=this.resolver;k(this._then,this.thenable,e,t,n)},R.prototype.fulfilled=function(e){this.f.call(this.c,this.z,e,this.to)},R.prototype.rejected=function(e){this.to.reject(e)},R.prototype.progress=function(e){this.to.notify(e)},t}}.call(t,n,t,e))&&(e.exports=i)}(n(0))}).call(t,n(10))},function(e,t,n){var r;/** @license MIT License (c) copyright 2010-2014 original author or authors */
!function(i){"use strict";void 0!==(r=function(){function e(e){this._async=e,this._running=!1,this._queue=this,this._queueLen=0,this._afterQueue={},this._afterQueueLen=0;var t=this;this.drain=function(){t._drain()}}return e.prototype.enqueue=function(e){this._queue[this._queueLen++]=e,this.run()},e.prototype.afterQueue=function(e){this._afterQueue[this._afterQueueLen++]=e,this.run()},e.prototype.run=function(){this._running||(this._running=!0,this._async(this.drain))},e.prototype._drain=function(){for(var e=0;e<this._queueLen;++e)this._queue[e].run(),this._queue[e]=void 0;for(this._queueLen=0,this._running=!1,e=0;e<this._afterQueueLen;++e)this._afterQueue[e].run(),this._afterQueue[e]=void 0;this._afterQueueLen=0},e}.call(t,n,t,e))&&(e.exports=r)}(n(0))},function(e,t,n){var r;/** @license MIT License (c) copyright 2010-2014 original author or authors */
!function(i){"use strict";void 0!==(r=function(e){function t(e,t,n,i){return r.setTimer(function(){e(n,i,t)},t)}var r=n(13),i=n(22);return function(e){function n(e,n,r){t(o,e,n,r)}function o(e,t){t.resolve(e)}function a(e,t,n){var r=void 0===e?new i("timed out after "+n+"ms"):e;t.reject(r)}return e.prototype.delay=function(e){var t=this._beget();return this._handler.fold(n,e,void 0,t._handler),t},e.prototype.timeout=function(e,n){var i=this._beget(),o=i._handler,s=t(a,e,n,i._handler);return this._handler.visit(o,function(e){r.clearTimer(s),this.resolve(e)},function(e){r.clearTimer(s),this.reject(e)},o.notify),i},e}}.call(t,n,t,e))&&(e.exports=r)}(n(0))},function(e,t,n){var r;/** @license MIT License (c) copyright 2010-2014 original author or authors */
!function(i){"use strict";void 0!==(r=function(e){var t=n(23),r=n(24);return function(e){function n(t){function n(e){c=null,this.resolve(e)}function r(e){this.resolved||(c.push(e),0==--l&&this.reject(c))}for(var i,o,a=e._defer(),s=a._handler,u=t.length>>>0,l=u,c=[],f=0;f<u;++f)if(void 0!==(o=t[f])||f in t){if(i=e._handler(o),i.state()>0){s.become(i),e._visitRemaining(t,f,i);break}i.visit(s,n,r)}else--l;return 0===l&&s.reject(new RangeError("any(): array must not be empty")),a}function i(t,n){function r(e){this.resolved||(c.push(e),0==--h&&(f=null,this.resolve(c)))}function i(e){this.resolved||(f.push(e),0==--o&&(c=null,this.reject(f)))}var o,a,s,u=e._defer(),l=u._handler,c=[],f=[],d=t.length>>>0,h=0;for(s=0;s<d;++s)(void 0!==(a=t[s])||s in t)&&++h;for(n=Math.max(n,0),o=h-n+1,h=Math.min(n,h),n>h?l.reject(new RangeError("some(): array must contain at least "+n+" item(s), but had "+h)):0===h&&l.resolve(c),s=0;s<d;++s)(void 0!==(a=t[s])||s in t)&&e._handler(a).visit(l,r,i,l.notify);return u}function o(t,n){return e._traverse(n,t)}function a(t,n){var r=_.call(t);return e._traverse(n,r).then(function(e){return s(r,e)})}function s(t,n){for(var r=n.length,i=new Array(r),o=0,a=0;o<r;++o)n[o]&&(i[a++]=e._handler(t[o]).value);return i.length=a,i}function u(e){return v(e.map(l))}function l(n){var r;return n instanceof e&&(r=n._handler.join()),r&&0===r.state()||!r?p(n).then(t.fulfilled,t.rejected):(r._unreport(),t.inspect(r))}function c(e,t){return arguments.length>2?m.call(e,d(t),arguments[2]):m.call(e,d(t))}function f(e,t){return arguments.length>2?g.call(e,d(t),arguments[2]):g.call(e,d(t))}function d(e){return function(t,n,r){return h(e,void 0,[t,n,r])}}var h=r(e),p=e.resolve,v=e.all,m=Array.prototype.reduce,g=Array.prototype.reduceRight,_=Array.prototype.slice;return e.any=n,e.some=i,e.settle=u,e.map=o,e.filter=a,e.reduce=c,e.reduceRight=f,e.prototype.spread=function(e){return this.then(v).then(function(t){return e.apply(this,t)})},e}}.call(t,n,t,e))&&(e.exports=r)}(n(0))},function(e,t,n){var r;/** @license MIT License (c) copyright 2010-2014 original author or authors */
!function(i){"use strict";void 0!==(r=function(){function e(){throw new TypeError("catch predicate must be a function")}function t(e,t){return n(t)?e instanceof t:t(e)}function n(e){return e===Error||null!=e&&e.prototype instanceof Error}function r(e){return("object"==typeof e||"function"==typeof e)&&null!==e}function i(e){return e}return function(n){function o(e,n){return function(r){return t(r,n)?e.call(this,r):l(r)}}function a(e,t,n,i){var o=e.call(t);return r(o)?s(o,n,i):n(i)}function s(e,t,n){return u(e).then(function(){return t(n)})}var u=n.resolve,l=n.reject,c=n.prototype.catch;return n.prototype.done=function(e,t){this._handler.visit(this._handler.receiver,e,t)},n.prototype.catch=n.prototype.otherwise=function(t){return arguments.length<2?c.call(this,t):"function"!=typeof t?this.ensure(e):c.call(this,o(arguments[1],t))},n.prototype.finally=n.prototype.ensure=function(e){return"function"!=typeof e?this:this.then(function(t){return a(e,this,i,t)},function(t){return a(e,this,l,t)})},n.prototype.else=n.prototype.orElse=function(e){return this.then(void 0,function(){return e})},n.prototype.yield=function(e){return this.then(function(){return e})},n.prototype.tap=function(e){return this.then(e).yield(this)},n}}.call(t,n,t,e))&&(e.exports=r)}(n(0))},function(e,t,n){var r;/** @license MIT License (c) copyright 2010-2014 original author or authors */
!function(i){"use strict";void 0!==(r=function(){return function(e){return e.prototype.fold=function(t,n){var r=this._beget();return this._handler.fold(function(n,r,i){e._handler(n).fold(function(e,n,r){r.resolve(t.call(this,n,e))},r,this,i)},n,r._handler.receiver,r._handler),r},e}}.call(t,n,t,e))&&(e.exports=r)}(n(0))},function(e,t,n){var r;/** @license MIT License (c) copyright 2010-2014 original author or authors */
!function(i){"use strict";void 0!==(r=function(e){var t=n(23).inspect;return function(e){return e.prototype.inspect=function(){return t(e._handler(this))},e}}.call(t,n,t,e))&&(e.exports=r)}(n(0))},function(e,t,n){var r;/** @license MIT License (c) copyright 2010-2014 original author or authors */
!function(i){"use strict";void 0!==(r=function(){return function(e){function t(e,t,r,i){return n(function(t){return[t,e(t)]},t,r,i)}function n(e,t,i,o){function a(o,a){return r(i(o)).then(function(){return n(e,t,i,a)})}return r(o).then(function(n){return r(t(n)).then(function(t){return t?n:r(e(n)).spread(a)})})}var r=e.resolve;return e.iterate=t,e.unfold=n,e}}.call(t,n,t,e))&&(e.exports=r)}(n(0))},function(e,t,n){var r;/** @license MIT License (c) copyright 2010-2014 original author or authors */
!function(i){"use strict";void 0!==(r=function(){return function(e){return e.prototype.progress=function(e){return this.then(void 0,void 0,e)},e}}.call(t,n,t,e))&&(e.exports=r)}(n(0))},function(e,t,n){var r;/** @license MIT License (c) copyright 2010-2014 original author or authors */
!function(i){"use strict";void 0!==(r=function(){return function(e){return e.prototype.with=e.prototype.withThis=function(e){var t=this._beget(),n=t._handler;return n.receiver=e,this._handler.chain(n,e),t},e}}.call(t,n,t,e))&&(e.exports=r)}(n(0))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});window.infos.baseDir,window.infos.sharedBaseDir;t.default={asset_url:function(e){return window.manifest["twingo/assets/"+e]},shared_asset_url:function(e){return window.manifest["assets/"+e]}},e.exports=t.default},function(e,t,n){"use strict";function r(e,t){return t[0]=(e>>16&255)/255,t[1]=(e>>8&255)/255,t[2]=(255&e)/255,t}function i(e){return Math.round(255*e[0])<<16|Math.round(255*e[1])<<8|Math.round(255*e[2])}function o(e){return r(e,new Float32Array(3))}function a(e,t){r(t,u),e.set(u[0],u[1],u[2])}function s(e){return"string"==typeof e&&(e.match(l)||[]).length===e.length}Object.defineProperty(t,"__esModule",{value:!0});var u=new Float32Array(3),l=/([0-9]|[a-f])/gim;t.default={HexToVec:r,VecToHex:i,MakeFromHex:o,HexInput:a,isHex:s},e.exports=t.default},function(e,t,n){"use strict";function r(e,t){var n=t.binaries[e.buffer],r=e.byteOffset||0;return new Uint8Array(n,r,e.byteLength)}function i(e,t,n){var r=t.json,i=r.bufferViews[e.bufferView],o=t.binaries[i.buffer],a=f[e.type],s=c[e.componentType],u=(i.byteOffset||0)+(e.byteOffset||0),h=u+e.count*a*s,p=o.slice(u,h);if(e.componentType===l.default.FLOAT)d=new Float32Array(p);else if(e.componentType!==l.default.UNSIGNED_SHORT||n)if(e.componentType===l.default.UNSIGNED_SHORT&&n)d=new Uint16Array(p);else{if(e.componentType!==l.default.BYTE)throw new Error("[GLTFUtils getDataFromAccessor] accessor componentType non-defined");d=new Uint8Array(o,u,h)}else d=new Float32Array(p);return{data:d,nbcomps:a}}function o(e,t,n){for(var r=i(e,t,!1).data,o=s(e.type),a=[],u=0;u<r.length/o;u++){for(var l=[],c=0;c<o;c++){var f=u*o;l[c]=r[f+c]}a.push(l)}return a}function a(e,t){return t.bufferViews[e.bufferView].byteStride||0}function s(e){return l.default[e]}Object.defineProperty(t,"__esModule",{value:!0});var u=n(191),l=function(e){return e&&e.__esModule?e:{default:e}}(u),c={5121:1,5123:2,5126:4},f={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT3:9,MAT4:16},d=void 0;t.default={getComponentSize:s,getBufferViewData:r,getDataFromAccessor:i,getUnflattenDataFromAccessor:o,getStrideFromAccessor:a},e.exports=t.default},function(e,t,n){"use strict";(function(r){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t,n,r,i){var o={};return Object.keys(r).forEach(function(e){o[e]=r[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}Object.defineProperty(t,"__esModule",{value:!0});var s,u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(30),c=i(l),f=n(15),d=i(f),h=n(16),p=i(h),v=(s=function(){function e(){o(this,e),this._binded=!1,this._isTouchDevice="ontouchstart"in window||navigator.maxTouchPoints,this._signals=p.default,this.client=new m(d.default.width/2,d.default.height/2),this.delta=new m,this.movement=new m,this.mouseDownPos=new m,this.mouseUpPos=new m,this.lastPos=new m,this.isDown=!1,this.downNow=0,this.pressDuration=0,this.hasMoved=!1,this.lastModifier=null,this._domEl=document.body,this._cursors=["grab","grabbing","pointer","move","not-allowed"],this._createSignals(),this._bindSignals()}return u(e,[{key:"bind",value:function(){this._binded||(this._binded=!0,this._domEl.addEventListener("touchstart",this._handleMouseDown,!1),this._domEl.addEventListener("touchend",this._handleMouseUp,!1),this._domEl.addEventListener("touchmove",this._handleMouseMove,!1),this._domEl.addEventListener("mousedown",this._handleMouseDown,!1),this._domEl.addEventListener("mouseup",this._handleMouseUp,!1),this._domEl.addEventListener("mousemove",this._handleMouseMove,!1),this._domEl.addEventListener("mouseleave",this._handleMouseLeave,!1),this._domEl.addEventListener("contextmenu",this._handleContextMenu,!1))}},{key:"unbind",value:function(){this._binded&&(this._binded=!1,this._domEl.removeEventListener("touchstart",this._handleMouseDown,!1),this._domEl.removeEventListener("touchend",this._handleMouseUp,!1),this._domEl.removeEventListener("touchmove",this._handleMouseMove,!1),this._domEl.removeEventListener("mousedown",this._handleMouseDown,!1),this._domEl.removeEventListener("mouseup",this._handleMouseUp,!1),this._domEl.removeEventListener("mousemove",this._handleMouseMove,!1),this._domEl.removeEventListener("mouseleave",this._handleMouseLeave,!1),this._domEl.removeEventListener("contextmenu",this._handleContextMenu,!1))}},{key:"addCursor",value:function(e){if(e!==this.lastModifier&&!this._isTouchDevice){for(var t=0,n=this._cursors.length;t<n;t++){var r=this._cursors[t];this._domEl.classList.toggle("cursor-"+r,r===e)}this.lastModifier=e}}},{key:"removeCursor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.lastModifier;this._isTouchDevice||(this._domEl.classList.remove("cursor-"+e),this.lastModifier=null)}},{key:"destroy",value:function(){this._unbindSignals(),this.unbind()}},{key:"_createSignals",value:function(){this.upped=new c.default,this.downed=new c.default,this.moved=new c.default,this.leaved=new c.default,this.contextMenu=new c.default}},{key:"_bindSignals",value:function(){p.default.engine.loaded.add(this._onEngineLoaded)}},{key:"_unbindSignals",value:function(){p.default.engine.loaded.remove(this._onEngineLoaded)}},{key:"_setPointerMovement",value:function(e,t){this.movement.x=e-this.mouseDownPos.x,this.movement.y=t-this.mouseDownPos.y}},{key:"_setPointerDelta",value:function(e,t){this.delta.x=e-this.lastPos.x,this.delta.y=t-this.lastPos.y}},{key:"_getClientValues",value:function(e){var t=0,n=0;return this._isTouchDevice&&e.touches&&e.touches.length?(t=e.touches[0].clientX,n=e.touches[0].clientY):this._isTouchDevice&&e.changedTouches&&e.changedTouches.length?(t=e.changedTouches[0].clientX,n=e.changedTouches[0].clientY):(t=e.clientX,n=e.clientY),{clientX:t,clientY:n}}},{key:"_onEngineLoaded",value:function(e){this._domEl=e.renderer.canvas,this.bind()}},{key:"_handleMouseDown",value:function(e){var t=this._getClientValues(e),n=t.clientX,r=t.clientY;this.client.set(n,r),this.lastPos.set(n,r),this.mouseDownPos.set(n,r),this.downNow=(new Date).getTime(),this.isDown=!0,this.downed.dispatch(e)}},{key:"_handleMouseUp",value:function(e){var t=this._getClientValues(e),n=t.clientX,r=t.clientY;this.client.set(n,r),this.lastPos.set(n,r),this.mouseUpPos.set(n,r),this._setPointerMovement(n,r),this._setPointerDelta(n,r);var i=(new Date).getTime();this.pressDuration=i-this.downNow,this.isDown=!1,this.hasMoved=0!==this.movement.x||0!==this.movement.y,this.upped.dispatch(e)}},{key:"_handleMouseMove",value:function(e){e.preventDefault();var t=this._getClientValues(e),n=t.clientX,r=t.clientY;this.client.set(n,r),this._setPointerDelta(n,r),this.moved.dispatch(e),this.lastPos.set(n,r)}},{key:"_handleMouseLeave",value:function(e){this.isDown=!1,this.leaved.dispatch(e)}},{key:"_handleContextMenu",value:function(e){this.contextMenu.dispatch(e)}},{key:"isTouchDevice",get:function(){return this._isTouchDevice}}]),e}(),a(s.prototype,"_onEngineLoaded",[r],Object.getOwnPropertyDescriptor(s.prototype,"_onEngineLoaded"),s.prototype),a(s.prototype,"_handleMouseDown",[r],Object.getOwnPropertyDescriptor(s.prototype,"_handleMouseDown"),s.prototype),a(s.prototype,"_handleMouseUp",[r],Object.getOwnPropertyDescriptor(s.prototype,"_handleMouseUp"),s.prototype),a(s.prototype,"_handleMouseMove",[r],Object.getOwnPropertyDescriptor(s.prototype,"_handleMouseMove"),s.prototype),a(s.prototype,"_handleMouseLeave",[r],Object.getOwnPropertyDescriptor(s.prototype,"_handleMouseLeave"),s.prototype),a(s.prototype,"_handleContextMenu",[r],Object.getOwnPropertyDescriptor(s.prototype,"_handleContextMenu"),s.prototype),s),m=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;o(this,e),this.norm={x:t/d.default.width,y:n/d.default.height},this.center={x:2*t/d.default.width-1,y:-(2*n/d.default.height-1)},this.set(t,n)}return u(e,[{key:"set",value:function(e,t){this.x=e,this.y=t}},{key:"x",set:function(e){this._x=e,this.norm.x=e/d.default.width,this.center.x=2*e/d.default.width-1},get:function(){return this._x}},{key:"y",set:function(e){this._y=e,this.norm.y=e/d.default.height,this.center.y=-(2*e/d.default.height-1)},get:function(){return this._y}}]),e}();t.default=new v,e.exports=t.default}).call(t,n(2).bind)},,function(e,t,n){function r(e){this.target=e,this.level=0,this._isTexture=e.id instanceof WebGLTexture}function i(e){this.gl=e,this.width=0,this.height=0,this.fbo=e.createFramebuffer(),this.bind(),this.attachments={},this.attachmentsList=[]}function o(e,t){return e|t<<1}function a(e,t){switch(o(e,t)){case 1:return 36096;case 2:return 36128;case 3:return 33306;default:return 0}}function s(e,t){switch(o(e,t)){case 1:return 33189;case 2:return 36168;case 3:return 34041;default:return 0}}function u(e,t){return t?{format:34041,type:34042,internal:e.DEPTH24_STENCIL8}:{format:6402,type:5125,internal:e.DEPTH_COMPONENT24}}var l=n(29),c=n(154);r.prototype={isTexture:function(){return this._isTexture},_resize:function(e,t){e>0&&t>0&&(this._isTexture?this.target.fromData(e,t,null):(this.target.resize(e,t),this.target.allocate()))},_attach:function(e){var t=this.target.gl;this._isTexture?t.framebufferTexture2D(t.FRAMEBUFFER,e,t.TEXTURE_2D,this.target.id,this.level):t.framebufferRenderbuffer(t.FRAMEBUFFER,e,t.RENDERBUFFER,this.target.id)},_detach:function(e){var t=this.target.gl;this._isTexture?t.framebufferTexture2D(t.FRAMEBUFFER,e,t.TEXTURE_2D,null,this.level):t.framebufferRenderbuffer(t.FRAMEBUFFER,e,t.RENDERBUFFER,null)},dispose:function(){this.target.dispose(),this.target=null}},i.prototype={attach:function(e,t){var n=new r(t);return e|=0,this.detach(e),this.attachments[e.toString()]=n,this.attachmentsList.push(n),n._resize(this.width,this.height),n._attach(e),n},detach:function(e){var t=this.attachments[e.toString()];if(void 0!==t){var n=this.attachmentsList.indexOf(t);this.attachmentsList.splice(n,1),t._detach(e)}delete this.attachments[e.toString()]},getAttachment:function(e){var t=this.attachments[e.toString()];return void 0!==t?t:null},getColor:function(e){e|=0;var t=this.getAttachment(36064+e);return t?t.target:null},getDepth:function(){var e=this.getAttachment(36096)||this.getAttachment(36128)||this.getAttachment(33306);return e?e.target:null},attachColor:function(e,t,n){var r=new l(this.gl,e,t,n);return this.attach(36064,r)},attachDepth:function(e,t,n){e=void 0===e||!!e,t=!!t,n=!!n&&e;var r;if(n){var i=u(this.gl,t);r=new l(this.gl,i.format,i.type,i.internal)}else r=new c(this.gl,s(e,t));return this.attach(a(e,t),r)},resize:function(e,t){this.width===e&&this.height===t||(this.width=0|e,this.height=0|t,this._allocate())},bind:function(){var e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,this.fbo)},clear:function(){this.gl.clear(17664)},defaultViewport:function(){this.gl.viewport(0,0,this.width,this.height)},isValid:function(){var e=this.gl;return e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE},dispose:function(){this.gl.deleteFramebuffer(this.fbo);for(var e=0;e<this.attachmentsList.length;e++)this.attachmentsList[e].dispose();this.attachmentsList=null,this.attachments=null,this.valid=!1,this.fbo=null,this.gl=null},_allocate:function(){for(var e=0;e<this.attachmentsList.length;e++)this.attachmentsList[e]._resize(this.width,this.height)}},e.exports=i},function(e,t){function n(e){this.gl=e,this.EXT_texture_float=e.getExtension("OES_texture_float"),this.EXT_texture_half_float=e.getExtension("OES_texture_half_float"),this.EXT_texture_half_float_linear=e.getExtension("OES_texture_half_float_linear"),this.EXT_texture_float_linear=e.getExtension("OES_texture_float_linear"),this.EXT_color_buffer_float=e.getExtension("EXT_color_buffer_float"),this.EXT_color_buffer_half_float=e.getExtension("EXT_color_buffer_half_float"),this.WEBGL_depth_texture=e.getExtension("WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture"),void 0===e.HALF_FLOAT&&this.EXT_texture_half_float&&(e.HALF_FLOAT=this.EXT_texture_half_float.HALF_FLOAT_OES),void 0===e.UNSIGNED_INT_24_8&&this.WEBGL_depth_texture&&(e.UNSIGNED_INT_24_8=34042),this._availables={},this._renderables={},this.RGB8=r(e.RGB,e.RGB,e.UNSIGNED_BYTE),this.RGBA8=r(e.RGBA,e.RGBA,e.UNSIGNED_BYTE),this.RGB32F=r(e.RGB,e.RGB32F,e.FLOAT),this.RGBA32F=r(e.RGBA,e.RGBA32F,e.FLOAT),this.RGB16F=r(e.RGB,e.RGB16F,e.HALF_FLOAT),this.RGBA16F=r(e.RGBA,e.RGBA16F,e.HALF_FLOAT),this.A2B10G10R10=r(e.RGBA,e.RGB10_A2,e.UNSIGNED_INT_2_10_10_10_REV)}function r(e,t,n){return{format:e,internal:t,type:n}}function i(e,t,n){return e^n<<8^t<<16}n.getInstance=function(e){var t=e.__pf;return void 0===t&&(e.__pf=t=new n(e)),t},n.prototype={dispose:function(){this.EXT_texture_float=null,this.EXT_texture_half_float=null,this.EXT_texture_half_float_linear=null,this.EXT_texture_float_linear=null,this.EXT_color_buffer_float=null,this.EXT_color_buffer_half_float=null,this.gl.__pf===this&&delete this.gl.__pf,this.gl=null},hasDepthTexture:function(){return this.isAvailable(this.gl.DEPTH_COMPONENT,this.gl.UNSIGNED_INT,this.gl.DEPTH_COMPONENT24)},isAvailable:function(e,t,n){if(void 0===e||void 0===t)return!1;void 0===n&&(n=e);var r=i(e,t,n);return void 0===this._availables[r]&&(this._availables[r]=this._testAvailable(e,t,n)),this._availables[r]},isRenderable:function(e,t,n){if(void 0===e||void 0===t)return!1;void 0===n&&(n=e);var r=i(e,t,n);if(void 0===this._renderables[r]){var o=this.isAvailable(e,t,n);this._renderables[r]=o&&this._testRenderable(e,t,n)}return this._renderables[r]},getRenderableFormat:function(e){for(var t=0;t<e.length;t++){var n=e[t];if(this.isRenderable(n.format,n.type,n.internal))return n}return null},_testAvailable:function(e,t,n){var r=this.gl;r.getError();var i=r.createTexture();return r.bindTexture(r.TEXTURE_2D,i),r.texImage2D(r.TEXTURE_2D,0,n,4,4,0,e,t,null),r.deleteTexture(i),0===r.getError()},_testRenderable:function(e,t,n){var r=this.gl,i=r.createTexture();r.bindTexture(r.TEXTURE_2D,i),r.texImage2D(r.TEXTURE_2D,0,n,4,4,0,e,t,null);var o=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,o),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,i,0);var a=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindFramebuffer(r.FRAMEBUFFER,null),r.bindTexture(r.TEXTURE_2D,null),r.deleteTexture(i),r.deleteFramebuffer(o),a}},e.exports=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(6),u=r(s),l=n(14),c=r(l),f=n(7),d=r(f),h=n(8),p=r(h),v=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.iAlbedo=r.inputs.add(new u.default("albedo",3)),r.iSpecular=r.inputs.add(new u.default("specular",3)),r.iAlpha=r.inputs.add(new u.default("alpha",1)),r.iGloss=r.inputs.add(new u.default("gloss_base",1)),r.iNormal=r.inputs.add(new u.default("normal",3)),r.iOcclusion=r.inputs.add(new u.default("occlusion",1)),r.iCavity=r.inputs.add(new u.default("cavity",1)),r.iCavityStrength=r.inputs.add(new u.default("cavityStrength",2)),r.iEmissive=r.inputs.add(new u.default("emissive",1)),r.iEmissiveScale=r.inputs.add(new u.default("emissiveScale",1)),r.iFresnel=r.inputs.add(new u.default("fresnel",3)),r.iPureGlossAttenuation=r.inputs.add(new u.default("pureGlossAttenuation",1)),r.conserveEnergy=r.inputs.add(new c.default("conserveEnergy",!0)),r.perVertexIrrad=r.inputs.add(new c.default("perVertexIrrad",!0)),r.glossNearest=r.inputs.add(new c.default("glossNearest",!1)),r.inferBitangent=r.inputs.add(new c.default("inferBitangent",!0)),r.pureGloss=r.inputs.add(new c.default("pureGloss",!1)),r.iLodDither=r.inputs.add(new u.default("lodDither",1)),r.lodDitherUniform=new u.default.Uniform("uLodDitherFactor",1),r.gammaMode=new d.default("gammaMode",["GAMMA_NONE","GAMMA_STD","GAMMA_2_2","GAMMA_TB"]),r.inputs.add(r.gammaMode),r.iGamma=r.inputs.add(new u.default("gamma",1)),r.iExposure=r.inputs.add(new u.default("exposure",1)),r.isWater=r.inputs.add(new c.default("isWater",!1)),r.iFog=r.inputs.add(new c.default("fog",!1)),r.renderMode=p.default.RENDER_MODES.DEFAULT,r._uid="standard",r._vertSrc=n(172)(),r._fragSrc=n(173)(),r}return a(t,e),t}(p.default);t.default=v,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={RENDER_MODES:{DISABLED:-1,DEFAULT:0,REFLECT:1}},e.exports=t.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(1),a=o.vec3.create(),s=o.vec3.create(),u=function(){function e(){r(this,e),this.min=new Float32Array(3),this.max=new Float32Array(3),this.center=new Float32Array(3),this.radius=new Float32Array(3)}return i(e,[{key:"fromMinMax",value:function(e,t){this.min.set(e),this.max.set(t),this._updateSphere()}},{key:"fromPoints",value:function(e){var t=this;this.reset(),e.forEach(function(e){return t.addPoint(e)})}},{key:"fromCenterSize",value:function(e,t){void 0===t&&(o.vec3.sub(a,this.max,this.min),t=a),o.vec3.copy(s,t),o.vec3.scale(s,s,.5),o.vec3.copy(this.center,e),o.vec3.sub(this.min,e,s),o.vec3.add(this.max,e,s),this._updateSphere()}},{key:"addMinMax",value:function(e,t){for(var n=0;n<3;n++)this.min[n]=Math.min(e[n],e[n]),this.max[n]=Math.max(t[n],t[n]);this._updateSphere()}},{key:"addBounds",value:function(e){this.addMinMax(e.min,e.max)}},{key:"addPoint",value:function(e){e[0]<this.min[0]&&(this.min[0]=e[0]),e[1]<this.min[1]&&(this.min[1]=e[1]),e[2]<this.min[2]&&(this.min[2]=e[2]),e[0]>this.max[0]&&(this.max[0]=e[0]),e[1]>this.max[1]&&(this.max[1]=e[1]),e[2]>this.max[2]&&(this.max[2]=e[2]),this._updateSphere()}},{key:"intersects",value:function(e){return!(e.max[0]<this.min[0]||e.min[0]>this.max[0]||e.max[1]<this.min[1]||e.min[1]>this.max[1]||e.max[2]<this.min[2]||e.min[2]>this.max[2])}},{key:"reset",value:function(){this.max[0]=this.min[0]=0,this.max[1]=this.min[1]=0,this.max[2]=this.min[2]=0,this._updateSphere()}},{key:"clone",value:function(){var t=new e;return t.min=this.min.slice(0),t.max=this.max.slice(0),t.center=this.center.slice(0),t.radius=this.radius.slice(0),t}},{key:"_updateSphere",value:function(){this.center[0]=.5*(this.min[0]+this.max[0]),this.center[1]=.5*(this.min[1]+this.max[1]),this.center[2]=.5*(this.min[2]+this.max[2]),this.radius[0]=this.max[0]-this.center[0],this.radius[1]=this.max[1]-this.center[1],this.radius[2]=this.max[2]-this.center[2]}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){function r(e,t,n,r){this.gl=e,this.buffer=e.createBuffer(),this.usage=r||e.STATIC_DRAW,this.type=0,this.typeSize=0,this.size=0,this.setType(t||e.UNSIGNED_SHORT),n&&this.data(n)}var i=n(90),o=34963;r.prototype={bind:function(){this.gl.bindBuffer(o,this.buffer)},setType:function(e){this.type=e,this.typeSize=i.getComponentSize(e)},data:function(e){var t=this.gl;t.bindBuffer(o,this.buffer),t.bufferData(o,e,this.usage),t.bindBuffer(o,null),this.size=void 0===e.byteLength?e:e.byteLength},subData:function(e,t){var n=this.gl;n.bindBuffer(o,this.buffer),n.bufferSubData(o,t,e),n.bindBuffer(o,null)},dispose:function(){this.gl.deleteBuffer(this.buffer),this.buffer=null,this.gl=null},draw:function(e,t,n){t=void 0===t?this.size/this.typeSize:t,this.gl.drawElements(e,t,this.type,0|n)}},i.Drawable(r.prototype),e.exports=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(63),i={isDesktop:window.BrowserDetect.isDesktop,isMobile:!window.BrowserDetect.isDesktop,engine:null,loading:{progress:0,loaded:!1},section:{default:(0,r.getQueryVariable)("module")||"configurator",current:null},ui:{display:!1,logo:!0,small:null,inverted:!1,minimal:!0,isLCS:!1,isEnd:!1,isInside:!1,endReady:!1},xp1:{counter:{time:1/0,started:!1}},popup:!1,expPopup:!1};t.default=i,e.exports=t.default},function(e,t,n){"use strict";function r(e){for(var t=window.location.search.substring(1),n=t.split("&"),r=0;r<n.length;r++){var i=n[r].split("=");if(i[0]===e)return i[1]}return!1}Object.defineProperty(t,"__esModule",{value:!0}),t.default={getQueryVariable:r},e.exports=t.default},function(e,t,n){"use strict";(function(r){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t,n,r,i){var o={};return Object.keys(r).forEach(function(e){o[e]=r[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}Object.defineProperty(t,"__esModule",{value:!0});var s,u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(30),c=i(l),f=n(234),d=i(f),h=n(15),p=i(h),v=(s=function(){function e(){o(this,e),this._binded=!1,this.pressedKeys={},this._createSignals(),this.bind()}return u(e,[{key:"bind",value:function(){this._binded||(window.addEventListener("keydown",this._handleKeyDown,!1),window.addEventListener("keyup",this._handleKeyUp,!1),p.default.blurred.add(this._onWindowBlur),p.default.visibilityChanged.add(this._onVisibilityChange),this._binded=!0)}},{key:"unbind",value:function(){this._binded&&(window.removeEventListener("keydown",this._handleKeyDown,!1),window.removeEventListener("keyup",this._handleKeyUp,!1),p.default.blurred.remove(this._onWindowBlur),p.default.visibilityChanged.remove(this._onVisibilityChange),this._binded=!1)}},{key:"isDown",value:function(e){for(var t=!1,n=(0,d.default)(e),r=0,i=n.length;r<i;r++){var o=n[r];if(this.pressedKeys[o]){t=!0;break}}return t}},{key:"_createSignals",value:function(){this.upped=new c.default,this.downed=new c.default}},{key:"_resetInputs",value:function(){this.pressedKeys={}}},{key:"_handleKeyDown",value:function(e){this.downNow=(new Date).getTime(),this.pressedKeys[e.keyCode]=!0;var t=(0,d.default)(e);this.downed.dispatch(e,t)}},{key:"_handleKeyUp",value:function(e){var t=(new Date).getTime();this.pressDuration=t-this.downNow,delete this.pressedKeys[e.keyCode];var n=(0,d.default)(e);this.upped.dispatch(e,n)}},{key:"_onWindowBlur",value:function(){this._resetInputs()}},{key:"_onVisibilityChange",value:function(e){!1===e&&this._resetInputs()}}]),e}(),a(s.prototype,"_handleKeyDown",[r],Object.getOwnPropertyDescriptor(s.prototype,"_handleKeyDown"),s.prototype),a(s.prototype,"_handleKeyUp",[r],Object.getOwnPropertyDescriptor(s.prototype,"_handleKeyUp"),s.prototype),a(s.prototype,"_onWindowBlur",[r],Object.getOwnPropertyDescriptor(s.prototype,"_onWindowBlur"),s.prototype),a(s.prototype,"_onVisibilityChange",[r],Object.getOwnPropertyDescriptor(s.prototype,"_onVisibilityChange"),s.prototype),s);t.default=new v,e.exports=t.default}).call(t,n(2).bind)},,,,function(e,t,n){var r=n(38),i={};i.create=function(){var e=new r.ARRAY_TYPE(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},i.fromMat4=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},i.clone=function(e){var t=new r.ARRAY_TYPE(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},i.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},i.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},i.transpose=function(e,t){if(e===t){var n=t[1],r=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=r,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},i.invert=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],l=t[7],c=t[8],f=c*a-s*l,d=-c*o+s*u,h=l*o-a*u,p=n*f+r*d+i*h;return p?(p=1/p,e[0]=f*p,e[1]=(-c*r+i*l)*p,e[2]=(s*r-i*a)*p,e[3]=d*p,e[4]=(c*n-i*u)*p,e[5]=(-s*n+i*o)*p,e[6]=h*p,e[7]=(-l*n+r*u)*p,e[8]=(a*n-r*o)*p,e):null},i.adjoint=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],l=t[7],c=t[8];return e[0]=a*c-s*l,e[1]=i*l-r*c,e[2]=r*s-i*a,e[3]=s*u-o*c,e[4]=n*c-i*u,e[5]=i*o-n*s,e[6]=o*l-a*u,e[7]=r*u-n*l,e[8]=n*a-r*o,e},i.determinant=function(e){var t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],u=e[7],l=e[8];return t*(l*o-a*u)+n*(-l*i+a*s)+r*(u*i-o*s)},i.multiply=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],l=t[6],c=t[7],f=t[8],d=n[0],h=n[1],p=n[2],v=n[3],m=n[4],g=n[5],_=n[6],y=n[7],b=n[8];return e[0]=d*r+h*a+p*l,e[1]=d*i+h*s+p*c,e[2]=d*o+h*u+p*f,e[3]=v*r+m*a+g*l,e[4]=v*i+m*s+g*c,e[5]=v*o+m*u+g*f,e[6]=_*r+y*a+b*l,e[7]=_*i+y*s+b*c,e[8]=_*o+y*u+b*f,e},i.mul=i.multiply,i.translate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],l=t[6],c=t[7],f=t[8],d=n[0],h=n[1];return e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=u,e[6]=d*r+h*a+l,e[7]=d*i+h*s+c,e[8]=d*o+h*u+f,e},i.rotate=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],l=t[6],c=t[7],f=t[8],d=Math.sin(n),h=Math.cos(n);return e[0]=h*r+d*a,e[1]=h*i+d*s,e[2]=h*o+d*u,e[3]=h*a-d*r,e[4]=h*s-d*i,e[5]=h*u-d*o,e[6]=l,e[7]=c,e[8]=f,e},i.scale=function(e,t,n){var r=n[0],i=n[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},i.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e},i.fromRotation=function(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=-n,e[4]=r,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},i.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},i.fromMat2d=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e},i.fromQuat=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n+n,s=r+r,u=i+i,l=n*a,c=r*a,f=r*s,d=i*a,h=i*s,p=i*u,v=o*a,m=o*s,g=o*u;return e[0]=1-f-p,e[3]=c-g,e[6]=d+m,e[1]=c+g,e[4]=1-l-p,e[7]=h-v,e[2]=d-m,e[5]=h+v,e[8]=1-l-f,e},i.normalFromMat4=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],l=t[7],c=t[8],f=t[9],d=t[10],h=t[11],p=t[12],v=t[13],m=t[14],g=t[15],_=n*s-r*a,y=n*u-i*a,b=n*l-o*a,w=r*u-i*s,M=r*l-o*s,x=i*l-o*u,S=c*v-f*p,P=c*m-d*p,C=c*g-h*p,T=f*m-d*v,A=f*g-h*v,O=d*g-h*m,I=_*O-y*A+b*T+w*C-M*P+x*S;return I?(I=1/I,e[0]=(s*O-u*A+l*T)*I,e[1]=(u*C-a*O-l*P)*I,e[2]=(a*A-s*C+l*S)*I,e[3]=(i*A-r*O-o*T)*I,e[4]=(n*O-i*C+o*P)*I,e[5]=(r*C-n*A-o*S)*I,e[6]=(v*x-m*M+g*w)*I,e[7]=(m*b-p*x-g*y)*I,e[8]=(p*M-v*b+g*_)*I,e):null},i.str=function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"},i.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))},e.exports=i},function(e,t,n){var r=n(130),i={};i.create=function(){var e=new r.ARRAY_TYPE(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},i.clone=function(e){var t=new r.ARRAY_TYPE(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},i.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},i.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},i.transpose=function(e,t){if(e===t){var n=t[1],r=t[2],i=t[3],o=t[6],a=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=o,e[11]=t[14],e[12]=i,e[13]=a,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e},i.invert=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],l=t[7],c=t[8],f=t[9],d=t[10],h=t[11],p=t[12],v=t[13],m=t[14],g=t[15],_=n*s-r*a,y=n*u-i*a,b=n*l-o*a,w=r*u-i*s,M=r*l-o*s,x=i*l-o*u,S=c*v-f*p,P=c*m-d*p,C=c*g-h*p,T=f*m-d*v,A=f*g-h*v,O=d*g-h*m,I=_*O-y*A+b*T+w*C-M*P+x*S;return I?(I=1/I,e[0]=(s*O-u*A+l*T)*I,e[1]=(i*A-r*O-o*T)*I,e[2]=(v*x-m*M+g*w)*I,e[3]=(d*M-f*x-h*w)*I,e[4]=(u*C-a*O-l*P)*I,e[5]=(n*O-i*C+o*P)*I,e[6]=(m*b-p*x-g*y)*I,e[7]=(c*x-d*b+h*y)*I,e[8]=(a*A-s*C+l*S)*I,e[9]=(r*C-n*A-o*S)*I,e[10]=(p*M-v*b+g*_)*I,e[11]=(f*b-c*M-h*_)*I,e[12]=(s*P-a*T-u*S)*I,e[13]=(n*T-r*P+i*S)*I,e[14]=(v*y-p*w-m*_)*I,e[15]=(c*w-f*y+d*_)*I,e):null},i.adjoint=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],l=t[7],c=t[8],f=t[9],d=t[10],h=t[11],p=t[12],v=t[13],m=t[14],g=t[15];return e[0]=s*(d*g-h*m)-f*(u*g-l*m)+v*(u*h-l*d),e[1]=-(r*(d*g-h*m)-f*(i*g-o*m)+v*(i*h-o*d)),e[2]=r*(u*g-l*m)-s*(i*g-o*m)+v*(i*l-o*u),e[3]=-(r*(u*h-l*d)-s*(i*h-o*d)+f*(i*l-o*u)),e[4]=-(a*(d*g-h*m)-c*(u*g-l*m)+p*(u*h-l*d)),e[5]=n*(d*g-h*m)-c*(i*g-o*m)+p*(i*h-o*d),e[6]=-(n*(u*g-l*m)-a*(i*g-o*m)+p*(i*l-o*u)),e[7]=n*(u*h-l*d)-a*(i*h-o*d)+c*(i*l-o*u),e[8]=a*(f*g-h*v)-c*(s*g-l*v)+p*(s*h-l*f),e[9]=-(n*(f*g-h*v)-c*(r*g-o*v)+p*(r*h-o*f)),e[10]=n*(s*g-l*v)-a*(r*g-o*v)+p*(r*l-o*s),e[11]=-(n*(s*h-l*f)-a*(r*h-o*f)+c*(r*l-o*s)),e[12]=-(a*(f*m-d*v)-c*(s*m-u*v)+p*(s*d-u*f)),e[13]=n*(f*m-d*v)-c*(r*m-i*v)+p*(r*d-i*f),e[14]=-(n*(s*m-u*v)-a*(r*m-i*v)+p*(r*u-i*s)),e[15]=n*(s*d-u*f)-a*(r*d-i*f)+c*(r*u-i*s),e},i.determinant=function(e){var t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],u=e[7],l=e[8],c=e[9],f=e[10],d=e[11],h=e[12],p=e[13],v=e[14],m=e[15];return(t*a-n*o)*(f*m-d*v)-(t*s-r*o)*(c*m-d*p)+(t*u-i*o)*(c*v-f*p)+(n*s-r*a)*(l*m-d*h)-(n*u-i*a)*(l*v-f*h)+(r*u-i*s)*(l*p-c*h)},i.multiply=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],l=t[6],c=t[7],f=t[8],d=t[9],h=t[10],p=t[11],v=t[12],m=t[13],g=t[14],_=t[15],y=n[0],b=n[1],w=n[2],M=n[3];return e[0]=y*r+b*s+w*f+M*v,e[1]=y*i+b*u+w*d+M*m,e[2]=y*o+b*l+w*h+M*g,e[3]=y*a+b*c+w*p+M*_,y=n[4],b=n[5],w=n[6],M=n[7],e[4]=y*r+b*s+w*f+M*v,e[5]=y*i+b*u+w*d+M*m,e[6]=y*o+b*l+w*h+M*g,e[7]=y*a+b*c+w*p+M*_,y=n[8],b=n[9],w=n[10],M=n[11],e[8]=y*r+b*s+w*f+M*v,e[9]=y*i+b*u+w*d+M*m,e[10]=y*o+b*l+w*h+M*g,e[11]=y*a+b*c+w*p+M*_,y=n[12],b=n[13],w=n[14],M=n[15],e[12]=y*r+b*s+w*f+M*v,e[13]=y*i+b*u+w*d+M*m,e[14]=y*o+b*l+w*h+M*g,e[15]=y*a+b*c+w*p+M*_,e},i.mul=i.multiply,i.translate=function(e,t,n){var r,i,o,a,s,u,l,c,f,d,h,p,v=n[0],m=n[1],g=n[2];return t===e?(e[12]=t[0]*v+t[4]*m+t[8]*g+t[12],e[13]=t[1]*v+t[5]*m+t[9]*g+t[13],e[14]=t[2]*v+t[6]*m+t[10]*g+t[14],e[15]=t[3]*v+t[7]*m+t[11]*g+t[15]):(r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],l=t[6],c=t[7],f=t[8],d=t[9],h=t[10],p=t[11],e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=u,e[6]=l,e[7]=c,e[8]=f,e[9]=d,e[10]=h,e[11]=p,e[12]=r*v+s*m+f*g+t[12],e[13]=i*v+u*m+d*g+t[13],e[14]=o*v+l*m+h*g+t[14],e[15]=a*v+c*m+p*g+t[15]),e},i.scale=function(e,t,n){var r=n[0],i=n[1],o=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},i.rotate=function(e,t,n,i){var o,a,s,u,l,c,f,d,h,p,v,m,g,_,y,b,w,M,x,S,P,C,T,A,O=i[0],I=i[1],E=i[2],D=Math.sqrt(O*O+I*I+E*E);return Math.abs(D)<r.EPSILON?null:(D=1/D,O*=D,I*=D,E*=D,o=Math.sin(n),a=Math.cos(n),s=1-a,u=t[0],l=t[1],c=t[2],f=t[3],d=t[4],h=t[5],p=t[6],v=t[7],m=t[8],g=t[9],_=t[10],y=t[11],b=O*O*s+a,w=I*O*s+E*o,M=E*O*s-I*o,x=O*I*s-E*o,S=I*I*s+a,P=E*I*s+O*o,C=O*E*s+I*o,T=I*E*s-O*o,A=E*E*s+a,e[0]=u*b+d*w+m*M,e[1]=l*b+h*w+g*M,e[2]=c*b+p*w+_*M,e[3]=f*b+v*w+y*M,e[4]=u*x+d*S+m*P,e[5]=l*x+h*S+g*P,e[6]=c*x+p*S+_*P,e[7]=f*x+v*S+y*P,e[8]=u*C+d*T+m*A,e[9]=l*C+h*T+g*A,e[10]=c*C+p*T+_*A,e[11]=f*C+v*T+y*A,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)},i.rotateX=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[4],a=t[5],s=t[6],u=t[7],l=t[8],c=t[9],f=t[10],d=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*i+l*r,e[5]=a*i+c*r,e[6]=s*i+f*r,e[7]=u*i+d*r,e[8]=l*i-o*r,e[9]=c*i-a*r,e[10]=f*i-s*r,e[11]=d*i-u*r,e},i.rotateY=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[0],a=t[1],s=t[2],u=t[3],l=t[8],c=t[9],f=t[10],d=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i-l*r,e[1]=a*i-c*r,e[2]=s*i-f*r,e[3]=u*i-d*r,e[8]=o*r+l*i,e[9]=a*r+c*i,e[10]=s*r+f*i,e[11]=u*r+d*i,e},i.rotateZ=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[0],a=t[1],s=t[2],u=t[3],l=t[4],c=t[5],f=t[6],d=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i+l*r,e[1]=a*i+c*r,e[2]=s*i+f*r,e[3]=u*i+d*r,e[4]=l*i-o*r,e[5]=c*i-a*r,e[6]=f*i-s*r,e[7]=d*i-u*r,e},i.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},i.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},i.fromRotation=function(e,t,n){var i,o,a,s=n[0],u=n[1],l=n[2],c=Math.sqrt(s*s+u*u+l*l);return Math.abs(c)<r.EPSILON?null:(c=1/c,s*=c,u*=c,l*=c,i=Math.sin(t),o=Math.cos(t),a=1-o,e[0]=s*s*a+o,e[1]=u*s*a+l*i,e[2]=l*s*a-u*i,e[3]=0,e[4]=s*u*a-l*i,e[5]=u*u*a+o,e[6]=l*u*a+s*i,e[7]=0,e[8]=s*l*a+u*i,e[9]=u*l*a-s*i,e[10]=l*l*a+o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)},i.fromXRotation=function(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},i.fromYRotation=function(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},i.fromZRotation=function(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},i.fromRotationTranslation=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=r+r,u=i+i,l=o+o,c=r*s,f=r*u,d=r*l,h=i*u,p=i*l,v=o*l,m=a*s,g=a*u,_=a*l;return e[0]=1-(h+v),e[1]=f+_,e[2]=d-g,e[3]=0,e[4]=f-_,e[5]=1-(c+v),e[6]=p+m,e[7]=0,e[8]=d+g,e[9]=p-m,e[10]=1-(c+h),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e},i.fromRotationTranslationScale=function(e,t,n,r){var i=t[0],o=t[1],a=t[2],s=t[3],u=i+i,l=o+o,c=a+a,f=i*u,d=i*l,h=i*c,p=o*l,v=o*c,m=a*c,g=s*u,_=s*l,y=s*c,b=r[0],w=r[1],M=r[2];return e[0]=(1-(p+m))*b,e[1]=(d+y)*b,e[2]=(h-_)*b,e[3]=0,e[4]=(d-y)*w,e[5]=(1-(f+m))*w,e[6]=(v+g)*w,e[7]=0,e[8]=(h+_)*M,e[9]=(v-g)*M,e[10]=(1-(f+p))*M,e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e},i.fromRotationTranslationScaleOrigin=function(e,t,n,r,i){var o=t[0],a=t[1],s=t[2],u=t[3],l=o+o,c=a+a,f=s+s,d=o*l,h=o*c,p=o*f,v=a*c,m=a*f,g=s*f,_=u*l,y=u*c,b=u*f,w=r[0],M=r[1],x=r[2],S=i[0],P=i[1],C=i[2];return e[0]=(1-(v+g))*w,e[1]=(h+b)*w,e[2]=(p-y)*w,e[3]=0,e[4]=(h-b)*M,e[5]=(1-(d+g))*M,e[6]=(m+_)*M,e[7]=0,e[8]=(p+y)*x,e[9]=(m-_)*x,e[10]=(1-(d+v))*x,e[11]=0,e[12]=n[0]+S-(e[0]*S+e[4]*P+e[8]*C),e[13]=n[1]+P-(e[1]*S+e[5]*P+e[9]*C),e[14]=n[2]+C-(e[2]*S+e[6]*P+e[10]*C),e[15]=1,e},i.fromQuat=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n+n,s=r+r,u=i+i,l=n*a,c=r*a,f=r*s,d=i*a,h=i*s,p=i*u,v=o*a,m=o*s,g=o*u;return e[0]=1-f-p,e[1]=c+g,e[2]=d-m,e[3]=0,e[4]=c-g,e[5]=1-l-p,e[6]=h+v,e[7]=0,e[8]=d+m,e[9]=h-v,e[10]=1-l-f,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},i.frustum=function(e,t,n,r,i,o,a){var s=1/(n-t),u=1/(i-r),l=1/(o-a);return e[0]=2*o*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*o*u,e[6]=0,e[7]=0,e[8]=(n+t)*s,e[9]=(i+r)*u,e[10]=(a+o)*l,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*o*2*l,e[15]=0,e},i.perspective=function(e,t,n,r,i){var o=1/Math.tan(t/2),a=1/(r-i);return e[0]=o/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(i+r)*a,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*i*r*a,e[15]=0,e},i.perspectiveFromFieldOfView=function(e,t,n,r){var i=Math.tan(t.upDegrees*Math.PI/180),o=Math.tan(t.downDegrees*Math.PI/180),a=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),u=2/(a+s),l=2/(i+o);return e[0]=u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=l,e[6]=0,e[7]=0,e[8]=-(a-s)*u*.5,e[9]=(i-o)*l*.5,e[10]=r/(n-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*n/(n-r),e[15]=0,e},i.ortho=function(e,t,n,r,i,o,a){var s=1/(t-n),u=1/(r-i),l=1/(o-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*l,e[11]=0,e[12]=(t+n)*s,e[13]=(i+r)*u,e[14]=(a+o)*l,e[15]=1,e},i.lookAt=function(e,t,n,o){var a,s,u,l,c,f,d,h,p,v,m=t[0],g=t[1],_=t[2],y=o[0],b=o[1],w=o[2],M=n[0],x=n[1],S=n[2];return Math.abs(m-M)<r.EPSILON&&Math.abs(g-x)<r.EPSILON&&Math.abs(_-S)<r.EPSILON?i.identity(e):(d=m-M,h=g-x,p=_-S,v=1/Math.sqrt(d*d+h*h+p*p),d*=v,h*=v,p*=v,a=b*p-w*h,s=w*d-y*p,u=y*h-b*d,v=Math.sqrt(a*a+s*s+u*u),v?(v=1/v,a*=v,s*=v,u*=v):(a=0,s=0,u=0),l=h*u-p*s,c=p*a-d*u,f=d*s-h*a,v=Math.sqrt(l*l+c*c+f*f),v?(v=1/v,l*=v,c*=v,f*=v):(l=0,c=0,f=0),e[0]=a,e[1]=l,e[2]=d,e[3]=0,e[4]=s,e[5]=c,e[6]=h,e[7]=0,e[8]=u,e[9]=f,e[10]=p,e[11]=0,e[12]=-(a*m+s*g+u*_),e[13]=-(l*m+c*g+f*_),e[14]=-(d*m+h*g+p*_),e[15]=1,e)},i.str=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},i.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))},e.exports=i},function(e,t){var n=function(e){var t="";return t+="#define GLSLIFY 1\nif(uRenderMode == 1.) {\n  float fogHeightFactor = max(0.0, vWorldPosition.y * 0.08);\n  fogHeightFactor = pow(exp2(-fogHeightFactor * fogHeightFactor), 16.0);\n\n  FragColor.xyz = mix(vec3(1.0), clamp(FragColor.xyz * vec3(0.96), 0.0, 1.0), fogHeightFactor);\n}\n"};n.toString=n,e.exports=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(4),s=r(a),u=n(11),l=r(u),c=n(33),f=r(c),d=n(51),h=r(d),p=n(189),v=r(p),m=n(59),g=n(190),_=r(g),y=1,b=function(){function e(t,n){i(this,e),this.scene=t,this.gl=t.gl,this.subrenderables=[],this.keepBuffer=!1,this.keepBufferMeshes=[],this.time=0,this.unpack=this._unpack.bind(this),this.parse=this._parse.bind(this),this.loadBuffer=this._loadBuffer.bind(this),this.loadBinaries=this._loadBinaries.bind(this),this.onLoad=this._onLoad.bind(this),this.mats=t.matlib.createProvider(n),this.texs=t.texlib.createProvider(n),this.glbBody=null,this.buffers=[],this._state=y,this._loadables=[],this._loadPromise=null,this.node=new s.default,this.childrenRootNodes=[],this.nodeList=[],this.meshList=[],this.animator=null,this.skins=null}return o(e,[{key:"getLoadables",value:function(){var e=void 0;if(this._state===y){var t=h.default.asset_url(this.getGLTFUrl());e=f.default.loadBytes(t).then(this.unpack).then(this.loadBinaries).then(this.parse),this._loadables.push(e);for(var n=this.texs.getLoadables(),r=0;r<n.length;r++)this._loadables.push(n[r]);this._state=2,this._loadPromise=l.default.all(this._loadables),this._loadPromise.then(this.onLoad)}return this._loadables}},{key:"getGLTFUrl",value:function(){return null}},{key:"getMaterial",value:function(e){var t=this.mats.getMaterial(e);return t}},{key:"getNodeByUUID",value:function(e){for(var t=0,n=this.nodeList.length;t<n;t++)if(this.nodeList[t].uuid===e)return this.nodeList[t]}},{key:"getNodeByName",value:function(e){for(var t=0,n=this.nodeList.length;t<n;t++)if(this.nodeList[t].name===e)return this.nodeList[t]}},{key:"getNodesByCondition",value:function(e){for(var t=[],n=this.nodeList,r=0,i=n.length;r<i;r++){var o=n[r];e(o)&&t.push(o)}return t}},{key:"getNodesByRegex",value:function(e){return this.getNodesByCondition(function(t){return t.name.match(e)})}},{key:"getMeshByName",value:function(e){for(var t=0;t<this.meshList.length;t++)if(this.meshList[t].name===e)return this.meshList[t]}},{key:"getMeshesByCondition",value:function(e){for(var t=[],n=this.meshList,r=0,i=n.length;r<i;r++){var o=n[r];e(o)&&t.push(o)}return t}},{key:"getMeshesByRegex",value:function(e){return this.getMeshesByCondition(function(t){return t.name.match(e)})}},{key:"getMeshByUUID",value:function(e){for(var t=0;t<this.meshList.length;t++)if(this.meshList[t].uuid===e)return this.meshList[t]}},{key:"toggleMesh",value:function(e,t){this.getNodeByName(e).getMeshByName(e).isVisible=t}},{key:"toggleNodesByRegex",value:function(e,t){for(var n=this.getNodesByCondition(function(t){return t.name.match(e)}),r=0,i=n.length;r<i;r++){var o=n[r];this.toggleNodeTree(o.name,t)}}},{key:"toggleNodeTree",value:function(e,t){for(var n=this.getNodeByName(e),r=n.meshes,i=0,o=r.length;i<o;i++){var a=r[i];a.name===e&&(a.isVisible=t)}}},{key:"updateRenderMode",value:function(e){for(var t=this.mats.matlist,n=0,r=t.length;n<r;n++){var i=t[n];i.renderMode!==m.RENDER_MODES.DISABLED&&(i.renderMode=e)}}},{key:"_unpack",value:function(e){return 1179937895===new Uint32Array(e,0,1)[0]?this.parseGlb(e):JSON.parse((0,v.default)(new Uint8Array(e)))}},{key:"parseGlb",value:function(e){var t=new Uint32Array(e,0,5);if(2!==t[1])throw new Error("Binary glTF version is not 2");var n=t[3];if(1313821514!==t[4])throw new Error("Binary glTF scene format is not JSON");var r=(0,v.default)(new Uint8Array(e,20,n)),i=JSON.parse(r);return this.glbBody=e.slice(20+n+8),i}},{key:"_loadBuffer",value:function(e,t){if(0===t&&void 0===e.uri)return this.glbBody;var n=h.default.asset_url(this.getAssetPath(e.uri));return f.default.loadBytes(n)}},{key:"_loadBinaries",value:function(e){var t=this;return l.default.map(e.buffers,this.loadBuffer).then(function(e){t.buffers=e}).yield(e)}},{key:"_parse",value:function(e){this.loader=new _.default(e,this.buffers),this.loader.keepBuffer=this.keepBuffer,this.loader.load(this,this.node),this.meshList=this.loader.getMeshes(),this.skinList=this.loader.getSkins(),this._postParse(),this._state=3}},{key:"_postParse",value:function(){if(this.skinList.length>0)for(var e=0;e<this.meshList.length;e++){var t=this.meshList[e];t.skinIdx>-1&&t.setSkin(this.skins.getSkin(t.skinIdx))}}},{key:"_onLoad",value:function(){null==this.skins&&(this._state=3)}},{key:"preRender",value:function(e){if(this.time+=e,3===this._state){for(var t=0;t<this.subrenderables.length;t++)this.subrenderables[t].preRender();for(var n=this.childrenRootNodes,r=0;r<n.length;r++)n[r].preRender(this.scene);this.animator&&this.animator.update(e),this.skins&&this.skins.update(e)}}},{key:"render",value:function(e,t){if(3===this._state){for(var n=0;n<this.subrenderables.length;n++)this.subrenderables[n].render(e,t);for(var r=this.childrenRootNodes,i=0;i<r.length;i++)r[i].render(this.scene,e,t)}}},{key:"renderPass",value:function(e,t,n,r){if(3===this._state){for(var i=0;i<this.subrenderables.length;i++)this.subrenderables[i].renderPass(t,n,r);for(var o=this.childrenRootNodes,a=0;a<o.length;a++)o[a].renderPass(e,t,n,r)}}},{key:"renderDepth",value:function(e,t,n,r,i){if(3===this._state)for(var o=this.childrenRootNodes,a=0;a<o.length;a++)o[a].renderDepth(e,t,n,r,i)}},{key:"renderProgram",value:function(e,t,n){for(var r=this.childrenRootNodes,i=0;i<r.length;i++)r[i].renderProgram(e,t,n)}}]),e}();t.default=b,e.exports=t.default},function(e,t,n){(function(t){function n(e,t,n){function i(t){var n=v,r=m;return v=m=void 0,S=t,_=e.apply(r,n)}function o(e){return S=e,y=setTimeout(c,t),P?i(e):_}function u(e){var n=e-x,r=e-S,i=t-n;return C?w(i,g-r):i}function l(e){var n=e-x,r=e-S;return void 0===x||n>=t||n<0||C&&r>=g}function c(){var e=M();if(l(e))return f(e);y=setTimeout(c,u(e))}function f(e){return y=void 0,T&&v?i(e):(v=m=void 0,_)}function d(){void 0!==y&&clearTimeout(y),S=0,v=x=m=y=void 0}function h(){return void 0===y?_:f(M())}function p(){var e=M(),n=l(e);if(v=arguments,m=this,x=e,n){if(void 0===y)return o(x);if(C)return y=setTimeout(c,t),i(x)}return void 0===y&&(y=setTimeout(c,t)),_}var v,m,g,_,y,x,S=0,P=!1,C=!1,T=!0;if("function"!=typeof e)throw new TypeError(s);return t=a(t)||0,r(n)&&(P=!!n.leading,C="maxWait"in n,g=C?b(a(n.maxWait)||0,t):g,T="trailing"in n?!!n.trailing:T),p.cancel=d,p.flush=h,p}function r(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function i(e){return!!e&&"object"==typeof e}function o(e){return"symbol"==typeof e||i(e)&&y.call(e)==l}function a(e){if("number"==typeof e)return e;if(o(e))return u;if(r(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=r(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(c,"");var n=d.test(e);return n||h.test(e)?p(e.slice(2),n?2:8):f.test(e)?u:+e}var s="Expected a function",u=NaN,l="[object Symbol]",c=/^\s+|\s+$/g,f=/^[-+]0x[0-9a-f]+$/i,d=/^0b[01]+$/i,h=/^0o[0-7]+$/i,p=parseInt,v="object"==typeof t&&t&&t.Object===Object&&t,m="object"==typeof self&&self&&self.Object===Object&&self,g=v||m||Function("return this")(),_=Object.prototype,y=_.toString,b=Math.max,w=Math.min,M=function(){return g.Date.now()};e.exports=n}).call(t,n(5))},function(e,t,n){"use strict";function r(){function e(){return!a[n.hidden]}function t(t){a.addEventListener(n.event,function(){t(e())})}var n=u(a);return n?{visible:e,onChange:s(t)}:i()}function i(){return{visible:function(){return!0},onChange:o}}function o(){}var a=n(74),s=n(76),u=n(78);e.exports=r},function(e,t,n){(function(t){var r,i=void 0!==t?t:"undefined"!=typeof window?window:{},o=n(75);"undefined"!=typeof document?r=document:(r=i["__GLOBAL_DOCUMENT_CACHE@4"])||(r=i["__GLOBAL_DOCUMENT_CACHE@4"]=o),e.exports=r}).call(t,n(5))},function(e,t){},function(e,t,n){function r(e){var t=i();return e(t.broadcast),t.listen}var i=n(77);e.exports=r},function(e,t){function n(){function e(e){for(var t=0;t<n.length;t++)n[t](e)}function t(e){function t(){var t=n.indexOf(e);-1!==t&&n.splice(t,1)}return n.push(e),t}var n=[];return{broadcast:e,listen:t}}e.exports=n},function(e,t,n){"use strict";function r(e){var t=i(e);if(null!=t)return{hidden:o(t+"Hidden"),event:t+"visibilitychange"}}function i(e){return null!=e.hidden?"":null!=e.mozHidden?"moz":null!=e.msHidden?"ms":null!=e.webkitHidden?"webkit":void 0}function o(e){return e.substring(0,1).toLowerCase()+e.substring(1)}e.exports=r},function(e,t){/*!
* screenfull
* v3.3.3 - 2018-09-04
* (c) Sindre Sorhus; MIT License
*/
!function(){"use strict";var t="undefined"!=typeof window&&void 0!==window.document?window.document:{},n=void 0!==e&&e.exports,r="undefined"!=typeof Element&&"ALLOW_KEYBOARD_INPUT"in Element,i=function(){for(var e,n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],r=0,i=n.length,o={};r<i;r++)if((e=n[r])&&e[1]in t){for(r=0;r<e.length;r++)o[n[0][r]]=e[r];return o}return!1}(),o={change:i.fullscreenchange,error:i.fullscreenerror},a={request:function(e){var n=i.requestFullscreen;e=e||t.documentElement,/ Version\/5\.1(?:\.\d+)? Safari\//.test(navigator.userAgent)?e[n]():e[n](r?Element.ALLOW_KEYBOARD_INPUT:{})},exit:function(){t[i.exitFullscreen]()},toggle:function(e){this.isFullscreen?this.exit():this.request(e)},onchange:function(e){this.on("change",e)},onerror:function(e){this.on("error",e)},on:function(e,n){var r=o[e];r&&t.addEventListener(r,n,!1)},off:function(e,n){var r=o[e];r&&t.removeEventListener(r,n,!1)},raw:i};if(!i)return void(n?e.exports=!1:window.screenfull=!1);Object.defineProperties(a,{isFullscreen:{get:function(){return Boolean(t[i.fullscreenElement])}},element:{enumerable:!0,get:function(){return t[i.fullscreenElement]}},enabled:{enumerable:!0,get:function(){return Boolean(t[i.fullscreenEnabled])}}}),n?e.exports=a:window.screenfull=a}()},function(e,t){var n=function(e){var t="";return t+="#define GLSLIFY 1\nvec2 noiseUv(sampler2D tex, vec2 uv, float scale, float power, float time, float speed) {\n  float noise = texture2D(tex, uv * scale + time * speed).r;\n  return uv + noise * power;\n}\n"};n.toString=n,e.exports=n},function(e,t,n){"use strict";(function(r){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o,a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(11),u=function(e){return e&&e.__esModule?e:{default:e}}(s),l=(o=function(){function e(t){i(this,e),this.scene=t,this.name=null,this.started=!1,this.loaded=!1}return a(e,[{key:"init",value:function(e){this.name=e,this.bind()}},{key:"destroy",value:function(){this.unbind()}},{key:"bind",value:function(){}},{key:"unbind",value:function(){}},{key:"start",value:function(){return this.started=!0,(0,u.default)()}},{key:"stop",value:function(){return this.started=!1,(0,u.default)()}},{key:"preRender",value:function(e){}},{key:"render",value:function(){}},{key:"getLoadables",value:function(){return[]}},{key:"_onLoaded",value:function(){this.loaded=!0}}]),e}(),function(e,t,n,r,i){var o={};return Object.keys(r).forEach(function(e){o[e]=r[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}(o.prototype,"_onLoaded",[r],Object.getOwnPropertyDescriptor(o.prototype,"_onLoaded"),o.prototype),o);t.default=l,e.exports=t.default}).call(t,n(2).bind)},,,,,function(e,t,n){var r=n(38),i=n(68),o=n(87),a=n(128),s={};s.create=function(){var e=new r.ARRAY_TYPE(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},s.rotationTo=function(){var e=o.create(),t=o.fromValues(1,0,0),n=o.fromValues(0,1,0);return function(r,i,a){var u=o.dot(i,a);return u<-.999999?(o.cross(e,t,i),o.length(e)<1e-6&&o.cross(e,n,i),o.normalize(e,e),s.setAxisAngle(r,e,Math.PI),r):u>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(o.cross(e,i,a),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=1+u,s.normalize(r,r))}}(),s.setAxes=function(){var e=i.create();return function(t,n,r,i){return e[0]=r[0],e[3]=r[1],e[6]=r[2],e[1]=i[0],e[4]=i[1],e[7]=i[2],e[2]=-n[0],e[5]=-n[1],e[8]=-n[2],s.normalize(t,s.fromMat3(t,e))}}(),s.clone=a.clone,s.fromValues=a.fromValues,s.copy=a.copy,s.set=a.set,s.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},s.setAxisAngle=function(e,t,n){n*=.5;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e},s.add=a.add,s.multiply=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=n[0],u=n[1],l=n[2],c=n[3];return e[0]=r*c+a*s+i*l-o*u,e[1]=i*c+a*u+o*s-r*l,e[2]=o*c+a*l+r*u-i*s,e[3]=a*c-r*s-i*u-o*l,e},s.mul=s.multiply,s.scale=a.scale,s.rotateX=function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(n),u=Math.cos(n);return e[0]=r*u+a*s,e[1]=i*u+o*s,e[2]=o*u-i*s,e[3]=a*u-r*s,e},s.rotateY=function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(n),u=Math.cos(n);return e[0]=r*u-o*s,e[1]=i*u+a*s,e[2]=o*u+r*s,e[3]=a*u-i*s,e},s.rotateZ=function(e,t,n){n*=.5;var r=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(n),u=Math.cos(n);return e[0]=r*u+i*s,e[1]=i*u-r*s,e[2]=o*u+a*s,e[3]=a*u-o*s,e},s.calculateW=function(e,t){var n=t[0],r=t[1],i=t[2];return e[0]=n,e[1]=r,e[2]=i,e[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),e},s.dot=a.dot,s.lerp=a.lerp,s.slerp=function(e,t,n,r){var i,o,a,s,u,l=t[0],c=t[1],f=t[2],d=t[3],h=n[0],p=n[1],v=n[2],m=n[3];return o=l*h+c*p+f*v+d*m,o<0&&(o=-o,h=-h,p=-p,v=-v,m=-m),1-o>1e-6?(i=Math.acos(o),a=Math.sin(i),s=Math.sin((1-r)*i)/a,u=Math.sin(r*i)/a):(s=1-r,u=r),e[0]=s*l+u*h,e[1]=s*c+u*p,e[2]=s*f+u*v,e[3]=s*d+u*m,e},s.sqlerp=function(){var e=s.create(),t=s.create();return function(n,r,i,o,a,u){return s.slerp(e,r,a,u),s.slerp(t,i,o,u),s.slerp(n,e,t,2*u*(1-u)),n}}(),s.invert=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n*n+r*r+i*i+o*o,s=a?1/a:0;return e[0]=-n*s,e[1]=-r*s,e[2]=-i*s,e[3]=o*s,e},s.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},s.length=a.length,s.len=s.length,s.squaredLength=a.squaredLength,s.sqrLen=s.squaredLength,s.normalize=a.normalize,s.fromMat3=function(e,t){var n,r=t[0]+t[4]+t[8];if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[3*i+i]&&(i=2);var o=(i+1)%3,a=(i+2)%3;n=Math.sqrt(t[3*i+i]-t[3*o+o]-t[3*a+a]+1),e[i]=.5*n,n=.5/n,e[3]=(t[3*o+a]-t[3*a+o])*n,e[o]=(t[3*o+i]+t[3*i+o])*n,e[a]=(t[3*a+i]+t[3*i+a])*n}return e},s.str=function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},e.exports=s},function(e,t,n){var r=n(38),i={};i.create=function(){var e=new r.ARRAY_TYPE(3);return e[0]=0,e[1]=0,e[2]=0,e},i.clone=function(e){var t=new r.ARRAY_TYPE(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},i.fromValues=function(e,t,n){var i=new r.ARRAY_TYPE(3);return i[0]=e,i[1]=t,i[2]=n,i},i.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},i.set=function(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e},i.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e},i.subtract=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e},i.sub=i.subtract,i.multiply=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e},i.mul=i.multiply,i.divide=function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e},i.div=i.divide,i.min=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e},i.max=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e},i.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e},i.scaleAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e},i.distance=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(n*n+r*r+i*i)},i.dist=i.distance,i.squaredDistance=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return n*n+r*r+i*i},i.sqrDist=i.squaredDistance,i.length=function(e){var t=e[0],n=e[1],r=e[2];return Math.sqrt(t*t+n*n+r*r)},i.len=i.length,i.squaredLength=function(e){var t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r},i.sqrLen=i.squaredLength,i.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},i.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e},i.normalize=function(e,t){var n=t[0],r=t[1],i=t[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o),e},i.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},i.cross=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],s=n[1],u=n[2];return e[0]=i*u-o*s,e[1]=o*a-r*u,e[2]=r*s-i*a,e},i.lerp=function(e,t,n,r){var i=t[0],o=t[1],a=t[2];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e[2]=a+r*(n[2]-a),e},i.hermite=function(e,t,n,r,i,o){var a=o*o,s=a*(2*o-3)+1,u=a*(o-2)+o,l=a*(o-1),c=a*(3-2*o);return e[0]=t[0]*s+n[0]*u+r[0]*l+i[0]*c,e[1]=t[1]*s+n[1]*u+r[1]*l+i[1]*c,e[2]=t[2]*s+n[2]*u+r[2]*l+i[2]*c,e},i.bezier=function(e,t,n,r,i,o){var a=1-o,s=a*a,u=o*o,l=s*a,c=3*o*s,f=3*u*a,d=u*o;return e[0]=t[0]*l+n[0]*c+r[0]*f+i[0]*d,e[1]=t[1]*l+n[1]*c+r[1]*f+i[1]*d,e[2]=t[2]*l+n[2]*c+r[2]*f+i[2]*d,e},i.random=function(e,t){t=t||1;var n=2*r.RANDOM()*Math.PI,i=2*r.RANDOM()-1,o=Math.sqrt(1-i*i)*t;return e[0]=Math.cos(n)*o,e[1]=Math.sin(n)*o,e[2]=i*t,e},i.transformMat4=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[3]*r+n[7]*i+n[11]*o+n[15];return a=a||1,e[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/a,e[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/a,e[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/a,e},i.transformMat3=function(e,t,n){var r=t[0],i=t[1],o=t[2];return e[0]=r*n[0]+i*n[3]+o*n[6],e[1]=r*n[1]+i*n[4]+o*n[7],e[2]=r*n[2]+i*n[5]+o*n[8],e},i.transformQuat=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],s=n[1],u=n[2],l=n[3],c=l*r+s*o-u*i,f=l*i+u*r-a*o,d=l*o+a*i-s*r,h=-a*r-s*i-u*o;return e[0]=c*l+h*-a+f*-u-d*-s,e[1]=f*l+h*-s+d*-a-c*-u,e[2]=d*l+h*-u+c*-s-f*-a,e},i.rotateX=function(e,t,n,r){var i=[],o=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e},i.rotateY=function(e,t,n,r){var i=[],o=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e},i.rotateZ=function(e,t,n,r){var i=[],o=[];return i[0]=t[0]-n[0],i[1]=t[1]-n[1],i[2]=t[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],e[0]=o[0]+n[0],e[1]=o[1]+n[1],e[2]=o[2]+n[2],e},i.forEach=function(){var e=i.create();return function(t,n,r,i,o,a){var s,u;for(n||(n=3),r||(r=0),u=i?Math.min(i*n+r,t.length):t.length,s=r;s<u;s+=n)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],o(e,e,a),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2];return t}}(),i.angle=function(e,t){var n=i.fromValues(e[0],e[1],e[2]),r=i.fromValues(t[0],t[1],t[2]);i.normalize(n,n),i.normalize(r,r);var o=i.dot(n,r);return o>1?0:Math.acos(o)},i.str=function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},e.exports=i},function(e,t,n){function r(e){i.call(this),this.lens=e,this._view=o.create(),this._viewProj=o.create()}var i=n(4),o=n(69),a=n(131),s=n(132),u=o.create(),l=Object.create(i.prototype);l.modelViewMatrix=function(e,t){o.multiply(e,t,this._view)},l.modelViewProjectionMatrix=function(e,t){o.multiply(e,this._viewProj,t)},l.getMVP=function(e){return o.multiply(u,this._viewProj,e),u},l.unproject=function(e,t){o.invert(IMVP,this._proj),vec3.transformMat4(e,t,IMVP)},l.updateViewProjectionMatrix=function(e,t){this.lens.aspect=e/t,o.multiply(this._viewProj,this.lens.getProjection(),this._view)},l._computeWorldMatrix=function(e){i.prototype._computeWorldMatrix.call(this,e),o.invert(this._view,this._wmatrix)},r.makePerspectiveCamera=function(){return new r(new a)},r.makeOrthoCamera=function(){return new r(new s)},l.constructor=r,r.prototype=l,e.exports=r},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t,n){r(this,e),this.env=t,this.sh=n}return i(e,[{key:"setupProgram",value:function(e){e.tEnv&&e.tEnv(this.env),e.uSHCoeffs&&e.uSHCoeffs(this.sh)}}],[{key:"convert",value:function(e,t){void 0===t&&(t=1);var n=Math.sqrt(Math.PI),r=1/(2*n),i=Math.sqrt(3)/(3*n),o=Math.sqrt(15)/(8*n),a=Math.sqrt(5)/(16*n),s=.5*o,u=new Float32Array(28);return u[0]=t*(i*e[6]),u[1]=t*(-i*e[3]),u[2]=t*(-i*e[9]),u[3]=t*(r*e[0]-a*e[18]),u[4]=t*(i*e[7]),u[5]=t*(-i*e[4]),u[6]=t*(-i*e[10]),u[7]=t*(r*e[1]-a*e[19]),u[8]=t*(i*e[8]),u[9]=t*(-i*e[5]),u[10]=t*(-i*e[11]),u[11]=t*(r*e[2]-a*e[20]),u[12]=t*(o*e[12]),u[13]=t*(-o*e[15]),u[14]=t*(3*a*e[18]),u[15]=t*(-o*e[21]),u[16]=t*(o*e[13]),u[17]=t*(-o*e[16]),u[18]=t*(3*a*e[19]),u[19]=t*(-o*e[22]),u[20]=t*(o*e[14]),u[21]=t*(-o*e[17]),u[22]=t*(3*a*e[20]),u[23]=t*(-o*e[23]),u[24]=t*(s*e[24]),u[25]=t*(s*e[25]),u[26]=t*(s*e[26]),u[27]=1*t,u}}]),e}();t.default=o,e.exports=t.default},function(e,t){e.exports={getComponentSize:function(e){switch(e){case 5120:case 5121:return 1;case 5122:case 5123:return 2;case 5124:case 5125:case 5126:return 4;default:return 0}},Drawable:function(e){e.drawPoints=function(e,t){this.draw(0,e,t)},e.drawLines=function(e,t){this.draw(1,e,t)},e.drawLineLoop=function(e,t){this.draw(2,e,t)},e.drawLineStrip=function(e,t){this.draw(3,e,t)},e.drawTriangles=function(e,t){this.draw(4,e,t)},e.drawTriangleStrip=function(e,t){this.draw(5,e,t)},e.drawTriangleFan=function(e,t){this.draw(6,e,t)}}}},function(e,t){function n(){this.post=null,this._flags=0}n.NEED_DEPTH=2,n.NEED_LINEAR=4,n.prototype={_init:function(e){this.post!==e&&(this.post=e,this.init())},init:function(){},release:function(){},preRender:function(){},genCode:function(e,t){},setupProgram:function(e){},resize:function(){}},e.exports=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(17),s=r(a),u=n(93),l=r(u),c=n(94),f=r(c),d=n(1).mat4.create(),h=function(){function e(t){i(this,e),this.ibl=null,this.prg=null,this.skinSetup=null,this.morphSetup=null,this.inputs=new f.default,this.config=new s.default,this.config.enableCullface(!0).enableDepthTest().depthMask(!0),this._prgcache=l.default.getCache(t),this._uid="depthlcl",this._precision="highp",this._vertSrc=n(168)(),this._fragSrc=n(171)()}return o(e,[{key:"setSkinSetup",value:function(e){if(this.skinSetup)throw new Error("material already have skin setup");this.skinSetup=e,this.inputs.addChunks(e.getChunks())}},{key:"setMorphSetup",value:function(e){if(this.morphSetup)throw new Error("material already have morph setup");this.morphSetup=e,this.inputs.addChunks(e.getChunks())}},{key:"setLightSetup",value:function(e){this.depthFormat=e.depthFormat.createProxy(),this.inputs.add(this.depthFormat)}},{key:"prepare",value:function(e,t){this._isDirty()&&this.compile();var n=this.prg;n.use(),n.setupInputs(this),t.modelViewProjectionMatrix(d,e._wmatrix),n.uMVP(d)}},{key:"_isDirty",value:function(){return null===this.prg||this.inputs._isDirty}},{key:"compile",value:function(){null!==this.prg&&this._prgcache.release(this.prg),this.prg=this._prgcache.compile(this)}}]),e}();t.default=h,e.exports=t.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(167),a=function(e){return e&&e.__esModule?e:{default:e}}(o),s=/^\s*#pragma SLOT\s\w+\s*$/gm,u=function(){function e(t){r(this,e),this.gl=t,this._cache={}}return i(e,[{key:"compile",value:function(e){var t=e.inputs;t.compile();var n=t.getHash();n+=e._uid+e._precision;var r=this._cache[n];if(void 0!==r)return r.usage++,r;var i=t.getCode(),o=this.processSlots(e._vertSrc,i),s=this.processSlots(e._fragSrc,i),u="precision "+e._precision+" float;\n";e.version&&(u="#version "+e.version+"\n"+u);var l=new a.default(this.gl,o,s,u);return l._usage++,this._cache[n]=l,l}},{key:"release",value:function(e){}},{key:"_addProgram",value:function(e,t){this._cache[t]=e}},{key:"processSlots",value:function(e,t){for(var n=0;n<t.slots.length;n++){var r=t.slots[n].code,i=t.slots[n].key;e=e.replace("#pragma SLOT "+i,r)}return s.lastIndex=0,e=e.replace(s,"")}}],[{key:"getCache",value:function(t){return void 0===t._prgcache&&(t._prgcache=new e(t)),t._prgcache}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(){this.slots=[],this.slotsMap={}}function i(e){this.material=e,this._setups=[],this._codes=[],this._flat=[],this._root=new o,this._root.list=this,this._isDirty=!0}var o=n(28);r.prototype={getSlot:function(e){var t=this.slotsMap[e];return void 0===t&&(t={key:e,code:""},this.slotsMap[e]=t,this.slots.push(t)),t},add:function(e,t){this.getSlot(e).code+=t+"\n"}},i.prototype={add:function(e){return this._root.add(e)},remove:function(e){return this._root.remove(e)},addChunks:function(e){for(var t=0;t<e.length;t++)this._root.add(e[t])},compile:function(){this._flatten()},_flatten:function(){var e=this._setups,t=this._codes,n=this._flat;e.length=0,t.length=0,n.length=0,this._root.traverse(e,t,n),this._isDirty=!1},getHash:function(){for(var e=this._codes,t="",n=0;n<e.length;n++)t+=e[n].getHash();return t},getCode:function(){for(var e=this._codes,t=new r,n=0;n<e.length;n++)e[n].genCode(t);return t}},e.exports=i},function(e,t){var n=function(e){var t="";return t+="#define GLSLIFY 1\n#ifndef _H_OCTWRAP_DECODE_\n#define _H_OCTWRAP_DECODE_\n\nvec2 octwrapDecode( vec3 v ) {\n  // Project the sphere onto the octahedron, and then onto the xy plan\n  vec2 p = v.xy / dot(  abs( v ) , vec3(1.0) );\n  p = vec2( p.x+p.y-1.0, p.x-p.y );\n\n  if( v.z < 0.0 )\n    p.x *= -1.0;\n\n  // p.x *= sign( v.z );\n  return p;\n}\n\n#endif"};n.toString=n,e.exports=n},function(e,t){var n=function(e){var t="";return t+="#define GLSLIFY 1\n#ifndef _H_DECODE_RGBE_\n#define _H_DECODE_RGBE_\n\nvec3 decodeRGBE( vec4 hdr ){\n  return hdr.rgb * exp2( (hdr.a*255.0)-128.0 );\n  // return hdr.rgb * pow( 2.0, (hdr.a*255.0)-128.0 );\n}\n\n#endif"};n.toString=n,e.exports=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(4),l=r(u),c=n(29),f=r(c),d=n(56),h=r(d),p=n(57),v=r(p),m=n(1),g=new Float32Array([.5,0,0,0,0,.5,0,0,0,0,.5,0,.5,.5,.5,1]),_=m.mat4.create(),y=new Float32Array(6),b=m.vec3.create(),w=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.gl=e,n._type=0,n._color=new Float32Array([1,1,1]),n._wdir=new Float32Array(n._wmatrix.buffer,32,3),n._castShadows=!1,n._fbo=null,n._camera=null,n._shadowmapSize=512,n.iblShadowing=.5,n}return a(t,e),s(t,[{key:"getShadowProjection",value:function(e){return this.projectionFromBounds(e),this._camera.updateViewProjectionMatrix(1,1),m.mat4.multiply(_,g,this._camera._viewProj),_}},{key:"castShadows",value:function(e){this._castShadows!==e&&(this._castShadows=e,e?this._initShadowMapping():this._releaseShadowMapping())}},{key:"hasDepthShadowmap",value:function(){return this._castShadows&&this._fbo.getAttachment(this.gl.DEPTH_ATTACHMENT).isTexture()}},{key:"getShadowmap",value:function(){if(this._castShadows){var e=this._fbo.getAttachment(this.gl.DEPTH_ATTACHMENT);return e.isTexture()?e.target:this._fbo.getAttachment(this.gl.COLOR_ATTACHMENT0).target}return null}},{key:"_initShadowMapping",value:function(e){var t=this._shadowmapSize,n=this.gl;this._fbo=new h.default(n),this._fbo.bind(),this._fbo.resize(t,t),this._fbo.attach(n.COLOR_ATTACHMENT0,new f.default(n,n.RGB));var r=v.default.getInstance(n).hasDepthTexture();this._fbo.attachDepth(!0,!1,r);var i=this.getShadowmap();i.bind(),n.COMPARE_REF_TO_TEXTURE?(i.setFilter(!0,!1,!1),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE)):i.setFilter(!1,!1,!1),this._camera=this._createCamera(),this.add(this._camera)}},{key:"_releaseShadowMapping",value:function(e){this._fbo.dispose(),this._fbo=null,this.remove(this._camera),this._camera=null}},{key:"_createCamera",value:function(){}},{key:"prepareShadowmap",value:function(){var e=this._shadowmapSize;this._fbo.resize(e,e),this._fbo.bind(),this._fbo.defaultViewport()}},{key:"boundsInLocalSpace",value:function(e){y[0]=y[1]=y[2]=Number.MAX_VALUE,y[3]=y[4]=y[5]=-Number.MAX_VALUE;for(var t=0;t<8;t++)b[0]=1&t?e.max[0]:e.min[0],b[1]=2&t?e.max[1]:e.min[1],b[2]=4&t?e.max[2]:e.min[2],m.vec3.transformMat4(b,b,this._camera._view),y[0]=Math.min(y[0],b[0]),y[1]=Math.min(y[1],b[1]),y[2]=Math.min(y[2],b[2]),y[3]=Math.max(y[3],b[0]),y[4]=Math.max(y[4],b[1]),y[5]=Math.max(y[5],b[2]);return y}}]),t}(l.default);w.TYPE_DIR=1,w.TYPE_SPOT=2,w.TYPE_POINT=4,t.default=w,e.exports=t.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=(function(){function e(){r(this,e),this.init()}i(e,[{key:"init",value:function(){this.gui=new dat.GUI({autoPlace:!1,scrollable:!0}),this.gui.close(),document.body.appendChild(this.gui.domElement)}},{key:"_toggle",value:function(){this.gui.domElement.classList.toggle("dg--visible")}}])}(),void 0),a=function(){return o};o={addFolder:a,removeFolder:a,add:a,addColor:a,remove:a,listen:a,setValue:a,getValue:a,updateDisplay:a,isModified:a,options:a,name:a,onChange:a,onFinishChange:a,destroy:a,open:a,close:a,step:a,min:a,max:a,getRoot:a,getSaveObject:a},t.default=o,e.exports=t.default},function(e,t,n){"use strict";(function(r){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u,l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},f=n(1),d=n(6),h=i(d),p=n(14),v=i(p),m=n(7),g=i(m),_=n(15),y=i(_),b=n(8),w=i(b),M=(u=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.iAlbedo=r.inputs.add(new h.default("albedo",3)),r.iSpecular=r.inputs.add(new h.default("specular",3)),r.iAlpha=r.inputs.add(new h.default("alpha",1)),r.iGloss=r.inputs.add(new h.default("gloss_base",1)),r.iNormal=r.inputs.add(new h.default("normal",3)),r.iOcclusion=r.inputs.add(new h.default("occlusion",1)),r.iCavity=r.inputs.add(new h.default("cavity",1)),r.iCavityStrength=r.inputs.add(new h.default("cavityStrength",2)),r.iEmissive=r.inputs.add(new h.default("emissive",1)),r.iEmissiveScale=r.inputs.add(new h.default("emissiveScale",1)),r.iFresnel=r.inputs.add(new h.default("fresnel",3)),r.conserveEnergy=r.inputs.add(new v.default("conserveEnergy",!0)),r.perVertexIrrad=r.inputs.add(new v.default("perVertexIrrad",!0)),r.glossNearest=r.inputs.add(new v.default("glossNearest",!1)),r.inferBitangent=r.inputs.add(new v.default("inferBitangent",!0)),r.pureGloss=r.inputs.add(new v.default("pureGloss",!1)),r.iLodDither=r.inputs.add(new h.default("lodDither",1)),r.lodDitherUniform=new h.default.Uniform("uLodDitherFactor",1),r.gammaMode=new g.default("gammaMode",["GAMMA_NONE","GAMMA_STD","GAMMA_2_2","GAMMA_TB"]),r.inputs.add(r.gammaMode),r.iGamma=r.inputs.add(new h.default("gamma",1)),r.iExposure=r.inputs.add(new h.default("exposure",1)),r.carReflectFbo=null,r.resolution=f.vec2.fromValues(y.default.prWidth,y.default.prHeight),r._uid="ground",r._vertSrc=n(208)(),r._fragSrc=n(209)(),r._bind(),r}return s(t,e),l(t,[{key:"_bind",value:function(){y.default.resized.add(this._onWindowResized)}},{key:"_unbind",value:function(){y.default.resized.remove(this._onWindowResized)}},{key:"_onWindowResized",value:function(e,t,n){f.vec2.set(this.resolution,e*n,t*n)}},{key:"prepare",value:function(e,n){c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"prepare",this).call(this,e,n),this.carReflectFbo&&0!==this.carReflectFbo.width&&this.prg.tCarReflect(this.carReflectFbo),this.prg.uResolution(this.resolution)}}]),t}(w.default),function(e,t,n,r,i){var o={};return Object.keys(r).forEach(function(e){o[e]=r[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}(u.prototype,"_onWindowResized",[r],Object.getOwnPropertyDescriptor(u.prototype,"_onWindowResized"),u.prototype),u);t.default=M,e.exports=t.default}).call(t,n(2).bind)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(6),u=r(s),l=n(8),c=r(l),f=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.iAlbedo=r.inputs.add(new u.default("albedo",3)),r._uid="sky",r._vertSrc=n(210)(),r._fragSrc=n(211)(),r}return a(t,e),t}(c.default);t.default=f,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(6),u=r(s),l=n(8),c=r(l),f=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.iAlbedo=r.inputs.add(new u.default("albedo",3)),r.iNoise=r.inputs.add(new u.default("noise",3)),r._uid="sky-reflect",r._vertSrc=n(212)(),r._fragSrc=n(213)(),r}return a(t,e),t}(c.default);t.default=f,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},l=n(6),c=r(l),f=n(14),d=r(f),h=n(7),p=r(h),v=n(20),m=r(v),g=n(8),_=r(g),y=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.iAlbedo=r.inputs.add(new c.default("albedo",3)),r.iSpecular=r.inputs.add(new c.default("specular",3)),r.iAlpha=r.inputs.add(new c.default("alpha",1)),r.iGloss=r.inputs.add(new c.default("gloss_base",1)),r.iNormal=r.inputs.add(new c.default("normal",3)),r.iOcclusion=r.inputs.add(new c.default("occlusion",1)),r.iCavity=r.inputs.add(new c.default("cavity",1)),r.iCavityStrength=r.inputs.add(new c.default("cavityStrength",2)),r.iEmissive=r.inputs.add(new c.default("emissive",1)),r.iEmissiveScale=r.inputs.add(new c.default("emissiveScale",1)),r.iFresnel=r.inputs.add(new c.default("fresnel",3)),r.conserveEnergy=r.inputs.add(new d.default("conserveEnergy",!0)),r.perVertexIrrad=r.inputs.add(new d.default("perVertexIrrad",!0)),r.glossNearest=r.inputs.add(new d.default("glossNearest",!1)),r.inferBitangent=r.inputs.add(new d.default("inferBitangent",!0)),r.pureGloss=r.inputs.add(new d.default("pureGloss",!1)),r.iLodDither=r.inputs.add(new c.default("lodDither",1)),r.lodDitherUniform=new c.default.Uniform("uLodDitherFactor",1),r.gammaMode=new p.default("gammaMode",["GAMMA_NONE","GAMMA_STD","GAMMA_2_2","GAMMA_TB"]),r.inputs.add(r.gammaMode),r.iGamma=r.inputs.add(new c.default("gamma",1)),r.iExposure=r.inputs.add(new c.default("exposure",1)),r.iFog=r.inputs.add(new d.default("fog",!1)),r._uid="obstacle",r._mask=m.default.BLENDED,r.config.enableDepthTest(!0).enableBlend().blendFunc(r.gl.SRC_ALPHA,r.gl.ONE_MINUS_SRC_ALPHA),r._vertSrc=n(214)(),r._fragSrc=n(215)(),r}return a(t,e),s(t,[{key:"prepare",value:function(e,n){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"prepare",this).call(this,e,n);var r=this.prg;r.uAlpha&&e.alpha&&r.uAlpha(e.alpha)}}]),t}(_.default);t.default=y,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(6),u=r(s),l=n(8),c=r(l),f=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.iColor=r.inputs.add(new u.default("color",4)),r.renderMode=c.default.RENDER_MODES.DEFAULT,r._uid="unlit",r._precision="lowp",r._vertSrc=n(216)(),r._fragSrc=n(217)(),r}return a(t,e),t}(c.default);t.default=f,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(1),s=n(57),u=r(s),l=n(56),c=r(l),f=n(29),d=r(f),h=n(17),p=r(h),v=n(223),m=r(v),g=n(62),_=r(g),y=a.mat4.create(),b=a.mat4.create(),w=function(){function e(t){i(this,e),this.scene=t,this.gl=t.gl,this._viewprojCopy=a.mat4.create(),this._fbo=null,this._blur=new m.default(t,.4),this.cfg=(new p.default).enableCullface().frontFace(this.gl.CW),this._createDefaultTex(),this._createFbo()}return o(e,[{key:"_createFbo",value:function(){var e=this.gl;this._fbo=new c.default(e);var t=new d.default(e,e.RGB);t.bind(),t.setFilter(!0,!1,!1),t.clamp(),this._fbo.attach(e.COLOR_ATTACHMENT0,t),this._fbo.attachDepth(!0,!1,u.default.getInstance(e).hasDepthTexture())}},{key:"_createDefaultTex",value:function(){var e=document.createElement("canvas");e.width=e.height=2;var t=e.getContext("2d");t.fillStyle="white",t.fillRect(0,0,2,2),this.defaultTex=new d.default(this.gl),this.defaultTex.bind(),this.defaultTex.fromImage(e)}},{key:"getOutput",value:function(){return _.default.isDesktop?this._blur.getBlurredTex():this.defaultTex}},{key:"prepare",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,r=this.gl;this.scene.glstate.apply();var i=this._fbo;i.resize(e,t),i.bind(),i.defaultViewport(),this._blur.resize(e*n,t*n),r.clearColor(1,1,1,1),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT)}},{key:"processCamera",value:function(e){this._viewprojCopy.set(e._viewProj),a.mat4.identity(y),y[5]=-1,a.mat4.multiply(b,y,e._wmatrix),a.mat4.invert(b,b),a.mat4.multiply(e._viewProj,e.lens.getProjection(),b)}},{key:"restoreCamera",value:function(e){e._viewProj.set(this._viewprojCopy)}},{key:"processOutput",value:function(){this._blur.process(this._fbo.getColor())}}]),e}();t.default=w,e.exports=t.default},function(e,t,n){function r(e,t,n,r,a){t=void 0===t?-1:t,n=void 0===n?-1:n,r=void 0===r?2:r,a=void 0===a?2:a,i.call(this,e);var s=o;s[0]=s[4]=t,s[1]=s[9]=n,s[8]=s[12]=t+r,s[5]=s[13]=n+a,this.data(s),this.attrib("aPosition",2,e.FLOAT),this.attrib("aTexCoord",2,e.FLOAT)}var i=n(224),o=new Float32Array([-1,-1,0,0,-1,1,0,1,1,-1,1,0,1,1,1,1]);r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.render=function(){this.drawTriangleStrip()},e.exports=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={linear:function(e){return e},easeInQuad:function(e){return e*e},easeOutQuad:function(e){return e*(2-e)},easeInOutQuad:function(e){return e<.5?2*e*e:(4-2*e)*e-1},easeInCubic:function(e){return e*e*e},easeOutCubic:function(e){return--e*e*e+1},easeInOutCubic:function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},easeInQuart:function(e){return e*e*e*e},easeOutQuart:function(e){return 1- --e*e*e*e},easeInOutQuart:function(e){return e<.5?8*e*e*e*e:1-8*--e*e*e*e},easeInQuint:function(e){return e*e*e*e*e},easeOutQuint:function(e){return 1+--e*e*e*e*e},easeInOutQuint:function(e){return e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e},easeInExpo:function(e){return Math.pow(2,10*(e-1))},easeOutExpo:function(e){return 1-Math.pow(2,-10*e)},easeInOutExpo:function(e){return e*=2,e<1?.5*Math.pow(2,10*(e-1)):.5*(2-Math.pow(2,-10*--e))},easeInSine:function(e){return 1-Math.cos(e*Math.PI/2)},easeOutSine:function(e){return Math.sin(e*Math.PI/2)},easeInOutSine:function(e){return.5*(1-Math.cos(Math.PI*e))}},e.exports=t.default},function(e,t,n){"use strict";(function(r){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u,l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(4),f=i(c),d=n(51),h=i(d),p=n(33),v=i(p),m=n(288),g=i(m),_=n(289),y=i(_),b=(u=function(e){function t(e){var n=e.idx,r=e.scene,i=e.url;o(this,t);var s=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return s.idx=n,s.scene=r,s.url=i,s.catmull=null,s.pathView=new y.default(s),s.add(s.pathView),s}return s(t,e),l(t,[{key:"init",value:function(){this.pathView.init()}},{key:"render",value:function(){this.pathView.render()}},{key:"getLoadables",value:function(){var e=h.default.shared_asset_url("paths/"+this.url),t=v.default.loadBytes(e);return t.then(this.onLoaded),t}},{key:"getPositionAt",value:function(e,t){return this.catmull.getPositionAt(e,t)}},{key:"getPositionAndTangentAt",value:function(e,t,n){return this.catmull.getPositionAndTangentAt(e,t,n)}},{key:"getChunks",value:function(){return this.pathView.chunks}},{key:"onLoaded",value:function(e){var t=e,n=new Uint32Array(t)[0],r=new Float32Array(t,4,3*n),i=Array.prototype.slice.call(r),o=i.length;i.push(i[o-3],i[o-2],i[o-1]),i.unshift(i[0],i[1],i[2]),r=new Float32Array(i),this.catmull=new g.default(r),this.init()}}]),t}(f.default),function(e,t,n,r,i){var o={};return Object.keys(r).forEach(function(e){o[e]=r[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}(u.prototype,"onLoaded",[r],Object.getOwnPropertyDescriptor(u.prototype,"onLoaded"),u.prototype),u);t.default=b,e.exports=t.default}).call(t,n(2).bind)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(4),l=r(u),c=n(17),f=r(c),d=n(1),h=n(290),p=r(h),v=d.mat4.create(),m=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.scene,r=e.verts,a=e.prg,s=e.hasColor,u=void 0!==s&&s,l=e.hasSize,c=void 0!==l&&l;i(this,t);var f=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return f.scene=n,f.gl=n.gl,f.prg=a||n.programs.debugPoints,f.setup(r,u,c),f}return a(t,e),s(t,[{key:"setup",value:function(e,t,n){this.geom=new p.default(this.gl,e,t,n),this.config=new f.default}},{key:"preRender",value:function(){}},{key:"render",value:function(){var e=this.prg,t=this.scene.camera,n=this.config;this.scene.glstate.push(n),this.scene.glstate.apply(),e.use(),t.modelViewProjectionMatrix(v,this._wmatrix),e.uMVP(v),this.geom.render(e),this.scene.glstate.pop()}}]),t}(l.default);t.default=m,e.exports=t.default},,,,,,,,,,,,,,,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var i=n(124),o=r(i),a=n(98),s=r(a);window.API=o.default,window.gui=s.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(i),a=n(125),s=r(a),u=n(248),l=r(u),c=n(249),f=r(c),d=n(254),h=r(d),p=n(81),v=r(p),m=n(33),g=r(m),_=n(106),y=r(_),b=n(18),w=r(b),M=n(52),x=r(M),S=n(51),P=r(S),C=n(60),T=r(C),A=n(103),O=r(A),I=n(58),E=r(I),D=n(256),k=r(D),R=n(259),N=r(R),F=n(262),L=r(F),j=n(99),V=r(j),B=n(265),G=r(B),z=n(268),H=r(z),U=n(271),W=r(U),q=n(100),X=r(q),Y=n(101),Q=r(Y),K=n(274),Z=r(K),J=n(277),$=r(J),ee=n(102),te=r(ee),ne=n(280),re=r(ne),ie=n(283),oe=r(ie),ae=n(286),se=r(ae),ue=n(287),le=r(ue),ce=n(291),fe=r(ce),de=n(107),he=r(de),pe=n(108),ve=r(pe),me=n(104),ge=r(me),_e=n(16),ye=r(_e),be=n(54),we=r(be),Me=n(15),xe=r(Me),Se=n(64),Pe=r(Se),Ce=n(59),Te=r(Ce);t.default={glmatrix:o,Engine:s.default,AbstractCar:l.default,AbstractConfigurator:f.default,AbstractExperience:h.default,AbstractModule:v.default,Net:g.default,Ease:y.default,MathUtils:w.default,Color:x.default,Config:P.default,Bounds:T.default,UnlitMaterial:O.default,StandardMaterial:E.default,PaintMaterial:k.default,PlasticMaterial:N.default,FabricMaterial:L.default,GroundMaterial:V.default,GroundAOMaterial:G.default,GroundGradientMaterial:H.default,StickerMaterial:W.default,SkyMaterial:X.default,SkyReflectMaterial:Q.default,RoadLineMaterial:Z.default,WaterMaterial:$.default,ObstacleMaterial:te.default,PilarMaterial:re.default,CloudsMaterial:oe.default,MaterialTransition:se.default,CarPathCtrl:le.default,CarPlayerCtrl:fe.default,PathEntity:he.default,PointsEntity:ve.default,ReflectEntity:ge.default,SignalManager:ye.default,PointerManager:we.default,WindowManager:xe.default,KeyboardManager:Pe.default,consts:Te.default},e.exports=t.default},function(e,t,n){"use strict";(function(r){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t,n,r,i){var o={};return Object.keys(r).forEach(function(e){o[e]=r[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}Object.defineProperty(t,"__esModule",{value:!0});var s,u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(126),c=i(l),f=n(242),d=i(f),h=n(16),p=i(h),v=(s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.car,r=t.canvas,i=t.domElement;if(o(this,e),!n)return void console.error("[Engine] : Car instance not found");this.car=n,this.canvas=r,this.domElement=i||r,this.renderer=null,this.scene=null,this.init()}return u(e,[{key:"init",value:function(){this.renderer=new d.default(this.canvas),this.scene=new c.default(this.renderer);var e=this.scene;this.renderer.scene=e,e.init({car:this.car,domElement:this.domElement}),this.car.init({scene:e,engine:this})}},{key:"load",value:function(){var e=this.scene.load();return e.then(this._onLoadComplete,this._onLoadError,this._onLoadProgress),e}},{key:"destroy",value:function(){this.renderer&&this.renderer.stop(),this.scene&&this.scene.dispose()}},{key:"_onLoadComplete",value:function(){p.default.engine.loaded.dispatch(this),this.renderer.play()}},{key:"_onLoadError",value:function(e){console.error("[Engine]",e)}},{key:"_onLoadProgress",value:function(e){}}]),e}(),a(s.prototype,"_onLoadComplete",[r],Object.getOwnPropertyDescriptor(s.prototype,"_onLoadComplete"),s.prototype),a(s.prototype,"_onLoadError",[r],Object.getOwnPropertyDescriptor(s.prototype,"_onLoadError"),s.prototype),a(s.prototype,"_onLoadProgress",[r],Object.getOwnPropertyDescriptor(s.prototype,"_onLoadProgress"),s.prototype),s);t.default=v,e.exports=t.default}).call(t,n(2).bind)},function(e,t,n){"use strict";(function(r){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t,n,r,i){var o={};return Object.keys(r).forEach(function(e){o[e]=r[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}Object.defineProperty(t,"__esModule",{value:!0});var s,u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(4),c=i(l),f=n(88),d=i(f),h=n(133),p=i(h),v=n(135),m=i(v),g=n(148),_=i(g),y=n(152),b=i(y),w=n(159),M=i(w),x=n(20),S=i(x),P=n(175),C=i(P),T=n(188),A=i(T),O=n(218),I=i(O),E=n(230),D=i(E),k=n(231),R=i(k),N=n(232),F=i(N),L=n(233),j=i(L),V=n(235),B=i(V),G=n(33),z=i(G),H=n(236),U=(i(H),n(237)),W=i(U),q=n(241),X=(i(q),n(62)),Y=i(X),Q=(s=function(){function e(t){o(this,e),this.renderer=t,this.gl=t.gl,this.canvas=t.canvas,this.car=null,this.domElement=null,this.guiFolder=null,this.dt=0,this.time=0}return u(e,[{key:"init",value:function(e){var t=e.car,n=e.domElement;this.car=t,this.domElement=n,this.debugDraw=new W.default(this),this._createGUI();var r=this.gl;this.root=new c.default,this.sroot=new c.default,this.root.add(this.sroot),this.postProcess=new b.default(r),this.post=this.postProcess.post,this.glstate=new p.default(r),this.programs=new m.default(r),this.lights=new C.default(this),this.env=new _.default(this),this.texlib=new M.default(this),this.matlib=new S.default(this),this.environmentScene=new A.default(this),this.carScene=new I.default(this),this.camera=this.makeCamera(),this.trackballCtrl=new D.default(this.renderer.canvas),this.orbitCtrl=new R.default(this.renderer.canvas),this.baseCtrl=new F.default(this.renderer.canvas),this.camCtrl=new j.default(this),this.camCtrl.add([this.trackballCtrl,this.orbitCtrl,this.baseCtrl]);var i=t.getModules();this.moduleCtrl=new B.default(this,i),this.sroot.add(this.lights.node),this.sroot.add(this.camera),this.sroot.add(this.environmentScene.node),this.sroot.add(this.carScene.carContainerNode)}},{key:"destroy",value:function(){}},{key:"load",value:function(){var e=[];e=e.concat(this.car.getLoadables()),e=e.concat(this.carScene.getLoadables()),e=e.concat(this.environmentScene.getLoadables()),e=e.concat(this.moduleCtrl.getLoadables()),e=e.concat(this.env.getLoadables());var t=z.default.whenAll(e);return t.then(this._onLoadComplete,this._onLoadError,this._onLoadProgress),t}},{key:"_createGUI",value:function(){var e=gui.addFolder("Common");this.guiFolder=e}},{key:"_destroyGUI",value:function(){gui.removeFolder(this.guiFolder)}},{key:"_onLoadComplete",value:function(){this.matlib.compileAll()}},{key:"_onLoadError",value:function(e){console.error("[Scene]",e)}},{key:"_onLoadProgress",value:function(e){}},{key:"makeCamera",value:function(){var e=d.default.makePerspectiveCamera();return e.lens.setAutoFov(.25*Math.PI),e.lens.near=.6,e.lens.far=1500,this.guiFolder.addFolder("Camera").add(this,"logCam"),e}},{key:"updateCameraFov",value:function(e){var t=this.camera,n={fov:t.lens.fov};TweenMax.to(n,2,{fov:e/180*Math.PI,onUpdate:function(){return t.lens.setAutoFov(n.fov)}})}},{key:"logCam",value:function(){console.log(this.camera._wmatrix)}},{key:"renderCar",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.carScene.render(S.default.OPAQUE),e&&this.carScene.render(S.default.BLENDED)}},{key:"render",value:function(e){this.dt=e,this.time+=e,this.time%.5<.03&&this.fpsEl&&(this.fpsEl.innerHTML=Math.min(Math.floor(1/e),60));var t=this.renderer.width,n=this.renderer.height,r=this.post;this.camCtrl.preRender(),this.lights.preRender(),this.moduleCtrl.preRender(e),this.environmentScene.preRender(e),this.carScene.preRender(e),this.sroot.updateWorldMatrix(),this.camera.updateViewProjectionMatrix(t,n),this.lights.setup.update(),this.renderLightmaps(),this.glstate.apply(),r.preRender(t,n),r.bindColor(),this.environmentScene.render(S.default.OPAQUE),this.moduleCtrl.render(),this.moduleCtrl._current&&"configurator"===this.moduleCtrl._current.name&&Y.default.isDesktop&&this.carScene.renderReflect(t,n),this.moduleCtrl._current&&"experience-2"!==this.moduleCtrl._current.name?this.moduleCtrl.get("configurator").materials.getMaterial("ground_cavity").isVisible=!0:this.moduleCtrl.get("configurator").materials.getMaterial("ground_cavity").isVisible=!1,this.renderCar(),this.carScene.renderInterior(),this.carScene.renderViews(),this.environmentScene.render(S.default.BLENDED),this.glstate.apply(),r.render()}},{key:"renderLightmaps",value:function(){var e=this.gl,t=this.lights.list,n=this.matlib.depthPass,r=this.glstate,i="D_RGB"===this.lights.setup.depthFormat._val;this.matlib.depthCfg.colorMask(i,i,i,i),r.push(this.matlib.depthCfg);for(var o=0;o<t.length;o++){var a=t[o];a._castShadows&&(a.prepareShadowmap(),e.clearColor(1,1,1,1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),this.moduleCtrl._current&&this.moduleCtrl._current.gltfScene&&"configurator"!==this.moduleCtrl._current.name&&(this.moduleCtrl._current.gltfScene.renderDepth(this,a._camera,S.default.OPAQUE,void 0,n),this.carScene.renderDepth(this,a._camera,S.default.OPAQUE,void 0,n)))}r.pop(this.matlib.depthCfg),r.apply()}},{key:"_addFpsDebug",value:function(){this.fpsEl=document.createElement("div"),this.fpsEl.style.position="absolute",this.fpsEl.style.top=this.fpsEl.style.left="10px",this.fpsEl.style.color="black",this.fpsEl.style.fontSize="10px",this.fpsEl.style.zIndex=9999,document.body.appendChild(this.fpsEl)}}]),e}(),a(s.prototype,"_onLoadComplete",[r],Object.getOwnPropertyDescriptor(s.prototype,"_onLoadComplete"),s.prototype),a(s.prototype,"_onLoadError",[r],Object.getOwnPropertyDescriptor(s.prototype,"_onLoadError"),s.prototype),a(s.prototype,"_onLoadProgress",[r],Object.getOwnPropertyDescriptor(s.prototype,"_onLoadProgress"),s.prototype),s);t.default=Q,e.exports=t.default}).call(t,n(2).bind)},function(e,t,n){function r(e,t,n,r){t[0]=e[12],t[1]=e[13],t[2]=e[14],r[0]=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]),r[1]=Math.sqrt(e[4]*e[4]+e[5]*e[5]+e[6]*e[6]),r[2]=Math.sqrt(e[8]*e[8]+e[9]*e[9]+e[10]*e[10]),a[0]=e[0]/r[0],a[1]=e[1]/r[0],a[2]=e[2]/r[0],a[3]=e[4]/r[1],a[4]=e[5]/r[1],a[5]=e[6]/r[1],a[6]=e[8]/r[2],a[7]=e[9]/r[2],a[8]=e[10]/r[2],o.fromMat3(n,a)}var i=n(68),o=n(86),a=i.create();e.exports={decomposeMat4:r}},function(e,t,n){var r=n(38),i={};i.create=function(){var e=new r.ARRAY_TYPE(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e},i.clone=function(e){var t=new r.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},i.fromValues=function(e,t,n,i){var o=new r.ARRAY_TYPE(4);return o[0]=e,o[1]=t,o[2]=n,o[3]=i,o},i.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},i.set=function(e,t,n,r,i){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e},i.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e},i.subtract=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e},i.sub=i.subtract,i.multiply=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e[3]=t[3]*n[3],e},i.mul=i.multiply,i.divide=function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e[3]=t[3]/n[3],e},i.div=i.divide,i.min=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e[3]=Math.min(t[3],n[3]),e},i.max=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e[3]=Math.max(t[3],n[3]),e},i.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e},i.scaleAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e},i.distance=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2],o=t[3]-e[3];return Math.sqrt(n*n+r*r+i*i+o*o)},i.dist=i.distance,i.squaredDistance=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2],o=t[3]-e[3];return n*n+r*r+i*i+o*o},i.sqrDist=i.squaredDistance,i.length=function(e){var t=e[0],n=e[1],r=e[2],i=e[3];return Math.sqrt(t*t+n*n+r*r+i*i)},i.len=i.length,i.squaredLength=function(e){var t=e[0],n=e[1],r=e[2],i=e[3];return t*t+n*n+r*r+i*i},i.sqrLen=i.squaredLength,i.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},i.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},i.normalize=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n*n+r*r+i*i+o*o;return a>0&&(a=1/Math.sqrt(a),e[0]=n*a,e[1]=r*a,e[2]=i*a,e[3]=o*a),e},i.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},i.lerp=function(e,t,n,r){var i=t[0],o=t[1],a=t[2],s=t[3];return e[0]=i+r*(n[0]-i),e[1]=o+r*(n[1]-o),e[2]=a+r*(n[2]-a),e[3]=s+r*(n[3]-s),e},i.random=function(e,t){return t=t||1,e[0]=r.RANDOM(),e[1]=r.RANDOM(),e[2]=r.RANDOM(),e[3]=r.RANDOM(),i.normalize(e,e),i.scale(e,e,t),e},i.transformMat4=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3];return e[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,e[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,e[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,e[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,e},i.transformQuat=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=n[0],s=n[1],u=n[2],l=n[3],c=l*r+s*o-u*i,f=l*i+u*r-a*o,d=l*o+a*i-s*r,h=-a*r-s*i-u*o;return e[0]=c*l+h*-a+f*-u-d*-s,e[1]=f*l+h*-s+d*-a-c*-u,e[2]=d*l+h*-u+c*-s-f*-a,e[3]=t[3],e},i.forEach=function(){var e=i.create();return function(t,n,r,i,o,a){var s,u;for(n||(n=4),r||(r=0),u=i?Math.min(i*n+r,t.length):t.length,s=r;s<u;s+=n)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],e[3]=t[s+3],o(e,e,a),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2],t[s+3]=e[3];return t}}(),i.str=function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},e.exports=i},function(e,t,n){var r=n(38),i={};i.create=function(){var e=new r.ARRAY_TYPE(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},i.clone=function(e){var t=new r.ARRAY_TYPE(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},i.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},i.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},i.transpose=function(e,t){if(e===t){var n=t[1],r=t[2],i=t[3],o=t[6],a=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=o,e[11]=t[14],e[12]=i,e[13]=a,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e},i.invert=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],l=t[7],c=t[8],f=t[9],d=t[10],h=t[11],p=t[12],v=t[13],m=t[14],g=t[15],_=n*s-r*a,y=n*u-i*a,b=n*l-o*a,w=r*u-i*s,M=r*l-o*s,x=i*l-o*u,S=c*v-f*p,P=c*m-d*p,C=c*g-h*p,T=f*m-d*v,A=f*g-h*v,O=d*g-h*m,I=_*O-y*A+b*T+w*C-M*P+x*S;return I?(I=1/I,e[0]=(s*O-u*A+l*T)*I,e[1]=(i*A-r*O-o*T)*I,e[2]=(v*x-m*M+g*w)*I,e[3]=(d*M-f*x-h*w)*I,e[4]=(u*C-a*O-l*P)*I,e[5]=(n*O-i*C+o*P)*I,e[6]=(m*b-p*x-g*y)*I,e[7]=(c*x-d*b+h*y)*I,e[8]=(a*A-s*C+l*S)*I,e[9]=(r*C-n*A-o*S)*I,e[10]=(p*M-v*b+g*_)*I,e[11]=(f*b-c*M-h*_)*I,e[12]=(s*P-a*T-u*S)*I,e[13]=(n*T-r*P+i*S)*I,e[14]=(v*y-p*w-m*_)*I,e[15]=(c*w-f*y+d*_)*I,e):null},i.adjoint=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],l=t[7],c=t[8],f=t[9],d=t[10],h=t[11],p=t[12],v=t[13],m=t[14],g=t[15];return e[0]=s*(d*g-h*m)-f*(u*g-l*m)+v*(u*h-l*d),e[1]=-(r*(d*g-h*m)-f*(i*g-o*m)+v*(i*h-o*d)),e[2]=r*(u*g-l*m)-s*(i*g-o*m)+v*(i*l-o*u),e[3]=-(r*(u*h-l*d)-s*(i*h-o*d)+f*(i*l-o*u)),e[4]=-(a*(d*g-h*m)-c*(u*g-l*m)+p*(u*h-l*d)),e[5]=n*(d*g-h*m)-c*(i*g-o*m)+p*(i*h-o*d),e[6]=-(n*(u*g-l*m)-a*(i*g-o*m)+p*(i*l-o*u)),e[7]=n*(u*h-l*d)-a*(i*h-o*d)+c*(i*l-o*u),e[8]=a*(f*g-h*v)-c*(s*g-l*v)+p*(s*h-l*f),e[9]=-(n*(f*g-h*v)-c*(r*g-o*v)+p*(r*h-o*f)),e[10]=n*(s*g-l*v)-a*(r*g-o*v)+p*(r*l-o*s),e[11]=-(n*(s*h-l*f)-a*(r*h-o*f)+c*(r*l-o*s)),e[12]=-(a*(f*m-d*v)-c*(s*m-u*v)+p*(s*d-u*f)),e[13]=n*(f*m-d*v)-c*(r*m-i*v)+p*(r*d-i*f),e[14]=-(n*(s*m-u*v)-a*(r*m-i*v)+p*(r*u-i*s)),e[15]=n*(s*d-u*f)-a*(r*d-i*f)+c*(r*u-i*s),e},i.determinant=function(e){var t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],u=e[7],l=e[8],c=e[9],f=e[10],d=e[11],h=e[12],p=e[13],v=e[14],m=e[15];return(t*a-n*o)*(f*m-d*v)-(t*s-r*o)*(c*m-d*p)+(t*u-i*o)*(c*v-f*p)+(n*s-r*a)*(l*m-d*h)-(n*u-i*a)*(l*v-f*h)+(r*u-i*s)*(l*p-c*h)},i.multiply=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],l=t[6],c=t[7],f=t[8],d=t[9],h=t[10],p=t[11],v=t[12],m=t[13],g=t[14],_=t[15],y=n[0],b=n[1],w=n[2],M=n[3];return e[0]=y*r+b*s+w*f+M*v,e[1]=y*i+b*u+w*d+M*m,e[2]=y*o+b*l+w*h+M*g,e[3]=y*a+b*c+w*p+M*_,y=n[4],b=n[5],w=n[6],M=n[7],e[4]=y*r+b*s+w*f+M*v,e[5]=y*i+b*u+w*d+M*m,e[6]=y*o+b*l+w*h+M*g,e[7]=y*a+b*c+w*p+M*_,y=n[8],b=n[9],w=n[10],M=n[11],e[8]=y*r+b*s+w*f+M*v,e[9]=y*i+b*u+w*d+M*m,e[10]=y*o+b*l+w*h+M*g,e[11]=y*a+b*c+w*p+M*_,y=n[12],b=n[13],w=n[14],M=n[15],e[12]=y*r+b*s+w*f+M*v,e[13]=y*i+b*u+w*d+M*m,e[14]=y*o+b*l+w*h+M*g,e[15]=y*a+b*c+w*p+M*_,e},i.mul=i.multiply,i.translate=function(e,t,n){var r,i,o,a,s,u,l,c,f,d,h,p,v=n[0],m=n[1],g=n[2];return t===e?(e[12]=t[0]*v+t[4]*m+t[8]*g+t[12],e[13]=t[1]*v+t[5]*m+t[9]*g+t[13],e[14]=t[2]*v+t[6]*m+t[10]*g+t[14],e[15]=t[3]*v+t[7]*m+t[11]*g+t[15]):(r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],l=t[6],c=t[7],f=t[8],d=t[9],h=t[10],p=t[11],e[0]=r,e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=u,e[6]=l,e[7]=c,e[8]=f,e[9]=d,e[10]=h,e[11]=p,e[12]=r*v+s*m+f*g+t[12],e[13]=i*v+u*m+d*g+t[13],e[14]=o*v+l*m+h*g+t[14],e[15]=a*v+c*m+p*g+t[15]),e},i.scale=function(e,t,n){var r=n[0],i=n[1],o=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},i.rotate=function(e,t,n,i){var o,a,s,u,l,c,f,d,h,p,v,m,g,_,y,b,w,M,x,S,P,C,T,A,O=i[0],I=i[1],E=i[2],D=Math.sqrt(O*O+I*I+E*E);return Math.abs(D)<r.EPSILON?null:(D=1/D,O*=D,I*=D,E*=D,o=Math.sin(n),a=Math.cos(n),s=1-a,u=t[0],l=t[1],c=t[2],f=t[3],d=t[4],h=t[5],p=t[6],v=t[7],m=t[8],g=t[9],_=t[10],y=t[11],b=O*O*s+a,w=I*O*s+E*o,M=E*O*s-I*o,x=O*I*s-E*o,S=I*I*s+a,P=E*I*s+O*o,C=O*E*s+I*o,T=I*E*s-O*o,A=E*E*s+a,e[0]=u*b+d*w+m*M,e[1]=l*b+h*w+g*M,e[2]=c*b+p*w+_*M,e[3]=f*b+v*w+y*M,e[4]=u*x+d*S+m*P,e[5]=l*x+h*S+g*P,e[6]=c*x+p*S+_*P,e[7]=f*x+v*S+y*P,e[8]=u*C+d*T+m*A,e[9]=l*C+h*T+g*A,e[10]=c*C+p*T+_*A,e[11]=f*C+v*T+y*A,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)},i.rotateX=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[4],a=t[5],s=t[6],u=t[7],l=t[8],c=t[9],f=t[10],d=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*i+l*r,e[5]=a*i+c*r,e[6]=s*i+f*r,e[7]=u*i+d*r,e[8]=l*i-o*r,e[9]=c*i-a*r,e[10]=f*i-s*r,e[11]=d*i-u*r,e},i.rotateY=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[0],a=t[1],s=t[2],u=t[3],l=t[8],c=t[9],f=t[10],d=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i-l*r,e[1]=a*i-c*r,e[2]=s*i-f*r,e[3]=u*i-d*r,e[8]=o*r+l*i,e[9]=a*r+c*i,e[10]=s*r+f*i,e[11]=u*r+d*i,e},i.rotateZ=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),o=t[0],a=t[1],s=t[2],u=t[3],l=t[4],c=t[5],f=t[6],d=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i+l*r,e[1]=a*i+c*r,e[2]=s*i+f*r,e[3]=u*i+d*r,e[4]=l*i-o*r,e[5]=c*i-a*r,e[6]=f*i-s*r,e[7]=d*i-u*r,e},i.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},i.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},i.fromRotation=function(e,t,n){var i,o,a,s=n[0],u=n[1],l=n[2],c=Math.sqrt(s*s+u*u+l*l);return Math.abs(c)<r.EPSILON?null:(c=1/c,s*=c,u*=c,l*=c,i=Math.sin(t),o=Math.cos(t),a=1-o,e[0]=s*s*a+o,e[1]=u*s*a+l*i,e[2]=l*s*a-u*i,e[3]=0,e[4]=s*u*a-l*i,e[5]=u*u*a+o,e[6]=l*u*a+s*i,e[7]=0,e[8]=s*l*a+u*i,e[9]=u*l*a-s*i,e[10]=l*l*a+o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)},i.fromXRotation=function(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},i.fromYRotation=function(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},i.fromZRotation=function(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},i.fromRotationTranslation=function(e,t,n){var r=t[0],i=t[1],o=t[2],a=t[3],s=r+r,u=i+i,l=o+o,c=r*s,f=r*u,d=r*l,h=i*u,p=i*l,v=o*l,m=a*s,g=a*u,_=a*l;return e[0]=1-(h+v),e[1]=f+_,e[2]=d-g,e[3]=0,e[4]=f-_,e[5]=1-(c+v),e[6]=p+m,e[7]=0,e[8]=d+g,e[9]=p-m,e[10]=1-(c+h),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e},i.fromRotationTranslationScale=function(e,t,n,r){var i=t[0],o=t[1],a=t[2],s=t[3],u=i+i,l=o+o,c=a+a,f=i*u,d=i*l,h=i*c,p=o*l,v=o*c,m=a*c,g=s*u,_=s*l,y=s*c,b=r[0],w=r[1],M=r[2];return e[0]=(1-(p+m))*b,e[1]=(d+y)*b,e[2]=(h-_)*b,e[3]=0,e[4]=(d-y)*w,e[5]=(1-(f+m))*w,e[6]=(v+g)*w,e[7]=0,e[8]=(h+_)*M,e[9]=(v-g)*M,e[10]=(1-(f+p))*M,e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e},i.fromRotationTranslationScaleOrigin=function(e,t,n,r,i){var o=t[0],a=t[1],s=t[2],u=t[3],l=o+o,c=a+a,f=s+s,d=o*l,h=o*c,p=o*f,v=a*c,m=a*f,g=s*f,_=u*l,y=u*c,b=u*f,w=r[0],M=r[1],x=r[2],S=i[0],P=i[1],C=i[2];return e[0]=(1-(v+g))*w,e[1]=(h+b)*w,e[2]=(p-y)*w,e[3]=0,e[4]=(h-b)*M,e[5]=(1-(d+g))*M,e[6]=(m+_)*M,e[7]=0,e[8]=(p+y)*x,e[9]=(m-_)*x,e[10]=(1-(d+v))*x,e[11]=0,e[12]=n[0]+S-(e[0]*S+e[4]*P+e[8]*C),e[13]=n[1]+P-(e[1]*S+e[5]*P+e[9]*C),e[14]=n[2]+C-(e[2]*S+e[6]*P+e[10]*C),e[15]=1,e},i.fromQuat=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],a=n+n,s=r+r,u=i+i,l=n*a,c=r*a,f=r*s,d=i*a,h=i*s,p=i*u,v=o*a,m=o*s,g=o*u;return e[0]=1-f-p,e[1]=c+g,e[2]=d-m,e[3]=0,e[4]=c-g,e[5]=1-l-p,e[6]=h+v,e[7]=0,e[8]=d+m,e[9]=h-v,e[10]=1-l-f,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},i.frustum=function(e,t,n,r,i,o,a){var s=1/(n-t),u=1/(i-r),l=1/(o-a);return e[0]=2*o*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*o*u,e[6]=0,e[7]=0,e[8]=(n+t)*s,e[9]=(i+r)*u,e[10]=(a+o)*l,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*o*2*l,e[15]=0,e},i.perspective=function(e,t,n,r,i){var o=1/Math.tan(t/2),a=1/(r-i);return e[0]=o/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(i+r)*a,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*i*r*a,e[15]=0,e},i.perspectiveFromFieldOfView=function(e,t,n,r){var i=Math.tan(t.upDegrees*Math.PI/180),o=Math.tan(t.downDegrees*Math.PI/180),a=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),u=2/(a+s),l=2/(i+o);return e[0]=u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=l,e[6]=0,e[7]=0,e[8]=-(a-s)*u*.5,e[9]=(i-o)*l*.5,e[10]=r/(n-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*n/(n-r),e[15]=0,e},i.ortho=function(e,t,n,r,i,o,a){var s=1/(t-n),u=1/(r-i),l=1/(o-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*l,e[11]=0,e[12]=(t+n)*s,e[13]=(i+r)*u,e[14]=(a+o)*l,e[15]=1,e},i.lookAt=function(e,t,n,o){var a,s,u,l,c,f,d,h,p,v,m=t[0],g=t[1],_=t[2],y=o[0],b=o[1],w=o[2],M=n[0],x=n[1],S=n[2];return Math.abs(m-M)<r.EPSILON&&Math.abs(g-x)<r.EPSILON&&Math.abs(_-S)<r.EPSILON?i.identity(e):(d=m-M,h=g-x,p=_-S,v=1/Math.sqrt(d*d+h*h+p*p),d*=v,h*=v,p*=v,a=b*p-w*h,s=w*d-y*p,u=y*h-b*d,v=Math.sqrt(a*a+s*s+u*u),v?(v=1/v,a*=v,s*=v,u*=v):(a=0,s=0,u=0),l=h*u-p*s,c=p*a-d*u,f=d*s-h*a,v=Math.sqrt(l*l+c*c+f*f),v?(v=1/v,l*=v,c*=v,f*=v):(l=0,c=0,f=0),e[0]=a,e[1]=l,e[2]=d,e[3]=0,e[4]=s,e[5]=c,e[6]=h,e[7]=0,e[8]=u,e[9]=f,e[10]=p,e[11]=0,e[12]=-(a*m+s*g+u*_),e[13]=-(l*m+c*g+f*_),e[14]=-(d*m+h*g+p*_),e[15]=1,e)},i.str=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},i.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))},e.exports=i},function(e,t){var n={};n.EPSILON=1e-6,n.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,n.RANDOM=Math.random,n.setMatrixArrayType=function(e){GLMAT_ARRAY_TYPE=e};var r=Math.PI/180;n.toRadian=function(e){return e*r},e.exports=n},function(e,t,n){function r(){this._near=.01,this._far=10,this._fov=Math.PI/3,this._vfov=0,this._hfov=0,this._aspect=1,this._fovMode=0,this._proj=i.create(),this._valid=!1}var i=n(69);r.prototype={getProjection:function(){return this._valid||this._updateProjection(),this._proj},set fov(e){this.setVerticalFov(e)},get fov(){return this._fov},set near(e){this._near!==e&&(this._near=e,this._invalidate())},get near(){return this._near},set far(e){this._far!==e&&(this._far=e,this._invalidate())},get far(){return this._far},set aspect(e){this._aspect!==e&&(this._aspect=e,this._invalidate())},get aspect(){return this._aspect},setHorizontalFov:function(e){this._fov=e,this._fovMode=2,this._invalidate()},setVerticalFov:function(e){this._fov=e,this._fovMode=1,this._invalidate()},getHorizontalFov:function(){return this.getProjection(),this._hfov},getVerticalFov:function(){return this.getProjection(),this._vfov},setAutoFov:function(e){this._fov=e,this._fovMode=3,this._invalidate()},_updateProjection:function(){var e=this._fovMode,t=this._aspect;1===e||3===e&&t>1?(this._vfov=this._fov,this._hfov=2*Math.atan(Math.tan(this._fov/2)*t)):(this._hfov=this._fov,this._vfov=2*Math.atan(Math.tan(this._fov/2)/t)),i.perspective(this._proj,this._vfov,t,this._near,this._far),this._valid=!0},_invalidate:function(){this._valid=!1}},e.exports=r},function(e,t,n){function r(){this._near=.01,this._far=10,this._xMin=-1,this._xMax=1,this._yMin=-1,this._yMax=1,this._proj=i.create(),this._valid=!1}var i=n(69);r.prototype={getProjection:function(){return this._valid||this._updateProjection(),this._proj},setBound:function(e,t,n,r){this._xMin=e,this._xMax=t,this._yMin=n,this._yMax=r,this._invalidate()},set near(e){this._near!==e&&(this._near=e,this._invalidate())},get near(){return this._near},set far(e){this._far!==e&&(this._far=e,this._invalidate())},get far(){return this._far},set aspect(e){this._aspect!==e&&(this._aspect=e)},get aspect(){return this._aspect},_updateProjection:function(){i.ortho(this._proj,this._xMin,this._xMax,this._yMin,this._yMax,this._near,this._far),this._valid=!0},_invalidate:function(){this._valid=!1}},e.exports=r},function(e,t,n){function r(e){this.gl=e,this.cfgStack=new a,this.cfgStack.initFromGL(e),this._validCfg=!1}function i(e){o.call(this),this.state=e}var o=n(17),a=n(134),s=new o;r.prototype={push:function(e){this.cfgStack.push(e),this._validCfg=!1},pop:function(){this.cfgStack.pop(),this._validCfg=!1},apply:function(){this._validCfg||(this.cfgStack.commit(s),s.setupGL(this.gl),this._validCfg=!0)},now:function(e){this.push(e),this.apply(),this.pop()},config:function(){return new i(this)}},i.prototype=Object.create(o.prototype),i.prototype.constructor=i,i.prototype.apply=function(){this.state.now(this)},r.config=function(){return new o},e.exports=r},function(e,t,n){!function(){function t(){this._stack=new Uint32Array(816),this._sets=new Uint32Array(16),this._tmpDat=new Uint32Array(51),this._size=16,this._ptr=0,this._headPos=0,this._wcfg=new r}var r=n(17),i=r.DAT_MASKS;t.prototype={initFromGL:function(e){this._ptr=0,this._wcfg.fromGL(e),this._sets[0]=0,this._stack.set(this._wcfg._dat)},push:function(e){var t,n,r,o,a,s,u,l=this._ptr,c=this._sets[l++],f=e._set;for(l==this._size&&this._grow(),c|=f,this._sets[l]=c,this._ptr=l,t=51*l,n=this._stack,r=e._dat,o=this._tmpDat,a=0;51>a;a++)s=i[a],u=0!=(f&s)?r[a]:n[t+a-51],o[a]=u;n.set(o,t)},pop:function(){var e=--this._ptr;this._headPos>e&&(this._sets[e]|=this._sets[e+1],this._headPos=e)},flush:function(){for(;this._ptr>0;)this.pop()},commit:function(e){var t=this._ptr;this.copyConfig(t,e),this._headPos=t,this._sets[t-1]|=this._sets[t],this._sets[t]=0},patch:function(e,t){this.copyConfig(this._ptr,this._wcfg),this._wcfg.patch(e,t)},copyConfig:function(e,t){var n=new Uint32Array(this._stack.buffer,204*e,51);t._dat.set(n),t._set=this._sets[e]},_grow:function(){var e=this._size<<1,t=new Uint32Array(51*e),n=new Uint32Array(e);t.set(this._stack,0),n.set(this._sets,0),this._stack=t,this._sets=n,this._size=e}},e.exports=t}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){var t=e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT);return e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0&&t.precision>0}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(27),s=function(e){return e&&e.__esModule?e:{default:e}}(a);s.default.debug=!0;var u=function(){function e(t){r(this,e),this.hasHighp=i(t),this.programs=[this.debugFbo=new s.default(t),this.debugMesh=new s.default(t),this.debugPoints=new s.default(t),this.debugPathView=new s.default(t),this.viewCircle=new s.default(t),this.interior=new s.default(t)],this.compile()}return o(e,[{key:"precision",value:function(){return this.hasHighp?"highp":"mediump"}},{key:"dispose",value:function(){for(var e=0;e<this.programs.length;e++)this.programs[e].dispose();this.programs=null}},{key:"compile",value:function(){var e="\n";e+="precision "+this.precision()+" float;\n",this.debugFbo.compile(n(136),n(137),e),this.debugMesh.compile(n(138),n(139),e),this.debugPoints.compile(n(140),n(141),e),this.debugPathView.compile(n(142),n(143),e),this.viewCircle.compile(n(144),n(145),e),this.interior.compile(n(146),n(147),e),this.process()}},{key:"process",value:function(){for(var e=0;e<this.programs.length;e++)this.programs[e].use()}}]),e}();t.default=u,e.exports=t.default},function(e,t){var n=function(e){var t="";return t+="#define GLSLIFY 1\nattribute vec2 aPosition;\nattribute vec2 aTexCoord;\n\nvarying vec2 vTexCoord;\n\nvoid main(void) {\n  gl_Position = vec4( aPosition, 0.0, 1.0 );\n  vTexCoord = aTexCoord;\n}\n"};n.toString=n,e.exports=n},function(e,t){var n=function(e){var t="";return t+="#define GLSLIFY 1\nvarying vec2 vTexCoord;\n\nuniform sampler2D tTex;\n\nvoid main(void) {\n  gl_FragColor = texture2D( tTex, vTexCoord );\n}\n"};n.toString=n,e.exports=n},function(e,t){var n=function(e){var t="";return t+="#define GLSLIFY 1\nattribute vec3 aPosition;\nattribute vec2 aTexCoord;\nattribute vec3 aNormal;\n\nattribute vec3 aTranslation;\nattribute vec3 aScale;\n\nuniform mat4 uMVP;\nuniform bool uInstanced;\n\nvarying float vScale;\n\nvec3 applyTRS(vec3 position, vec3 translation, vec4 quaternion, vec3 scale) {\n  position *= scale;\n  position += 2.0 * cross(quaternion.xyz, cross(quaternion.xyz, position) + quaternion.w * position);\n  return position + translation;\n}\n\nvoid main() {\n  vec3 pos = aPosition;\n\n  if (uInstanced) {\n    pos = applyTRS(aPosition, aTranslation, vec4(0., 0., 0., 1.), aScale);\n  }\n\n  gl_Position = uMVP * vec4(pos, 1.);\n\n  vScale = aScale.x;\n}\n"};n.toString=n,e.exports=n},function(e,t){var n=function(e){var t="";return t+="#define GLSLIFY 1\nvarying float vScale;\n\nfloat map(float value, float inMin, float inMax, float outMin, float outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nvoid main() {\n  float f = map(vScale, .3, 0.06, 0., 1.);\n\n  vec3 highSpeedColor = vec3(0.101960784, 0.462745098, 0.0823529412);\n  vec3 lowSpeedColor = vec3(1., 0., 0.);\n\n  // vec3 c = vec3(1., 0., 0.);\n  vec3 c = mix(highSpeedColor, lowSpeedColor, f);\n\n  gl_FragColor = vec4(c, 1.);\n}\n"};n.toString=n,e.exports=n},function(e,t){var n=function(e){var t="";return t+="#define GLSLIFY 1\nattribute vec3 aPosition;\nattribute vec3 aColor;\nattribute float aSize;\n\nuniform mat4 uMVP;\n\nvarying vec3 vColor;\n\nvoid main() {\n  gl_Position = uMVP * vec4(aPosition, 1.0);\n  gl_PointSize = aSize;\n\n  vColor = aColor;\n}\n"};n.toString=n,e.exports=n},function(e,t){var n=function(e){var t="";return t+="#define GLSLIFY 1\nvarying vec3 vColor;\n\nvoid main() {\n  vec3 c = vColor / 255.0;\n  gl_FragColor = vec4(c, 1.0);\n}\n"};n.toString=n,e.exports=n},function(e,t){var n=function(e){var t="";return t+="#define GLSLIFY 1\nattribute vec3 aPosition;\n\nuniform mat4 uMVP;\n\nvoid main() {\n  gl_Position = uMVP * vec4(aPosition, 1.0);\n  gl_PointSize = 3.0;\n}\n"};n.toString=n,e.exports=n},function(e,t){var n=function(e){var t="";return t+="#define GLSLIFY 1\nuniform vec3 uColor;\n\nvoid main() {\n  vec3 c = uColor / 255.0;\n  gl_FragColor = vec4(c, 1.0);\n}\n"};n.toString=n,e.exports=n},function(e,t){var n=function(e){var t="";return t+="precision highp float;\n#define GLSLIFY 1\n\n#define PI 3.141592653589793\n\nattribute vec3 aPosition;\nattribute float aIndex;\nattribute float aAlpha;\n\nuniform mat4 uMVP;\n\nuniform float uAspect;\nuniform float uTime;\nuniform float uIntersecting;\n\nvarying float vAlpha;\nvarying float vIsHovered;\n\nfloat map(float value, float inMin, float inMax, float outMin, float outMax) {\n  return ((value - inMin) / (inMax - inMin) * (outMax - outMin)) + outMin; \n}\n\nfloat sineInOut(float t) {\n  return -0.5 * (cos(PI * t) - 1.0);\n}\n\nfloat when_eq(float x, float y) {\n  return 1.0 - abs(sign(x - y));\n}\n\nvoid main(void) {\n  vec4 pos = vec4(aPosition, 1.0);\n\n  float pointSize = 28.0 * uAspect;\n  float pointSizeTransition = map(cos(uTime * 4.0 + aIndex), -1.0, 1.0, 0.0, 1.0);\n  pointSize *= map(sineInOut(pointSizeTransition), 0.0, 1.0, 0.5, 1.0);\n\n  gl_Position = uMVP * pos;\n  gl_PointSize = pointSize;\n\n  vIsHovered = when_eq(uIntersecting, aIndex);\n  vAlpha = aAlpha;\n}\n"};n.toString=n,e.exports=n},function(e,t){var n=function(e){var t="";return t+="precision highp float;\n#define GLSLIFY 1\n\nuniform float uIntersectingTransition;\nuniform float uAlpha;\nuniform float uTime;\nuniform vec3 uColor;\n\nvarying float vAlpha;\nvarying float vIsHovered;\n\nconst float smoothstepThreshold = 0.005;\n\nfloat antialias(float threshold, float value) {\n  return smoothstep(threshold - smoothstepThreshold, threshold + smoothstepThreshold, value);\n}\n\nfloat circle(vec2 st, float radius) {\n  return antialias(radius, length(st - vec2(0.5)));\n}\n\nvoid main(void) {\n  vec2 st = vec2(gl_PointCoord.x, gl_PointCoord.y);\n  float outerCircle = 1.0 - circle(st, 0.5 - smoothstepThreshold);\n  float innerCircle = circle(st, 0.3);\n  float circle = outerCircle * innerCircle * uAlpha * vAlpha;\n\n  vec3 color = uColor;\n  color = mix(color, color, vIsHovered * uIntersectingTransition);\n\n  gl_FragColor = vec4(color, circle);\n}\n"};n.toString=n,e.exports=n},function(e,t){var n=function(e){var t="";return t+="#define GLSLIFY 1\nattribute vec3 aPosition;\nattribute vec3 aDirection;\n\nuniform mat4 uMVP;\n\nvarying vec3 vDir;\n\nvoid main(void) {\n  gl_Position = uMVP * vec4(aPosition, 1.0);\n  vDir = aPosition - aDirection;\n}\n"};n.toString=n,e.exports=n},function(e,t){var n=function(e){var t="";return t+="#define GLSLIFY 1\nuniform samplerCube tCube;\nuniform samplerCube tCubeBlurred;\nuniform float uBlurredProgress;\nuniform float uOpacity;\n\nvarying vec3 vDir;\n\nvoid main(void) {\n  vec3 dir = vDir;\n  dir.x = -dir.x;\n  dir = normalize( dir );\n  \n  vec4 tex = textureCube(tCube, dir);\n  vec4 texBlurred = textureCube(tCubeBlurred, dir);\n  \n  vec4 color = mix(tex, texBlurred, uBlurredProgress);\n  color.a = uOpacity;\n\n  gl_FragColor = color;\n  // gl_FragColor = gl_FragColor*0.001 + vec4( 1.0, 1.0, 1.0, 1.0 );\n}\n"};n.toString=n,e.exports=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(1),s=n(89),u=r(s),l=n(6),c=r(l),f=n(7),d=r(f),h=n(149),p=r(h),v=n(29),m=r(v),g=n(33),_=r(g),y=n(51),b=r(y),w=n(151),M=r(w),x=["buildings","5008","desert_highway","doge","downtown_afternoon","helipad","mans_outside","sunset"],S=function(){function e(t){i(this,e),this.scene=t;var n=t.gl;this.gl=n,this.envTex=new m.default(this.gl,this.gl.RGBA),this.envTex.setFilter(!1),this.envHi=new m.default(this.gl,this.gl.RGBA),this.envBg=new m.default(this.gl,this.gl.RGB),this.ibl=new M.default(this.envTex,this.envHi,this.envBg),this.gammaMode=new d.default("gammaMode",["GAMMA_NONE","GAMMA_STD","GAMMA_2_2","GAMMA_TB"]),this.gamma=new c.default("gamma",1,c.default.ALL),this.exposure=new c.default("exposure",1,c.default.ALL),t.post&&t.post.enabled?(this.exposure.attachConstant(1),this.gammaMode.set("GAMMA_NONE")):(this.gammaMode.set("GAMMA_STD"),this.exposure.attachConstant(2.3),this.gamma.attachConstant(1/2.2)),this._createGUI()}return o(e,[{key:"setupMat",value:function(e){e.setIBL(this.ibl),e.iGamma&&e.iGamma.parent&&e.iGamma.parent.remove(e.iGamma),e.iExposure&&e.iExposure.parent&&e.iExposure.parent.remove(e.iExposure),e.gammaMode&&e.gammaMode.parent&&e.gammaMode.parent.remove(e.gammaMode),e.inputs.add(this.gamma.createProxy()),e.inputs.add(this.gammaMode.createProxy()),e.inputs.add(this.exposure.createProxy())}},{key:"dispose",value:function(){this.envTex.dispose(),this.envHi.dispose(),this.envBg.dispose(),this.envTex=null,this.envHi=null,this.envBg=null,this.ibl=null,this.scene=null,this.shBase=null,this.shMul=1}},{key:"getLoadables",value:function(){return this.load("envs/"+x[0])}},{key:"load",value:function(e){var t=this.ibl,n=this;return[p.default.load(this.envBg,b.default.shared_asset_url(e+"/bg.jpg")),p.default.load(this.envTex,b.default.shared_asset_url(e+"/env.png")),p.default.load(this.envHi,b.default.shared_asset_url(e+"/env_hi.png")),_.default.loadBytes(b.default.shared_asset_url(e+"/sh.bin")).then(function(e){n.shBase=new Float32Array(e,0,27),t.sh=u.default.convert(n.shBase,n.shMul)})]}},{key:"preRender",value:function(e){this.scene.post.enabled?this.gammaMode.set("GAMMA_NONE"):this.gammaMode.set("GAMMA_STD")}},{key:"_createGUI",value:function(){var e=this,t=this,n=this.scene.guiFolder.addFolder("Environment"),r={rotY:0};n.add(r,"rotY",0,2*Math.PI,.01).name("Rotation Y").onChange(function(){a.quat.setAxisAngle(e.scene.root.rotation,[0,1,0],r.rotY),e.scene.root.invalidate()});for(var i=0;i<x.length;i++)!function(e){var n=x[e];t[n]=function(){this.load("envs/"+n)}}(i),n.add(this,x[i]);var o=this.scene.guiFolder.addFolder("IBL"),s={iblexpo:2,expo:2.3,gamma:2.2,ambient:1},l=null,c=null;o.add(s,"iblexpo",{none:0,uniform:1,constant:2}).onChange(function(e){"0"===e?(t.exposure.detach(),t.gamma.detach(),l=null,c=null):"1"===e?(l=t.exposure.attachUniform("uexposure"),l.set(s.expo),t.scene.post.enabled||(c=t.gamma.attachUniform("ugamma"),c.set(1/s.gamma))):"2"===e&&(l=null,c=null,t.exposure.attachConstant(s.expo),t.gamma.attachConstant(1/s.gamma))}),o.add(s,"expo",0,15).onChange(function(e){l&&l.set(s.expo)}),o.add(s,"gamma",0,3).onChange(function(e){c&&c.set(1/s.gamma)}),o.add(s,"ambient",0,2).onChange(function(e){t.shMul=s.ambient,t.ibl.sh=u.default.convert(t.shBase,t.shMul)})}}]),e}();t.default=S,e.exports=t.default},function(e,t,n){function r(){if(void 0!==a&&a.defer)return a.defer();var e={resolve:null,reject:null};return e.promise=new a(function(t,n){e.resolve=t,e.reject=n}.bind(e)),Object.freeze(e),e}function i(e){var t=s[e._uid];t&&(t.img.onload=t.img.onerror=null,t.img.src="",t.defer.reject(e)),delete s[e._uid]}function o(e){return e.fromImage(s[e._uid].img),i(e),e}var a=n(150),s={},u={};u.load=function(e,t){i(e);var n=r(),a=new Image;return a.onload=function(){n.resolve(e)},a.onerror=function(){n.reject(e),i(e)},a.crossOrigin="anonymous",a.src=t,s[e._uid]={texture:e,img:a,defer:n},n.promise.then(o),n.promise},u.release=function(e){i(e)},e.exports=u},function(e,t,n){(function(t){/** @license MIT License (c) copyright 2010-2014 original author or authors */
var r=n(31),i=r(n(32));e.exports=void 0!==t?t.Promise=i:"undefined"!=typeof self?self.Promise=i:i}).call(t,n(5))},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},u=n(89),l=function(e){return e&&e.__esModule?e:{default:e}}(u),c=function(e){function t(e,n,o){r(this,t);var a=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.envHi=n,a.envBg=o,a}return o(t,e),a(t,[{key:"setupProgram",value:function(e){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setupProgram",this).call(this,e),e.tEnvHi&&e.tEnvHi(this.envHi)}}]),t}(l.default);t.default=c,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=n(153),a=r(o),s=n(157),u=r(s),l=function e(t){i(this,e),this.gl=t,this.post=new a.default(t,!0),this.post.enabled=!1,this.post.add(new u.default)};t.default=l,e.exports=t.default},function(e,t,n){function r(e,t){if(this.gl=e,this._effects=[],this._flags=0,this._shaderInvalid=!0,this.renderWidth=1,this.renderHeight=1,this.bufferWidth=1,this.bufferHeight=1,this.enabled=!0,this.mipmap=void 0!==t&&t,this.float_texture_ext=e.getExtension("OES_texture_float"),this.halfFloat=e.getExtension("OES_texture_half_float"),this.float_texture_ext_l=e.getExtension("OES_texture_half_float_linear"),this.halfFloat_l=e.getExtension("OES_texture_float_linear"),this.color_buffer_float=e.getExtension("EXT_color_buffer_float"),this.hasDepthTexture=u.getInstance(e).hasDepthTexture(),this.mainFbo=this.genFbo(),this.mainColor=this.mainFbo.getColor(),this.mipmap){this.mainColor.bind(),e.generateMipmap(e.TEXTURE_2D);e.getError()&&(this.mipmap=!1,this.mainFbo.dispose(),this.mainFbo=this.genFbo(),this.mainColor=this.mainFbo.getColor())}this.mainColor.setFilter(!1,this.mipmap,!1),this.prg=new o(e);var n=new Float32Array([0,0,1,0,0,1,1,1]);this.fsPlane=new s(e,n),this.fsPlane.attrib("aTexCoord0",2,e.FLOAT)}function i(e){for(var t=1;t<e;)t<<=1;return t>d&&(t=d),t}var o=n(27),a=(n(29),n(56)),s=n(19),u=n(57),l=n(155),c=n(156),f=n(91);r.prototype={dispose:function(){this.mainFbo.dispose(),this.fsPlane.dispose(),this.prg.dispose()},_needDepth:function(){return 0!=(this._flags&f.NEED_DEPTH)},_needLinear:function(){return 0!=(this._flags&f.NEED_LINEAR)},genFbo:function(){var e=this.gl,t=u.getInstance(e),n=e.getContextAttributes(),r=[];r=[t.RGB16F,t.RGBA16F,t.RGB32F,t.RGBA32F,t.RGB8],e.UNSIGNED_INT_2_10_10_10_REV;var i=t.getRenderableFormat(r),o=new a(e);o.bind(),o.attachColor(i.format,i.type,i.internal),o.attachDepth(n.depth,n.stencil,this.hasDepthTexture),o.resize(4,4);var s=o.getColor();if(s.bind(),s.clamp(),this.hasDepthTexture){var l=o.getDepth();l.bind(),l.clamp(),l.setFilter(!1,!1,!1)}return o},add:function(e){-1===this._effects.indexOf(e)&&(this._effects.push(e),e._init(this),e.resize(this.renderWidth,this.renderHeight),this._flags|=e._flags,this._shaderInvalid=!0)},remove:function(e){var t=this._effects.indexOf(e);if(t>-1&&(this._effects.splice(t,1),e.release(),e.post=null,this._shaderInvalid=!0,0!==e._flags)){this._flags=0;for(var t=0;t<this._effects.length;t++)this._flags|=e._flags}},resize:function(e,t){this.bufferWidth=e,this.bufferHeight=t,this.mainFbo.resize(this.bufferWidth,this.bufferHeight);for(var n=0;n<this._effects.length;n++)this._effects[n].resize(e,t)},preRender:function(e,t){this.gl;if(this.renderWidth=e,this.renderHeight=t,this.enabled){var n=this.mipmap?i(e):e,r=this.mipmap?i(t):t;this.bufferWidth===n&&this.bufferHeight===r||this.resize(n,r)}},needDepthPass:function(){return this.enabled&&this._needDepth()&&!this.hasDepthTexture},bindDepth:function(){if(!this.needDepthPass())return!1;var e=this.gl;return this.depthFbo.bind(),e.viewport(0,0,this.renderWidth,this.renderHeight),e.clearColor(1,1,1,1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),!0},bindColor:function(){var e=this.gl;this.enabled?this.mainFbo.bind():e.bindFramebuffer(e.FRAMEBUFFER,null),e.viewport(0,0,this.renderWidth,this.renderHeight),this.mainFbo.clear()},render:function(e){if(this.enabled){var t=this.gl;this.mainColor.bind(),this.mipmap&&t.generateMipmap(t.TEXTURE_2D);for(var n=0;n<this._effects.length;n++)this._effects[n].preRender();void 0!==e?(e.resize(this.renderWidth,this.renderHeight),e.bind()):(t.bindFramebuffer(t.FRAMEBUFFER,null),t.viewport(0,0,this.renderWidth,this.renderHeight)),t.clearColor(0,0,0,1),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this._shaderInvalid&&this.buildProgram(),this.prg.use();for(var n=0;n<this._effects.length;n++)this._effects[n].setupProgram(this.prg);this.prg.tInput(this.mainColor),this._needDepth()&&(this.hasDepthTexture?this.prg.tDepth(this.mainFbo.getDepth()):this.prg.tDepth(this.depthFbo.color)),this.fillScreen(this.prg)}},fillScreen:function(e,t){!0===t?e.uViewportScale(1,1):e.uViewportScale(this.renderWidth/this.bufferWidth,this.renderHeight/this.bufferHeight),this.fsPlane.attribPointer(e),this.fsPlane.drawTriangleStrip()},buildProgram:function(){for(var e=[],t=[],n=this._effects,r=0;r<n.length;r++)n[r].genCode(t,e);e=e.join("\n"),t=t.join("\n");var i=l({code:e,precode:t}),o=c(),a=this._needDepth()&&this.hasDepthTexture,s="";this.gl.SIGNALED&&(s+="#version 300 es\n"),s+="precision highp float;\n",s+="#define NEED_DEPTH "+(0|this._needDepth())+"\n",s+="#define TEXTURE_DEPTH "+(0|a)+"\n",this.prg.compile(o,i,s),this._shaderInvalid=!1,this.mainColor.bind(),this.mainColor.setFilter(this._needLinear(),this.mipmap,!1)}};var d=4096;e.exports=r},function(e,t){function n(e,t){this._uid=r++,this.gl=e,this.id=e.createRenderbuffer(),this.width=0,this.height=0,this.format=t||e.DEPTH_COMPONENT16,this._valid=!1,this._storage()}var r=0;n.prototype={resize:function(e,t){this.width===e&&this.height===t||(this.width=e,this.height=t,this._valid=!1)},allocate:function(){!this._valid&&this.width>0&&this.height>0&&(this._storage(),this._valid=!0)},bind:function(){this.gl.bindRenderbuffer(36161,this.id)},dispose:function(){this.gl.deleteRenderbuffer(this.id),this.id=null,this.gl=null},_storage:function(){var e=this.gl;e.bindRenderbuffer(36161,this.id),e.renderbufferStorage(36161,this.format,this.width,this.height),e.bindRenderbuffer(36161,null)}},e.exports=n},function(e,t){var n=function(e){var t="";return t+="#define GLSLIFY 1\n\n#if __VERSION__ == 300\n  #define IN in\n  out vec4 FragColor;\n  #define texture2D(a,b) texture( a, b )\n#else\n  #define IN varying\n  #define FragColor gl_FragColor\n#endif\n\nuniform sampler2D tInput;\nIN vec2 vTexCoordVP;\nIN vec2 vTexCoordFull;\n\n#if NEED_DEPTH\n  uniform sampler2D tDepth;\n#endif\n\n\n#if TEXTURE_DEPTH\n  float FETCH_DEPTH( sampler2D t, vec2 uvs ){\n    return texture2D(t,uvs).x;\n  }\n#else\n  \n  highp float decodeDepthRGB(highp vec3 rgb){\n    return(rgb.x+rgb.y*(1.0/255.0))+rgb.z*(1.0/65025.0);\n  }\n\n  float FETCH_DEPTH( sampler2D t, vec2 uvs ){\n    return decodeDepthRGB( texture2D(t,uvs).xyz );\n  }\n#endif\n\n\n\nvec3 sRGB( vec3 c )\n{\n  return c * ( c * ( c*0.305306011 + vec3(0.682171111) ) + vec3(0.012522878) );\n}\n\nfloat luminance( vec3 c )\n{\n  return dot( c, vec3(0.3,0.59,0.11) );\n}\n\n\n\n"+e.precode+"\n\n\nvoid main(void){\n  vec3 c;\n\n  vec2 texCoordVP   = vTexCoordVP;\n  vec2 texCoordFull = vTexCoordFull;\n\n\n  #if NEED_DEPTH\n    float sceneDepth = FETCH_DEPTH( tDepth, texCoordVP );\n  #endif\n\n  "+e.code+"\n\n  FragColor.xyz=c;\n  FragColor.w=1.0;\n\n}"};n.toString=n,e.exports=n},function(e,t){var n=function(e){var t="";return t+="precision highp float;\n#define GLSLIFY 1\n\n#if __VERSION__ == 300\n  #define IN in\n  #define OUT out\n#else\n  #define IN attribute\n  #define OUT varying\n#endif\n\n\nIN vec2 aTexCoord0;\n\nOUT vec2 vTexCoordVP;\nOUT vec2 vTexCoordFull;\n\nuniform vec2 uViewportScale;\n\nvoid main(void)\n{\n  vTexCoordVP   = aTexCoord0 * uViewportScale;\n  vTexCoordFull = aTexCoord0;\n\n  gl_Position.xy = 2.0 * aTexCoord0-vec2(1.0,1.0);\n  gl_Position.zw = vec2(0.0,1.0);\n}\n"};n.toString=n,e.exports=n},function(e,t,n){function r(){i.call(this),this._code=n(158)()}var i=n(91);r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.genCode=function(e,t){t.push(this._code)},e.exports=r},function(e,t){var n=function(e){var t="";return t+="#define GLSLIFY 1\nc = texture2D(tInput,texCoordVP).xyz;"};n.toString=n,e.exports=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t,n){this.parser=e,this.ext=n,this.compressed=t,this.transformPath=function(e){return l.default.asset_url(e+n)}}function a(e){return[l.default.asset_url(e+"/negx.jpg"),l.default.asset_url(e+"/negy.jpg"),l.default.asset_url(e+"/negz.jpg"),l.default.asset_url(e+"/posx.jpg"),l.default.asset_url(e+"/posy.jpg"),l.default.asset_url(e+"/posz.jpg")]}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(51),l=r(u),c=n(160),f=r(c),d=n(161),h=r(d),p=n(162),v=r(p),m=n(163),g=r(m),_=n(164),y=r(_),b=n(165),w=r(b),M=function(){function e(t){i(this,e);var n=t.gl;this.gl=n,this._lib={},this._list=[],this.resolveUrl=this._resolveUrl.bind(this),this.bbc=!0,this.maxCubeSize=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),this.extAniso=n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||n.getExtension("EXT_texture_filter_anisotropic"),this.maxAniso=this.extAniso?n.getParameter(this.extAniso.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,this.DDSCodec=new o(new f.default(n),!0,".dds"),this.PVRCodec=new o(new h.default(n),!0,".pvr"),this.KTXCodec=new o(new v.default(n),!0,".ktx"),this.JPGCodec=new o(new g.default(n),!1,""),this.texDefs=[]}return s(e,[{key:"createProvider",value:function(e){return void 0===e&&(e=""),new y.default(this,e)}},{key:"get",value:function(e){var t=this._lib[e];if(void 0===t)throw new Error('texture "'+e+'" not found.');return t}},{key:"setAniso",value:function(e,t){var n=this.gl;(t=Math.min(this.maxAniso,t))>0&&n.texParameterf(n.TEXTURE_2D,this.extAniso.TEXTURE_MAX_ANISOTROPY_EXT,t)}},{key:"_resolveUrl",value:function(e){return e}},{key:"resolveTexUrls",value:function(e,t){return e.map(this.resolveUrl).map(t.transformPath)}},{key:"resolveCubeUrl",value:function(e,t){return t.compressed?[t.transformPath(e+"/tex")]:a(e)}},{key:"makeTex",value:function(e,t){var n=new w.default.TexDef(this,e,t);return this.texDefs.push(n),n}},{key:"makeCube",value:function(e,t,n){e+="/"+this.getCubeSize(t);var r=new w.default.CubeDef(this,e,n);return this.texDefs.push(r),r}},{key:"getLoadables",value:function(){for(var e=[],t=0;t<this.texDefs.length;t++){var n=this.texDefs[t].load(this);e.push(n)}return e}},{key:"getCodec",value:function(e){return void 0===e&&(e=!0),e=e&&this.bbc,this.DDSCodec.parser.isSupported()&&e?this.DDSCodec:this.PVRCodec.parser.isSupported()&&e?this.PVRCodec:this.KTXCodec.parser.isSupported()&&e?this.KTXCodec:this.JPGCodec}},{key:"getCubeSize",value:function(e){for(;e>this.maxCubeSize;)e>>=1;return e}}]),e}();t.default=M,e.exports=t.default},function(e,t,n){"use strict";function r(e){this.ext=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");var t=this;this.parse=function(e){return t._parse(e)}}function i(e){var t=new Int32Array(e,0,_);if(t[y]!==s)throw new Error("Invalid magic number in DDS header");if(!t[P]&l)throw new Error("Unsupported format, must contain a FourCC code");var n=void 0,r=void 0,i=t[C];switch(i){case c:n=8,r="dxt1";break;case f:n=16,r="dxt3";break;case d:n=16,r="dxt5";break;case p:r="rgba32f";break;case h:var o=new Uint32Array(e.slice(128,148));r=o[0];var A=o[1];o[2],o[3],o[4];if(A!==m||r!==g)throw new Error("Unsupported DX10 texture format "+r);r="rgba32f";break;default:throw new Error("Unsupported FourCC code: "+a(i))}var O=t[w],I=1;O&u&&(I=Math.max(1,t[S]));var E=!1;t[T]&v&&(E=!0);var D=t[x],k=t[M],R=t[b]+4,N=D,F=k,L=[],j=void 0;if(i===h&&(R+=20),E)for(var V=0;V<6;V++){var B=[];L[V]=B,D=N,k=F;for(var G=0;G<I;G++)j=Math.max(4,D)/4*Math.max(4,k)/4*n,B.push(new Uint8Array(e,R,j)),R+=j,D=Math.floor(D/2),k=Math.floor(k/2)}else{var z=[];L[0]=z;for(var H=0;H<I;H++)j=Math.max(4,D)/4*Math.max(4,k)/4*n,z.push(new Uint8Array(e,R,j)),R+=j,D=Math.max(1,Math.floor(D/2)),k=Math.max(1,Math.floor(k/2))}return{width:N,height:F,surfaces:L,format:this._getFormat(r),flags:O,cubemap:E}}function o(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}function a(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)}Object.defineProperty(t,"__esModule",{value:!0});var s=542327876,u=131072,l=4,c=o("DXT1"),f=o("DXT3"),d=o("DXT5"),h=o("DX10"),p=116,v=512,m=3,g=2,_=31,y=0,b=1,w=2,M=3,x=4,S=7,P=20,C=21,T=28;r.prototype={isSupported:function(){return!!this.ext},_getFormat:function(e){switch(e){case"dxt1":return this.ext.COMPRESSED_RGB_S3TC_DXT1_EXT;case"dxt3":return this.ext.COMPRESSED_RGBA_S3TC_DXT3_EXT;case"dxt5":return this.ext.COMPRESSED_RGBA_S3TC_DXT5_EXT;default:throw new Error("unsupported format "+e)}},_parse:i},t.default=r,e.exports=t.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){var t=e.header,n=void 0,r=void 0,i=t[12],o=t[2],a=t[6],f=t[7],d=(t[9],t[10]),h=t[11];switch(o){case 0:n=2,r=u;break;case 1:n=2,r=c;break;case 2:n=4,r=s;break;case 3:n=4,r=l;break;default:throw new Error("pvrtc - unsupported PVR format "+o)}return e.dataPtr=52+i,e.bpp=n,e.format=r,e.width=f,e.height=a,e.numSurfaces=d,e.numMipmaps=h,e.isCubemap=6===d,e}function o(e){var t=e.header,n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],f=(t[5],t[6]),d=(t[7],t[8],t[9],t[10]),h=(t[11],t[12]),p=255&a,v=void 0,m=d>0;if(25===p)v=m?l:s,f=4;else{if(24!==p)throw new Error("pvrtc - unknown format "+p);v=m?c:u,f=2}return e.dataPtr=n,e.bpp=f,e.format=v,e.width=i,e.height=r,e.numSurfaces=h,e.numMipmaps=o+1,e.isCubemap=6===h,e}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=2100,u=2101,l=2102,c=2103,f=function(){function e(t){r(this,e),this.ext=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");var n=this;this.parse=function(e){return n._parse(e)}}return a(e,[{key:"isSupported",value:function(){return!!this.ext}},{key:"_parse",value:function(e){var t=new Uint32Array(e,0,13),n={buffer:e,header:t},r=void 0;if(55727696===t[0])r=i(n);else{if(559044176!==t[11])throw new Error("[PVRLoader] Unknown PVR format");r=o(n)}return this._extract(r)}},{key:"_getFormat",value:function(e){switch(e){case s:return this.ext.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;case u:return this.ext.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;case l:return this.ext.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;case c:return this.ext.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG;default:throw new Error("[PVRLoader] Unknown pixel format")}}},{key:"_extract",value:function(e){for(var t=[],n=this._getFormat(e.format),r={width:e.width,height:e.height,surfaces:t,format:n,cubemap:e.isCubemap},i=e.buffer,o=e.dataPtr,a=e.bpp,s=e.numSurfaces,u=0,l=0,c=0,f=0,d=0,h=0,p=0;p<s;p++)t.push([]);2===a?(c=8,f=4):(c=4,f=4),l=c*f*a/8;for(var v=0;v<e.numMipmaps;){var m=e.width>>v,g=e.height>>v;d=m/c,h=g/f,d<2&&(d=2),h<2&&(h=2),u=d*h*l;for(var _=0;_<s;_++){var y=new Uint8Array(i,o,u);t[_].push(y),o+=u}v++}return r}}]),e}();t.default=f,e.exports=t.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){for(var t=0;t<12;t++)if(e[t]!==a[t])return!1;return!0}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=new Uint8Array([171,75,84,88,32,49,49,187,13,10,26,10]),s=function(){function e(t){r(this,e),this.ext=t.getExtension("WEBGL_compressed_texture_etc1")||t.getExtension("WEBKIT_WEBGL_compressed_texture_etc1");var n=this;this.parse=function(e){return n._parse(e)}}return o(e,[{key:"isSupported",value:function(){return!!this.ext}},{key:"_parse",value:function(e){if(!i(new Uint8Array(e,0,12)))throw new Error("[KTXParser] Bad Magic");var e=new DataView(e),t=67305985===e.getUint32(12,!0),n=16;e.getUint32(n,t);n+=4;e.getUint32(n,t);n+=4;e.getUint32(n,t);n+=4;var r=e.getUint32(n,t);n+=4;e.getUint32(n,t);n+=4;var o=e.getUint32(n,t);n+=4;var a=e.getUint32(n,t);n+=4;e.getUint32(n,t);n+=4;var s=e.getUint32(n,t);n+=4;var u=e.getUint32(n,t);n+=4;var l=e.getUint32(n,t);n+=4;var c=e.getUint32(n,t);if(n+=4,r!==this.ext.COMPRESSED_RGB_ETC1_WEBGL)throw new Error("KTX unsupported internal format "+r+". Must be COMPRESSED_RGB_ETC1_WEBGL");n+=c;for(var f=l>0?l:1,d=s>0?s:1,h=u>0?u:1,p=[],v=0;v<h;v++)p.push([]);for(var m=0;m<f;m++){var g=e.getUint32(n,t);n+=4;for(var _=-4&g,y=0;y<d;y++)for(var b=0;b<h;b++){var w=new Uint8Array(e.buffer,n,_);n+=_,p[b].push(w)}}return{width:o,height:a,surfaces:p,format:r,cubemap:!1}}},{key:"_getFormat",value:function(e){switch(e){case RGB_PVRTC_4BPPV1_Format:return this.ext.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;case RGB_PVRTC_2BPPV1_Format:return this.ext.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;case RGBA_PVRTC_4BPPV1_Format:return this.ext.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;case RGBA_PVRTC_2BPPV1_Format:return this.ext.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG;default:throw new Error("[PVRLoader] Unknown pixel format")}}},{key:"_extract",value:function(e){for(var t=[],n=this._getFormat(e.format),r=(e.width,e.height,e.isCubemap,e.buffer),i=e.dataPtr,o=e.bpp,a=e.numSurfaces,s=0,u=0,l=0,c=0,f=0,d=0,h=0;h<a;h++)t.push([]);2===o?(l=8,c=4):(l=4,c=4),u=l*c*o/8;for(var p=0;p<e.numMipmaps;){var v=e.width>>p,m=e.height>>p;f=v/l,d=m/c,f<2&&(f=2),d<2&&(d=2),s=f*d*u;for(var h=0;h<a;h++){var g=new Uint8Array(r,i,s);t[h].push(g),i+=s}p++}}}]),e}();t.default=s,e.exports=t.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(11),a=function(e){return e&&e.__esModule?e:{default:e}}(o),s=function(){function e(){r(this,e)}return i(e,[{key:"parse",value:function(e){var t=a.default.defer(),n=new window.Blob([e],{type:"image/jpeg"}),r=URL.createObjectURL(n),i=new window.Image;return i.onload=function(){URL.revokeObjectURL(r),t.resolve(i)},i.onerror=function(){URL.revokeObjectURL(r),t.reject()},i.src=r,t.promise}}]),e}();t.default=s,e.exports=t.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t,n){r(this,e),this.name=n,this.lib=t,this._defs=[],this._lib={},this._list=[],this._dlib={}}return i(e,[{key:"register",value:function(e,t){void 0===this._lib[t]&&(this._dlib[t]=e,this._lib[t]=e.tex,this._defs.push(e),this._list.push(e),this.lib._lib[this.name+"/"+t]=e.tex)}},{key:"get",value:function(e){var t=this._lib[e];if(void 0===t)throw new Error('texture "'+e+'" not found.');return t}},{key:"getDef",value:function(e){var t=this._dlib[e];if(void 0===t)throw new Error('texture def"'+e+'" not found.');return t}},{key:"makeTex",value:function(e,t,n){var r=this._dlib[e];return void 0===r&&(r=this.lib.makeTex(t,n),this.register(r,e)),r}},{key:"makeCube",value:function(e,t,n,r){var i=this._dlib[e];return void 0===i&&(i=this.lib.makeCube(t,n,r),this.register(i,e)),i}},{key:"getLoadables",value:function(){return this._defs.map(function(e){return e.load()})}},{key:"getGhostLoadables",value:function(e){void 0===e&&(e=1);for(var t=[],n=0;n<this._list.length;n++)if(this._list[n].loadLevel){var r=this._list[n].loadLevel(e);r&&t.push(r)}return t}},{key:"dispose",value:function(){}}]),e}();t.default=o,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e){var t=h.default.defer();return h.default.all(e).then(t.resolve),t}function u(e,t){switch(t){case 0:return e.TEXTURE_CUBE_MAP_POSITIVE_X;case 1:return e.TEXTURE_CUBE_MAP_POSITIVE_Y;case 2:return e.TEXTURE_CUBE_MAP_POSITIVE_Z;case 3:return e.TEXTURE_CUBE_MAP_NEGATIVE_X;case 4:return e.TEXTURE_CUBE_MAP_NEGATIVE_Y;case 5:return e.TEXTURE_CUBE_MAP_NEGATIVE_Z;default:throw new Error("surface overflow")}}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(29),f=r(c),d=n(11),h=r(d),p=n(33),v=r(p),m=n(166),g=r(m),_=function(){function e(t){a(this,e),this.loader=t,this.gl=t.gl,this.codec=null,this.url=null,this.baseUrl=null,this._bbc=!0,this._genMips=!1,this._dryLoad=!1,this._retainData=!1,this._datas=null}return l(e,[{key:"nobbc",value:function(e){return this._bbc=!1,this}},{key:"retainData",value:function(){return this._retainData=!0,this}},{key:"dryLoad",value:function(){return this._dryLoad=!0,this}},{key:"genMipmap",value:function(){return this._genMips=!0,this}},{key:"setFilter",value:function(e,t,n){return t&&this.genMipmap(),this.tex.setFilter(e,t,n),this}},{key:"repeat",value:function(){return this.tex.repeat(),this}},{key:"clamp",value:function(){return this.tex.clamp(),this}},{key:"aniso",value:function(e){return this.loader.setAniso(this.tex,e),this}},{key:"load",value:function(){}},{key:"prepare",value:function(){this.codec=this.loader.getCodec(this._bbc),this.resolveUrl()}},{key:"resolveUrl",value:function(){this.url=this.baseUrl}},{key:"uploadBcc",value:function(e,t){void 0===t&&(t=0);var n=this.tex,r=this.gl;n.bind();var i=e.surfaces[0],o=e.format,a=e.width,s=e.height;n.width=a,n.height=s;for(var u=0;u<i.length;u++){var l=i[u];r.compressedTexImage2D(r.TEXTURE_2D,u+t,o,a,s,0,l),a=Math.max(1,a>>1),s=Math.max(1,s>>1)}return n}},{key:"uploadCubeBcc",value:function(e){var t=this.tex,n=this.gl;t.bind();for(var r=0;r<e.surfaces.length;r++){var i=e.surfaces[r],o=e.format,a=e.width,s=e.height;t.width=a,t.height=s;for(var l=0;l<i.length;l++){var c=i[l];n.compressedTexImage2D(u(n,r),l,o,a,s,0,c),a=Math.max(1,a>>1),s=Math.max(1,s>>1)}}return t}},{key:"uploadStd",value:function(e){var t=this.tex,n=this.gl;return t.bind(),t.fromImage(e),this._genMips&&n.generateMipmap(n.TEXTURE_2D),t}}]),e}(),y=1,b=function(e){function t(e,n,r){a(this,t);var o=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));o.tex=new f.default(o.gl,r),o.baseUrl=Array.isArray(n)?n:[n],o.lodPromises=new Array(n.length),o.states=[];for(var s=0;s<n.length;s++)o.states[s]=y;return o.pendingUpload=null,o.upload=o._upload.bind(o),o}return o(t,e),l(t,[{key:"resolveUrl",value:function(){this.url=this.loader.resolveTexUrls(this.baseUrl,this.codec)}},{key:"load",value:function(){return this.loadLevel(0)}},{key:"loadLevel",value:function(e){if(this.prepare(),e>this.url.length-1)return null;for(var t=[],n=0;n<=e;n++)t.push(this._loadLodData(n));return this.pendingUpload&&this.pendingUpload.reject(),this.pendingUpload=s(t),this.pendingUpload.promise.then(this.upload)}},{key:"_loadLodData",value:function(e){var t=this.states;if(t[e]!==y)return this.lodPromises[e];var n=v.default.loadBytes(this.url[e]).then(this.codec.parser.parse);return this.lodPromises[e]=n,t[e]=2,n.then(function(){t[e]=4}),n}},{key:"_upload",value:function(e){if(this._retainData&&(this._datas=e),!this._dryLoad){var t=e.length-1;if(this.codec.compressed)for(var n=0;n<e.length;n++)this.uploadBcc(e[n],t-n);else this.uploadStd(e[t])}}}]),t}(_),w=function(e){function t(e,n,r){a(this,t);var o=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.tex=new g.default(o.gl,r),o.baseUrl=n,o.upload=o._upload.bind(o),o.parse=o._parse.bind(o),o}return o(t,e),l(t,[{key:"resolveUrl",value:function(e){this.url=this.loader.resolveCubeUrl(this.baseUrl,this.codec)}},{key:"load",value:function(){return this.prepare(),h.default.map(this.url,v.default.loadBytes).then(this.parse).then(this.upload)}},{key:"_parse",value:function(e){return h.default.map(e,this.codec.parser.parse)}},{key:"_upload",value:function(e){this._retainData&&(this._datas=e),this._dryLoad||(this.codec.compressed?this.uploadCubeBcc(e[0]):(this.tex.fromImages(e),this._genMips&&gl.generateMipmap(gl.TEXTURE_CUBE)))}}]),t}(_);t.default={TexDef:b,CubeDef:w},e.exports=t.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t,n){return 9728|+e|+t<<8|+(t&&n)<<1}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=0,s=34067,u=function(){function e(t,n){r(this,e),this._uid=a++,this.gl=t,this.id=this.gl.createTexture(),this.width=0,this.height=0,this.format=n||t.RGB,this.type=t.UNSIGNED_BYTE,t.bindTexture(s,this.id),this.setFilter(!0),this.clamp()}return o(e,[{key:"fromImages",value:function(e){var t=this.gl,n=this.format,r=this.type;this.width=e[0].width,this.height=e[0].height,t.bindTexture(s,this.id),t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X,0,n,n,r,e[0]),t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_Y,0,n,n,r,e[1]),t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_Z,0,n,n,r,e[2]),t.texImage2D(t.TEXTURE_CUBE_MAP_NEGATIVE_X,0,n,n,r,e[3]),t.texImage2D(t.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,n,n,r,e[4]),t.texImage2D(t.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,n,n,r,e[5])}},{key:"bind",value:function(e){var t=this.gl;void 0!==e&&t.activeTexture(t.TEXTURE0+(0|e)),t.bindTexture(s,this.id)}},{key:"dispose",value:function(){this.gl.deleteTexture(this.id),this.id=null,this.gl=null}},{key:"setFilter",value:function(e,t,n){var r=this.gl,o=i(!!e,!!t,!!n);r.texParameteri(s,r.TEXTURE_MAG_FILTER,i(!!e,!1,!1)),r.texParameteri(s,r.TEXTURE_MIN_FILTER,o)}},{key:"repeat",value:function(){this.wrap(this.gl.REPEAT)}},{key:"clamp",value:function(){this.wrap(this.gl.CLAMP_TO_EDGE)}},{key:"mirror",value:function(){this.wrap(this.gl.MIRRORED_REPEAT)}},{key:"wrap",value:function(e){var t=this.gl;t.texParameteri(s,t.TEXTURE_WRAP_S,e),t.texParameteri(s,t.TEXTURE_WRAP_T,e)}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(e,t,n,r){i.call(this,e,t,n,r),this._usage=0,this._currentMaterial=null}var i=n(27);r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.setupInputs=function(e){for(var t=e.inputs._setups,n=0;n<t.length;n++)t[n]._invalid,t[n].setup(this);this._currentMaterial=e},e.exports=r},function(e,t,n){var r=function(e){var t="";return t+="#define GLSLIFY 1\n#if __VERSION__ == 300\n  #define IN in\n  #define OUT out\n#else\n  #define IN attribute\n  #define OUT varying\n#endif\n\n#pragma SLOT pv\n\nattribute vec3 aPosition;\nuniform mat4 uMVP;\n\n#ifdef SKIN_NUM_JOINTS\n"+n(169)+"\n#endif\n\n"+n(170)+"\n\n#if depthFormat( D_RGB )\n  varying vec2 fragZW;\n#endif\n\nvoid main(void) {\n  vec4 pos = vec4( aPosition, 1.0 );\n  ApplyMorph( pos );\n\n  #ifdef SKIN_NUM_JOINTS\n    gl_Position = (uMVP * getSkinMatrix()) * pos;\n  #else\n    gl_Position = uMVP * pos;\n  #endif\n\n  #if depthFormat( D_RGB )\n    fragZW = gl_Position.zw;\n  #endif\n}\n"};r.toString=r,e.exports=r},function(e,t){var n=function(e){var t="";return t+="#define GLSLIFY 1\n\n#ifndef _NGL_SKIN\n#define _NGL_SKIN 1\n\n\n#if skinNumWeight( SKIN4 )\n  IN vec4 aWeight;\n  IN vec4 aJoint;\n#endif\n#if skinNumWeight( SKIN3 )\n  IN vec3 aWeight;\n  IN vec3 aJoint;\n#endif\n#if skinNumWeight( SKIN2 )\n  IN vec2 aWeight;\n  IN vec2 aJoint;\n#endif\n#if skinNumWeight( SKIN1 )\n  IN float aWeight;\n  IN float aJoint;\n#endif\n\n\nmat4 getSkinMatrix() {\n\n  #if skinNumWeight( SKIN1 )\n    mat4 SM =   uJoints[int(aJoint)] * aWeight;\n  #else\n\n    mat4 SM  =  uJoints[int(aJoint.x)] * aWeight.x +\n                uJoints[int(aJoint.y)] * aWeight.y;\n\n    #if skinNumWeight( SKIN3 )\n      SM += uJoints[int(aJoint.z)] * aWeight.z;\n    #endif\n    \n    #if skinNumWeight( SKIN4 )\n      SM += uJoints[int(aJoint.z)] * aWeight.z;\n      SM += uJoints[int(aJoint.w)] * aWeight.w;\n    #endif\n\n  #endif\n\n  return SM;\n\n}\n\n\n#endif"};n.toString=n,e.exports=n},function(e,t){var n=function(e){var t="";return t+="#define GLSLIFY 1\n\n#ifndef _NGL_MORPHTGT\n#define _NGL_MORPHTGT 1\n\n\n#ifdef MORPH_NUM_WEIGHTS\n  IN float aVertexID;\n#else\n\n#endif\n\n\n// chunks :\n// #define MORPH_NUM_WEIGHTS XXX;\n// uniform float uMorphWeights[MORPH_NUM_WEIGHTS];\n// uniform vec2 uMorphTexSize;\n// uniform sampler2D tMorphTex;\n\nvoid ApplyMorph( inout vec4 aPos ) {\n\n#ifdef MORPH_NUM_WEIGHTS\n\n  for(int i = 0; i < MORPH_NUM_WEIGHTS; i++) {\n\n    float ptr = aVertexID * float(MORPH_NUM_WEIGHTS) + float(i);\n\n    float x = mod( ptr, uMorphTexSize.x );\n    float y = floor( ptr / uMorphTexSize.x );\n  \n    vec2 uv = ( vec2(x, y) + .5 ) / uMorphTexSize;\n    vec3 deltaPos = uMorphWeights[i] * texture2D( tMorphTex, uv ).xyz;\n    aPos.xyz += deltaPos;\n\n  }\n\n\n#endif\n\n}\n\n\n#endif\n"};n.toString=n,e.exports=n},function(e,t){var n=function(e){var t="";return t+="#define GLSLIFY 1\n#pragma SLOT pf\n\n#if depthFormat( D_RGB )\n  varying vec2 fragZW;\n\n  vec3 encodeDepthRGB(float depth){\n    vec4 c = vec4(1.0,255.0,65025.0,16581375.0)*depth;\n    c=fract(c);\n    c.xyz-=c.yzw*(1.0/255.0);\n    return c.xyz;\n  }\n#endif\n\nvoid main(void) {\n  #if depthFormat( D_RGB )\n    gl_FragColor.xyz = encodeDepthRGB( ( fragZW.x / fragZW.y ) * 0.5 + 0.5 );\n    gl_FragColor.w=0.0;\n  #endif\n\n  #if depthFormat( D_DEPTH )\n    gl_FragColor = vec4( 0.0 );\n  #endif\n}\n"};n.toString=n,e.exports=n},function(e,t,n){var r=function(e){var t="";return t+="#define GLSLIFY 1\n#pragma SLOT pv\n\n#if __VERSION__ == 300\n  #define IN in\n  #define OUT out\n#else\n  #define IN attribute\n  #define OUT varying\n#endif\n\nIN vec3 aPosition;\nIN vec2 aTexCoord;\nIN vec2 aTexCoord1;\nIN vec3 aNormal;\nIN vec3 aTangent;\n\n#if !inferBitangent\n  IN vec3 aBitangent;\n#endif\n\nuniform mat4 uMVP;\nuniform mat4 uWorldMatrix;\n\nOUT vec2 vTexCoord;\nOUT vec2 vTexCoord1;\nOUT vec3 vWorldPosition;\nOUT vec3 vNormal;\n\nOUT mediump vec3 vWorldNormal;\n\n#if HAS_normal\n  OUT mediump vec3 vWorldTangent;\n  OUT mediump vec3 vWorldBitangent;\n#endif\n\n#if perVertexIrrad\n  OUT vec3 vIrradiance;\n  uniform vec4 uSHCoeffs[7];\n  \n"+n(3)()+"\n#endif\n\nvec3 rotate( mat4 m, vec3 v ) {\n  return m[0].xyz*v.x + m[1].xyz*v.y + m[2].xyz*v.z;\n}\n\nvoid main( void ) {\n\n  #pragma SLOT v\n\n  vec4 pos = vec4( aPosition, 1.0 );\n\n  gl_Position    = uMVP * pos;\n\n  vWorldPosition = (uWorldMatrix * pos).xyz;\n  vWorldNormal   = rotate( uWorldMatrix, aNormal );\n\n  #if inferBitangent\n    vec3 aBitangent = cross( aNormal, aTangent );\n  #endif\n\n  #if HAS_normal\n    vWorldTangent   = rotate( uWorldMatrix, aTangent );\n    vWorldBitangent = rotate( uWorldMatrix, aBitangent );\n  #endif\n\n  #if perVertexIrrad\n    vIrradiance = SampleSH( normalize( vWorldNormal ), uSHCoeffs );\n  #endif\n\n\n  vTexCoord = aTexCoord;\n  vTexCoord1 = aTexCoord1;\n  vNormal = aNormal;\n\n}\n"};r.toString=r,e.exports=r},function(e,t,n){var r=function(e){var t="";return t+="#define GLSLIFY 1\n#if __VERSION__ == 300\n  #define IN in\n  out vec4 FragColor;\n  #define texture2D(a,b) texture( a, b )\n#else\n  #define IN varying\n  #define FragColor gl_FragColor\n#endif\n\n\nuniform vec3 uCameraPosition;\n\n"+n(25)()+"\n\nIN vec2 vTexCoord;\nIN vec2 vTexCoord1;\nIN vec3 vWorldPosition;\nIN vec3 vNormal;\n\nIN mediump vec3 vWorldNormal;\n\n#pragma SLOT pf\n\n#if HAS_normal\n  IN mediump vec3 vWorldTangent;\n  IN mediump vec3 vWorldBitangent;\n#endif\n\n\n\n// IBL\n// ========\nuniform sampler2D tEnv;\n\n#if pureGloss\n  uniform sampler2D tEnvHi;\n  "+n(21)()+"\n#endif\n\n#if perVertexIrrad\n  IN vec3 vIrradiance;\n#else\n  uniform vec4 uSHCoeffs[7];\n  "+n(3)()+"\n#endif\n\n\n\n// MATH\n// =========\n#define saturate(x) clamp( x, 0.0, 1.0 )\n#define sdot( a, b ) saturate( dot(a,b) )\n\n\n// INCLUDES\n// =========\n\n"+n(12)()+"\n\n#if fog\n  "+n(34)()+'\n#endif\n\n// Schlick approx\n// [Schlick 1994, "An Inexpensive BRDF Model for Physically-Based Rendering"]\n// https://github.com/EpicGames/UnrealEngine/blob/dff3c48be101bb9f84633a733ef79c91c38d9542/Engine/Shaders/BRDF.usf#L168\nvec3 F_Schlick( float VoH,vec3 spec,float glo )\n{\n  float dot = glo*glo * pow( 1.0-VoH, 5.0 );\n  #if HAS_fresnel\n    return( 1.0 - dot )*spec + dot*fresnel();\n  #else\n    return( 1.0 - dot )*spec + dot;\n  #endif\n}\n\n\n// ------------------------------\n//\n\n#if HAS_normal\nvec3 perturbWorldNormal(vec3 n){\n  n = 2.0*n - 1.0;\n  vec3 nrm = gl_FrontFacing ? vWorldNormal : -vWorldNormal;\n  return normalize(vWorldTangent * n.x + vWorldBitangent*n.y + nrm );\n}\n#endif\n\n#if HAS_lodDither\n\n  float nrand(vec2 n) {\n    return fract(sin(dot(n.xy, vec2(12.9898, 78.233)))* 43758.5453);\n  }\n\n\n  void LOD_Dithering_Discard(vec2 sPos, float factor){\n    float RandCos = nrand(sPos);\n    float RandomVal = fract(RandCos * 1000.0);\n    lowp float RetVal = (factor < 0.0) ?\n        step( RandomVal, factor + 1.0 ) :\n        step(factor , RandomVal);\n    if(RetVal - .001 < 0.0){\n      discard;\n    }\n  }\n#endif\n\n//                MAIN\n// ===================\n\n#define gloss(k) gloss_base()*gloss_base()*.6\n\nvoid main( void ) {\n\n  #pragma SLOT f\n\n  #if HAS_lodDither\n    LOD_Dithering_Discard( gl_FragCoord.xy, lodDither() );\n  #endif\n\n\n  // -----------\n  vec3 worldNormal =\n    #if HAS_normal\n      perturbWorldNormal( normal() );\n    #else\n      gl_FrontFacing ? vWorldNormal : -vWorldNormal;\n    #endif\n  worldNormal = normalize( worldNormal );\n\n\n  // SH Irradiance diffuse coeff\n  // -------------\n  #if perVertexIrrad\n    vec3 diffuseCoef = vIrradiance;\n  #else\n    vec3 diffuseCoef = SampleSH(worldNormal, uSHCoeffs );\n  #endif\n\n\n  // IBL reflexion\n  // --------------\n\n  vec3 viewDir = normalize( uCameraPosition - vWorldPosition );\n  vec3 worldReflect = reflect( -viewDir, worldNormal );\n\n  #if pureGloss\n    vec3 specularColor = SampleEnvHi( tEnvHi, worldReflect );\n    #if HAS_pureGlossAttenuation\n      specularColor *= pureGlossAttenuation();\n    #endif\n  #else\n    vec3 specularColor = SpecularIBL( tEnv, worldReflect, 1.0-gloss() );\n  #endif\n\n  #pragma SLOT lightsf\n\n\n  float NoV = sdot( viewDir, worldNormal );\n  vec3 specularSq = specular()*specular();\n  specularColor *= F_Schlick( NoV, specularSq, gloss() );\n\n\n  vec3 alb = albedo();\n  #if conserveEnergy\n    alb = alb - alb * specular();\n  #endif\n  vec3 albedoSq = alb*alb;\n\n\n  #if HAS_occlusion\n    diffuseCoef *= occlusion();\n  #endif\n\n\n  #if HAS_cavity\n    #ifndef cavityStrength\n      #define cavityStrength(k) vec2(1.0)\n    #endif\n    diffuseCoef   *= cavity() * cavityStrength().r + (1.0-cavityStrength().r);\n    specularColor *= cavity() * cavityStrength().g + (1.0-cavityStrength().g);\n  #endif\n\n\n  #if HAS_emissive\n    float e = emissive();\n    #if HAS_emissiveScale\n      e = e * emissiveScale();\n    #endif\n    diffuseCoef += vec3( e ) * albedo();\n  #endif\n\n\n  FragColor.xyz = diffuseCoef * albedoSq + specularColor;\n\n  #if HAS_exposure\n    FragColor.xyz *= vec3( exposure() );\n  #endif\n\n  \n  #if gammaMode( GAMMA_STD ) && HAS_gamma\n    FragColor.xyz = pow( FragColor.xyz, vec3( gamma() ) );\n  #endif\n\n  #if gammaMode( GAMMA_2_2 )\n    FragColor.xyz = pow( FragColor.xyz, vec3( 1.0/2.2 ) );\n  #endif\n\n  #if gammaMode( GAMMA_TB )\n    {\n      vec3 c = FragColor.xyz;\n      vec3 sqrtc = sqrt( c );\n      FragColor.xyz = (sqrtc-sqrtc*c) + c*(0.4672*c+vec3(0.5328));\n    }\n  #endif\n\n  #if HAS_alpha\n    FragColor.a = alpha();\n  #else\n    FragColor.a = 1.0;\n  #endif\n\n  #if isWater\n    '+n(70)()+"\n  #else\n    "+n(26)()+"\n  #endif\n\n  #if fog\n    "+n(35)()+"\n  #endif\n\n  // FragColor.rgb = vec3( gloss() );\n  // FragColor.rgb = vec3( albedo() );\n  // FragColor.rgb = vec3( specular() );\n  // FragColor.rgb = vNormal + vec3(.5);\n}\n"};r.toString=r,e.exports=r},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t,n){r(this,e),this.uid=n,this.lib=t,this.matlist=[],this.materials={}}return i(e,[{key:"registerMaterial",value:function(e,t){void 0===this.materials[t]&&(e.name=this.uid+"/"+t,this.materials[t]=e,this.matlist.push(e),this.lib.registerMaterial(e,this.uid+"/"+t))}},{key:"getMaterial",value:function(e){return this.materials[e]||this.lib.getMaterial(e)}},{key:"setOpaque",value:function(){var e;(e=this.lib).setOpaque.apply(e,arguments)}},{key:"setGlass",value:function(){var e;(e=this.lib).setGlass.apply(e,arguments)}},{key:"setTransparent",value:function(){var e;(e=this.lib).setTransparent.apply(e,arguments)}},{key:"dummy",value:function(){return this.lib.dummy()}},{key:"dispose",value:function(){}}]),e}();t.default=o,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(1),s=n(4),u=r(s),l=n(176),c=r(l),f=n(187),d=r(f),h=n(52),p=a.vec3.create(),v=a.vec3.create(),m=function(){function e(t){i(this,e),this.scene=t,this.node=new u.default,this.list=[],this.setup=new c.default,this.setup.stdModel.shadowFilter.set("PCF4x4"),this.setup.stdModel.iblShadowing.set(!1),this.dirLight=new d.default(t.gl),this.dirLight._offsets.far=1,this.dirLight._shadowmapSize=1024,this.dirLight.iblShadowing=.5,this.dirLight.castShadows(!0),v.set([.2,.5,-.2]),this.dirLight.position.set(v),this.dirLight.lookAt(p),this.color=(0,h.MakeFromHex)(12895428),this.dirLight._color.set(this.color),this.node.add(this.dirLight),this.setup.add(this.dirLight),this.list.push(this.dirLight),this._createGUI()}return o(e,[{key:"_createGUI",value:function(){var e=this,t=this.scene.guiFolder.addFolder("Lights");t.addColor({color:(0,h.VecToHex)(this.color)},"color").name("Color").onChange(function(t){return(0,h.HexToVec)(t,e.color)});var n=t.addFolder("Position");n.add(v,"0",0,1,.01).name("X"),n.add(v,"1",0,1,.01).name("Y"),n.add(v,"2",0,1,.01).name("Z")}},{key:"preRender",value:function(){this.dirLight._color.set(this.color),this.dirLight.position.set(v),this.dirLight.lookAt(p)}}]),e}();t.default=m,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(7),s=r(a),u=n(60),l=r(u),c=n(177),f=r(c),d=function(){function e(){i(this,e),this._lights=[],this._models=[],this._modelsMap={},this.depthFormat=new s.default("depthFormat",["D_RGB","D_DEPTH"]),this.bounds=new l.default,this.stdModel=new f.default,this._registerModel("std",this.stdModel)}return o(e,[{key:"add",value:function(e){if(!this._lights.includes(e)){this._lights.push(e);for(var t=0;t<this._models.length;t++)this._models[t].add(e)}}},{key:"remove",value:function(e){var t=this._lights.indexOf(e);if(t>-1)for(this._lights.splice(t,1),t=0;t<this._models.length;t++)this._models[t].remove(e)}},{key:"update",value:function(){for(var e=0;e<this._models.length;e++)this._models[e].update()}},{key:"getChunks",value:function(e){void 0===e&&(e="std");var t=this._modelsMap[e].getChunks();return t.unshift(this.depthFormat.createProxy()),t}},{key:"_registerModel",value:function(e,t){if(void 0===this._modelsMap[e]){this._modelsMap[e]=t,this._models.push(t),t._setup=this;for(var n=0;n<this._lights.length;n++)t.add(this._lights[n])}}}]),e}();t.default=d,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(97),l=r(u),c=n(28),f=r(c),d=n(7),h=r(d),p=n(14),v=r(p),m=n(178),g=r(m),_=n(179),y=r(_),b=n(180),w=r(b),M=n(181),x=r(M),S=n(182),P=r(S),C=n(183),T=r(C),A=n(184),O=r(A),I=n(185),E=r(I),D=n(186),k=r(D),R=function(){function e(){a(this,e),this._datas={},this._dataList=[],this._setup=null;var t=void 0;this.preLightsChunk=new N,this.postLightsChunk=new F,this.shadowChunk=new j(this),this.shadowFilter=new h.default("shadowFilter",["PCFNONE","PCF4x1","PCF4x4","PCF2x2"]),this.iblShadowing=new v.default("iblShadowing",!1),t=new z,this._datas[l.default.TYPE_DIR]=t,this._dataList.push(t),t=new G,this._datas[l.default.TYPE_SPOT]=t,this._dataList.push(t),t=new H,this._datas[l.default.TYPE_POINT]=t,this._dataList.push(t)}return s(e,[{key:"add",value:function(e){this._datas[e._type].addLight(e)}},{key:"remove",value:function(e){this._datas[e._type].removeLight(e)}},{key:"update",value:function(){this.shadowChunk.shadowCount=0;for(var e=0;e<this._dataList.length;e++)this._dataList[e].update(this);this.shadowChunk.check()}},{key:"getChunks",value:function(){var e=[];e.push(this.iblShadowing.createProxy()),e.push(this.shadowFilter.createProxy()),e.push(this.shadowChunk.createProxy()),e.push(this.preLightsChunk.createProxy());for(var t=0;t<this._dataList.length;t++)e.push(this._dataList[t].createProxy());return e.push(this.postLightsChunk.createProxy()),e}}]),e}(),N=function(e){function t(){return a(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,!0,!1))}return o(t,e),s(t,[{key:"genCode",value:function(e){var t=(0,E.default)(this);e.add("lightsf",t)}},{key:"getHash",value:function(){return"0"}}]),t}(f.default),F=function(e){function t(){return a(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,!0,!1))}return o(t,e),s(t,[{key:"genCode",value:function(e){var t=(0,k.default)(this);e.add("lightsf",t)}},{key:"getHash",value:function(){return"0"}}]),t}(f.default),L=4,j=function(e){function t(e){a(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,!0,!0));return n.lightModel=e,n.shadowCount=0,n.genCount=0,n._matrices=new Float32Array(16*L),n._texelBiasVector=new Float32Array(4*L),n._shadowmapSizes=new Float32Array(2*L),n._umatrices=null,n._utexelBiasVector=null,n._ushadowmapSizes=null,n}return o(t,e),s(t,[{key:"genCode",value:function(e){this.shadowCount>0&&e.add("pf",(0,O.default)(this))}},{key:"addLight",value:function(e){var t=this.shadowCount;this.shadowCount++,this._matrices.set(e.getShadowProjection(this.lightModel._setup.bounds),16*t),this._texelBiasVector.set(e.getTexelBiasVector(),4*t);var n=e._shadowmapSize;if(this._shadowmapSizes[2*t+0]=n,this._shadowmapSizes[2*t+1]=1/n,0===t){var r=e.hasDepthShadowmap();this.lightModel._setup.depthFormat.set(r?"D_DEPTH":"D_RGB")}return t}},{key:"getHash",value:function(){return this.shadowCount}},{key:"check",value:function(){this.genCount!==this.shadowCount&&(this.genCount=this.shadowCount,this._umatrices=new Float32Array(this._matrices.buffer,0,16*this.shadowCount),this._utexelBiasVector=new Float32Array(this._texelBiasVector.buffer,0,4*this.shadowCount),this._ushadowmapSizes=new Float32Array(this._shadowmapSizes.buffer,0,2*this.shadowCount),this.invalidate()),this._invalid=!0}},{key:"setup",value:function(e){this.shadowCount>0&&(e.uShadowMatrices(this._umatrices),e.uShadowTexelBiasVector(this._utexelBiasVector),e.uShadowMapSize(this._ushadowmapSizes),void 0!==e.uShadowKernelRotation&&e.uShadowKernelRotation(1*Math.cos(V),1*Math.sin(V)),this._invalid=!1)}}]),t}(f.default),V=Math.PI/4,B=function(e){function t(){a(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,!0,!0));return e.type=0,e.lights=[],e.shadowIndices=[],e.preCodeTemplate=null,e}return o(t,e),s(t,[{key:"addLight",value:function(e){this.lights.includes(e)||(this.lights.push(e),this.shadowIndices.push(-1),this.invalidate())}},{key:"removeLight",value:function(e){var t=this.lights.indexOf(e);t>-1&&(this.lights.splice(t,1),this.shadowIndices.splice(t,1),this.invalidate())}},{key:"genCode",value:function(e){var t=this.preCodeTemplate({count:this.lights.length});e.add("pf",t),t="";for(var n=0;n<this.lights.length;n++)t+=this.genCodePerLights(this.lights[n],n,this.shadowIndices[n]);e.add("lightsf",t)}},{key:"genCodePerLights",value:function(e,t,n){}},{key:"getHash",value:function(){for(var e=""+this.type+this.lights.length,t=0;t<this.lights.length;t++)this.lights[t]._castShadows&&(e+=t);return e}},{key:"setup",value:function(e){for(var t=0;t<this.shadowIndices.length;t++){var n=this.shadowIndices[t];if(n>-1){var r=this.lights[t].getShadowmap();e["tShadowMap"+n](r)}}}}]),t}(f.default),G=function(e){function t(){a(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.type=l.default.TYPE_SPOT,e._directions=null,e._colors=null,e._positions=null,e._spot=null,e._falloff=null,e.preCodeTemplate=y.default,e}return o(t,e),s(t,[{key:"genCodePerLights",value:function(e,t,n){var r={index:t,shadowIndex:n};return(0,P.default)(r)}},{key:"allocate",value:function(e){null!==this._colors&&this._colors.length/4===e||(this._directions=new Float32Array(3*e),this._colors=new Float32Array(4*e),this._positions=new Float32Array(3*e),this._spot=new Float32Array(2*e),this._falloff=new Float32Array(3*e))}},{key:"update",value:function(e){var t=this.lights;this.allocate(t.length);for(var n=0;n<t.length;n++){var r=t[n];if(this._directions.set(r._wdir,3*n),this._colors.set(r._color,4*n),this._positions.set(r._wposition,3*n),this._spot.set(r._spotData,2*n),this._falloff.set(r._falloffData,3*n),this._colors[4*n+3]=r.iblShadowing,r._castShadows){var i=e.shadowChunk.addLight(r);this.shadowIndices[n]!==i&&this.invalidate(),this.shadowIndices[n]=i}else this.shadowIndices[n]=-1}this._invalid=!0}},{key:"setup",value:function(e){this.lights.length>0&&(B.prototype.setup.call(this,e),e.uLSpotDirections(this._directions),e.uLSpotColors(this._colors),e.uLSpotPositions(this._positions),e.uLSpotSpot(this._spot),e.uLSpotFalloff(this._falloff),this._invalid=!1)}}]),t}(B),z=function(e){function t(){a(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.type=l.default.TYPE_DIR,e._directions=null,e._colors=null,e.preCodeTemplate=g.default,e}return o(t,e),s(t,[{key:"genCodePerLights",value:function(e,t,n){var r={index:t,shadowIndex:n};return(0,x.default)(r)}},{key:"allocate",value:function(e){null!==this._colors&&this._colors.length/4===e||(this._directions=new Float32Array(3*e),this._colors=new Float32Array(4*e))}},{key:"update",value:function(e){var t=this.lights;this.allocate(t.length);for(var n=0;n<t.length;n++){var r=t[n];if(this._directions.set(r._wdir,3*n),this._colors.set(r._color,4*n),this._colors[4*n+3]=r.iblShadowing,r._castShadows){var i=e.shadowChunk.addLight(r);this.shadowIndices[n]!==i&&this.invalidate(),this.shadowIndices[n]=i}else this.shadowIndices[n]=-1}this._invalid=!0}},{key:"setup",value:function(e){this.lights.length>0&&(B.prototype.setup.call(this,e),e.uLDirDirections(this._directions),e.uLDirColors(this._colors),this._invalid=!1)}}]),t}(B),H=function(e){function t(){a(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.type=l.default.TYPE_POINT,e._colors=null,e._positions=null,e._falloff=null,e.preCodeTemplate=w.default,e}return o(t,e),s(t,[{key:"genCodePerLights",value:function(e,t,n){var r={index:t,shadowIndex:n};return(0,T.default)(r)}},{key:"allocate",value:function(e){null!==this._colors&&this._colors.length/3===e||(this._colors=new Float32Array(3*e),this._positions=new Float32Array(3*e),this._falloff=new Float32Array(3*e))}},{key:"update",value:function(e){var t=this.lights;this.allocate(t.length);for(var n=0;n<t.length;n++){var r=t[n];if(this._colors.set(r._color,3*n),this._positions.set(r._wposition,3*n),this._falloff.set(r._falloffData,3*n),r._castShadows){var i=e.shadowChunk.addLight(r);this.shadowIndices[n]!==i&&this.invalidate(),this.shadowIndices[n]=i}else this.shadowIndices[n]=-1}this._invalid=!0}},{key:"setup",value:function(e){this.lights.length>0&&(B.prototype.setup.call(this,e),e.uLPointColors(this._colors),e.uLPointPositions(this._positions),e.uLPointFalloff(this._falloff),this._invalid=!1)}}]),t}(B);t.default=R,e.exports=t.default},function(e,t){var n=function(e){var t="";return t+="#define GLSLIFY 1\n#define NUM_D_LIGHTS "+e.count+"\n\n",e.count>0&&(t+="\nuniform vec3 uLDirDirections [NUM_D_LIGHTS];\nuniform vec4 uLDirColors     [NUM_D_LIGHTS]; // rgb + iblShadowing\n"),t+="\n\n"};n.toString=n,e.exports=n},function(e,t){var n=function(e){var t="";return t+="#define GLSLIFY 1\n#define NUM_S_LIGHTS "+e.count+"\n\n",e.count>0&&(t+="\nuniform vec3 uLSpotPositions  [NUM_S_LIGHTS];\nuniform vec3 uLSpotFalloff    [NUM_S_LIGHTS];\nuniform vec2 uLSpotSpot       [NUM_S_LIGHTS];\nuniform vec3 uLSpotDirections [NUM_S_LIGHTS];\nuniform vec4 uLSpotColors     [NUM_S_LIGHTS]; // rgb + iblShadowing\n"),t+="\n\n"};n.toString=n,e.exports=n},function(e,t){var n=function(e){var t="";return t+="#define GLSLIFY 1\n#define NUM_P_LIGHTS "+e.count+"\n\n",e.count>0&&(t+="\nuniform vec3 uLPointPositions  [NUM_P_LIGHTS];\nuniform vec3 uLPointFalloff    [NUM_P_LIGHTS];\nuniform vec3 uLPointColors     [NUM_P_LIGHTS]; // rgb\n"),t+="\n\n"};n.toString=n,e.exports=n},function(e,t){var n=function(e){var t="";return t+="#define GLSLIFY 1\n// --------- SPEC\n{\n\n  vec3 H = normalize( uLDirDirections["+e.index+"] + viewDir );\n  float NoH = sdot( H,worldNormal );\n  float sContib = specularMul * pow( NoH, roughness );\n  \n  // -------- DIFFUSE\n  float dContrib = (1.0/3.141592) * sdot( uLDirDirections["+e.index+"] ,worldNormal );\n\n  ",e.shadowIndex>-1&&(t+="\n  {\n    vec3 fragCoord = calcShadowPosition( uShadowTexelBiasVector["+e.shadowIndex+"], uShadowMatrices["+e.shadowIndex+"] , vWorldPosition, worldNormal, uShadowMapSize["+e.shadowIndex+"].y );\n\n    bvec4 inFrustumVec = bvec4 (fragCoord.x >= 0.0, fragCoord.x <= 0.99, fragCoord.y >= 0.0, fragCoord.y <= 0.99);\n    bool inFrustum = all(inFrustumVec);\n\n    bvec2 frustumTestVec = bvec2(inFrustum, fragCoord.z <= 1.0);\n    bool frustumTest = all(frustumTestVec);\n\n    if (frustumTest) {\n      float shOccl = calcLightOcclusions(tShadowMap"+e.shadowIndex+",fragCoord,uShadowMapSize["+e.shadowIndex+"]);\n\n      dContrib *= shOccl;\n      sContib  *= shOccl;\n\n      totalShadow += 1.0 - shOccl;\n\n      #if iblShadowing\n        float sDamp = uLDirColors["+e.index+"].a;\n        specularColor *= mix( sDamp, 1.0, shOccl );\n      #endif\n    }\n  }\n  "),t+="\n\n  diffuseCoef   += dContrib * uLDirColors["+e.index+"].rgb;\n  LS_SPECULAR   += sContib  * uLDirColors["+e.index+"].rgb;\n\n}\n"};n.toString=n,e.exports=n},function(e,t){var n=function(e){var t="";return t+="#define GLSLIFY 1\n{\n\n  vec3 lightDir= uLSpotPositions["+e.index+"] - vWorldPosition;\n  float invLightDist=inversesqrt(dot(lightDir,lightDir));\n  lightDir *= invLightDist;\n\n  // spot effect\n  float falloff = saturate( uLSpotFalloff["+e.index+"].z / invLightDist );\n  falloff = 1.0 + falloff * ( uLSpotFalloff["+e.index+"].x + uLSpotFalloff["+e.index+"].y * falloff );\n\n  float s = saturate( dot( lightDir, uLSpotDirections["+e.index+"] ) );\n  s = saturate( uLSpotSpot["+e.index+"].x-uLSpotSpot["+e.index+"].y * (1.0-s*s) );\n\n  vec3 lightContrib = (falloff *s ) * uLSpotColors["+e.index+"].rgb;\n\n\n  // --------- SPEC\n  vec3 H = normalize( lightDir + viewDir );\n  float NoH = sdot( H,worldNormal );\n  float sContrib = specularMul * pow( NoH, roughness );\n  // -------- DIFFUSE\n  float dContrib = (1.0/3.141592) * sdot( lightDir, worldNormal );\n\n  ",e.shadowIndex>-1&&(t+="\n  {\n    vec3 fragCoord = calcShadowPosition( uShadowTexelBiasVector["+e.shadowIndex+"], uShadowMatrices["+e.shadowIndex+"] , vWorldPosition, worldNormal, uShadowMapSize["+e.shadowIndex+"].y );\n    float shOccl = calcLightOcclusions(tShadowMap"+e.shadowIndex+",fragCoord,uShadowMapSize["+e.shadowIndex+"]);\n    dContrib *= shOccl;\n    sContrib  *= shOccl;\n\n    #if iblShadowing\n      float sDamp = uLSpotColors["+e.index+"].a;\n      specularColor *= mix( sDamp, 1.0, shOccl );\n    #endif\n\n    // sContrib = sin( decodeDepthRGB(texture2D(tShadowMap"+e.shadowIndex+",fragCoord.xy).xyz)*200.0);\n    // dContrib = sin( decodeDepthRGB(texture2D(tShadowMap"+e.shadowIndex+",fragCoord.xy).xyz)*200.0);\n\n    // diffuseCoef = vec3( decodeDepthRGB(texture2D(tShadowMap"+e.shadowIndex+",fragCoord.xy).xyz ) );\n  }\n  "),t+="\n\n\n  diffuseCoef   += dContrib * lightContrib;\n  LS_SPECULAR   += sContrib  * lightContrib;\n\n  // specularColor *= 0.0;\n\n}"};n.toString=n,e.exports=n},function(e,t){var n=function(e){var t="";return t+="#define GLSLIFY 1\n{\n\n  vec3 lightDir= uLPointPositions["+e.index+"] - vWorldPosition;\n  float invLightDist=inversesqrt(dot(lightDir,lightDir));\n  lightDir *= invLightDist;\n\n  // spot effect\n  float falloff = saturate( uLPointFalloff["+e.index+"].z / invLightDist );\n  falloff = 1.0 + falloff * ( uLPointFalloff["+e.index+"].x + uLPointFalloff["+e.index+"].y * falloff );\n\n  vec3 lightContrib = falloff * uLPointColors["+e.index+"].rgb;\n\n\n  // --------- SPEC\n  vec3 H = normalize( lightDir + viewDir );\n  float NoH = sdot( H,worldNormal );\n  float sContrib = specularMul * pow( NoH, roughness );\n  // -------- DIFFUSE\n  float dContrib = (1.0/3.141592) * sdot( lightDir, worldNormal );\n\n  diffuseCoef   += dContrib * lightContrib;\n  LS_SPECULAR   += sContrib  * lightContrib;\n\n  // specularColor *= 0.0;\n\n}"};n.toString=n,e.exports=n},function(e,t){var n=function(e){var t="";t+="\n\n#define SHADOW_COUNT "+e.shadowCount+"\n\n#if __VERSION__ == 300\n  precision lowp sampler2DShadow;\n#define GLSLIFY 1\n\n\n  #define DepthSampler sampler2DShadow\n  \n#else\n  #define DepthSampler sampler2D\n#endif\n\n\n";for(var n=0;n<e.shadowCount;n++)t+="\n  uniform DepthSampler tShadowMap"+n+";\n";return t+="\n\n\n\n\nuniform highp vec2 uShadowKernelRotation;\nuniform highp mat4 uShadowMatrices[SHADOW_COUNT];\nuniform highp vec4 uShadowTexelBiasVector[SHADOW_COUNT];\nuniform       vec2 uShadowMapSize[SHADOW_COUNT];\n\n\n// RGB depth decoding\n// ------------------\nhighp float decodeDepthRGB(highp vec3 rgb){\n  return(rgb.x+rgb.y*(1.0/255.0))+rgb.z*(1.0/65025.0);\n}\n\n\n#if __VERSION__ == 300\n  \n      \n  float textureShadow( DepthSampler t, float ref, vec2 uvs ){\n    return texture(t, vec3( uvs, ref ) );\n  }\n\n  vec2 textureShadow( DepthSampler t, float ref, vec4 uvs ){\n    \n    return vec2(\n      texture(t, vec3( uvs.xy, ref ) ),\n      texture(t, vec3( uvs.zw, ref ) )\n    );\n\n  }\n\n  vec4 textureShadow( DepthSampler t, float ref, vec4 uvs0, vec4 uvs1 ){\n    \n    return vec4(\n      texture(t, vec3( uvs0.xy, ref ) ),\n      texture(t, vec3( uvs0.zw, ref ) ),\n      texture(t, vec3( uvs1.xy, ref ) ),\n      texture(t, vec3( uvs1.zw, ref ) )\n    );\n\n  }\n\n\n\n#else\n\n\n\n  #if depthFormat( D_RGB )\n    float FETCH_DEPTH( DepthSampler t, vec2 uvs ){\n      return decodeDepthRGB( texture2D(t,uvs).xyz );\n    }\n    //define FETCH_DEPTH(t,uvs) decodeDepthRGB( texture2D(t,uvs).xyz )\n  #endif\n\n  #if depthFormat( D_DEPTH )\n    float FETCH_DEPTH( DepthSampler t, vec2 uvs ){\n      return texture2D(t,uvs).x;\n    }\n    //define FETCH_DEPTH(t,uvs) texture2D(t,uvs).x\n  #endif\n\n  \n  float textureShadow( DepthSampler t, float ref, vec2 uvs ){\n    return step( ref, FETCH_DEPTH(t,uvs));\n  }\n\n  vec2 textureShadow( DepthSampler t, float ref, vec4 uvs ){\n    \n    vec2 occl = vec2(\n      FETCH_DEPTH(t,uvs.xy),\n      FETCH_DEPTH(t,uvs.zw)\n    );\n\n    return step( vec2(ref), occl );\n  }\n\n  vec4 textureShadow( DepthSampler t, float ref, vec4 uvs0, vec4 uvs1 ){\n    \n    vec4 occl = vec4(\n      FETCH_DEPTH(t,uvs0.xy),\n      FETCH_DEPTH(t,uvs0.zw),\n      FETCH_DEPTH(t,uvs1.xy),\n      FETCH_DEPTH(t,uvs1.zw)\n    );\n\n    return step( vec4(ref), occl );\n  }\n\n#endif\n\n\n\n\n\n\n\nfloat resolveShadowNoFiltering(highp float fragZ, DepthSampler depth,highp vec2 uv ){\n    return textureShadow( depth, fragZ, uv );\n}\n\n\n#if __VERSION__ == 300\n  // Bilinear is natively supported in ES3\n  // Shadowmap filtering must be set by sampler2DShadow filter parameter\n\n  float resolveShadow2x1(highp float fragZ, DepthSampler depth,highp vec2 uv, vec2 mapSize ){\n    return textureShadow( depth, fragZ, uv );\n  }\n\n  float resolveShadow2x2(highp float fragZ, DepthSampler depth,highp vec2 uv, vec2 mapSize ){\n    return textureShadow( depth, fragZ, uv );\n  }\n\n#else\n\n  float resolveShadow2x1(highp float fragZ, DepthSampler depth,highp vec2 uv, vec2 mapSize ){\n\n    highp float coordsPx = uv.x*mapSize.x;\n    highp float uvMin = floor( coordsPx ) * mapSize.y;\n    highp float uvMax = ceil(  coordsPx ) * mapSize.y;\n\n    vec2 occl = textureShadow( depth, fragZ, vec4(\n      uvMin,uv.y,\n      uvMax,uv.y\n    ));\n\n    highp float ratio = coordsPx - uvMin*mapSize.x;\n    return ( ratio * occl.y + occl.x ) - ratio * occl.x;\n\n  }\n\n  float resolveShadow2x2(highp float fragZ, DepthSampler depth,highp vec2 uv, vec2 mapSize ){\n\n    highp vec2 coordsPx = uv*mapSize.x;\n    highp vec2 uvMin=floor( coordsPx ) *mapSize.y;\n    highp vec2 uvMax=ceil(  coordsPx ) *mapSize.y;\n\n    vec4 occl = textureShadow( depth, fragZ, \n      vec4(\n        uvMin,\n        vec2(uvMax.x,uvMin.y)\n      ),\n      vec4(\n        vec2(uvMin.x,uvMax.y),\n        uvMax\n      )\n    );\n\n    highp vec2 ratio = coordsPx - uvMin*mapSize.x;\n    vec2  t = ( ratio.y * occl.zw + occl.xy ) - ratio.y * occl.xy;\n\n    return(ratio.x*t.y+t.x)-ratio.x*t.x;\n  }\n\n#endif\n\n\nfloat calcLightOcclusions(DepthSampler depth, highp vec3 fragCoord, vec2 mapSize ){\n  float s;\n\n  highp vec2 kernelOffset = uShadowKernelRotation * mapSize.y;\n\n  // NO FILTER\n  #if shadowFilter( PCFNONE )\n\n    s = resolveShadowNoFiltering( fragCoord.z, depth, fragCoord.xy );\n  #endif\n\n  // PCF4x1\n  #if shadowFilter( PCF4x1 )\n\n    s = resolveShadowNoFiltering( fragCoord.z, depth, fragCoord.xy + kernelOffset                    );\n    s+= resolveShadowNoFiltering( fragCoord.z, depth, fragCoord.xy - kernelOffset                    );\n    s+= resolveShadowNoFiltering( fragCoord.z, depth, fragCoord.xy + vec2(-kernelOffset.y,kernelOffset.x)  );\n    s+= resolveShadowNoFiltering( fragCoord.z, depth, fragCoord.xy + vec2(kernelOffset.y,-kernelOffset.x)  );\n    s /= 4.0;\n  #endif\n\n  // PCF4x4\n  #if shadowFilter( PCF4x4 )\n\n    s = resolveShadow2x2( fragCoord.z, depth, fragCoord.xy + kernelOffset                         , mapSize );\n    s+= resolveShadow2x2( fragCoord.z, depth, fragCoord.xy - kernelOffset                         , mapSize );\n    s+= resolveShadow2x2( fragCoord.z, depth, fragCoord.xy + vec2(-kernelOffset.y,kernelOffset.x) , mapSize );\n    s+= resolveShadow2x2( fragCoord.z, depth, fragCoord.xy + vec2(kernelOffset.y,-kernelOffset.x) , mapSize );\n    s /= 4.0;\n  #endif\n\n  // PCF2x2\n  #if shadowFilter( PCF2x2 )\n\n    s = resolveShadow2x1( fragCoord.z, depth, fragCoord.xy + kernelOffset , mapSize);\n    s+= resolveShadow2x1( fragCoord.z, depth, fragCoord.xy - kernelOffset , mapSize);\n    s /= 2.0;\n  #endif\n\n\n  return s;\n\n}\n\n\n\nvec3 calcShadowPosition( vec4 texelBiasVector, mat4 shadowProjection, vec3 worldPos, vec3 worldNormal, float invMapSize )\n{\n  float WoP = dot( texelBiasVector, vec4( worldPos, 1.0 ) );\n\n  WoP *= .0005+2.0*invMapSize;\n\n  highp vec4 fragCoord = shadowProjection * vec4( worldPos + WoP * worldNormal, 1.0);\n  return fragCoord.xyz / fragCoord.w;\n}\n\n\n"};n.toString=n,e.exports=n},function(e,t){var n=function(e){var t="";return t+="#define GLSLIFY 1\nhighp float roughness = -10.0 / log2( gloss()*0.968+0.03 );\nroughness *= roughness;\nfloat specularMul = roughness * (0.125/3.141592) + 0.5/3.141592;\n\nvec3 lSpecularColor = vec3(0.0);\n#define LS_SPECULAR lSpecularColor\n\nfloat totalShadow = 0.0;\n"};n.toString=n,e.exports=n},function(e,t){var n=function(e){var t="";return t+="#define GLSLIFY 1\n// post light setup\n\nspecularColor += lSpecularColor * specular()*specular();"};n.toString=n,e.exports=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(97),l=r(u),c=n(88),f=r(c),d=new Float32Array(4),h=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._type=l.default.TYPE_DIR,n._offsets={near:0,far:0,right:0,left:0,bottom:0,top:0},n}return a(t,e),s(t,[{key:"projectionFromBounds",value:function(e){var t=this.boundsInLocalSpace(e);this._camera.lens.near=-t[5]-this._offsets.near,this._camera.lens.far=-t[2]+this._offsets.far,this._camera.lens.setBound(t[0]+this._offsets.right,t[3]-this._offsets.left,t[1]-this._offsets.bottom,t[4]+this._offsets.top)}},{key:"getTexelBiasVector",value:function(){var e=this._camera.lens;return d[3]=Math.max(e._xMax-e._xMin,e._yMax-e._yMin),d}},{key:"_createCamera",value:function(){return f.default.makeOrthoCamera()}}]),t}(l.default);t.default=h,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},l=n(71),c=r(l),f=n(99),d=r(f),h=n(100),p=r(h),v=n(101),m=r(v),g=n(102),_=r(g),y=n(103),b=r(y),w=n(52),M=r(w),x=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,"environment"));return n.keepBufferMeshes=[/bounds/gi],n.registerTextures(),n.registerMaterials(),n}return a(t,e),s(t,[{key:"init",value:function(){for(var e=this.getNodeByName("objects"),t=e._children,n=0,r=t.length;n<r;n++){this.getMeshByName(t[n].name).proxiesOnly=!0}}},{key:"registerTextures",value:function(){var e=this.texs;e.makeTex("sky","sky.jpg").setFilter(!0,!1,!1),e.makeTex("unif_noise","unif_noise.jpg").setFilter(!0,!1,!1)}},{key:"registerMaterials",value:function(){var e=this.scene,t=e.gl,n=this.mats,r=this.texs,i=void 0;i=new d.default(t),e.env.setupMat(i),i.setLightSetup(e.lights.setup),i.albedo=i.iAlbedo.attachUniform("uAlbedo"),i.specular=i.iSpecular.attachConstant([.22,.21,.19]),i.gloss=i.iGloss.attachConstant(.98),M.default.HexInput(i.albedo,16049872),n.setOpaque(i),n.registerMaterial(i,"ground"),i=new p.default(t),i.albedo=i.iAlbedo.attachSampler("tAlbedo","vTexCoord"),i.albedo.set(r.get("sky")),n.setOpaque(i),n.registerMaterial(i,"sky"),i=new m.default(t),this.skyReflectMaterial=i,i.albedo=i.iAlbedo.attachSampler("tAlbedo","vTexCoordAlbedo"),i.noise=i.iNoise.attachSampler("tNoise","vTexCoord"),i.albedo.set(r.get("sky")),i.noise.set(r.get("unif_noise")),n.setOpaque(i),n.registerMaterial(i,"sky_reflect"),i=new _.default(t),e.env.setupMat(i),i.setLightSetup(e.lights.setup),i.albedo=i.iAlbedo.attachUniform("uAlbedo"),i.specular=i.iSpecular.attachUniform("uSpecular"),i.gloss=i.iGloss.attachConstant(.6),i.iFog.enable(),M.default.HexInput(i.albedo,16509397),M.default.HexInput(i.specular,0),n.registerMaterial(i,"obstacle_grey"),i=new _.default(t),e.env.setupMat(i),i.setLightSetup(e.lights.setup),i.albedo=i.iAlbedo.attachUniform("uAlbedo"),i.specular=i.iSpecular.attachUniform("uSpecular"),i.gloss=i.iGloss.attachConstant(.6),i.iFog.enable(),M.default.HexInput(i.albedo,14598279),M.default.HexInput(i.specular,0),n.registerMaterial(i,"obstacle_orange"),i=new _.default(t),e.env.setupMat(i),i.setLightSetup(e.lights.setup),i.albedo=i.iAlbedo.attachUniform("uAlbedo"),i.specular=i.iSpecular.attachUniform("uSpecular"),i.gloss=i.iGloss.attachConstant(.6),i.iFog.enable(),M.default.HexInput(i.albedo,16770975),M.default.HexInput(i.specular,0),n.registerMaterial(i,"obstacle_yellow"),i=new b.default(t),i.isVisible=!1,i.color=i.iColor.attachConstant([0,0,0,1]),n.setOpaque(i),n.registerMaterial(i,"hidden")}},{key:"getGLTFUrl",value:function(){return"environment.glb"}},{key:"preRender",value:function(e){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"preRender",this).call(this,e);var n=this.skyReflectMaterial.prg;n.use(),n.uTime(this.scene.time)}},{key:"toggleGround",value:function(e){this.toggleNodesByRegex(/ground/i,e)}},{key:"toggleSkyReflect",value:function(e){this.toggleNodesByRegex(/sky_reflect/i,e)}},{key:"toggleFog",value:function(e){for(var t=e?"enable":"disable",n=this.mats.matlist,r=0,i=n.length;r<i;r++){var o=n[r];void 0!==o.iFog&&o.iFog[t]()}}},{key:"_onLoad",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_onLoad",this).call(this),this.init()}}]),t}(c.default);t.default=x,e.exports=t.default},function(e,t,n){"use strict";function r(e){return new window.TextDecoder("utf-8").decode(e)}function i(e){for(var t="",n=a(e),r=n.length,i=0;i<r;++i){var o=n[i];o<=65535?t+=String.fromCharCode(o):(o-=65536,t+=String.fromCharCode(55296+(o>>10),56320+(1023&o)))}return t}function o(e,t,n){return t<=e&&e<=n}function a(e){for(var t=0,n=0,r=0,i=128,a=191,s=[],u=e.length,l=0;l<u;++l){var c=e[l];if(0===r){if(o(c,0,127)){s.push(c);continue}if(o(c,194,223)){r=1,t=31&c;continue}if(o(c,224,239)){224===c&&(i=160),237===c&&(a=159),r=2,t=15&c;continue}if(o(c,240,244)){240===c&&(i=144),244===c&&(a=143),r=3,t=7&c;continue}throw new Error("String decoding failed.")}o(c,i,a)?(i=128,a=191,t=t<<6|63&c,++n===r&&(s.push(t),t=r=n=0)):(t=r=n=0,i=128,a=191,--l)}return s}"undefined"!=typeof TextDecoder?e.exports=r:e.exports=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(19),s=r(a),u=n(53),l=r(u),c=n(192),f=r(c),d=n(195),h=r(d),p={handleMeshes:n(196),handleNodes:n(203),handleMaterials:n(205),handleAnimations:n(206),handleSkin:n(207)},v=function(){function e(t,n){i(this,e),this.json=t,this.binaries=n,this.keepBuffer=!1,this.isSkinned=void 0!==t.skins,this.buffers={},this._lib={nodeList:[],nodes:[],materials:[],meshes:[],animations:[],skins:[]}}return o(e,[{key:"load",value:function(e,t){this.gltfScene=e,this.container=t,p.handleMeshes(this),p.handleNodes(this),p.handleAnimations(this),p.handleSkin(this);for(var n=this.getNodes(),r=0;r<n.length;r++)e.node.add(n[r]),e.childrenRootNodes.push(n[r]);for(var i=this.getNodeList(),o=0;o<i.length;o++)e.nodeList.push(i[o]);for(var a=this.getMeshes(),s=0;s<a.length;s++)e.meshList.push(a[s]);this._lib.skins.length>0&&this.createSkin(),this._lib.animations.length>0&&this.createAnimator()}},{key:"createAnimator",value:function(){this.gltfScene.animator=new f.default(this)}},{key:"createSkin",value:function(){this.gltfScene.skins=new h.default(this)}},{key:"getArrayBufferForAccessor",value:function(e){var t=e.bufferView,n=this.json.bufferViews[t];if(!this.buffers[t]){var r=new s.default(this.gltfScene.gl),i=l.default.getBufferViewData(n,this);r.data(i),r.stride=l.default.getStrideFromAccessor(e,this.json)||0,r.length=e.count,this.buffers[t]=r}return this.buffers[t]}},{key:"getNodes",value:function(){return this._lib.nodes}},{key:"getNodeList",value:function(){return this._lib.nodeList}},{key:"getMeshes",value:function(){return this._lib.meshes}},{key:"getSkins",value:function(){return this._lib.skins}}]),e}();t.default=v,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={0:"POINTS",1:"LINES",2:"LINE_LOOP",3:"LINE_STRIP",4:"TRIANGLES",5:"TRIANGLE_STRIP",6:"TRIANGLE_FAN",5121:"UNSIGNED_BYTE",5123:"UNSIGNED_SHORT",5126:"FLOAT",34963:"ELEMENT_ARRAY_BUFFER",34962:"ARRAY_BUFFER",35678:"SAMPLER_2D",35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35676:"FLOAT_MAT4",BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,UNSIGNED_INT:5125,FLOAT:5126,SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(193),s=r(a),u=n(194),l=r(u),c=function(){function e(t){i(this,e),this.loader=t,this.gltfScene=t.gltfScene,this.animations=[],this.currentAnimation=null,this.nextAnimation=null,this.timeScale=1,this.createAnimations();var n=Math.floor(Math.random()*this.animations.length);this.currentAnimation=this.animations[n],this.currentAnimation.play(),this.transition=new l.default(this),this.onTransitionComplete=this._onTransitionComplete.bind(this)}return o(e,[{key:"createAnimations",value:function(){for(var e=0;e<this.loader._lib.animations.length;e++)this.animations.push(new s.default(this.loader._lib.animations[e],this))}},{key:"getAnimationByName",value:function(e){for(var t=0;t<this.animations.length;t++){var n=this.animations[t];if(n.name===e)return n}return!1}},{key:"addAnimation",value:function(e){var t=new s.default(e.data,this);this.animations.push(t)}},{key:"gotoAnimIdx",value:function(e){this.animations[e]&&(this.currentAnimation=this.animations[e])}},{key:"gotoAnimName",value:function(e){var t=this.getAnimationByName(e);t?(this.nextAnimation=t,this.transitionToAnim(t)):console.log("[Animator goToAnimName] anim",e,"not found")}},{key:"transitionToAnim",value:function(e){console.log("---------------------"),console.log("go to anim",e.name),console.log("---------------------"),this.transition.setAnims(this.currentAnimation,e),this.transition.play().then(this.onTransitionComplete)}},{key:"play",value:function(){this.currentAnimation.play()}},{key:"pause",value:function(){this.currentAnimation.pause()}},{key:"stop",value:function(){this.currentAnimation.stop()}},{key:"update",value:function(e){this.currentAnimation&&(this.currentAnimation&&this.currentAnimation.update(e),this.transition.update(e))}},{key:"_onTransitionComplete",value:function(){this.currentAnimation=this.nextAnimation,this.currentAnimation.play()}}]),e}();t.default=c,e.exports=t.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(1),a=o.vec2.create(),s=o.vec3.create(),u=o.quat.create(),l=function(){function e(t,n){r(this,e),this.data=t,this.name=t.name,this.uuid=t.uuid,this.samplers=t.samplers,this.channels=t.channels,this.animator=n,this.minTime=0,this.maxTime=0,this.duration=0,this.currentTime=0,this.isPlaying=!1,this.loop=!0,this.nodeStates={},this.computeDuration(),this.initStates()}return i(e,[{key:"computeDuration",value:function(){for(var e=1e10,t=0,n=0;n<this.samplers.length;n++){var r=this.samplers[n].minKeyframe,i=this.samplers[n].maxKeyframe;r<e&&(e=r),i>t&&(t=i)}this.minTime=e,this.maxTime=t,this.duration=this.maxTime-this.minTime}},{key:"initStates",value:function(){this.nodeStates={};for(var e=this.animator.gltfScene,t=0;t<this.channels.length;t++){var n=this.channels[t],r=e.nodeList[n.target.node];null===this.getStateForNodeUUID(r.uuid)&&(this.nodeStates[r.uuid]={node:r,translation:o.vec3.fromValues(r.position[0],r.position[1],r.position[2]),rotation:o.quat.fromValues(r.rotation[0],r.rotation[1],r.rotation[2],r.rotation[3]),scale:o.vec3.fromValues(r.scale[0],r.scale[1],r.scale[2])})}}},{key:"getStateForNodeUUID",value:function(e){return this.nodeStates[e]?this.nodeStates[e]:null}},{key:"play",value:function(){this.isPlaying=!0}},{key:"stop",value:function(){this.isPlaying=!1,this.currentTime=this.minTime,this.updateProps()}},{key:"pause",value:function(){this.isPlaying=!1}},{key:"update",value:function(e){this.isPlaying&&(this.currentTime+=e*this.animator.timeScale,this.loop&&this.currentTime>this.maxTime&&(this.currentTime=this.minTime),this.updateProps(),this.sync())}},{key:"updateProps",value:function(){for(var e=this.animator.gltfScene,t=0;t<this.channels.length;t++){var n=this.channels[t];if("weights"!==n.target.path){var r=this.samplers[n.sampler];this._getBoundingFramesForSampler(r,this.currentTime,a);var i=r.keyframes[a[0]],o=r.keyframes[a[1]],s=Math.max(r.minKeyframe,Math.min(this.currentTime,r.maxKeyframe)),u=(s-i)/(o-i);u=Math.max(0,Math.min(u,1));var l=r.values[[a[0]]],c=r.values[[a[1]]],f=e.nodeList[n.target.node],d=this.getStateForNodeUUID(f.uuid);this["_updateTarget"+(n.target.path.charAt(0).toUpperCase()+n.target.path.slice(1))](d,l,c,u)}}}},{key:"reset",value:function(){for(var e=this.animator.gltfScene.nodeList,t=0;t<e.length;t++)e[t].setMatrix(e[t].defaultM4)}},{key:"sync",value:function(){for(var e=this.animator.gltfScene,t=0;t<this.channels.length;t++){var n=this.channels[t],r=e.nodeList[n.target.node],i=this.nodeStates[r.uuid];o.vec3.copy(r.position,i.translation),o.quat.copy(r.rotation,i.rotation),o.vec3.copy(r.scale,i.scale),r.invalidate(),r.updateMatrix()}}},{key:"_getBoundingFramesForSampler",value:function(e,t,n){for(var r=0;r<e.keyframes.length;r++){var i=e.keyframes[r],o=e.keyframes[r+1]||e.maxKeyframe;if(t>=i&&t<o){n[0]=r,n[1]=Math.min(r+1,e.keyframes.length-1);break}}}},{key:"_updateTargetTranslation",value:function(e,t,n,r){o.vec3.lerp(s,t,n,r),o.vec3.copy(e.translation,s)}},{key:"_updateTargetRotation",value:function(e,t,n,r){o.quat.slerp(u,t,n,r),o.quat.copy(e.rotation,u)}},{key:"_updateTargetScale",value:function(e,t,n,r){o.vec3.lerp(s,t,n,r),o.vec3.copy(e.scale,s)}}]),e}();t.default=l,e.exports=t.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(11),a=function(e){return e&&e.__esModule?e:{default:e}}(o),s=n(1),u=function(){function e(t){r(this,e),this.animator=t,this.currentTime=0,this.duration=.5,this.prevAnim=null,this.nextAnim=null,this.defer=null,this.nodeStates=[],this.initStateCache()}return i(e,[{key:"initStateCache",value:function(){for(var e=this.animator.gltfScene,t=0;t<e.nodeList.length;t++){var n=e.nodeList[t];this.nodeStates.push({node:n,translation:s.vec3.fromValues(n.position[0],n.position[1],n.position[2]),rotation:s.quat.fromValues(n.rotation[0],n.rotation[1],n.rotation[2],n.rotation[3]),scale:s.vec3.fromValues(n.scale[0],n.scale[1],n.scale[2])})}}},{key:"getStateForNodeUUID",value:function(e){for(var t=0;t<this.nodeStates.length;t++)if(this.nodeStates[t].node.uuid===e)return this.nodeStates[t];return null}},{key:"getStateForNodeName",value:function(e){for(var t=0;t<this.nodeStates.length;t++)if(this.nodeStates[t].node.name===e)return this.nodeStates[t];return null}},{key:"setAnims",value:function(e,t){this.prevAnim=e,this.nextAnim=t}},{key:"play",value:function(){return this.defer=a.default.defer(),this.isPlaying=!0,this.prevAnim.play(),this.nextAnim.play(),this.defer.promise}},{key:"stop",value:function(){this.isPlaying=!1,this.currentTime=0}},{key:"pause",value:function(){this.isPlaying=!1}},{key:"update",value:function(e){this.isPlaying&&(this.currentTime+=e*this.animator.timeScale,this.currentTime=Math.max(0,Math.min(this.currentTime,this.duration)),this.prevAnim.update(e),this.nextAnim.update(e),this.updateNodes(),this.sync(),this.currentTime>=this.duration&&this.onComplete())}},{key:"updateNodes",value:function(){var e=this.currentTime/this.duration;for(var t in this.nodeStates){var n=this.nodeStates[t],r=n.node,i=this.prevAnim.getStateForNodeUUID(r.uuid)||r.defaultTRS,o=this.nextAnim.getStateForNodeUUID(r.uuid)||r.defaultTRS;s.vec3.lerp(n.translation,i.translation,o.translation,e),s.quat.slerp(n.rotation,i.rotation,o.rotation,e),s.vec3.lerp(n.scale,i.scale,o.scale,e)}}},{key:"sync",value:function(){for(var e in this.nodeStates){var t=this.nodeStates[e],n=t.node;s.vec3.copy(n.position,t.translation),s.quat.copy(n.rotation,t.rotation),s.vec3.copy(n.scale,t.scale),n.invalidate(),n.updateMatrix()}}},{key:"onComplete",value:function(){this.stop(),this.defer.resolve()}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t,n){r(this,e),this.skins=n,this.skeleton=t.skeleton,this.jointsIdx=t.joints,this.joints=[],this.inverseBindMatrices=[];for(var i=t.inverseBindMatrices,o=0;o<i.length;o++)this.inverseBindMatrices.push(new Float32Array(i[o]));for(var a=this.skins.loader.gltfScene.nodeList,s=0;s<this.jointsIdx.length;s++)this.joints[s]=a[this.jointsIdx[s]]}return i(e,[{key:"update",value:function(){for(var e=this.skins.loader.gltfScene.nodeList,t=0;t<this.jointsIdx.length;t++)this.joints[t]=e[this.jointsIdx[t]]}}]),e}(),a=function(){function e(t){r(this,e),this.loader=t,this.skins=[],this.createSkins()}return i(e,[{key:"createSkins",value:function(){for(var e=this.loader.getSkins(),t=0;t<e.length;t++){var n=e[t],r=new o(n,this);this.skins.push(r)}}},{key:"getSkin",value:function(e){return this.skins[e]}},{key:"update",value:function(){for(var e=0;e<this.skins.length;e++)this.skins[e].update()}}]),e}();t.default=a,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n){var r=new f.default(e,n);return r.data(t),r}function o(e,t){var n=new l.default(t);if(e<255){for(var r=new Uint8Array(e),i=0;i<e;i++)r[i]=i;n.attrib("aVertexID",1,t.UNSIGNED_BYTE)}else if(e<65535){for(var r=new Uint16Array(e),i=0;i<e;i++)r[i]=i;n.attrib("aVertexID",1,t.UNSIGNED_SHORT)}else console.log("no support for 32bit");return n.data(r),n}function a(e,t,n){var r=n.json,i=r.accessors[t],o=n.getArrayBufferForAccessor(i),a=M[e];return void 0===a&&console.warn("unsupported attribute "+e),o.attribs.push({name:a,type:i.componentType,size:g.default.getComponentSize(i.type),normalize:i.normalized||!1,offset:i.byteOffset||0}),o}function s(e){x=-1;for(var t=e.json,n=t.meshes,r=e.gltfScene,s=r.gl,u=[],l=0;l<n.length;l++){x++;var c=n[l],f=c.name||"Mesh_"+x,d=new v.default(s),p=new h.default(s);if(p.name=f,p.uuid="mesh_"+x,p.geom=d,p.morphSetup=null,void 0!==c.weights){var m=new w.default(c.weights.length);m.setWeights(c.weights),p.morphSetup=m}u.push(p);for(var _=c.primitives,b=0;b<_.length;b++){var M=new v.default.SubGeom(s);d.subgeoms.push(M);var S=_[b],P=S.indices,C=t.accessors[P],T=t.bufferViews[C.bufferView],A=g.default.getBufferViewData(T,e);M.ibuffer=i(s,A,C.componentType);for(var O=r.keepBuffer,I=0;I<r.keepBufferMeshes.length;I++){var E=r.keepBufferMeshes[I],D=f.match(E);if(D){O=D;break}}O&&(M.indices=g.default.getDataFromAccessor(C,e,!0).data);for(var k in S.attributes){var R=S.attributes[k],N=a(k,R,e);if(M.buffers.includes(N)||M.buffers.push(N),"POSITION"===k&&O){var F=t.accessors[R];M.vertices=g.default.getDataFromAccessor(F,e).data}}var L=S.material,j=null;if(void 0===L)throw new Error("no material for primitive");var V=t.materials[L],B=V.name||""+L;if(j=r.getMaterial(B),p.materials.push(j),void 0!==S.targets){var G=new y.default;if(G.parse(S.targets,e),M.buffers.push(o(G.numverts,s)),M.morph=G,null===j.morphSetup)j.setMorphSetup(m);else if(j.morphSetup.weights.length!==m.weights.length)throw new Error("morph target number conflict on material")}}}e._lib.meshes=u}Object.defineProperty(t,"__esModule",{value:!0});var u=n(19),l=r(u),c=n(61),f=r(c),d=n(197),h=r(d),p=n(199),v=r(p),m=n(53),g=r(m),_=n(201),y=r(_),b=n(202),w=r(b),M={POSITION:"aPosition",COLOR_0:"aColor",NORMAL:"aNormal",TANGENT:"aTangent",TEXCOORD_0:"aTexCoord",TEXCOORD_1:"aTexCoord1",JOINTS_0:"aJoint",WEIGHTS_0:"aWeight"},x=-1;t.default=s,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(4),l=r(u),c=n(198),f=r(c),d=n(1),h=d.mat4.create(),p=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.gl=e,n.geom=null,n.name="",n.materials=[],n.skin=null,n.skinIdx=-1,n.flattenJointsMatrices=null,n.morphSetup=null,n.isVisible=!0,n.proxies=[],n.proxiesOnly=!1,n}return a(t,e),s(t,[{key:"proxy",value:function(){var e=new l.default;return e.mesh=this,this._parent&&this._parent.add(e),this.proxies.push(e),e}},{key:"removeProxy",value:function(e){var t=this.proxies.indexOf(e);-1!==t&&(this.proxies.splice(t,1),e._parent&&e._parent.remove(e))}},{key:"removeAllProxies",value:function(){for(var e=this.proxies,t=0,n=e.length;t<n;t++)this.removeProxy(e[t])}},{key:"preRender",value:function(e){null!==this.skin&&this.updateSkin()}},{key:"render",value:function(e,t,n){if(this.isVisible)for(var r=this.geom.subgeoms,i=this.materials.length,o=e.glstate,a=e.camera,s=0;s<r.length;s++){var u=r[s],l=this.materials[Math.min(i-1,s)];l&&0!=(l._mask&t)&&l.isVisible&&(l.prepare(this,a),u.setup(l.prg),o.push(l.config),this.cfg&&o.push(this.cfg),n&&o.push(n),o.apply(),this.drawCall(a,l.prg,u,l),o.pop(),this.cfg&&o.pop(),n&&o.pop())}}},{key:"drawCall",value:function(e,t,n,r){this.proxiesOnly||n.render();for(var i=this.proxies,o=0;o<i.length;o++){var a=i[o];a.isVisible&&(e.modelViewProjectionMatrix(h,a._wmatrix),t.uMVP&&t.uMVP(h),t.uWorldMatrix&&t.uWorldMatrix(a._wmatrix),t.uAlpha&&a.alpha&&t.uAlpha(a.alpha),r.prepare(a,e,n),n.render())}n.unbind()}},{key:"renderDepth",value:function(e,t,n,r,i){if(this.isVisible)for(var o=this.geom.subgeoms,a=this.materials.length,s=e.glstate,u=0;u<o.length;u++){var l=o[u],c=this.materials[Math.min(a-1,u)];c&&0!=(c._mask&n)&&c.isVisible&&(c=c.depthPass,void 0===c&&(c=i),c.prepare(this,t),l.setup(c.prg),c.config&&s.push(c.config),this.cfg&&s.push(this.cfg),r&&s.push(r),s.apply(),this.drawCall(t,c.prg,l,c),c.config&&s.pop(),this.cfg&&s.pop(),r&&s.pop())}}},{key:"renderPass",value:function(e,t,n,r){if(this.isVisible)for(var i=this.geom.subgeoms,o=this.materials.length,a=0;a<i.length;a++){var s=i[a],u=this.materials[Math.min(o-1,a)];u&&0!=(u._mask&n)&&u.isVisible&&(r.prepare(this,t),s.setup(r.prg),e.glstate.apply(),s.render())}}},{key:"renderProgram",value:function(e,t,n){if(this.isVisible){var r=this.geom.subgeoms,i=this.materials.length;n=n||-1,t.uMVP&&t.uMVP(e.getMVP(this._wmatrix)),t.uWorldMatrix&&t.uWorldMatrix(this._wmatrix),t.uViewMatrix&&(d.mat4.multiply(h,e._view,this._wmatrix),t.uViewMatrix(h));for(var o=0;o<r.length;o++){var a=r[o],s=this.materials[Math.min(i-1,o)];s&&0!=(s._mask&n)&&(a.setup(t),a.render())}}}},{key:"setSkin",value:function(e){this.skin=e;var t=this.geom.subgeoms,n=this.materials.length;this.flattenJointsMatrices=new Float32Array(16*this.skin.joints.length),this.jointMatrixChunks=[];for(var r=0;r<this.skin.joints.length;r++)this.jointMatrixChunks.push(new Float32Array(this.flattenJointsMatrices.buffer,64*r,16));for(var i=new f.default(e,this),o=0;o<t.length;o++){var a=this.materials[Math.min(n-1,o)];a.setSkinSetup(i),a.compile(),a.depthPass&&a.depthPass.compile()}}},{key:"updateSkin",value:function(){for(var e=0;e<this.skin.joints.length;e++){var t=this._wmatrix,n=this.skin.joints[e]._wmatrix,r=this.skin.inverseBindMatrices[e],i=this.jointMatrixChunks[e];d.mat4.invert(i,t),d.mat4.mul(i,i,n),d.mat4.mul(i,i,r)}}}]),t}(l.default);t.default=p,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(28),l=r(u),c=n(7),f=r(c),d=function(){function e(t,n){a(this,e),this.mesh=n,this.skin=null,this.jointsChunk=new h(this),this.skinNumWeight=new f.default("skinNumWeight",["SKIN4","SKIN3","SKIN2","SKIN1"]),this.setSkin(t)}return s(e,[{key:"setSkin",value:function(e){this.skin=e;var t=Math.min(e.joints.length,4);this.skinNumWeight.set("SKIN"+t),this.jointsChunk.invalidate()}},{key:"getChunks",value:function(){return[this.jointsChunk.createProxy(),this.skinNumWeight.createProxy()]}}]),e}(),h=function(e){function t(e){a(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,!0,!0));return n.skinSetup=e,n}return o(t,e),s(t,[{key:"genCode",value:function(e){var t=this.skinSetup.skin.joints.length,n="#define SKIN_NUM_JOINTS "+t+"\n";n+="uniform mat4 uJoints[SKIN_NUM_JOINTS];",e.add("pv",n)}},{key:"getHash",value:function(){return this.skinSetup.skin.joints.length}},{key:"setup",value:function(e){e.uJoints(this.skinSetup.mesh.flattenJointsMatrices)}}]),t}(l.default);t.default=d,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(200),s=r(a),u=n(60),l=r(u),c=function e(t){i(this,e),this.gl=t,this.name="",this.subgeoms=[]};c.SubGeom=function(){function e(t){i(this,e),this._vaoMap={},this.gl=t,this.buffers=[],this.ibuffer=null,this.indices=null,this.vertices=[],this.bounds=new l.default,this.vao=new s.default(this.gl),this.cprg=null,this.morph=null}return o(e,[{key:"getVao",value:function(e){var t=e._cuid,n=void 0;return void 0===this._vaoMap[t]&&(n=this._vaoMap[t]=new s.default(this.gl),n.setup(e,this.buffers,this.ibuffer)),this._vaoMap[t]}},{key:"setup",value:function(e){null!=this.morph&&this.morph.setupPrg(e),this.currentVao=this.getVao(e),this.currentVao.bind()}},{key:"render",value:function(){this.ibuffer.drawTriangles()}},{key:"unbind",value:function(){this.currentVao.unbind()}}]),e}(),t.default=c,e.exports=t.default},function(e,t){function n(e,t){e.bindVertexArray=function(){return t.bindVertexArrayOES.apply(t,arguments)},e.createVertexArray=function(){return t.createVertexArrayOES.apply(t,arguments)},e.deleteVertexArray=function(){return t.deleteVertexArrayOES.apply(t,arguments)},e.isVertexArray=function(){return t.isVertexArrayOES.apply(t,arguments)}}function r(e){if(this.gl=e,void 0!==e.bindVertexArray)this._impl=new i(this);else{var t=e.getExtension("OES_vertex_array_object");t?(n(e,t),this._impl=new i(this)):this._impl=new o(this)}}function i(e){this._vao=e,this._handle=null}function o(e){this._vao=e}r.prototype={dispose:function(){this._impl.dispose(),this._impl=null},setup:function(e,t,n){e.ready||e._grabParameters(),this._impl.setup(e,t,n)},bind:function(){this._impl.bind()},unbind:function(){this._impl.unbind()}},i.prototype={dispose:function(){this.release(),this._vao=null},setup:function(e,t,n){this.release();var r=this._vao.gl;this._handle=r.createVertexArray(),r.bindVertexArray(this._handle);for(var i=0;i<t.length;i++)t[i].attribPointer(e);void 0!==n&&n.bind(),r.bindVertexArray(null)},bind:function(){this._vao.gl.bindVertexArray(this._handle)},unbind:function(){this._vao.gl.bindVertexArray(null)},release:function(){this._handle&&(this._vao.gl.deleteVertexArray(this._handle),this._handle=null)}},o.prototype={dispose:function(){this._vao=null,this.prg=null,this.buffers=null,this.indices=null},setup:function(e,t,n){this.prg=e,this.buffers=t,this.indices=n},bind:function(){for(var e=0;e<this.buffers.length;e++)this.buffers[e].attribPointer(this.prg);void 0!==this.indices&&this.indices.bind()},unbind:function(){}},e.exports=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){if(!e)throw new Error(m)}function a(e){for(var t=h.default.nextPOT(Math.sqrt(e)),n=0;t*(1<<n)<e&&n<12;)n++;return[t,1<<n]}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(57),l=r(u),c=n(29),f=r(c),d=n(18),h=r(d),p=n(53),v=r(p),m="invalid morph targets",g=function(){function e(){i(this,e),this.rawData=null,this.dim=null,this.numverts=0,this.numTargets=0}return s(e,[{key:"setupPrg",value:function(e){e.uMorphTexSize(this.dim),e.tMorphTex(this.tex)}},{key:"parse",value:function(e,t){for(var n=t.json,r=(n.meshes,t.gltfScene),i=r.gl,s=0;s<e.length;s++)if(void 0===e[s].POSITION)throw new Error(m);var u=e[0],c=u.POSITION,d=n.accessors[c],h=d.count,p=e.length;o(void 0!==h);for(var g=h*p,_=a(g),y=new Float32Array(_[0]*_[1]*3),s=0;s<p;s++){u=e[s],c=u.POSITION,d=n.accessors[c],o(h===d.count),o("VEC3"===d.type),o(d.componentType===i.FLOAT),o(0===d.byteOffset);var b=n.bufferViews[d.bufferView];o(void 0===b.byteStride);var w=v.default.getBufferViewData(b,t);w=new Float32Array(w.buffer,w.byteOffset,w.length/4);for(var M=0;M<h;M++){var x=3*(s+M*p);y[x+0]=w[3*M+0],y[x+1]=w[3*M+1],y[x+2]=w[3*M+2]}}var S=l.default.getInstance(i),P=S.getRenderableFormat([S.RGB32F,S.RGB16F]),C=new f.default(i,P.format,P.type,P.internal);C.fromData(_[0],_[1],y),C.setFilter(!1,!1,!1),this.rawData=y,this.dim=new Float32Array(_),this.tex=C,this.numverts=h,this.numTargets=p}}]),e}();t.default=g,e.exports=t.default},function(e,t,n){"use strict";function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(28),u=function(e){return e&&e.__esModule?e:{default:e}}(s);if(Object({NODE_ENV:"production"}).DEV){n(98)}var l=function(){function e(t){if(o(this,e),this.weights=new Float32Array(t),this.weightsChunk=new c(this),this.weightsChunk.invalidate(),Object({NODE_ENV:"production"}).DEV){this.allw=0;var n=this;gui.add(this,"allw",0,3).onChange(function(e){for(var t=0;t<n.weights.length;t++)n.weights[t]=e})}}return a(e,[{key:"setWeights",value:function(e){this.weights.set(e)}},{key:"getChunks",value:function(){return[this.weightsChunk.createProxy()]}}]),e}(),c=function(e){function t(e){o(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,!0,!0));return n.morphSetup=e,n}return i(t,e),a(t,[{key:"genCode",value:function(e){var t=this.morphSetup.weights.length,n="#define MORPH_NUM_WEIGHTS "+t+"\n";n+="uniform float uMorphWeights[MORPH_NUM_WEIGHTS];\n",n+="uniform vec2 uMorphTexSize;\n",n+="uniform sampler2D tMorphTex;\n",e.add("pv",n)}},{key:"getHash",value:function(){return this.morphSetup.weights.length}},{key:"setup",value:function(e){e.uMorphWeights(this.morphSetup.weights)}}]),t}(u.default);t.default=l,e.exports=t.default},function(e,t,n){"use strict";function r(e){function t(e,n){var o=e.gltfData;if(n&&n.add(e),void 0!==o.mesh){var a=r[o.mesh];e.add(a),e.meshes.push(a)}if(o.children)for(var s=0;s<o.children.length;s++){var u=o.children[s],l=i[u];t(l,e)}}u=-1;for(var n=(e.gltfScene,e.json),r=(n.scenes[0].nodes,e.getMeshes()),i=[],l=[],c=null,f=0;f<n.nodes.length;f++){c=n.nodes[f];var d=function(e){u++;var t=new o.default;t.gltfData=e,t.uuid="node_"+u,t.name=e.name||t.uuid,void 0!==e.skin&&(r[e.mesh].skinIdx=e.skin);var n=c.rotation?a.quat.fromValues(c.rotation[0],c.rotation[1],c.rotation[2],c.rotation[3]):a.quat.create(),i=c.translation||a.vec3.create(),l=c.scale||a.vec3.fromValues(1,1,1);a.mat4.fromRotationTranslationScale(s,n,i,l),t.setMatrix(s);var f=a.mat4.create();return a.mat4.copy(f,s),t.defaultM4=f,t.defaultTRS.translation=i,t.defaultTRS.rotation=n,t.defaultTRS.scale=l,t}(c);i.push(d)}for(var h=0;h<n.scenes[0].nodes.length;h++){var p=n.scenes[0].nodes[h],v=i[p];l.push(v),t(v,null)}e._lib.nodeList=i,e._lib.nodes=l}Object.defineProperty(t,"__esModule",{value:!0});var i=n(204),o=function(e){return e&&e.__esModule?e:{default:e}}(i),a=n(1),s=a.mat4.create(),u=-1;t.default=r,e.exports=t.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(4),u=function(e){return e&&e.__esModule?e:{default:e}}(s),l=function(e){function t(){r(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.defaultM4=null,e.defaultTRS={translation:null,rotation:null,scale:null},e.meshes=[],e}return o(t,e),a(t,[{key:"getMeshByName",value:function(e){for(var t=null,n=0;n<this.meshes.length;n++){var r=this.meshes[n];r.name===e&&(t=r)}if(t)return t;console.warn("[GLTFNode getMeshByName] mesh",e,"doesnt exist")}},{key:"preRender",value:function(e,t,n){for(var r=0;r<this._children.length;r++);}},{key:"render",value:function(e,t,n){for(var r=0;r<this._children.length;r++)this._children[r].render&&this._children[r].render(e,t,n)}},{key:"renderPass",value:function(e,t,n,r){for(var i=0;i<this._children.length;i++)this._children[i].renderPass&&this._children[i].renderPass(e,t,n,r)}},{key:"renderDepth",value:function(e,t,n,r,i){for(var o=0;o<this._children.length;o++)this._children[o].renderDepth&&this._children[o].renderDepth(e,t,n,r,i)}},{key:"renderProgram",value:function(e,t,n){for(var r=0;r<this._children.length;r++)this._children[r].renderProgram&&this._children[r].renderProgram(e,t,n)}}]),t}(u.default);t.default=l,e.exports=t.default},function(e,t,n){"use strict";function r(e){for(var t=e.json,n=t.meshes,r=e.gltfScene,i=[],o=0;o<n.length;o++)for(var a=n[o],s=a.primitives,u=0;u<s.length;u++){var l=s[u],c=l.material,f=void 0;if(t.materials){var d=t.materials[c],h=d.name;f=r.getMaterial(h),f=r.getMaterial(h)||r.getMaterial("default"),i.push(f)}else f=r.getMaterial("default"),i.push(f)}e._lib.materials=i}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,e.exports=t.default},function(e,t,n){"use strict";function r(e,t){for(var n=t.json,r=[],i=0;i<e.samplers.length;i++){for(var o=e.samplers[i],s=n.accessors[o.input],u=(n.bufferViews[s.bufferView],a.getDataFromAccessor(s,t,!1).data),l=s.min[0],c=s.max[0],s=n.accessors[o.output],f=a.getComponentSize(s.type),d=a.getDataFromAccessor(s,t,!1).data,h=[],p=0;p<d.length/f;p++){for(var v=[],m=0;m<f;m++){var g=p*f;v[m]=d[g+m]}h.push(v)}var _={keyframes:u,minKeyframe:l,maxKeyframe:c,values:h,interpolation:o.interpolation};r.push(_)}return r}function i(e,t){for(var n=[],r=0;r<e.channels.length;r++){var i=e.channels[r];n.push(i)}return n}function o(e){var t=(e.gltfScene,e.json),n=[];if(t.animations){for(var o=0;o<t.animations.length;o++){s++;var a=t.animations[o],u=a.name||"anim_"+s,l=s,c=r(a,e),f=i(a,e);n.push({name:u,uuid:l,samplers:c,channels:f})}e._lib.animations=n}}var a=n(53),s=-1;e.exports=o},function(e,t,n){"use strict";function r(e){a=-1;var t=e.json,n=e.getNodeList(),r=[];if(t.skins){for(var i=0;i<t.skins.length;i++){for(var s=t.skins[i],u=s.name||"skin_"+a,l="skin_"+a,c=s.skeleton?n[s.skeleton]:n[t.scene],f=t.accessors[s.inverseBindMatrices],d=o.default.getUnflattenDataFromAccessor(f,e,!1),h=[],p=0;p<s.joints.length;p++){var v=s.joints[p],m=n[v];h.push(m)}r.push({name:u,skinIdx:a,uuid:l,inverseBindMatrices:d,joints:s.joints,skeleton:c})}e._lib.skins=r}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(53),o=function(e){return e&&e.__esModule?e:{default:e}}(i),a=-1;t.default=r,e.exports=t.default},function(e,t,n){var r=function(e){var t="";return t+="#define GLSLIFY 1\n#pragma SLOT pv\n\n#if __VERSION__ == 300\n  #define IN in\n  #define OUT out\n#else\n  #define IN attribute\n  #define OUT varying\n#endif\n\nIN vec3 aPosition;\nIN vec2 aTexCoord;\nIN vec3 aNormal;\nIN vec3 aTangent;\n\n#if !inferBitangent\n  IN vec3 aBitangent;\n#endif\n\nuniform mat4 uMVP;\nuniform mat4 uWorldMatrix;\n\nOUT vec2 vTexCoord;\nOUT vec3 vWorldPosition;\n\nOUT mediump vec3 vWorldNormal;\n\n#if HAS_normal\n  OUT mediump vec3 vWorldTangent;\n  OUT mediump vec3 vWorldBitangent;\n#endif\n\n#if perVertexIrrad\n  OUT vec3 vIrradiance;\n  uniform vec4 uSHCoeffs[7];\n  \n"+n(3)()+"\n#endif\n\nvec3 rotate( mat4 m, vec3 v ) {\n  return m[0].xyz*v.x + m[1].xyz*v.y + m[2].xyz*v.z;\n}\n\nvoid main( void ) {\n\n  #pragma SLOT v\n\n  vec4 pos = vec4( aPosition, 1.0 );\n\n  gl_Position    = uMVP * pos;\n\n  vWorldPosition = (uWorldMatrix * pos).xyz;\n  vWorldNormal   = rotate( uWorldMatrix, aNormal );\n\n  #if inferBitangent\n    vec3 aBitangent = cross( aNormal, aTangent );\n  #endif\n\n  #if HAS_normal\n    vWorldTangent   = rotate( uWorldMatrix, aTangent );\n    vWorldBitangent = rotate( uWorldMatrix, aBitangent );\n  #endif\n\n  #if perVertexIrrad\n    vIrradiance = SampleSH( normalize( vWorldNormal ), uSHCoeffs );\n  #endif\n\n\n  vTexCoord = aTexCoord;\n\n}\n"};r.toString=r,e.exports=r},function(e,t,n){var r=function(e){var t="";return t+="#define GLSLIFY 1\n#if __VERSION__ == 300\n  #define IN in\n  out vec4 FragColor;\n  #define texture2D(a,b) texture( a, b )\n#else\n  #define IN varying\n  #define FragColor gl_FragColor\n#endif\n\n\nuniform vec3 uCameraPosition;\nuniform vec2 uResolution;\nuniform sampler2D tCarReflect;\n\nIN vec2 vTexCoord;\nIN vec3 vWorldPosition;\n\nIN mediump vec3 vWorldNormal;\n\n#pragma SLOT pf\n\n#if HAS_normal\n  IN mediump vec3 vWorldTangent;\n  IN mediump vec3 vWorldBitangent;\n#endif\n\n\n\n// IBL\n// ========\nuniform sampler2D tEnv;\n\n#if pureGloss\n  uniform sampler2D tEnvHi;\n  "+n(21)()+"\n#endif\n\n#if perVertexIrrad\n  IN vec3 vIrradiance;\n#else\n  uniform vec4 uSHCoeffs[7];\n  "+n(3)()+"\n#endif\n\n\n\n// MATH\n// =========\n#define saturate(x) clamp( x, 0.0, 1.0 )\n#define sdot( a, b ) saturate( dot(a,b) )\n\n\n// INCLUDES\n// =========\n\n"+n(12)()+'\n\n\n// Schlick approx\n// [Schlick 1994, "An Inexpensive BRDF Model for Physically-Based Rendering"]\n// https://github.com/EpicGames/UnrealEngine/blob/dff3c48be101bb9f84633a733ef79c91c38d9542/Engine/Shaders/BRDF.usf#L168\nvec3 F_Schlick( float VoH,vec3 spec,float glo )\n{\n  float dot = glo*glo * pow( 1.0-VoH, 5.0 );\n  #if HAS_fresnel\n    return( 1.0 - dot )*spec + dot*fresnel();\n  #else\n    return( 1.0 - dot )*spec + dot;\n  #endif\n}\n\n\n// ------------------------------\n//\n\n#if HAS_normal\nvec3 perturbWorldNormal(vec3 n){\n  n = 2.0*n - 1.0;\n  vec3 nrm = gl_FrontFacing ? vWorldNormal : -vWorldNormal;\n  return normalize(vWorldTangent * n.x + vWorldBitangent*n.y + nrm );\n}\n#endif\n\n#if HAS_lodDither\n\n  float nrand(vec2 n) {\n    return fract(sin(dot(n.xy, vec2(12.9898, 78.233)))* 43758.5453);\n  }\n\n\n  void LOD_Dithering_Discard(vec2 sPos, float factor){\n    float RandCos = nrand(sPos);\n    float RandomVal = fract(RandCos * 1000.0);\n    lowp float RetVal = (factor < 0.0) ?\n        step( RandomVal, factor + 1.0 ) :\n        step(factor , RandomVal);\n    if(RetVal - .001 < 0.0){\n      discard;\n    }\n  }\n#endif\n\n//                MAIN\n// ===================\n\n#define gloss(k) gloss_base()*gloss_base()*.6\n\nvoid main( void ) {\n\n  #pragma SLOT f\n\n  #if HAS_lodDither\n    LOD_Dithering_Discard( gl_FragCoord.xy, lodDither() );\n  #endif\n\n\n  // -----------\n  vec3 worldNormal =\n    #if HAS_normal\n      perturbWorldNormal( normal() );\n    #else\n      gl_FrontFacing ? vWorldNormal : -vWorldNormal;\n    #endif\n  worldNormal = normalize( worldNormal );\n\n\n  // SH Irradiance diffuse coeff\n  // -------------\n  #if perVertexIrrad\n    vec3 diffuseCoef = vIrradiance;\n  #else\n    vec3 diffuseCoef = SampleSH(worldNormal, uSHCoeffs );\n  #endif\n\n\n  // IBL reflexion\n  // --------------\n\n  vec3 viewDir = normalize( uCameraPosition - vWorldPosition );\n  vec3 worldReflect = reflect( -viewDir, worldNormal );\n\n  #if pureGloss\n    vec3 specularColor = SampleEnvHi( tEnvHi, worldReflect );\n  #else\n    vec3 specularColor = SpecularIBL( tEnv, worldReflect, 1.0-gloss() );\n  #endif\n\n  #pragma SLOT lightsf\n\n  vec4 carReflect = texture2D(tCarReflect, gl_FragCoord.xy / uResolution);\n  specularColor = carReflect.rgb;\n\n\n  float NoV = sdot( viewDir, worldNormal );\n  vec3 specularSq = specular()*specular();\n  specularColor *= F_Schlick( NoV, specularSq, gloss() );\n\n\n  vec3 alb = albedo();\n  #if conserveEnergy\n    alb = alb - alb * specular();\n  #endif\n  vec3 albedoSq = alb*alb;\n\n\n  #if HAS_occlusion\n    diffuseCoef *= occlusion();\n  #endif\n\n\n  #if HAS_cavity\n    #ifndef cavityStrength\n      #define cavityStrength(k) vec2(1.0)\n    #endif\n    diffuseCoef   *= cavity() * cavityStrength().r + (1.0-cavityStrength().r);\n    specularColor *= cavity() * cavityStrength().g + (1.0-cavityStrength().g);\n  #endif\n\n\n  #if HAS_emissive\n    float e = emissive();\n    #if HAS_emissiveScale\n      e = e * emissiveScale();\n    #endif\n    diffuseCoef += vec3( e ) * albedo();\n  #endif\n\n\n  FragColor.xyz = diffuseCoef * albedoSq + specularColor;\n\n  #if HAS_exposure\n    FragColor.xyz *= vec3( exposure() );\n  #endif\n\n  \n  #if gammaMode( GAMMA_STD ) && HAS_gamma\n    FragColor.xyz = pow( FragColor.xyz, vec3( gamma() ) );\n  #endif\n\n  #if gammaMode( GAMMA_2_2 )\n    FragColor.xyz = pow( FragColor.xyz, vec3( 1.0/2.2 ) );\n  #endif\n\n  #if gammaMode( GAMMA_TB )\n    {\n      vec3 c = FragColor.xyz;\n      vec3 sqrtc = sqrt( c );\n      FragColor.xyz = (sqrtc-sqrtc*c) + c*(0.4672*c+vec3(0.5328));\n    }\n  #endif\n\n  #if HAS_alpha\n    FragColor.a = alpha();\n  #else\n    FragColor.a = 1.0;\n  #endif\n  \n}\n'};r.toString=r,e.exports=r},function(e,t){var n=function(e){var t="";return t+="#define GLSLIFY 1\n#pragma SLOT pv\n\n#if __VERSION__ == 300\n  #define IN in\n  #define OUT out\n#else\n  #define IN attribute\n  #define OUT varying\n#endif\n\nattribute vec3 aPosition;\nattribute vec2 aTexCoord;\n\nuniform mat4 uMVP;\n\nOUT vec2 vTexCoord;\n\nvoid main( void ) {\n  vec4 pos = vec4( aPosition, 1.0 );\n  gl_Position = uMVP * pos;\n\n  vTexCoord = aTexCoord;\n}\n"};n.toString=n,e.exports=n},function(e,t){var n=function(e){var t="";return t+="#define GLSLIFY 1\n#if __VERSION__ == 300\n  #define IN in\n  out vec4 FragColor;\n  #define texture2D(a,b) texture( a, b )\n#else\n  #define IN varying\n  #define FragColor gl_FragColor\n#endif\n\nIN vec2 vTexCoord;\n\n#pragma SLOT pf\n\nvoid main( void ) {\n  #pragma SLOT f\n\n  FragColor.rgb = albedo();\n}\n"};n.toString=n,e.exports=n},function(e,t){var n=function(e){var t="";return t+="#define GLSLIFY 1\n#pragma SLOT pv\n\n#if __VERSION__ == 300\n  #define IN in\n  #define OUT out\n#else\n  #define IN attribute\n  #define OUT varying\n#endif\n\nattribute vec3 aPosition;\nattribute vec2 aTexCoord;\n\nuniform mat4 uMVP;\nuniform mat4 uWorldMatrix;\n\nOUT vec2 vTexCoord;\nOUT vec3 vWorldPosition;\n\nvoid main( void ) {\n  vec4 pos = vec4( aPosition, 1.0 );\n  gl_Position = uMVP * pos;\n\n  vTexCoord = aTexCoord;\n  vWorldPosition = (uWorldMatrix * pos).xyz;\n}\n"};n.toString=n,e.exports=n},function(e,t,n){var r=function(e){var t="";return t+="#define GLSLIFY 1\n#if __VERSION__ == 300\n  #define IN in\n  out vec4 FragColor;\n  #define texture2D(a,b) texture( a, b )\n#else\n  #define IN varying\n  #define FragColor gl_FragColor\n#endif\n\nIN vec2 vTexCoord;\nIN vec3 vWorldPosition;\n\nuniform float uTime;\n\n#pragma SLOT pf\n\n"+n(80)+"\n\nvoid main( void ) {\n  #if HAS_albedo\n    vec2 vTexCoordAlbedo = noiseUv(tNoise, vTexCoord, 0.2, 0.005, uTime, 0.01);\n  #endif\n\n  #pragma SLOT f\n\n  FragColor.rgb = albedo();\n}\n"};r.toString=r,e.exports=r},function(e,t,n){var r=function(e){var t="";return t+="#define GLSLIFY 1\n#pragma SLOT pv\n\n#if __VERSION__ == 300\n  #define IN in\n  #define OUT out\n#else\n  #define IN attribute\n  #define OUT varying\n#endif\n\nIN vec3 aPosition;\nIN vec2 aTexCoord;\nIN vec3 aNormal;\nIN vec3 aTangent;\n\n#if !inferBitangent\n  IN vec3 aBitangent;\n#endif\n\nuniform mat4 uMVP;\nuniform mat4 uMV;\nuniform mat4 uWorldMatrix;\n\nOUT vec2 vTexCoord;\nOUT vec3 vWorldPosition;\n\nOUT mediump vec3 vWorldNormal;\n\n#if HAS_normal\n  OUT mediump vec3 vWorldTangent;\n  OUT mediump vec3 vWorldBitangent;\n#endif\n\n#if perVertexIrrad\n  OUT vec3 vIrradiance;\n  uniform vec4 uSHCoeffs[7];\n  \n"+n(3)()+"\n#endif\n\nvec3 rotate( mat4 m, vec3 v ) {\n  return m[0].xyz*v.x + m[1].xyz*v.y + m[2].xyz*v.z;\n}\n\nvoid main( void ) {\n\n  #pragma SLOT v\n\n  vec4 pos = vec4( aPosition, 1.0 );\n\n  gl_Position    = uMVP * pos;\n\n  vWorldPosition = (uWorldMatrix * pos).xyz;\n  vWorldNormal   = rotate( uWorldMatrix, aNormal );\n\n  vec4 mvPosition = uMV * pos;\n\n  #if inferBitangent\n    vec3 aBitangent = cross( aNormal, aTangent );\n  #endif\n\n  #if HAS_normal\n    vWorldTangent   = rotate( uWorldMatrix, aTangent );\n    vWorldBitangent = rotate( uWorldMatrix, aBitangent );\n  #endif\n\n  #if perVertexIrrad\n    vIrradiance = SampleSH( normalize( vWorldNormal ), uSHCoeffs );\n  #endif\n\n\n  vTexCoord = aTexCoord;\n\n}\n"};r.toString=r,e.exports=r},function(e,t,n){var r=function(e){var t="";return t+="#define GLSLIFY 1\n#if __VERSION__ == 300\n  #define IN in\n  out vec4 FragColor;\n  #define texture2D(a,b) texture( a, b )\n#else\n  #define IN varying\n  #define FragColor gl_FragColor\n#endif\n\nuniform vec3 uCameraPosition;\nuniform float uAlpha;\n\nIN vec2 vTexCoord;\nIN vec3 vWorldPosition;\n\nIN mediump vec3 vWorldNormal;\n\n#pragma SLOT pf\n\n#if HAS_normal\n  IN mediump vec3 vWorldTangent;\n  IN mediump vec3 vWorldBitangent;\n#endif\n\n\n\n// IBL\n// ========\nuniform sampler2D tEnv;\n\n#if pureGloss\n  uniform sampler2D tEnvHi;\n  "+n(21)()+"\n#endif\n\n#if perVertexIrrad\n  IN vec3 vIrradiance;\n#else\n  uniform vec4 uSHCoeffs[7];\n  "+n(3)()+"\n#endif\n\n\n\n// MATH\n// =========\n#define saturate(x) clamp( x, 0.0, 1.0 )\n#define sdot( a, b ) saturate( dot(a,b) )\n\n\n// INCLUDES\n// =========\n\n"+n(12)()+"\n\n#if fog\n  "+n(34)()+'\n#endif\n\n// Schlick approx\n// [Schlick 1994, "An Inexpensive BRDF Model for Physically-Based Rendering"]\n// https://github.com/EpicGames/UnrealEngine/blob/dff3c48be101bb9f84633a733ef79c91c38d9542/Engine/Shaders/BRDF.usf#L168\nvec3 F_Schlick( float VoH,vec3 spec,float glo )\n{\n  float dot = glo*glo * pow( 1.0-VoH, 5.0 );\n  #if HAS_fresnel\n    return( 1.0 - dot )*spec + dot*fresnel();\n  #else\n    return( 1.0 - dot )*spec + dot;\n  #endif\n}\n\n\n// ------------------------------\n//\n\n#if HAS_normal\nvec3 perturbWorldNormal(vec3 n){\n  n = 2.0*n - 1.0;\n  vec3 nrm = gl_FrontFacing ? vWorldNormal : -vWorldNormal;\n  return normalize(vWorldTangent * n.x + vWorldBitangent*n.y + nrm );\n}\n#endif\n\n#if HAS_lodDither\n\n  float nrand(vec2 n) {\n    return fract(sin(dot(n.xy, vec2(12.9898, 78.233)))* 43758.5453);\n  }\n\n\n  void LOD_Dithering_Discard(vec2 sPos, float factor){\n    float RandCos = nrand(sPos);\n    float RandomVal = fract(RandCos * 1000.0);\n    lowp float RetVal = (factor < 0.0) ?\n        step( RandomVal, factor + 1.0 ) :\n        step(factor , RandomVal);\n    if(RetVal - .001 < 0.0){\n      discard;\n    }\n  }\n#endif\n\n\n\n//                MAIN\n// ===================\n\n#define gloss(k) gloss_base()*gloss_base()*.6\n\nvoid main( void ) {\n\n  #pragma SLOT f\n\n  #if HAS_lodDither\n    LOD_Dithering_Discard( gl_FragCoord.xy, lodDither() );\n  #endif\n\n\n  // -----------\n  vec3 worldNormal =\n    #if HAS_normal\n      perturbWorldNormal( normal() );\n    #else\n      gl_FrontFacing ? vWorldNormal : -vWorldNormal;\n    #endif\n  worldNormal = normalize( worldNormal );\n\n\n  // SH Irradiance diffuse coeff\n  // -------------\n  #if perVertexIrrad\n    vec3 diffuseCoef = vIrradiance;\n  #else\n    vec3 diffuseCoef = SampleSH(worldNormal, uSHCoeffs );\n  #endif\n\n\n  // IBL reflexion\n  // --------------\n\n  vec3 viewDir = normalize( uCameraPosition - vWorldPosition );\n  vec3 worldReflect = reflect( -viewDir, worldNormal );\n\n  #if pureGloss\n    vec3 specularColor = 0.15 * SampleEnvHi( tEnvHi, worldReflect );\n  #else\n    vec3 specularColor = SpecularIBL( tEnv, worldReflect, 1.0-gloss() );\n  #endif\n\n  #pragma SLOT lightsf\n\n\n  float NoV = sdot( viewDir, worldNormal );\n  vec3 specularSq = specular()*specular();\n  specularColor *= F_Schlick( NoV, specularSq, gloss() );\n\n\n  vec3 alb = albedo();\n  #if conserveEnergy\n    alb = alb - alb * specular();\n  #endif\n  vec3 albedoSq = alb*alb;\n\n\n  #if HAS_occlusion\n    diffuseCoef *= occlusion();\n  #endif\n\n\n  #if HAS_cavity\n    #ifndef cavityStrength\n      #define cavityStrength(k) vec2(1.0)\n    #endif\n    diffuseCoef   *= cavity() * cavityStrength().r + (1.0-cavityStrength().r);\n    specularColor *= cavity() * cavityStrength().g + (1.0-cavityStrength().g);\n  #endif\n\n\n  #if HAS_emissive\n    float e = emissive();\n    #if HAS_emissiveScale\n      e = e * emissiveScale();\n    #endif\n    diffuseCoef += vec3( e ) * albedo();\n  #endif\n\n\n  FragColor.xyz = diffuseCoef * albedoSq + specularColor;\n\n  #if HAS_exposure\n    FragColor.xyz *= vec3( exposure() );\n  #endif\n\n  \n  #if gammaMode( GAMMA_STD ) && HAS_gamma\n    FragColor.xyz = pow( FragColor.xyz, vec3( gamma() ) );\n  #endif\n\n  #if gammaMode( GAMMA_2_2 )\n    FragColor.xyz = pow( FragColor.xyz, vec3( 1.0/2.2 ) );\n  #endif\n\n  #if gammaMode( GAMMA_TB )\n    {\n      vec3 c = FragColor.xyz;\n      vec3 sqrtc = sqrt( c );\n      FragColor.xyz = (sqrtc-sqrtc*c) + c*(0.4672*c+vec3(0.5328));\n    }\n  #endif\n\n  #if HAS_alpha\n    FragColor.a = alpha();\n  #else\n    FragColor.a = uAlpha;\n  #endif\n\n  #if fog\n    '+n(35)()+"\n  #endif\n}\n"};r.toString=r,e.exports=r},function(e,t){var n=function(e){var t="";return t+="#define GLSLIFY 1\n#pragma SLOT pv\n\n#if __VERSION__ == 300\n  #define IN in\n  #define OUT out\n#else\n  #define IN attribute\n  #define OUT varying\n#endif\n\nattribute vec3 aPosition;\nattribute vec2 aTexCoord;\n\nuniform mat4 uMVP;\nuniform mat4 uWorldMatrix;\n\nOUT vec2 vTexCoord;\nOUT vec3 vWorldPosition;\n\nvoid main( void ) {\n  vec4 pos = vec4( aPosition, 1.0 );\n  gl_Position = uMVP * pos;\n\n  vTexCoord = aTexCoord;\n  vWorldPosition = (uWorldMatrix * pos).xyz;\n}\n"};n.toString=n,e.exports=n},function(e,t,n){var r=function(e){var t="";return t+="#define GLSLIFY 1\n#if __VERSION__ == 300\n  #define IN in\n  out vec4 FragColor;\n  #define texture2D(a,b) texture( a, b )\n#else\n  #define IN varying\n  #define FragColor gl_FragColor\n#endif\n\nIN vec2 vTexCoord;\nIN vec3 vWorldPosition;\n\n"+n(25)()+"\n\n#pragma SLOT pf\n\nvoid main( void ) {\n  #pragma SLOT f\n\n  FragColor = color();\n  \n  "+n(26)()+"\n\n  // FragColor.rgb = vec3( gloss() );\n  // FragColor.rgb = vec3( albedo() );\n  // FragColor.rgb = vec3( specular() );\n  // FragColor.rgb = vec3( normal() );\n}\n"};r.toString=r,e.exports=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},l=n(1),c=n(4),f=r(c),d=n(71),h=r(d),p=n(60),v=r(p),m=n(219),g=r(m),_=n(104),y=r(_),b=n(228),w=r(b),M=n(59),x=l.vec3.create(),S=l.vec3.create(),P=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,"car"));return n.keepBufferMeshes=[/picking_/gi],n.wheelRotation=0,n.viewsEnabled=!1,n.carContainerNode=new f.default,n.carContainerNode.add(n.node),n.reflect=new y.default(e),n.shadowBounds=new v.default,n.shadowBounds.isVisible=!0,n.shadowBounds.fromPoints(n.scene.car.getShadowBounds()),e.lights.setup.bounds=n.shadowBounds,n.collisionBounds=new v.default,n.collisionBounds.isVisible=!0,n.collisionBounds.color=[0,0,1],n.collisionBounds.fromPoints(n.scene.car.getCollisionBounds()),n.interior=new w.default(e),n.carContainerNode.add(n.interior),n}return a(t,e),s(t,[{key:"getGLTFUrl",value:function(){return"car.glb"}},{key:"preRender",value:function(e){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"preRender",this).call(this,e),this.views&&this.viewsEnabled&&this.views.preRender(e)}},{key:"renderReflect",value:function(e,t){var n=this.scene,r=this.scene.glstate,i=this.gl;r.push(this.reflect.cfg),r.apply(),this.reflect.processCamera(n.camera),this.reflect.prepare(e,t,.25),this.updateRenderMode(M.RENDER_MODES.REFLECT),n.renderCar(!1),this.updateRenderMode(M.RENDER_MODES.DEFAULT),this.reflect.restoreCamera(n.camera),r.pop(),this.reflect.processOutput(),i.bindFramebuffer(i.FRAMEBUFFER,null)}},{key:"renderInterior",value:function(){this.interior.render()}},{key:"renderViews",value:function(){this.views&&this.viewsEnabled&&this.views.render()}},{key:"updateRenderMode",value:function(e){for(var t=this.mats.matlist,n=0,r=t.length;n<r;n++){var i=t[n];i.renderMode!==M.RENDER_MODES.DISABLED&&(i.renderMode=e)}}},{key:"syncBounds",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.newMode,n=void 0!==t&&t,r=e.shadow,i=void 0===r||r;this.body&&this.carContainerNode&&(i&&this._syncBounds(n,this.shadowBounds),this._syncBounds(n,this.collisionBounds))}},{key:"toggleViews",value:function(e){this.viewsEnabled=e}},{key:"rotateWheels",value:function(e){var t=this.wheels;for(var n in t){t[n].rotateY(e)}}},{key:"_onLoad",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_onLoad",this).call(this);var e=this.scene.environmentScene.mats.getMaterial("ground");e.carReflectFbo=this.reflect.getOutput(),this.groundMaterial=e,this.groundCavity=this.getNodeByName("ground_cavity"),this.views=new g.default(this.scene,this),this.carContainerNode.add(this.views),this.wheels={fl:this.getNodeByName("wheel_fl"),fr:this.getNodeByName("wheel_fr"),rl:this.getNodeByName("wheel_rl"),rr:this.getNodeByName("wheel_rr")},this.steerings={fl:this.getNodeByName("steering_fl"),fr:this.getNodeByName("steering_fr"),rl:this.getNodeByName("steering_rl"),rr:this.getNodeByName("steering_rr")},this.body=this.getNodeByName("body")}},{key:"_syncBounds",value:function(e,t){e?(l.vec3.copy(x,this.body.position),l.vec3.scale(x,x,100),S[0]=x[0],S[1]=x[2]+.5*(t.max[2]-t.min[2]),S[2]=-x[1],t.fromCenterSize(S)):(l.vec3.copy(x,this.carContainerNode.position),x[1]+=.5*(t.max[1]-t.min[1]),t.fromCenterSize(x))}}]),t}(h.default);t.default=P,e.exports=t.default},function(e,t,n){"use strict";(function(r){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t,n,r,i){var o={};return Object.keys(r).forEach(function(e){o[e]=r[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}Object.defineProperty(t,"__esModule",{value:!0});var l,c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=n(1),d=n(4),h=i(d),p=n(19),v=i(p),m=n(52),g=n(15),_=i(g),y=n(16),b=i(y),w=n(54),M=i(w),x=n(220),S=i(x),P=f.vec3.create(),C=f.mat4.create(),T={POINT_OFFSET:.038,NB_COMPS:5},A=new Float32Array(1),O=(l=function(e){function t(e,n){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));r.scene=e,r.carScene=n,r.time=0,r.alpha=1,r.color=[.8,.8,.8],r.points=null,r.isInView=!1,r.isIntersecting=!1,r.viewIntersecting=null,r.viewIntersectingIdx=-1,r.viewIntersectingTransition=0,r.viewPicking=[],r.viewsData=r.scene.car.configurator.model.getViewsData(),r.viewCount=0,r.viewPositions=[];var i=e.gl;return r.cfg=e.glstate.config().enableDepthTest(!0).enableBlend().blendFunc(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA),r._bind(),r._countTotalViews(),r._createPicking(),r._createCircles(),r}return s(t,e),c(t,[{key:"preRender",value:function(e){this.time+=e;for(var t=this.viewPicking,n=0,r=t.length;n<r;n++){var i=t[n];i.enabled&&i.prePrender(e)}this._updatePointerCursor(),this._updateViewPositions()}},{key:"render",value:function(){var e=this.scene,t=e.camera,n=e.programs.viewCircle,r=this.points;this.cfg.apply(),n.use(),t.modelViewProjectionMatrix(C,this._wmatrix),n.uMVP(C),n.uAspect(_.default.aspect),n.uTime(this.time),n.uAlpha(this.alpha),n.uIntersecting(BrowserDetect.isDesktop?this.viewIntersectingIdx:-1),n.uIntersectingTransition(this.viewIntersectingTransition),n.uColor(this.color),r.attribPointer(n),r.bind(),r.drawPoints()}},{key:"toggleByRegex",value:function(e,t){for(var n=this.viewPicking,r=0,i=n.length;r<i;r++){var o=n[r];if(o.name.match(e)){o.enabled=t,A[0]=t;var a=(o.idx+1)*T.NB_COMPS*4-4;this.points.subData(A,a)}}}},{key:"_bind",value:function(){M.default.upped.add(this._onPointerUpped),b.default.views.updated.add(this._onViewsUpdated),b.default.library.updated.add(this._onLibraryUpdated)}},{key:"_unbind",value:function(){M.default.upped.remove(this._onPointerUpped),b.default.views.updated.remove(this._onViewsUpdated),b.default.library.updated.remove(this._onLibraryUpdated)}},{key:"_countTotalViews",value:function(){for(var e=this.viewsData,t=0,n=e.length;t<n;t++){var r=e[t];r.hotspot&&(this.viewCount+=!0===r.symmetry?2:1)}}},{key:"_createPicking",value:function(){for(var e=0,t=0,n=this.viewsData.length;e<n;e++){var r=this.viewsData[e];if(r.enabled)if(!0===r.symmetry&&r.picking){var i={idx:t,picking:r.picking+"-right",name:r.name,side:"right"},o=new S.default(this.scene,this,i);this.viewPicking.push(o);var a={idx:t+1,picking:r.picking+"-left",name:r.name,side:"left"},s=new S.default(this.scene,this,a);this.viewPicking.push(s),t+=2}else if(r.picking){var u={idx:t,picking:r.picking,name:r.name},l=new S.default(this.scene,this,u);this.viewPicking.push(l),t+=1}}}},{key:"_createCircles",value:function(){for(var e=this.viewsData,t=e.length,n=new Float32Array(this.viewCount*T.NB_COMPS),r=0,i=0;r<t;r++){var o=e[r];if(o.hotspot&&o.enabled)if(!0===o.symmetry&&o.picking){var a=this.carScene.getNodeByName(o.picking+"-right_position"),s=this.carScene.getNodeByName(o.picking+"-left_position");this._hydrateBufferData(n,T.NB_COMPS,i,a,o),this._hydrateBufferData(n,T.NB_COMPS,i+1,s,o),i+=2}else{var u=this.carScene.getNodeByName(o.picking+"_position");this._hydrateBufferData(n,T.NB_COMPS,i,u,o),i+=1}}var l=this.scene.gl,c=new v.default(this.scene.gl,n);c.attrib("aPosition",3,l.FLOAT),c.attrib("aIndex",1,l.FLOAT),c.attrib("aAlpha",1,l.FLOAT),this.points=c}},{key:"_hydrateBufferData",value:function(e,t,n,r,i){r.updateWorldMatrix(),f.mat4.getTranslation(P,r._wmatrix);var o=0;if(i.offset){var a=Math.sign(P[2]);o=T.POINT_OFFSET*a}e[n*t]=P[0],e[n*t+1]=P[1],e[n*t+2]=P[2]+o,e[n*t+3]=n,e[n*t+4]=0}},{key:"_updatePointerCursor",value:function(){var e=this.isIntersecting;this.isIntersecting=!1,this.viewIntersecting=null;for(var t=this.viewPicking,n=0,r=t.length;n<r;n++){var i=t[n];if(this.isIntersecting=i.isIntersecting,this.isIntersecting&&i.enabled){this.viewIntersecting=i,this.viewIntersectingIdx=i.idx;break}}!this.isIntersecting||e||this.isInView?!this.isIntersecting&&e&&(M.default.removeCursor(),TweenMax.to(this,1,{viewIntersectingTransition:0,ease:Expo.easeOut})):(M.default.addCursor("pointer"),TweenMax.to(this,1,{viewIntersectingTransition:1,ease:Expo.easeOut}))}},{key:"_updateViewPositions",value:function(){for(var e=0,t=this.viewsData.length;e<t;e++){var n=this.viewsData[e];n.hotspot&&(!0===n.symmetry?(this._updateViewPosition(n,"right"),this._updateViewPosition(n,"left")):this._updateViewPosition(n))}}},{key:"_updateViewPosition",value:function(e,t){var n=this.carScene.getNodeByName(e.picking+(t?"-"+t:"")+"_position");n.updateWorldMatrix(),f.mat4.getTranslation(P,n._wmatrix);var r=e.picking+(t?"-"+t:"");this.viewPositions[r]||(this.viewPositions[r]=f.vec3.create()),f.vec3.copy(this.viewPositions[r],P)}},{key:"_updateIsInView",value:function(e){this.isInView=e,e?TweenMax.to(this,1,{alpha:0,ease:Expo.easeOut}):TweenMax.to(this,3,{alpha:1,ease:Expo.easeOut})}},{key:"_onPointerUpped",value:function(e){if(0===e.button||!BrowserDetect.isDesktop||M.default.isTouchDevice){var t=this.viewIntersecting;if(t&&"interior"===t.name&&!M.default.hasMoved)b.default.interior.inside.dispatch(t.side);else if(t&&"interior_door"===t.name&&!M.default.hasMoved)b.default.interior.outside.dispatch(t.side);else if(t&&t.name.match(/interior_/)&&!M.default.hasMoved){var n="configurator.interior_popups."+t.name.replace("interior_","");b.default.popup.open.dispatch(n,!0)}else if(this.isInView)this._updateIsInView(!1),b.default.views.reset.dispatch();else if(t&&!M.default.hasMoved){this._updateIsInView(!0);var r=t.name,i=t.side;b.default.views.update.dispatch({name:r,side:i})}}}},{key:"_onViewsUpdated",value:function(e){this._updateIsInView(e.canReset)}},{key:"_onLibraryUpdated",value:function(e){var t=e.partCfg;e.partName;t.hotspotColor&&(0,m.HexToVec)(parseInt(t.hotspotColor.replace("#",""),16),this.color)}}]),t}(h.default),u(l.prototype,"_onPointerUpped",[r],Object.getOwnPropertyDescriptor(l.prototype,"_onPointerUpped"),l.prototype),u(l.prototype,"_onViewsUpdated",[r],Object.getOwnPropertyDescriptor(l.prototype,"_onViewsUpdated"),l.prototype),u(l.prototype,"_onLibraryUpdated",[r],Object.getOwnPropertyDescriptor(l.prototype,"_onLibraryUpdated"),l.prototype),l);t.default=O,e.exports=t.default}).call(t,n(2).bind)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(1),s=n(221),u=r(s),l=n(222),c=r(l),f=a.vec3.create(),d=function(){function e(t,n,r){i(this,e),this.scene=t,this.ctrl=n,this.data=r,this.enabled=r.enabled,this.idx=r.idx,this.name=r.name,this.side=r.side,this.offset=r.offset,this.enabled=!1,this.picking=null,this.ray=null,this.isIntersecting=0,this.isActive=!1,this.pickingMesh=null,this._create()}return o(e,[{key:"prePrender",value:function(e){this.picking&&this.ray&&this.pickingMesh&&(this.ray.preRender(),this.isIntersecting=0!==this.picking.run(this.ray),this._updatePickingVerts())}},{key:"_create",value:function(){var e=this.scene.carScene.getMeshByName(this.data.picking);if(!e)return void console.warn("Picking mesh '"+this.data.picking+"' not found");this.pickingMesh=e;var t=e.geom.subgeoms[0],n=t.vertices,r=t.indices;this.picking=new u.default({verts:n,indices:r}),this.ray=new c.default(this.scene.carScene.scene)}},{key:"_updatePickingVerts",value:function(){var e=this.pickingMesh;e.updateWorldMatrix();var t=e.geom.subgeoms[0];if(t.vertices){for(var n=t.vertices,r=[],i=0,o=n.length;i<o;i+=3){var s=n[i],u=n[i+1],l=n[i+2];a.vec3.set(f,s,u,l),a.vec3.transformMat4(f,f,e._wmatrix),r[i]=f[0],r[i+1]=f[1],r[i+2]=f[2]}this.picking.datas.verts=r}}}]),e}();t.default=d,e.exports=t.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(1),a=o.vec3.create(),s=o.vec3.create(),u=o.vec3.create(),l=o.vec3.create(),c=o.vec3.create(),f=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];r(this,e),this.datas=t,this.doubleSided=!!n}return i(e,[{key:"run",value:function(e){for(var t=e.pos,n=e.dir,r=this.datas.indices,i=this.datas.verts,f=void 0,d=void 0,h=void 0,p=void 0,v=0,m=r.length;v<m;v+=3){f=3*r[v+0],d=3*r[v+1],h=3*r[v+2],a[0]=i[d+0]-i[f+0],a[1]=i[d+1]-i[f+1],a[2]=i[d+2]-i[f+2],s[0]=i[h+0]-i[f+0],s[1]=i[h+1]-i[f+1],s[2]=i[h+2]-i[f+2],o.vec3.cross(u,a,s);var g=o.vec3.dot(n,u);if(g>0){if(!this.doubleSided)continue;p=1}else{if(!(g<0))continue;p=-1,g=-g}l[0]=t[0]-i[f+0],l[1]=t[1]-i[f+1],l[2]=t[2]-i[f+2],o.vec3.cross(c,l,s);var _=p*o.vec3.dot(n,c);if(!(_<0)){o.vec3.cross(c,a,l);var y=p*o.vec3.dot(n,c);if(!(y<0||_+y>g)){var b=-p*o.vec3.dot(l,u);if(!(b<0))return o.vec3.scaleAndAdd(c,t,n,b/g),p}}}return 0}},{key:"getPos",value:function(){return c}}]),e}();t.default=f,e.exports=t.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(1),a=n(54),s=function(e){return e&&e.__esModule?e:{default:e}}(a),u=o.mat4.create(),l=o.mat3.create(),c=function(){function e(t){r(this,e),this.scene=t,this.mouse=o.vec3.create(),this.pos=o.vec3.create(),this.dir=o.vec3.create(),this.mouse[2]=1}return i(e,[{key:"update",value:function(e){this.mouse[0]=2*e.x-1,this.mouse[1]=-(2*e.y-1);var t=this.scene.camera;o.vec3.copy(this.pos,t._wposition),o.mat4.invert(u,t._viewProj),o.vec3.transformMat4(this.dir,this.mouse,u),o.mat4.invert(u,this.scene.root._wmatrix),o.mat3.fromMat4(l,u),o.vec3.transformMat3(this.dir,this.dir,l),o.vec3.transformMat4(this.pos,this.pos,u),o.vec3.subtract(this.dir,this.dir,this.pos),o.vec3.normalize(this.dir,this.dir)}},{key:"preRender",value:function(){this.update(s.default.client.norm)}}]),e}();t.default=c,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(1),s=n(27),u=r(s),l=n(56),c=r(l),f=n(105),d=r(f),h=function(){function e(t,r){i(this,e),this.scene=t,this.sizeMult=r;var o=t.gl;this.gl=o,this.blurSamples=8,this.size=a.vec2.create(),this.spread=.5,this.quad=new d.default(o),this.blurCfg=t.glstate.config().enableCullface(!1).depthMask(!1).enableDepthTest(!1),this.blurPrg=new u.default(o,n(226),n(227),"#define NUM_SAMPLES "+this.blurSamples),this.blurKernelA=new Float32Array(3*this.blurSamples),this.blurKernelB=new Float32Array(3*this.blurSamples),this.updateKernels(),this.blurA_fbo=this.makeBlurFbo(),this.blurB_fbo=this.makeBlurFbo()}return o(e,[{key:"process",value:function(e){var t=this.blurPrg,n=this.gl;n.clearColor(0,0,0,0),this.blurCfg.apply(),t.use(),t.uSpread(this.spread),t.uResolution(this.size);var r=this.quad;r.attribPointer(t),this.blurA_fbo.bind(),n.clear(n.COLOR_BUFFER_BIT),t.tInput(e),t.uKernel(this.blurKernelA),r.render(),this.blurB_fbo.bind(),n.clear(n.COLOR_BUFFER_BIT),t.tInput(this.blurA_fbo.getColor()),t.uKernel(this.blurKernelB),r.render()}},{key:"resize",value:function(e,t){var n=Math.floor(e*this.sizeMult),r=Math.floor(t*this.sizeMult);this.size[0]===n&&this.size[1]===r||(this.size[0]=n,this.size[1]=r,this.blurA_fbo.resize(n,r),this.blurB_fbo.resize(n,r),this.updateKernels())}},{key:"getBlurredTex",value:function(){return this.blurB_fbo.getColor()}},{key:"makeBlurFbo",value:function(){var e=new c.default(this.gl);return e.resize(this.size[0],this.size[1]),e.attachColor(),e.getColor().bind(),e.getColor().clamp(),e.getColor().setFilter(!0,!1,!1),e}},{key:"computeKernel",value:function(e,t,n){for(var r=t?0:1,i=t?1:0,o=Math.sqrt(Math.PI),a=0,s=0;s<this.blurSamples;++s){var u=3*s,l=s-Math.round((this.blurSamples-1)/2),c=4*l/this.blurSamples;c=Math.exp(-c*c/2)/o,a+=c,e[u+r]=l*n,e[u+i]=0,e[u+2]=c}for(s=0;s<this.blurSamples;++s)e[3*s+2]/=a}},{key:"updateKernels",value:function(){this.computeKernel(this.blurKernelA,!0,1/this.size[0]),this.computeKernel(this.blurKernelB,!1,1/this.size[1])}}]),e}();t.default=h,e.exports=t.default},function(e,t,n){function r(e,t,n){this.gl=e,this.usage=n||e.STATIC_DRAW,this.buffer=e.createBuffer(),this.attribs=[],this.stride=0,this.byteLength=0,this.length=0,t&&this.data(t)}var i=n(225),o=34962;r.prototype={bind:function(){this.gl.bindBuffer(o,this.buffer)},attrib:function(e,t,n,r){return this.attribs.push({name:e,type:0|n,size:0|t,normalize:!!r,offset:this.stride}),this.stride+=i.getComponentSize(n)*t,this._computeLength(),this},data:function(e){var t=this.gl;t.bindBuffer(o,this.buffer),t.bufferData(o,e,this.usage),t.bindBuffer(o,null),this.byteLength=void 0===e.byteLength?e:e.byteLength,this._computeLength()},subData:function(e,t){var n=this.gl;n.bindBuffer(o,this.buffer),n.bufferSubData(o,t,e),n.bindBuffer(o,null)},attribPointer:function(e){var t=this.gl;t.bindBuffer(o,this.buffer);for(var n=0;n<this.attribs.length;n++){var r=this.attribs[n];if(void 0!==e[r.name]){var i=e[r.name]();t.enableVertexAttribArray(i),t.vertexAttribPointer(i,r.size,r.type,r.normalize,this.stride,r.offset)}}},draw:function(e,t,n){t=void 0===t?this.length:t,this.gl.drawArrays(e,n,0|t)},dispose:function(){this.gl.deleteBuffer(this.buffer),this.buffer=null,this.gl=null},_computeLength:function(){this.stride>0&&(this.length=this.byteLength/this.stride)}},i.Drawable(r.prototype),e.exports=r},function(e,t){e.exports={getComponentSize:function(e){switch(e){case 5120:case 5121:return 1;case 5122:case 5123:return 2;case 5124:case 5125:case 5126:return 4;default:return 0}},Drawable:function(e){e.drawPoints=function(e,t){this.draw(0,e,t)},e.drawLines=function(e,t){this.draw(1,e,t)},e.drawLineLoop=function(e,t){this.draw(2,e,t)},e.drawLineStrip=function(e,t){this.draw(3,e,t)},e.drawTriangles=function(e,t){this.draw(4,e,t)},e.drawTriangleStrip=function(e,t){this.draw(5,e,t)},e.drawTriangleFan=function(e,t){this.draw(6,e,t)}}}},function(e,t){var n=function(e){var t="";return t+="precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 aPosition;\nattribute vec2 aTexCoord;\n\nvarying vec2 vTexCoord;\n  \nvoid main( void ) {\n  gl_Position = vec4( aPosition, 0.0, 1.0 );\n  vTexCoord = aTexCoord;\n}\n"};n.toString=n,e.exports=n},function(e,t){var n=function(e){var t="";return t+="precision highp float;\n#define GLSLIFY 1\n\nvarying vec2 vTexCoord;\n\nuniform sampler2D tInput;\nuniform float uSpread;\nuniform vec3 uKernel[NUM_SAMPLES];\nuniform vec2 uResolution;\n\nvoid main(void) {\n  vec3 color = vec3( 0.0 );\n  uResolution;\n  uSpread;\n  uKernel;\n  tInput;\n  for(int i = 0; i < NUM_SAMPLES; ++i) {\n    vec3 kernel = uKernel[i].xyz;\n    color += texture2D( tInput, gl_FragCoord.xy / uResolution + kernel.xy * uSpread ).xyz * kernel.z;\n  }\n\n  // color = texture2D(tInput,  gl_FragCoord.xy / uResolution).rgb;\n\n  gl_FragColor = vec4( color, 0.0 );\n}\n"};n.toString=n,e.exports=n},function(e,t,n){"use strict";(function(r){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t,n,r,i){var o={};return Object.keys(r).forEach(function(e){o[e]=r[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}Object.defineProperty(t,"__esModule",{value:!0});var l,c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=n(1),d=n(4),h=i(d),p=n(229),v=i(p),m=n(16),g=i(m),_=n(18),y=f.mat4.create(),b=(l=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));n.scene=e;var r=e.gl;return n.gl=r,n.geom=new v.default(r),n.cfg=e.glstate.config(),n.cfg.enableCullface(!0).enableDepthTest(!1).enableBlend().blendFunc(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA),n.rotateY(Math.PI/2),n.rotateX(Math.PI/180*-19),n.opacity=-10,n.blurredProgress=0,n.tex=null,n.texBlurred=null,n.configName=null,n.debugOpts={x:.21,y:1.27,z:.36,s:.66},n._bind(),n._createGUI(),n._onGUIChange(),n}return s(t,e),c(t,[{key:"render",value:function(){var e=this.scene;this.time+=e.dt;var t=e.orbitCtrl,n=t.insideTime,r="left"===t.interiorSide?.48:.46,i="left"===t.interiorSide?.53:.5;if(this.opacity=(0,_.map)(n,r,i,0,1),0===this.opacity&&(this.time=0),this.opacity>0){var o=e.programs.interior;o.use(),e.camera.modelViewProjectionMatrix(y,this._wmatrix),o.uMVP(y),o.tCube(this.tex),o.tCubeBlurred(this.texBlurred),o.uOpacity(this.opacity),o.uBlurredProgress(this.blurredProgress),this.geom.setup(o),this.cfg.apply(),this.geom.render()}}},{key:"_bind",value:function(){g.default.configs.updated.add(this._onConfigsUpdated),g.default.popup.opened.add(this._onPopupOpened),g.default.popup.closed.add(this._onPopupClosed)}},{key:"_unbind",value:function(){g.default.configs.updated.remove(this._onConfigsUpdated),g.default.popup.opened.remove(this._onPopupOpened),g.default.popup.closed.remove(this._onPopupClosed)}},{key:"_createGUI",value:function(){this.gui=gui.addFolder("Interior"),this.gui.add(this.debugOpts,"x",-8,8,.01).onChange(this._onGUIChange),this.gui.add(this.debugOpts,"y",-8,8,.01).onChange(this._onGUIChange),this.gui.add(this.debugOpts,"z",-8,8,.01).onChange(this._onGUIChange),this.gui.add(this.debugOpts,"s",.1,100,.01).onChange(this._onGUIChange),this.gui.add(this,"opacity",0,1,.01).onChange(this._onGUIChange)}},{key:"_getTexture",value:function(e){return this.scene.car.getModule("configurator").textures.getTexture(e)}},{key:"_onGUIChange",value:function(){this.position[0]=this.debugOpts.x,this.position[1]=this.debugOpts.y,this.position[2]=this.debugOpts.z,this.setScale(this.debugOpts.s),this.invalidate(),this.updateWorldMatrix()}},{key:"_onConfigsUpdated",value:function(e){this.configName=e.name,this.tex=this._getTexture(e.name),this.texBlurred=this._getTexture(e.name+"-blurred")}},{key:"_onPopupOpened",value:function(){TweenLite.to(this,1,{blurredProgress:1})}},{key:"_onPopupClosed",value:function(){TweenLite.to(this,1,{blurredProgress:0})}}]),t}(h.default),u(l.prototype,"_onGUIChange",[r],Object.getOwnPropertyDescriptor(l.prototype,"_onGUIChange"),l.prototype),u(l.prototype,"_onConfigsUpdated",[r],Object.getOwnPropertyDescriptor(l.prototype,"_onConfigsUpdated"),l.prototype),u(l.prototype,"_onPopupOpened",[r],Object.getOwnPropertyDescriptor(l.prototype,"_onPopupOpened"),l.prototype),u(l.prototype,"_onPopupClosed",[r],Object.getOwnPropertyDescriptor(l.prototype,"_onPopupClosed"),l.prototype),l);t.default=b,e.exports=t.default}).call(t,n(2).bind)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(19),s=r(a),u=n(61),l=r(u),c=1/1024,f=new Float32Array([-1,1,-1,-c,0,-c,1,1,-1,c,0,-c,1,1,1,c,0,c,-1,1,1,-c,0,c,1,-1,-1,c,0,-c,-1,-1,-1,-c,0,-c,-1,-1,1,-c,0,c,1,-1,1,c,0,c,1,1,-1,c,c,0,-1,1,-1,-c,c,0,-1,-1,-1,-c,-c,0,1,-1,-1,c,-c,0,-1,1,1,-c,c,0,1,1,1,c,c,0,1,-1,1,c,-c,0,-1,-1,1,-c,-c,0,-1,1,-1,0,c,-c,-1,1,1,0,c,c,-1,-1,1,0,-c,c,-1,-1,-1,0,-c,-c,1,1,1,0,c,c,1,1,-1,0,c,-c,1,-1,-1,0,-c,-c,1,-1,1,0,-c,c]),d=new Uint8Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),h=function(){function e(t){i(this,e),this.vbuffer=new s.default(t,f),this.ibuffer=new l.default(t,t.UNSIGNED_BYTE,d),this.vbuffer.attrib("aPosition",3,t.FLOAT),this.vbuffer.attrib("aDirection",3,t.FLOAT)}return o(e,[{key:"setup",value:function(e){this.vbuffer.attribPointer(e),this.ibuffer.bind()}},{key:"render",value:function(){this.ibuffer.drawTriangles()}}]),e}();t.default=h,e.exports=t.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t,n){var r=void 0,i=void 0;e.touches&&e.touches[0]?(r=e.touches[0].clientX,i=e.touches[0].clientY):(r=e.clientX,i=e.clientY),n[0]=2*r/t.width-1,n[1]=-(2*i/t.height-1)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(1),s=a.vec3.create(),u=function(){function e(t){r(this,e),this.el=t,this.rotateSpeed=30,this.wheelSpeed=.5,this.dragSpeed=5,this.dist=5,this.minDist=1,this.maxDist=100,this.center=a.vec3.fromValues(0,0,0),this._theta=.2*-Math.PI,this._phi=.4*Math.PI,this.mouseButton1=!1,this.mouseButton2=!1,this.mouse=a.vec3.fromValues(0,0,1),this.mStartDrag=a.vec3.fromValues(0,0,1),this.mDrag=a.vec3.fromValues(0,0,1),this.pan=a.vec3.fromValues(0,0,0),this.panInitialX=a.vec3.create(),this.panInitialY=a.quat.create(),this.panInitialP=a.vec3.create(),this._drag=a.vec3.fromValues(this._theta,this._phi,1),this.ctrl=null,this.camera=null,this.onMouseMove=this._onMouseMove.bind(this),this.onMouseDown=this._onMouseDown.bind(this),this.onMouseUp=this._onMouseUp.bind(this),this.onMouseWheel=this._onMouseWheel.bind(this),this.onRightClick=this._onRightClick.bind(this)}return o(e,[{key:"start",value:function(e){this.ctrl=e,this.camera=e.camera,this.el.addEventListener("mousemove",this.onMouseMove),this.el.addEventListener("touchmove",this.onMouseMove),this.el.addEventListener("touchstart",this.onMouseDown),this.el.addEventListener("mousedown",this.onMouseDown),this.el.addEventListener("mouseup",this.onMouseUp),this.el.addEventListener("touchend",this.onMouseUp),this.el.addEventListener("wheel",this.onMouseWheel),this.el.addEventListener("contextmenu",this.onRightClick),this.onMouseDown({clientX:0,clientY:0}),this.onMouseMove({clientX:0,clientY:0}),this.onMouseUp({clientX:0,clientY:0})}},{key:"stop",value:function(){this.ctrl=null,this.camera=null,this.el.removeEventListener("mousemove",this.onMouseMove),this.el.removeEventListener("touchmove",this.onMouseMove),this.el.removeEventListener("touchstart",this.onMouseDown),this.el.removeEventListener("mousedown",this.onMouseDown),this.el.removeEventListener("mouseup",this.onMouseUp),this.el.removeEventListener("touchend",this.onMouseUp),this.el.removeEventListener("wheel",this.onMouseWheel),this.el.removeEventListener("contextmenu",this.onRightClick)}},{key:"_onMouseWheel",value:function(e){var t=e.deltaY>0?1:-1;t*=this.wheelSpeed,this.dist+=t,this.dist=Math.max(this.minDist,Math.min(this.dist,this.maxDist))}},{key:"_onMouseDown",value:function(e){this.mouseButton1=!0,i(e,this.el,this.mouse),a.vec3.copy(this.mStartDrag,this.mouse)}},{key:"_onRightClick",value:function(e){return e.preventDefault(),this.mouseButton2=!0,i(e,this.el,this.mouse),a.vec3.copy(this.panInitialX,this.camera._matrix),a.vec3.copy(this.panInitialP,this.camera.position),this.panInitialY[0]=this.camera._matrix[4],this.panInitialY[1]=this.camera._matrix[5],this.panInitialY[2]=this.camera._matrix[6],a.vec3.copy(this.mStartDrag,this.mouse),!1}},{key:"_onMouseMove",value:function(e){if(this.mouseButton1){if(this.mouseButton2)return void this._pan(e);i(e,this.el,this.mouse),this.mDrag[0]=this.mouse[0]-this.mStartDrag[0],this.mDrag[1]=this.mouse[1]-this.mStartDrag[1],a.vec3.copy(this.mStartDrag,this.mouse),this._drag[0]-=this.mDrag[0]*this.dragSpeed/4,this._drag[1]+=this.mDrag[1]*this.dragSpeed/4,this._drag[1]<=.001&&(this._drag[1]=.001),this._drag[1]>=Math.PI-.001&&(this._drag[1]=Math.PI-.001)}}},{key:"_onMouseUp",value:function(e){this.mouseButton1=!1,this.mouseButton2=!1}},{key:"_pan",value:function(e){i(e,this.el,this.mouse),this.mDrag[0]=this.mouse[0]-this.mStartDrag[0],this.mDrag[1]=this.mouse[1]-this.mStartDrag[1],a.vec3.copy(this.mStartDrag,this.mouse);var t=a.vec3.create();a.vec3.scale(t,this.panInitialX,-this.mDrag[0]*this.dragSpeed),a.vec3.scaleAndAdd(t,t,this.panInitialY,-this.mDrag[1]*this.dragSpeed),this.pan=t}},{key:"update",value:function(e){if(this.camera){var t=this.dist,n=e*this.rotateSpeed;this._theta+=(this._drag[0]-this._theta)*n,this._phi+=(this._drag[1]-this._phi)*n,this.rnd=Math.floor(this._theta/(2*Math.PI)),s[0]=this.center[0]+t*Math.sin(this._phi)*Math.sin(this._theta),s[1]=this.center[1]+t*Math.cos(this._phi),s[2]=this.center[2]+t*Math.sin(this._phi)*Math.cos(this._theta),a.vec3.copy(this.camera.position,s),a.vec3.add(this.camera.position,this.camera.position,this.pan),a.vec3.add(this.center,this.center,this.pan),this.pan=a.vec3.create(),this.camera.lookAt(this.center),this.camera.invalidate()}}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){"use strict";(function(r){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t,n,r,i){var o={};return Object.keys(r).forEach(function(e){o[e]=r[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}Object.defineProperty(t,"__esModule",{value:!0});var s,u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(1),c=n(15),f=i(c),d=n(16),h=i(d),p=n(54),v=i(p),m=n(106),g=i(m),_=n(18),y=l.vec2.create(),b=l.vec3.create(),w=l.vec3.create(),M={IDLE_DURATION:3,INSIDE_DURATION:2,ORBIT:{SENSITIVITY:1.8,BOUNDS:{MIN:-.7,MAX:-.1}},VR:{SENSITIVITY:1.2,BOUNDS:{MIN:-1.2,MAX:.2}}},x={IDLE:0,DRAG:1,VIEW:2},S={x:.21,y:1.27,z:.36,fov:65},P=(s=function(){function e(t){o(this,e),this.el=t,this.ctrl=null,this.scene=null,this.camera=null,this.rotations=l.vec2.fromValues(Math.PI,-.4),this.srotations=l.vec2.create(),l.vec2.copy(this.srotations,this.rotations),this.center=l.vec3.fromValues(0,.65,0),this.orbitCenter=l.vec3.fromValues(0,.65,0),this.interiorCenter=l.vec3.fromValues(S.x,S.y,S.z),this.lookAt=l.vec3.create(),l.vec3.copy(this.lookAt,this.center),this._baseLookAt=l.vec3.create(),this.radius=5,this.defaultRadius=this.radius,this.orbitRadius=this.radius,this.defaultDragRadius=4,this.dragRadius=this.defaultDragRadius,this.orbitDirection=1,this.targetRotationY=-.1,this.orbitBounds={min:M.ORBIT.BOUNDS.MIN,max:M.ORBIT.BOUNDS.MAX},this.elliptic=1.2,this.zoomProgress=1,this.sensitivity=M.ORBIT.SENSITIVITY,this.defaultCameraNear=0,this.defaultCameraFov=null,this._canRotate=!1,this._autoPan=!1,this._orbitMatrix=l.mat4.create(),this._orbitNormal=l.quat.create(),l.quat.rotateZ(this._orbitNormal,this._orbitNormal,.1),l.mat4.fromQuat(this._orbitMatrix,this._orbitNormal),this._isIdle=!0,this._idleTime=M.IDLE_DURATION,this._idleRecenter=0,this._isDown=!1,this._time=0,this._mode=x.IDLE,this._downPos=l.vec2.create(),this._currPos=l.vec2.create(),this._downRot=l.vec2.create(),this._savedRotations=null,this._savedRadius=null,this._rotationsObj={},this._lookAtObj={},this.isInside=!1,this.insideTime=0,this.interiorProgress=0,this.interiorSide=null,this.isBetweenInAndOut=!1,this.beforeInsideRotations=l.vec2.create(),this.beforeInsideSRotations=l.vec2.create(),this._panProgress=0}return u(e,[{key:"start",value:function(e){this.ctrl=e,this.scene=e.scene,this.camera=e.camera,this.defaultCameraFov=this.camera.lens.fov,this._bind(),this._createGUI()}},{key:"stop",value:function(){this._unbind(),this._destroyGUI(),this.ctrl=null,this.camera=null,this._isDown=!1,this.isInside=!1}},{key:"update",value:function(e){this.updateMove(),this.isInside?this.insideTime+=e/M.INSIDE_DURATION:this.insideTime-=e/M.INSIDE_DURATION,this.insideTime=(0,_.clamp)(this.insideTime,0,1),0===this.insideTime?(this.isVR=!1,this.updateOrbit(e)):1===this.insideTime?this.updateVR(e):(this.isVR=!1,this.updateBlended(e))}},{key:"updateMove",value:function(){this._canRotate&&(this._isDown||(this._setMousePos(this._downPos),l.vec2.copy(this._downRot,this.rotations)),this._setMousePos(this._currPos),1===this.insideTime?l.vec2.sub(y,this._downPos,this._currPos):l.vec2.sub(y,this._currPos,this._downPos),l.vec2.scaleAndAdd(this.rotations,this._downRot,y,this.sensitivity),this.rotations[1]=(0,_.clamp)(this.rotations[1],this.orbitBounds.min,this.orbitBounds.max))}},{key:"updateOrbit",value:function(e){if(this.orbitBounds.min=M.ORBIT.BOUNDS.MIN,this.orbitBounds.max=M.ORBIT.BOUNDS.MAX,this.sensitivity=M.ORBIT.SENSITIVITY,this._time+=e,this._idleTime+=e,this._isIdle=this._idleTime>M.IDLE_DURATION&&this._canRotate,this._isIdle){this._mode=x.IDLE,this._idleRecenter+=2*e,this._idleRecenter=Math.min(1,this._idleRecenter);var t=g.default.easeInQuad(this._idleRecenter);this.rotations[0]+=-.12*e*t*this.orbitDirection,this.rotations[1]+=(this.targetRotationY-this.rotations[1])*e*t*.1}this._isDown&&this._resetIdle(),this.zoomProgress+=(this._isIdle?1:-1)*(1.8*e),this.zoomProgress=(0,_.clampNorm)(this.zoomProgress),this.radius=(0,_.mix)(this.dragRadius,this.orbitRadius,g.default.easeInOutQuad(this.zoomProgress)),this._mode===x.VIEW&&this._autoPan&&(this.lookAt[0]=this._baseLookAt[0]+.1*Math.cos(.18*this._time)*this._panProgress),l.vec2.sub(y,this.rotations,this.srotations),l.vec2.scaleAndAdd(this.srotations,this.srotations,y,Math.min(1,15*e)),l.vec2.copy(y,this.srotations),y[0]=(0,_.normalizeAngle)(y[0]);var n=Math.sin(y[0]),r=Math.sin(-y[1]),i=Math.cos(y[0]),o=Math.cos(-y[1]);b[0]=o*this.radius*i*this.elliptic,b[1]=this.radius*r,b[2]=o*this.radius*n,l.vec3.transformMat4(b,b,this._orbitMatrix),l.vec3.add(this.camera.position,b,this.lookAt);b[0]=1*o*i*this.elliptic,b[2]=1*o*n;var a=g.default.easeInQuad((0,_.clampNorm)((this.srotations[1]+.3)/.4));this.center.y=a,this.camera.lookAt(this.lookAt)}},{key:"updateVR",value:function(e){this.isVR||(this.isVR=!0,this._onVR()),this.orbitBounds.min=M.VR.BOUNDS.MIN,this.orbitBounds.max=M.VR.BOUNDS.MAX,this.sensitivity=M.VR.SENSITIVITY,this._time+=e,l.vec2.sub(y,this.rotations,this.srotations),l.vec2.scaleAndAdd(this.srotations,this.srotations,y,Math.min(1,15*e)),l.vec2.copy(y,this.srotations),y[0]=(0,_.normalizeAngle)(y[0]);var t=Math.sin(y[0]),n=Math.sin(-y[1]),r=Math.cos(y[0]),i=Math.cos(-y[1]);b[0]=i*this.radius*r*this.elliptic,b[1]=this.radius*n,b[2]=i*this.radius*t,l.vec3.transformMat4(b,b,this._orbitMatrix),l.vec3.add(this.camera.position,b,this.lookAt),this.interiorCenter[0]=S.x,this.interiorCenter[1]=S.y,this.interiorCenter[2]=S.z,l.vec3.copy(this.lookAt,this.interiorCenter),this.camera.lookAt(this.lookAt)}},{key:"updateBlended",value:function(e){var t=this.insideTime,n=g.default.easeInOutQuad(t),r=(0,_.mix)(this.defaultCameraFov,S.fov/180*Math.PI,n);this.camera.lens.setAutoFov(r);var i="left"===this.interiorSide?1:-1;if(this.insideTime<=.5){var o=(0,_.map)(this.insideTime,0,.5,0,1),a=g.default.easeInQuad(o),s=(0,_.shortestAngle)(this.beforeInsideRotations[0],-5.122672988891601*i),u=(0,_.shortestAngle)(this.beforeInsideRotations[1],-.10988382250070572);l.vec2.lerp(y,this.beforeInsideRotations,[s,u],a),l.vec2.copy(this.rotations,y),l.vec2.copy(this.srotations,y),y[0]=(0,_.normalizeAngle)(y[0]);var c=Math.sin(y[0]),f=Math.sin(-y[1]),d=Math.cos(y[0]),h=Math.cos(-y[1]),p=(0,_.mix)(this.dragRadius,this.orbitRadius,g.default.easeInOutQuad(this.zoomProgress));this.radius=(0,_.map)(a,0,1,p,1),b[0]=h*this.radius*d*this.elliptic,b[1]=this.radius*f,b[2]=h*this.radius*c,l.vec3.transformMat4(b,b,this._orbitMatrix),l.vec3.add(this.camera.position,b,this.lookAt),l.vec3.set(w,S.x,S.y,S.z),l.vec3.lerp(b,this.orbitCenter,w,a),l.vec3.copy(this.lookAt,b),this.camera.lookAt(this.lookAt)}else{var v=(0,_.map)(this.insideTime,.5,1,0,1),m=g.default.easeOutQuad(v),M=(0,_.shortestAngle)(-5.122672988891601*i,0),x=(0,_.shortestAngle)(-.10988382250070572,-.21135376393795013);this.isInside||(M=(0,_.shortestAngle)(-5.122672988891601*i,this.rotations[0]),x=(0,_.shortestAngle)(-.10988382250070572,this.rotations[1])),l.vec2.lerp(y,[-5.122672988891601*i,-.10988382250070572],[M,x],m),l.vec2.copy(this.rotations,y),l.vec2.copy(this.srotations,y),y[0]=(0,_.normalizeAngle)(y[0]);var P=Math.sin(y[0]),C=Math.sin(-y[1]),T=Math.cos(y[0]),A=Math.cos(-y[1]);this.radius=(0,_.map)(m,0,1,1,.01),b[0]=A*this.radius*T*this.elliptic,b[1]=this.radius*C,b[2]=A*this.radius*P,l.vec3.transformMat4(b,b,this._orbitMatrix),l.vec3.add(this.camera.position,b,this.lookAt),this.interiorCenter[0]=S.x,this.interiorCenter[1]=S.y,this.interiorCenter[2]=S.z,l.vec3.copy(this.lookAt,this.interiorCenter),this.camera.lookAt(this.lookAt)}this.camera.invalidate()}},{key:"_bind",value:function(){v.default.downed.add(this._onDown),v.default.upped.add(this._onUp),v.default.leaved.add(this._onMouseLeave),v.default.contextMenu.add(this._onContextMenu),f.default.blurred.add(this._onWindowBlurred),h.default.views.updated.add(this._onViewsUpdated),h.default.views.reseted.add(this._onViewsReseted),h.default.interior.inside.add(this.goInside),h.default.interior.outside.add(this.goOutside)}},{key:"_unbind",value:function(){v.default.downed.remove(this._onDown),v.default.upped.remove(this._onUp),v.default.leaved.remove(this._onMouseLeave),v.default.contextMenu.remove(this._onContextMenu),f.default.blurred.remove(this._onWindowBlurred),h.default.views.updated.remove(this._onViewsUpdated),h.default.views.reseted.remove(this._onViewsReseted),h.default.interior.inside.remove(this.goInside),h.default.interior.outside.remove(this.goOutside)}},{key:"_createGUI",value:function(){this.gui=this.ctrl.gui.addFolder("Orbit camera"),this.gui.add(S,"x",-4,4,.1).name("center x"),this.gui.add(S,"y",-4,4,.1).name("center y"),this.gui.add(S,"z",-4,4,.1).name("center z"),this.gui.add(S,"fov",30,90,.1),this.gui.add(this,"goInside"),this.gui.add(this,"goOutside"),this.gui.add(this,"logCam")}},{key:"_destroyGUI",value:function(){this.ctrl.gui.removeFolder(this.gui)}},{key:"_setMousePos",value:function(e){e[0]=2*v.default.client.norm.x-1,e[1]=-(2*v.default.client.norm.y-1)}},{key:"_resetIdle",value:function(){this._isIdle=!1,this._idleTime=0,this._idleRecenter=0}},{key:"goInside",value:function(e){TweenMax.killTweensOf([this._rotationObj,this._lookAtObj]),TweenMax.killTweensOf(this,{dragRadius:!0}),this._canRotate=!0,this.interiorSide=e,l.vec2.copy(this.beforeInsideRotations,this.rotations),this.isInside=!0,store.ui.isInside=!0,this.defaultCameraNear=this.scene.camera.lens.near,this.scene.camera.lens.near=.1}},{key:"goOutside",value:function(e){var t=this;this.interiorSide=e,store.ui.inverted=!1,this.scene.car.configurator.model.toggleViewsExterior(!0),this.isInside=!1,store.ui.isInside=!1,setTimeout(function(){t.scene.camera.lens.near=t.defaultCameraNear},2e3),this._idleTime=1/0,this.zoomProgress=1}},{key:"logCam",value:function(){var e=this.scene.dt;l.vec2.sub(y,this.rotations,this.srotations),l.vec2.scaleAndAdd(this.srotations,this.srotations,y,Math.min(1,15*e)),l.vec2.copy(y,this.srotations),y[0]=(0,_.normalizeAngle)(y[0]);var t=Math.sin(y[0]),n=Math.sin(-y[1]),r=Math.cos(y[0]),i={phi:t,theta:n,psi:r,pos:this.camera.position,rot:this.camera.rotation};console.table(i)}},{key:"_onDown",value:function(e){var t=e.button;!this._canRotate||0!==t&&BrowserDetect.isDesktop&&!v.default.isTouchDevice||(this._setMousePos(this._downPos),this._mode=x.DRAG,this._isDown=!0)}},{key:"_onUp",value:function(e){var t=e.button;!this._canRotate||0!==t&&BrowserDetect.isDesktop&&!v.default.isTouchDevice||(this._mode=x.IDLE,this._isDown=!1)}},{key:"_onMouseLeave",value:function(){this._isDown=!1}},{key:"_onContextMenu",value:function(e){e.preventDefault()}},{key:"_onWindowBlurred",value:function(){this._isDown=!1}},{key:"_onViewsUpdated",value:function(e){var t=this;this._mode=x.VIEW,this._autoPan=e.autoPan,TweenMax.killTweensOf([this._rotationObj,this._lookAtObj]),TweenMax.killTweensOf(this,{dragRadius:!0});var n=e.rotation,r=e.lookAt,i=e.radius,o=e.distance;this._canRotate=!1,this._isDown=!1,this._savedRotations={x:this.rotations[0],y:this.rotations[1]},this._rotationObj={x:this.rotations[0],y:this.rotations[1]};var a=e.duration;o&&(a=.8*o),TweenMax.to(this._rotationObj,a,{x:(0,_.shortestAngle)(this._rotationObj.x,n[0]),y:(0,_.shortestAngle)(this._rotationObj.y,n[1]),ease:Power2.easeOut,onUpdate:function(){t.rotations[0]=t._rotationObj.x,t.rotations[1]=t._rotationObj.y}}),this._lookAtObj={x:this.lookAt[0],y:this.lookAt[1],z:this.lookAt[2]},TweenMax.to(this._lookAtObj,a,{x:r[0],y:r[1],z:r[2],ease:Power2.easeOut,onUpdate:function(){l.vec3.set(t.lookAt,t._lookAtObj.x,t._lookAtObj.y,t._lookAtObj.z),l.vec3.set(t._baseLookAt,t._lookAtObj.x,t._lookAtObj.y,t._lookAtObj.z)}}),TweenMax.fromTo(this,a,{_panProgress:0},{_panProgress:1,ease:Power2.easeOut}),TweenMax.to(this,a+.5,{dragRadius:i,ease:Power2.easeOut,onComplete:function(){return h.default.views.transitionUpdated.dispatch()}})}},{key:"_onViewsReseted",value:function(){var e=this;this._mode=x.IDLE,TweenMax.killTweensOf([this._rotationObj,this._lookAtObj]),TweenMax.killTweensOf(this,{dragRadius:!0}),this._rotationObj={x:this.rotations[0],y:this.rotations[1]},TweenMax.to(this._rotationObj,2,{x:this._savedRotations.x,y:this._savedRotations.y,ease:Power2.easeOut,onUpdate:function(){return l.vec2.set(e.rotations,e._rotationObj.x,e._rotationObj.y)}}),this._lookAtObj={x:this.lookAt[0],y:this.lookAt[1],z:this.lookAt[2]},TweenMax.to(this._lookAtObj,2,{x:this.center[0],y:this.center[1],z:this.center[2],ease:Power2.easeOut,onUpdate:function(){l.vec3.set(e.lookAt,e._lookAtObj.x,e._lookAtObj.y,e._lookAtObj.z),l.vec3.set(e._baseLookAt,e._lookAtObj.x,e._lookAtObj.y,e._lookAtObj.z)},onComplete:function(){e._canRotate=!0}}),TweenMax.to(this,2,{dragRadius:this.defaultDragRadius,ease:Power2.easeOut})}},{key:"_onVR",value:function(){this.scene.car.configurator.model.toggleViewsInterior(!0)}},{key:"canRotate",set:function(e){this._canRotate=e}}]),e}(),a(s.prototype,"goInside",[r],Object.getOwnPropertyDescriptor(s.prototype,"goInside"),s.prototype),a(s.prototype,"goOutside",[r],Object.getOwnPropertyDescriptor(s.prototype,"goOutside"),s.prototype),a(s.prototype,"_onDown",[r],Object.getOwnPropertyDescriptor(s.prototype,"_onDown"),s.prototype),a(s.prototype,"_onUp",[r],Object.getOwnPropertyDescriptor(s.prototype,"_onUp"),s.prototype),a(s.prototype,"_onMouseLeave",[r],Object.getOwnPropertyDescriptor(s.prototype,"_onMouseLeave"),s.prototype),a(s.prototype,"_onContextMenu",[r],Object.getOwnPropertyDescriptor(s.prototype,"_onContextMenu"),s.prototype),a(s.prototype,"_onWindowBlurred",[r],Object.getOwnPropertyDescriptor(s.prototype,"_onWindowBlurred"),s.prototype),a(s.prototype,"_onViewsUpdated",[r],Object.getOwnPropertyDescriptor(s.prototype,"_onViewsUpdated"),s.prototype),a(s.prototype,"_onViewsReseted",[r],Object.getOwnPropertyDescriptor(s.prototype,"_onViewsReseted"),s.prototype),s);t.default=P,e.exports=t.default}).call(t,n(2).bind)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t){r(this,e),this.el=t,this.ctrl=null,this.camera=null}return i(e,[{key:"start",value:function(e){this.ctrl=e,this.camera=e.camera}},{key:"stop",value:function(){this.ctrl=null,this.camera=null}},{key:"update",value:function(e){}}]),e}();t.default=o,e.exports=t.default},function(e,t,n){"use strict";(function(r){function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a,s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(64),l=function(e){return e&&e.__esModule?e:{default:e}}(u),c=n(18),f=(a=function(){function e(t){o(this,e),this.scene=t,this.camera=t.camera,this._current=null,this._currentIdx=-1,this._ctrls=[],this._createGUI()}return s(e,[{key:"add",value:function(e){var t,n=[].concat(e);(t=this._ctrls).push.apply(t,i(n))}},{key:"set",value:function(e){this._current&&this._current.stop(),this._current=e,this._currentIdx=this._ctrls.indexOf(e),e.start(this)}},{key:"prev",value:function(){this.go(this._currentIdx-1)}},{key:"next",value:function(){this.go(this._currentIdx+1)}},{key:"go",value:function(e){this._currentIdx=(0,c.modAbs)(e,this._ctrls.length);var t=this._ctrls[this._currentIdx];this.set(t)}},{key:"preRender",value:function(){this._current&&this._current.update(this.scene.dt)}},{key:"_bind",value:function(){l.default.downed.add(this._onKeyboardDowned)}},{key:"_unbind",value:function(){l.default.downed.remove(this._onKeyboardDowned)}},{key:"_createGUI",value:function(){this.gui=gui.addFolder("Camera controlers")}},{key:"_destroyGUI",value:function(){gui.removeFolder(this.gui)}},{key:"_onKeyboardDowned",value:function(e,t){"c"===t&&this.next()}},{key:"cam",get:function(){return this._current}}]),e}(),function(e,t,n,r,i){var o={};return Object.keys(r).forEach(function(e){o[e]=r[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}(a.prototype,"_onKeyboardDowned",[r],Object.getOwnPropertyDescriptor(a.prototype,"_onKeyboardDowned"),a.prototype),a);t.default=f,e.exports=t.default}).call(t,n(2).bind)},function(e,t){function n(e){if(e&&"object"==typeof e){var t=e.which||e.keyCode||e.charCode;t&&(e=t)}if("number"==typeof e)return a[e];var n=String(e),o=r[n.toLowerCase()];if(o)return o;var o=i[n.toLowerCase()];return o||(1===n.length?n.charCodeAt(0):void 0)}n.isEventKey=function(e,t){if(e&&"object"==typeof e){var n=e.which||e.keyCode||e.charCode;if(null===n||void 0===n)return!1;if("string"==typeof t){var o=r[t.toLowerCase()];if(o)return o===n;var o=i[t.toLowerCase()];if(o)return o===n}else if("number"==typeof t)return t===n;return!1}},t=e.exports=n;var r=t.code=t.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},i=t.aliases={windows:91,"⇧":16,"⌥":18,"⌃":17,"⌘":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91};/*!
 * Programatically add the following
 */
for(o=97;o<123;o++)r[String.fromCharCode(o)]=o-32;for(var o=48;o<58;o++)r[o-48]=o;for(o=1;o<13;o++)r["f"+o]=o+111;for(o=0;o<10;o++)r["numpad "+o]=o+96;var a=t.names=t.title={};for(o in r)a[r[o]]=o;for(var s in i)r[s]=i[s]},function(e,t,n){"use strict";(function(r){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a,s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(11),l=i(u),c=n(16),f=i(c),d=(a=function(){function e(t,n){o(this,e),this._scene=t,this._modules=n,this._instances=[],this._current=null,this._bind(),this._create()}return s(e,[{key:"_bind",value:function(){f.default.module.change.add(this.change)}},{key:"_unbind",value:function(){f.default.module.change.remove(this.change)}},{key:"_create",value:function(){var e=this._modules;for(var t in e){var n=e[t],r=new n(this._scene);r.init(),this._instances.push(r)}}},{key:"getLoadables",value:function(){for(var e=[],t=this._instances,n=0,r=t.length;n<r;n++)!function(n,r){var i=t[n],o=l.default.all(i.getLoadables());o.then(function(){return i._onLoaded()}),e=e.concat(o)}(n);return e}},{key:"change",value:function(e){var t=this,n=this._current,r=this.get(e);if(r){var i=(0,l.default)();n&&(i=n.stop()),i.then(function(){r.start(),t._current=r,f.default.module.changed.dispatch(e)})}}},{key:"get",value:function(e){for(var t=this._instances,n=0,r=t.length;n<r;n++){var i=t[n];if(i.name===e)return i}return null}},{key:"preRender",value:function(e){for(var t=this._instances,n=0,r=t.length;n<r;n++)t[n].preRender(e)}},{key:"render",value:function(){this._current&&this._current.render()}}]),e}(),function(e,t,n,r,i){var o={};return Object.keys(r).forEach(function(e){o[e]=r[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}(a.prototype,"change",[r],Object.getOwnPropertyDescriptor(a.prototype,"change"),a.prototype),a);t.default=d,e.exports=t.default}).call(t,n(2).bind)},function(e,t,n){"use strict";function r(){var e=this;this.accum=0,this.dt=0,this.fps=3e3,this.step=function(t){return e.accum+=t,!(e.accum<1/e.fps)&&(e.dt=e.accum,e.accum=0,!0)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,e.exports=t.default},function(e,t,n){"use strict";(function(r){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e){var t=l.mat4.create();return l.mat4.fromTranslation(t,e),t}Object.defineProperty(t,"__esModule",{value:!0});var s,u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(1),c=n(64),f=i(c),d=n(238),h=i(d),p=n(239),v=i(p),m=n(240),g=i(m),_=(s=function(){function e(t){o(this,e),this.scene=t,this._enabled=!1,this._guizmos=[],this._frustums=[],this._bounds=[],this.guizmo=new h.default(t),this.frustum=new v.default(t),this.bounds=new g.default(t),this._bind()}return u(e,[{key:"_bind",value:function(){f.default.downed.add(this._onKeyboardDowned)}},{key:"_unbind",value:function(){f.default.downed.remove(this._onKeyboardDowned)}},{key:"clear",value:function(){this._guizmos.length=0,this._frustums.length=0}},{key:"drawGuizmo",value:function(e){3===e.length&&(e=a(e)),this._guizmos.push(e)}},{key:"drawFrustum",value:function(e){this._frustums.push(e)}},{key:"drawBounds",value:function(e){this._bounds.push(e)}},{key:"render",value:function(){if(this._enabled){for(var e=0,t=this._guizmos.length;e<t;e++)this.guizmo._wmatrix.set(this._guizmos[e]),this.guizmo.render(this.scene.camera);for(var n=0,r=this._frustums.length;n<r;n++)this.frustum.projection=this._frustums[n],this.frustum.render(this.scene.camera);for(var i=0,o=this._bounds.length;i<o;i++){var a=this._bounds[i],s=a.center,u=a.min,l=a.max,c=a.color,f=a.isVisible;this.bounds.center=s,this.bounds.minMax={min:u,max:l},this.bounds.color=c,this.bounds.isVisible=f,this.bounds.render(this.scene.camera)}this.clear()}}},{key:"_onKeyboardDowned",value:function(e,t){}}]),e}(),function(e,t,n,r,i){var o={};return Object.keys(r).forEach(function(e){o[e]=r[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}(s.prototype,"_onKeyboardDowned",[r],Object.getOwnPropertyDescriptor(s.prototype,"_onKeyboardDowned"),s.prototype),s);t.default=_,e.exports=t.default}).call(t,n(2).bind)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(19),l=r(u),c=n(27),f=r(c),d=n(4),h=r(d),p=n(17),v=r(p),m=n(1).mat4.create(),g=new ArrayBuffer(96),_=new Float32Array(g);_[4]=1,_[13]=1,_[22]=1;var y=new Uint32Array(g);y[3]=y[7]=255,y[11]=y[15]=65280,y[19]=y[23]=16711680;var b=["attribute vec3 aPosition;","attribute vec3 aColor;","varying vec3 vColor;","uniform mat4 uMVP;","void main(void){","  gl_Position = uMVP * vec4(aPosition, 1.0);","  vColor = aColor;","}"].join("\n"),w=["precision lowp float;","varying vec3 vColor;","void main(void){","  gl_FragColor = vec4( vColor, 1.0 );","}"].join("\n"),M=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));n.scene=e;var r=e.gl;return n.gl=r,n.buffer=new l.default(r,g),n.buffer.attrib("aPosition",3,r.FLOAT),n.buffer.attrib("aColor",3,r.UNSIGNED_BYTE,!0),n.buffer.attrib("pad",1,r.BYTE),n.prg=new f.default(r,b,w),n.cfg=new v.default,n.cfg.enableCullface(!1),n.cfg.enableDepthTest(),n.cfg.depthMask(!0),n.cfg.lineWidth(1),n}return a(t,e),s(t,[{key:"render",value:function(e){var t=this.scene.glstate;t.push(this.cfg),e.modelViewProjectionMatrix(m,this._wmatrix),this.prg.use(),this.prg.uMVP(m),this.buffer.attribPointer(this.prg),t.apply(),this.buffer.drawLines(),t.pop()}}]),t}(h.default);t.default=M,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(19),l=r(u),c=n(61),f=r(c),d=n(27),h=r(d),p=n(4),v=r(p),m=n(17),g=r(m),_=n(1),y=_.mat4.create(),b=new Float32Array([-1,1,1,-1,1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,1,-1,-1,1,-1,1]),w=new Uint8Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),M=["attribute vec3 aPosition;","uniform mat4 uMVP;","uniform mat4 uFrustumMat;","void main(void){","  vec4 wPos = uFrustumMat * vec4(aPosition, 1.0);","  wPos.xyz /= wPos.w;","  gl_Position = uMVP * vec4(wPos.xyz, 1.0);","}"].join("\n"),x=["precision lowp float;","uniform vec3 uColor;","void main(void){","  gl_FragColor = vec4( uColor, 1.0 );","}"].join("\n"),S=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));n.scene=e;var r=e.gl;return n.projection=null,n.gl=r,n.buffer=new l.default(r,b),n.buffer.attrib("aPosition",3,r.FLOAT),n.indices=new f.default(r,r.UNSIGNED_BYTE,w),n.prg=new h.default(r,M,x),n.cfg=new g.default,n.cfg.enableCullface(!1),n.cfg.enableDepthTest(),n.cfg.depthMask(!0),n.cfg.lineWidth(1),n}return a(t,e),s(t,[{key:"render",value:function(e){if(null!==this.projection){var t=this.scene.glstate;t.push(this.cfg),this.prg.use(),this.prg.uMVP(e._viewProj),_.mat4.invert(y,this.projection),this.prg.uFrustumMat(y),this.prg.uColor(1,0,0,1),this.buffer.attribPointer(this.prg),t.apply(),this.indices.bind(),this.indices.drawLines(),t.pop()}}}]),t}(v.default);t.default=S,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(19),l=r(u),c=n(61),f=r(c),d=n(27),h=r(d),p=n(4),v=r(p),m=n(17),g=r(m),_=n(1),y=_.mat4.create(),b=new Float32Array([-1,1,1,-1,1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,1,-1,-1,1,-1,1]),w=new Uint8Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),M=["attribute vec3 aPosition;","uniform mat4 uMVP;","void main(void){","  vec4 wPos = vec4(aPosition, 1.0);","  gl_Position = uMVP * vec4(wPos.xyz, 1.0);","}"].join("\n"),x=["precision lowp float;","uniform vec3 uColor;","void main(void){","  gl_FragColor = vec4( uColor, 1.0 );","}"].join("\n"),S=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));n.scene=e;var r=e.gl;return n.gl=r,n.buffer=new l.default(r,b),n.buffer.attrib("aPosition",3,r.FLOAT),n.indices=new f.default(r,r.UNSIGNED_BYTE,w),n.prg=new h.default(r,M,x),n._center=_.vec3.create(),n._min=_.vec3.create(),n._max=_.vec3.create(),n._color=_.vec3.fromValues(0,1,0),n.isVisible=!0,n.cfg=new g.default,n.cfg.enableCullface(!1),n.cfg.enableDepthTest(),n.cfg.depthMask(!0),n.cfg.lineWidth(1),n}return a(t,e),s(t,[{key:"render",value:function(e){if(this.isVisible){var t=this.scene.glstate;t.push(this.cfg),e.modelViewProjectionMatrix(y,this._wmatrix),this.prg.use(),this.prg.uMVP(y),this.prg.uColor(this._color[0],this._color[1],this._color[2]),this.buffer.attribPointer(this.prg),t.apply(),this.indices.bind(),this.indices.drawLines(),t.pop()}}},{key:"center",set:function(e){_.vec3.copy(this.position,e),this.invalidate(),this.updateWorldMatrix()},get:function(){return this._center}},{key:"minMax",set:function(e){_.vec3.copy(this._min,e.min),_.vec3.copy(this._max,e.max),_.vec3.sub(this.scale,this._max,this._min),_.vec3.scale(this.scale,this.scale,.5),this.invalidate(),this.updateWorldMatrix()}},{key:"color",set:function(e){e?_.vec3.copy(this._color,e):_.vec3.set(this._color,0,1,0)}}]),t}(v.default);t.default=S,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(17),s=r(a),u=n(105),l=r(u),c=function(){function e(t){i(this,e),this.scene=t,this.gl=t.gl,this.cfg=(new s.default).enableCullface(!1).enableDepthTest(!1),this.quad=new l.default(t.gl),this.fbo=null}return o(e,[{key:"debug",value:function(e){this.fbo=e}},{key:"render",value:function(){if(null!==this.fbo){var e=this.scene,t=this.quad,n=e.programs.debugFbo;n.use(),n.tTex(this.fbo.getColor()),t.attribPointer(n),e.glstate.push(this.cfg),e.glstate.apply(),t.render(),e.glstate.pop()}}}]),e}();t.default=c,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(243),s=r(a),u=n(245),l=r(u),c=n(15),f=r(c),d=n(246),h=r(d),p=n(63),v=function(){},m=function(){function e(t){var n=t.canvas,r=t.pixelRatio,o=t.hdpi,a=t.getContextOptions,s=void 0===a?{}:a,u=t.init,c=void 0===u?v:u,f=t.render,d=void 0===f?v:f,h=t.resize,p=void 0===h?v:h;i(this,e),this.canvas=n,this.pixelRatio=r,this.hdpi=o,this.init=c,this.render=d,this.resize=p;var m=s();this.gl=n.getContext("webgl",m)||n.getContext("experimental-webgl",m)||n.getContext("webgl"),this.width=0,this.height=0,this.canvasWidth=0,this.canvasHeight=0,this.frame=this._frame.bind(this),this.previousTime=(0,l.default)(),this._rafId=0,this._playing=!1,this.init()}return o(e,[{key:"dispose",value:function(){this.stop()}},{key:"play",value:function(){this._playing||(this._playing=!0,this.frame(),this.previousTime=(0,l.default)(),this._requestFrame())}},{key:"stop",value:function(){s.default.cancel(this._rafId),this._playing=!1,this._rafId=0}},{key:"updateSize",value:function(){var e=1;this.pixelRatio>0?e=this.pixelRatio:this.hdpi&&(e=window.devicePixelRatio),this.canvas.width=e*this.canvasWidth,this.canvas.height=e*this.canvasHeight,this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this.resize()}},{key:"_checkSize",value:function(){var e=window.getComputedStyle(this.canvas.parentElement),t=parseInt(e.getPropertyValue("width")),n=parseInt(e.getPropertyValue("height"));return!isNaN(t)&&!isNaN(n)&&0!==t&&0!==n&&(t===this.canvasWidth&&n===this.canvasHeight||(this.canvas.style="width:"+t+"px;height:"+n+"px;",this.canvasWidth=t,this.canvasHeight=n,this.updateSize()),!0)}},{key:"_requestFrame",value:function(){s.default.cancel(this._rafId),this._rafId=(0,s.default)(this.frame)}},{key:"_frame",value:function(){if(this._playing){var e=(0,l.default)(),t=(e-this.previousTime)/1e3;this.previousTime=e,(t>.2||t<1/180)&&(t=1/60),this._checkSize()&&this.render(t),this._playing&&this._requestFrame()}}}]),e}(),g=function(e){return new m({canvas:e,pixelRatio:f.default.pixelRatio,init:function(){this.scene=null},getContextOptions:function(){return{depth:!0,stencil:!1,antialias:"false"!==(0,p.getQueryVariable)("antialias")&&BrowserDetect.isDesktop&&h.default.isHigh,alpha:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1}},render:function(e){this.scene&&this.scene.render(e)},resize:function(){}})};t.default=g,e.exports=t.default},function(e,t,n){(function(t){for(var r=n(244),i="undefined"==typeof window?t:window,o=["moz","webkit"],a="AnimationFrame",s=i["request"+a],u=i["cancel"+a]||i["cancelRequest"+a],l=0;!s&&l<o.length;l++)s=i[o[l]+"Request"+a],u=i[o[l]+"Cancel"+a]||i[o[l]+"CancelRequest"+a];if(!s||!u){var c=0,f=0,d=[];s=function(e){if(0===d.length){var t=r(),n=Math.max(0,1e3/60-(t-c));c=n+t,setTimeout(function(){var e=d.slice(0);d.length=0;for(var t=0;t<e.length;t++)if(!e[t].cancelled)try{e[t].callback(c)}catch(e){setTimeout(function(){throw e},0)}},Math.round(n))}return d.push({handle:++f,callback:e,cancelled:!1}),f},u=function(e){for(var t=0;t<d.length;t++)d[t].handle===e&&(d[t].cancelled=!0)}}e.exports=function(e){return s.call(i,e)},e.exports.cancel=function(){u.apply(i,arguments)},e.exports.polyfill=function(e){e||(e=i),e.requestAnimationFrame=s,e.cancelAnimationFrame=u}}).call(t,n(5))},function(e,t,n){(function(t){(function(){var n,r,i,o,a,s;"undefined"!=typeof performance&&null!==performance&&performance.now?e.exports=function(){return performance.now()}:void 0!==t&&null!==t&&t.hrtime?(e.exports=function(){return(n()-a)/1e6},r=t.hrtime,n=function(){var e;return e=r(),1e9*e[0]+e[1]},o=n(),s=1e9*t.uptime(),a=o-s):Date.now?(e.exports=function(){return Date.now()-i},i=Date.now()):(e.exports=function(){return(new Date).getTime()-i},i=(new Date).getTime())}).call(this)}).call(t,n(10))},function(e,t,n){(function(t){e.exports=t.performance&&t.performance.now?function(){return performance.now()}:Date.now||function(){return+new Date}}).call(t,n(5))},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(247),a=function(){function e(){r(this,e),this.gpu=(0,o.getGPUTier)({mobileBenchmarkPercentages:[10,40,30,20],desktopBenchmarkPercentages:[10,40,30,20]})}return i(e,[{key:"tierNumber",get:function(){return parseInt(this.gpu.tier.match(/\d/)[0])}},{key:"isLow",get:function(){return 0===this.tierNumber}},{key:"isMedium",get:function(){return 1===this.tierNumber||2===this.tierNumber}},{key:"isHigh",get:function(){return 3===this.tierNumber}}]),e}();t.default=new a,e.exports=t.default},function(e,t,n){!function(t,n){e.exports=n()}(window,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var i in e)t.d(r,i,function(t){return e[t]}.bind(null,i));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=1)}([function(e,t,n){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i,o,a,s;s=function(e){"use strict";var t=function(){function e(e){this.cache=new Map,this.userAgent=e||(window&&window.navigator?window.navigator.userAgent:""),this.android=!/like android/i.test(this.userAgent)&&/android/i.test(this.userAgent),this.iOS=this.match(1,/(iphone|ipod|ipad)/i).toLowerCase()}return e.prototype.match=function(e,t){var n=this.userAgent.match(t);return n&&1<n.length&&n[e]||""},Object.defineProperty(e.prototype,"isMobile",{get:function(){return this.cache.get("isMobile")||(!this.isTablet&&(/[^-]mobi/i.test(this.userAgent)||"iphone"===this.iOS||"ipod"===this.iOS||this.android||/nexus\s*[0-6]\s*/i.test(this.userAgent))?(this.cache.set("isMobile",!0),!0):(this.cache.set("isMobile",!1),!1))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isTablet",{get:function(){return this.cache.get("isTablet")||(/tablet/i.test(this.userAgent)&&!/tablet pc/i.test(this.userAgent)||"ipad"===this.iOS||this.android&&!/[^-]mobi/i.test(this.userAgent)||!/nexus\s*[0-6]\s*/i.test(this.userAgent)&&/nexus\s*[0-9]+/i.test(this.userAgent)?(this.cache.set("isTablet",!0),!0):(this.cache.set("isTablet",!1),!1))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDesktop",{get:function(){var e=this.cache.get("isDesktop");if(e)return e;var t=!this.isMobile&&!this.isTablet;return this.cache.set("isDesktop",t),t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isiOS",{get:function(){return this.cache.get("isiOS")||!!this.iOS&&{name:"iOS",version:this.match(1,/os (\d+([_\s]\d+)*) like mac os x/i).replace(/[_\s]/g,".")}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isAndroid",{get:function(){return this.cache.get("isAndroid")||!!this.android&&{name:"Android",version:this.match(1,/android[ \/-](\d+(\.\d+)*)/i)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"browser",{get:function(){var e=this.cache.get("browser");if(e)return e;var t,n=this.match(1,/version\/(\d+(\.\d+)?)/i);return t=/opera/i.test(this.userAgent)?{name:"Opera",version:n||this.match(1,/(?:opera|opr|opios)[\s\/](\d+(\.\d+)?)/i)}:/opr\/|opios/i.test(this.userAgent)?{name:"Opera",version:this.match(1,/(?:opr|opios)[\s\/](\d+(\.\d+)?)/i)||n}:/SamsungBrowser/i.test(this.userAgent)?{name:"Samsung Internet for Android",version:n||this.match(1,/(?:SamsungBrowser)[\s\/](\d+(\.\d+)?)/i)}:/yabrowser/i.test(this.userAgent)?{name:"Yandex Browser",version:n||this.match(1,/(?:yabrowser)[\s\/](\d+(\.\d+)?)/i)}:/ucbrowser/i.test(this.userAgent)?{name:"UC Browser",version:this.match(1,/(?:ucbrowser)[\s\/](\d+(\.\d+)?)/i)}:/msie|trident/i.test(this.userAgent)?{name:"Internet Explorer",version:this.match(1,/(?:msie |rv:)(\d+(\.\d+)?)/i)}:/edg([ea]|ios)/i.test(this.userAgent)?{name:"Microsoft Edge",version:this.match(2,/edg([ea]|ios)\/(\d+(\.\d+)?)/i)}:/firefox|iceweasel|fxios/i.test(this.userAgent)?{name:"Firefox",version:this.match(1,/(?:firefox|iceweasel|fxios)[ \/](\d+(\.\d+)?)/i)}:/chromium/i.test(this.userAgent)?{name:"Chromium",version:this.match(1,/(?:chromium)[\s\/](\d+(?:\.\d+)?)/i)||n}:/chrome|crios|crmo/i.test(this.userAgent)?{name:"Chrome",version:this.match(1,/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:/safari|applewebkit/i.test(this.userAgent)?{name:"Safari",version:n}:{name:this.match(1,/^(.*)\/(.*) /),version:this.match(2,/^(.*)\/(.*) /)},this.cache.set("browser",t),t},enumerable:!0,configurable:!0}),e}();e.DetectUA=t,Object.defineProperty(e,"__esModule",{value:!0})},"object"==r(t)&&void 0!==e?s(t):(o=[t],void 0===(a="function"==typeof(i=s)?i.apply(t,o):i)||(e.exports=a))},function(e,t,n){"use strict";function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function i(e){return e.toLowerCase().split("- ")[1].split(" /")[0]}function o(e){return e.replace(/[\D]/g,"")}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new d(e)}n.r(t);var s=n(0),u=["736 - AMD Radeon HD 7290","726 - AMD Radeon HD 8180","724 - AMD Radeon HD 7310","722 - AMD Radeon HD 7340","718 - Intel HD Graphics (Bay Trail)","677 - Intel HD Graphics (Ivy Bridge)","673 - AMD Radeon HD 8210","649 - AMD Radeon HD 8250","648 - AMD Radeon R6 (Mullins)","647 - AMD Radeon HD 8240","639 - AMD Radeon HD 8280","636 - Intel HD Graphics (Cherry Trail)","635 - AMD Radeon R2 (Mullins/Beema/Carrizo-L)","614 - Intel HD Graphics (Haswell)","605 - Intel HD Graphics 400 (Braswell)","604 - Intel HD Graphics (Braswell)","603 - Intel HD Graphics 405 (Braswell)","583 - Intel HD Graphics 500","582 - Intel UHD Graphics 600","581 - AMD Radeon HD 8330","580 - AMD Radeon HD 8350G","567 - AMD Radeon HD 8400","563 - AMD Radeon HD 8450G","554 - Intel HD Graphics 4200","553 - AMD Radeon R2 (Stoney Ridge)","552 - AMD Radeon R3 (Mullins/Beema)","551 - AMD Radeon R4 (Beema)","550 - AMD Radeon R5 (Beema/Carrizo-L)","548 - Intel HD Graphics (Broadwell)","547 - AMD Radeon R4 (Kaveri)","546 - AMD Radeon R4 (Stoney Ridge)","542 - Intel HD Graphics 4000","541 - AMD Radeon HD 7480D","533 - Intel HD Graphics 505","532 - Intel UHD Graphics 605","531 - Intel HD Graphics 5300","502 - Intel HD Graphics 510","501 - Intel HD Graphics 610","500 - Intel HD Graphics 4400","499 - Intel HD Graphics 515","492 - AMD Radeon HD 8470D","483 - AMD Radeon HD 8550G","467 - Intel HD Graphics 5000","464 - AMD Radeon HD 7660G","463 - NVIDIA GeForce 710M","460 - AMD Radeon R5 (Kaveri)","459 - AMD Radeon R5 (Carrizo)","458 - Intel HD Graphics 615","457 - Intel UHD Graphics 615","456 - Intel UHD Graphics 617","447 - Intel HD Graphics 5500","445 - Intel HD Graphics 4600","442 - AMD Radeon HD 8610G","440 - Intel Iris Graphics 5100","438 - NVIDIA Quadro K610M","437 - Intel HD Graphics 6000","431 - AMD Radeon R5 M420","430 - AMD Radeon R5 M315","428 - AMD Radeon R5 M320","425 - AMD Radeon R5 (Stoney Ridge)","424 - NVIDIA GeForce GT 720M","423 - Intel Iris Graphics 6100","422 - Intel HD Graphics 520","421 - AMD Radeon RX Vega 3","420 - NVIDIA GeForce 820M","419 - NVIDIA GeForce 910M","417 - AMD Radeon R5 M255","416 - AMD Radeon R5 M430","415 - AMD Radeon R5 M330","412 - AMD Radeon HD 7560D","406 - AMD Radeon HD 8650G","390 - NVIDIA Quadro K1000M","388 - AMD Radeon HD 7660D","387 - AMD Radeon R6 M255DX","380 - Intel HD Graphics 5600","370 - AMD FirePro W2100","361 - AMD Radeon R6 (Kaveri)","349 - AMD Radeon R6 (Carrizo)","348 - Intel HD Graphics 620","347 - Intel UHD Graphics 620","346 - AMD Radeon R5 (Bristol Ridge)","344 - Intel HD Graphics P530","343 - Intel HD Graphics 530","342 - Intel HD Graphics P630","341 - Intel HD Graphics 630","340 - Intel UHD Graphics 630","339 - AMD Radeon RX Vega 6","337 - AMD Radeon 520","336 - AMD Radeon R7 M340","329 - AMD Radeon R7 M440","328 - AMD Radeon R8 M445DX","325 - NVIDIA GeForce 920M","323 - AMD Radeon R7 M360","320 - AMD Radeon R7 M460","318 - AMD Radeon R7 (Kaveri)","317 - AMD Radeon R7 (Carrizo)","316 - NVIDIA GeForce GT 640M","315 - AMD Radeon R7 (Bristol Ridge)","311 - AMD Radeon R7 M265","307 - AMD FirePro M4100","304 - NVIDIA GeForce GT 730M","294 - AMD FirePro M4000","292 - NVIDIA GeForce 825M","290 - NVIDIA GeForce GT 735M","287 - NVIDIA Quadro K2000M","283 - Intel Iris Graphics 540","282 - NVIDIA GeForce 920MX","281 - Intel Iris Plus Graphics 640","280 - NVIDIA GeForce MX110","279 - NVIDIA GeForce 830M","278 - AMD Radeon 530","277 - Intel Iris Graphics 550","276 - NVIDIA GeForce 930M","275 - Intel Iris Plus Graphics 650","274 - NVIDIA GeForce GT 740M","273 - AMD Radeon R7 384 Cores (Kaveri Desktop)","272 - Intel Iris Pro Graphics 5200","271 - AMD Radeon R7 512 Cores (Kaveri Desktop)","268 - NVIDIA GeForce GT 745M","266 - NVIDIA GeForce 840M","265 - NVIDIA Quadro M500M","260 - AMD Radeon R7 M445","259 - Intel Iris Plus Graphics 655","258 - AMD Radeon R9 M375","257 - AMD FirePro W4190M","256 - NVIDIA Quadro M600M","254 - NVIDIA GeForce 930MX","253 - NVIDIA GeForce 940M","252 - AMD Radeon RX Vega 8","251 - NVIDIA Quadro K1100M","250 - NVIDIA Quadro M520","249 - NVIDIA GeForce 940MX","248 - NVIDIA GeForce MX130","247 - NVIDIA GeForce MX230","246 - Intel Iris Pro Graphics 6200","245 - NVIDIA GeForce GT 750M","240 - AMD FirePro W4100","239 - AMD FirePro W4170M","237 - AMD Radeon R7 M465","235 - AMD Radeon R9 M265X","232 - NVIDIA GeForce 845M","230 - NVIDIA GeForce GT 755M","229 - AMD Radeon R7 250","224 - NVIDIA Quadro K2100M","223 - AMD FirePro M5100","222 - AMD FirePro M6000","220 - NVIDIA Quadro K3000M","214 - AMD FirePro W5130M","213 - NVIDIA Maxwell GPU Surface Book (940M, GDDR5)","207 - AMD Radeon R9 M370X","206 - AMD FirePro W5170M","205 - NVIDIA Quadro K3100M","194 - AMD Radeon R9 M470","189 - Intel Iris Pro Graphics 580","188 - Intel Iris Pro Graphics P580","187 - AMD Radeon RX Vega 10","186 - NVIDIA Quadro K4000M","182 - NVIDIA Quadro P500","180 - NVIDIA GeForce 945M","175 - AMD Radeon RX Vega 11","173 - NVIDIA Quadro M620","172 - NVIDIA Quadro M1000M","171 - NVIDIA GeForce GTX 850M","170 - AMD Radeon R9 M385X","169 - AMD Radeon R9 M470X","168 - AMD Radeon Pro 450","167 - NVIDIA GeForce GTX 950M","159 - NVIDIA GeForce GTX 860M","158 - AMD Radeon Pro WX 3100 Mobile","157 - AMD Radeon RX 540","155 - NVIDIA Quadro K4100M","154 - NVIDIA Quadro K5000M","153 - NVIDIA Quadro M2000M","152 - NVIDIA GeForce MX150","151 - NVIDIA GeForce MX250","150 - NVIDIA Quadro P600","149 - NVIDIA GeForce GT 1030 (Desktop)","148 - AMD Radeon Pro 455","147 - AMD Radeon Pro 555","146 - AMD Radeon Pro 555X","145 - NVIDIA Quadro M1200","141 - AMD Radeon RX 550 (Laptop)","140 - AMD Radeon RX 550X (Laptop)","138 - NVIDIA GeForce GTX 960M","137 - AMD Radeon Pro WX 4130","136 - AMD Radeon Pro 460","135 - AMD Radeon Pro 560","134 - AMD Radeon Pro 560X","132 - AMD FirePro M6100","131 - AMD Radeon R9 M390","128 - AMD Radeon RX 460 (Laptop)","121 - NVIDIA GeForce GTX 870M","120 - NVIDIA Quadro M2200","119 - AMD Radeon RX 560 (Laptop)","118 - AMD Radeon RX 560X (Laptop)","117 - NVIDIA GeForce GTX 965M","115 - AMD Radeon Pro WX 4150","114 - AMD Radeon RX 460 (Desktop)","112 - NVIDIA Quadro P1000","111 - NVIDIA Quadro K5100M","107 - AMD Radeon R9 270X","106 - NVIDIA GeForce GTX 950","105 - NVIDIA GeForce GTX 880M","103 - AMD Radeon R7 370","102 - AMD Radeon R9 M395","101 - AMD FirePro W7170M","100 - NVIDIA GeForce GTX 1050 Max-Q","99 - NVIDIA GeForce GTX 1050 (Laptop)","98 - NVIDIA GeForce GTX 1050 (Desktop)","97 - NVIDIA Quadro M3000M","94 - AMD Radeon R9 M485X","93 - AMD Radeon Pro Vega 16","92 - AMD Radeon Pro WX Vega M GL","91 - AMD Radeon RX Vega M GL / 870","90 - AMD Radeon R9 M395X","85 - NVIDIA Quadro M4000M","84 - NVIDIA GeForce GTX 970M","83 - NVIDIA Quadro P2000 Max-Q","82 - NVIDIA Quadro P2000","81 - NVIDIA GeForce GTX 1050 Ti Max-Q","80 - NVIDIA GeForce GTX 1050 Ti (Desktop)","79 - NVIDIA GeForce GTX 1050 Ti (Laptop)","78 - NVIDIA GeForce GTX 960","77 - AMD Radeon R9 380","76 - AMD Radeon R9 280X","75 - NVIDIA Quadro M5000M","74 - AMD Radeon Pro Vega 20","73 - AMD Radeon RX Vega M GH","72 - NVIDIA GeForce GTX 980M","65 - AMD Radeon R9 290X","62 - AMD Radeon RX 470 (Laptop)","61 - AMD Radeon RX 570 (Laptop)","60 - AMD Radeon RX 570X (Laptop)","59 - AMD Radeon RX 470 (Desktop)","58 - AMD Radeon Pro WX 7100","56 - NVIDIA Quadro P3000 Max-Q","55 - NVIDIA GeForce GTX 1060 Max-Q","54 - NVIDIA GeForce GTX 970","53 - NVIDIA Quadro P3000","52 - AMD Radeon RX Vega Mobile","50 - AMD Radeon RX 580 (Laptop)","49 - AMD Radeon RX 580X (Laptop)","48 - NVIDIA Quadro P3200","47 - NVIDIA Quadro P4000 Max-Q","46 - NVIDIA GeForce GTX 1060 (Laptop)","45 - AMD Radeon RX 480 (Desktop)","44 - NVIDIA Quadro P4000","43 - NVIDIA GeForce GTX 1660 Ti (Laptop)","42 - NVIDIA GeForce GTX 1060 (Desktop)","40 - AMD Radeon R9 390X","39 - NVIDIA Quadro M5500","38 - NVIDIA GeForce GTX 980 (Laptop)","37 - AMD Radeon RX 580 (Desktop)","36 - AMD Radeon RX 590 (Desktop)","35 - NVIDIA GeForce GTX 980","34 - AMD Radeon R9 Nano","33 - AMD Radeon R9 Fury","31 - NVIDIA Quadro P5000 Max-Q","30 - NVIDIA GeForce GTX 1070 Max-Q","29 - NVIDIA GeForce GTX 980 Ti","28 - NVIDIA Quadro P5000","27 - NVIDIA Quadro P4200","26 - NVIDIA GeForce GTX 1070 (Laptop)","25 - NVIDIA GeForce GTX 1080 Max-Q","24 - NVIDIA GeForce GTX 1070 (Desktop)","23 - AMD Radeon Pro Vega 56","22 - NVIDIA GeForce RTX 2060 Max-Q","21 - NVIDIA Quadro P5200","19 - NVIDIA GeForce RTX 2060 (Laptop)","18 - NVIDIA GeForce GTX 1070 Ti (Desktop)","17 - NVIDIA GeForce RTX 2060 (Desktop)","16 - NVIDIA GeForce GTX 1080 (Laptop)","15 - AMD Radeon RX Vega 64","14 - NVIDIA GeForce RTX 2070 Max-Q","13 - NVIDIA GeForce RTX 2070 (Laptop)","12 - NVIDIA GeForce GTX 1080 (Desktop)","11 - NVIDIA GeForce RTX 2070 (Desktop)","10 - NVIDIA GeForce GTX 1070 SLI (Laptop)","9 - NVIDIA GeForce GTX 1070 SLI (Desktop)","8 - NVIDIA GeForce GTX 1080 SLI (Laptop)","7 - NVIDIA Titan X Pascal","6 - NVIDIA GeForce GTX 1080 Ti (Desktop)","5 - NVIDIA GeForce RTX 2080 Max-Q","4 - NVIDIA GeForce RTX 2080 (Laptop)","3 - NVIDIA GeForce RTX 2080 (Desktop)","2 - NVIDIA GeForce RTX 2080 Ti (Desktop)","1 - NVIDIA Titan RTX"],l=["876 - ARM Mali-200","875 - Qualcomm Adreno 200","874 - PowerVR SGX530","873 - PowerVR SGX531","872 - PowerVR SGX535","871 - Vivante GC800","870 - Qualcomm Adreno 203","869 - Qualcomm Adreno 205","867 - PowerVR SGX540","865 - NVIDIA GeForce ULP (Tegra 2)","864 - ARM Mali-400 MP","863 - ARM Mali-400 MP2","862 - Vivante GC1000+ Dual-Core","861 - Qualcomm Adreno 220","860 - Broadcom VideoCore-IV","859 - NVIDIA GeForce ULP (Tegra 3)","858 - ARM Mali-400 MP4","857 - Vivante GC4000","856 - Qualcomm Adreno 225","848 - Qualcomm Adreno 302","847 - Vivante GC7000UL","846 - ARM Mali-T720","845 - Qualcomm Adreno 304","844 - Qualcomm Adreno 305","843 - Qualcomm Adreno 306","842 - Qualcomm Adreno 308","841 - PowerVR SGX544","840 - ARM Mali-T720 MP2","839 - PowerVR SGX544MP2","838 - PowerVR SGX545","835 - PowerVR SGX543MP2","825 - PowerVR SGX543MP3","817 - ARM Mali-T830 MP1","816 - ARM Mali-450 MP4","815 - ARM Mali-T720 MP4","814 - PowerVR GE8100","813 - PowerVR GE8320","812 - ARM Mali-T760 MP2","811 - Qualcomm Adreno 320","810 - ARM Mali-T624","809 - PowerVR SGX543MP4","782 - ARM Mali-T830 MP2","781 - Qualcomm Adreno 405","780 - PowerVR G6200","779 - NVIDIA GeForce Tegra 4","774 - ARM Mali-T604 MP4","768 - ARM Mali-T830 MP3","767 - ARM Mali-T860 MP2","763 - Qualcomm Adreno 505","762 - Qualcomm Adreno 506","761 - Qualcomm Adreno 508","760 - Qualcomm Adreno 509","759 - ARM Mali-T628 MP4","758 - PowerVR SGX554MP4","720 - ARM Mali-T760 MP4","719 - ARM Mali-T628 MP6","718 - Intel HD Graphics (Bay Trail)","717 - PowerVR G6400","716 - PowerVR GX6250","715 - PowerVR G6430","714 - Qualcomm Adreno 330","713 - Qualcomm Adreno 510","712 - Qualcomm Adreno 512","637 - ARM Mali-G51 MP4","636 - Intel HD Graphics (Cherry Trail)","634 - Qualcomm Adreno 616","633 - Qualcomm Adreno 418","613 - Qualcomm Adreno 420","612 - PowerVR GX6450","602 - ARM Mali-T880 MP2","601 - ARM Mali-T760 MP6","569 - ARM Mali-T880 MP4","568 - ARM Mali-G72 MP3","549 - Qualcomm Adreno 430","544 - ARM Mali-G71 MP2","543 - ARM Mali-T760 MP8","498 - ARM Mali-T880 MP12","497 - Apple A9 / PowerVR GT7600","496 - NVIDIA Tegra K1 Kepler GPU","495 - PowerVR GXA6850","494 - Qualcomm Adreno 530","455 - ARM Mali-G71 MP8","454 - ARM Mali-G72 MP12","453 - ARM Mali-G71 MP20","452 - ARM Mali-G72 MP18","451 - Qualcomm Adreno 540","450 - ARM Mali-G76 MP10","449 - Qualcomm Adreno 630","448 - Qualcomm Adreno 640","432 - Apple A10 Fusion GPU / PowerVR","345 - NVIDIA Tegra X1 Maxwell GPU","322 - Apple A9X / PowerVR Series 7XT","286 - Apple A10X Fusion GPU / PowerVR","285 - Apple A11 Bionic GPU","284 - Apple A12 Bionic GPU","255 - Apple A12X Bionic GPU"],c=function(e,t){var n=0;return t.map(function(t){var r=Math.round(e.length/100*t),i=e.slice(n,n+r);return n+=r,i})};n.d(t,"getGPUTier",function(){return a});var f=new s.DetectUA,d=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mobileBenchmarkPercentages=[10,40,30,20],this.desktopBenchmarkPercentages=[10,40,30,20],this.forceRendererString=!1,this.forceMobile=!1,r(this,t);var n,a,s,d,h=f.isMobile||f.isTablet||this.forceMobile,p=!h,v=function(){var e={alpha:!1,stencil:!1,antialias:!1,depth:!1,failIfMajorPerformanceCaveat:!0},t=document.createElement("canvas"),n=t.getContext("webgl",e)||t.getContext("experimental-webgl",e);return!!(n&&n instanceof WebGLRenderingContext)&&n}();if(!v)return h?{tier:"GPU_MOBILE_TIER_0",type:"WEBGL_UNSUPPORTED"}:{tier:"GPU_DESKTOP_TIER_0",type:"WEBGL_UNSUPPORTED"};n=!1===this.forceRendererString?function(e){if(e){var t=e.getExtension("WEBGL_debug_renderer_info");return t&&e.getParameter(t.UNMASKED_RENDERER_WEBGL)}return!1}(v):this.forceRendererString,(d=n.toLowerCase()).includes("angle (")&&d.includes("direct3d")&&(d=d.replace("angle (","").split(" direct3d")[0]),d.includes("nvidia")&&d.includes("gb")&&(d=d.split(/\dgb/)[0]);var m=(n=d).replace(/[\D]/g,"");if(/(radeon hd 6970m|radeon hd 6770m|radeon hd 6490m|radeon hd 6630m|radeon hd 6750m|radeon hd 5750|radeon hd 5670|radeon hd 4850|radeon hd 4870|radeon hd 4670|geforce 9400m|geforce 320m|geforce 330m|geforce gt 130|geforce gt 120|geforce gtx 285|geforce 8600|geforce 9600m|geforce 9400m|geforce 8800 gs|geforce 8800 gt|quadro fx 5|quadro fx 4|radeon hd 2600|radeon hd 2400|radeon hd 2600|mali-4|mali-3|mali-2)/.test(n))return h?{tier:"GPU_MOBILE_TIER_0",type:"BLACKLISTED"}:{tier:"GPU_DESKTOP_TIER_0",type:"BLACKLISTED"};if(h){var g=c(l,this.mobileBenchmarkPercentages),_=n.includes("adreno"),y=n.includes("apple"),b=n.includes("mali")&&!n.includes("mali-t"),w=n.includes("mali-t"),M=n.includes("nvidia"),x=n.includes("powervr");return g.forEach(function(e,t){return e.forEach(function(e){var n=i(e),r=o(n);(n.includes("adreno")&&_||n.includes("apple")&&y||n.includes("mali")&&!n.includes("mali-t")&&b||n.includes("mali-t")&&w||n.includes("nvidia")&&M||n.includes("powervr")&&x)&&r.includes(m)&&(a="GPU_MOBILE_TIER_".concat(t),s="BENCHMARK - ".concat(n))})}),a||(a="GPU_MOBILE_TIER_1",s="FALLBACK"),{tier:a,type:s}}if(p){var S=c(u,this.desktopBenchmarkPercentages),P=n.includes("intel"),C=n.includes("amd"),T=n.includes("nvidia");return S.forEach(function(e,t){return e.forEach(function(e){var n=i(e),r=o(n);(n.includes("intel")&&P||n.includes("amd")&&C||n.includes("nvidia")&&T)&&r.includes(m)&&(a="GPU_DESKTOP_TIER_".concat(t),s="BENCHMARK - ".concat(n))})}),a||(a="GPU_DESKTOP_TIER_1",s="FALLBACK"),{tier:a,type:s}}return{tier:a,type:s}}}])})},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,e),this.opts=t,this.scene=null,this.engine=null}return i(e,[{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.scene,n=e.engine;this.scene=t,this.engine=n,this.configurator=this.scene.moduleCtrl.get("configurator")}},{key:"getModule",value:function(e){return this.scene.moduleCtrl.get(e)}},{key:"getModules",value:function(){console.warn("Car.getModules() need to be implemented")}},{key:"getBounds",value:function(){console.warn("Car.getBounds() need to be implemented")}},{key:"getLoadables",value:function(){return[]}}]),e}();t.default=o,e.exports=t.default},function(e,t,n){"use strict";(function(r){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t,n,r,i){var o={};return Object.keys(r).forEach(function(e){o[e]=r[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}Object.defineProperty(t,"__esModule",{value:!0});var l,c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},d=n(81),h=i(d),p=n(250),v=i(p),m=n(251),g=i(m),_=n(252),y=i(_),b=n(253),w=i(b),M=n(16),x=i(M),S=(l=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.library=new v.default(e),n.configs=new g.default(e),n.views=new y.default(e),n.model=new w.default({scene:e,library:n.library,configs:n.configs,views:n.views}),n.library.parse(n.getLib()),n.configs.parse(n.getConfigs()),n.views.parse(n.getViews()),n}return s(t,e),c(t,[{key:"init",value:function(){f(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"init",this).call(this,"configurator")}},{key:"bind",value:function(){x.default.engine.loaded.add(this._onEngineLoaded),x.default.configs.updated.add(this._onConfigUpdated),x.default.library.updated.add(this._onLibraryPartChanged)}},{key:"unbind",value:function(){x.default.engine.loaded.remove(this._onEngineLoaded),x.default.configs.updated.remove(this._onConfigUpdated),x.default.library.updated.remove(this._onLibraryPartChanged)}},{key:"getLib",value:function(){console.warn("Configurator.getLib() need to be implemented")}},{key:"getConfigs",value:function(){console.warn("Configurator.getConfigs() need to be implemented")}},{key:"getViews",value:function(){console.warn("Configurator.getViews() need to be implemented")}},{key:"_updateMaterialsPart",value:function(e,t){var n=this.library.getMaterialsCfg(e,t);for(var r in n){var i=n[r],o=this.materials.getMaterial(r);o.transition?o.transition.to(i):console.warn("Configurator._updateMaterialsPart(): undefined material transition for '"+o.name+"'")}}},{key:"_onEngineLoaded",value:function(){this.configs.init()}},{key:"_onConfigUpdated",value:function(e){var t=e.parts;for(var n in t){var r=t[n];this.library.setPart(n,r)}}},{key:"_onLibraryPartChanged",value:function(e){var t=e.partKey,n=e.partCfgName,r=e.partCfg;if(this._updateMaterialsPart(t,n),"wheels"===t){this.scene.carScene.getMeshesByRegex(/tiregroup_/i).forEach(function(e){return e.setScale(r.size)});var i=this.scene.carScene.getNodesByRegex(/wheel_r/i),o=this.scene.carScene.getNodesByRegex(/steering_/i);i.concat(o).forEach(function(e){e.defaultZ||(e.defaultZ=e.z),e.z=e.defaultZ-r.offset}),this.scene.carScene.toggleNodesByRegex(/rim_/i,!1),this.scene.carScene.toggleNodesByRegex(new RegExp(r.rim,"i"),!0)}if("paint"===t){var a=this.library.getCurrentPartChoice("paint"),s=this.library.getCurrentPartChoice("stickers");if(!s)return;var u=this.library.getPartCfg("paint",a),l=u.dark,c=-1!==s.indexOf("dark");l&&c?this.library.setPart("stickers",s.replace("dark","light")):l||c||this.library.setPart("stickers",s.replace("light","dark"))}}}]),t}(h.default),u(l.prototype,"_onEngineLoaded",[r],Object.getOwnPropertyDescriptor(l.prototype,"_onEngineLoaded"),l.prototype),u(l.prototype,"_onConfigUpdated",[r],Object.getOwnPropertyDescriptor(l.prototype,"_onConfigUpdated"),l.prototype),u(l.prototype,"_onLibraryPartChanged",[r],Object.getOwnPropertyDescriptor(l.prototype,"_onLibraryPartChanged"),l.prototype),l);t.default=S,e.exports=t.default}).call(t,n(2).bind)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(52),s=r(a),u=n(16),l=r(u),c=function(){function e(t){i(this,e),this.scene=t,this.lib=null,this.parts=null,this.dataParts={}}return o(e,[{key:"parse",value:function(e){var t=e.lib,n=e.parts;this.lib=t,this.parts=n}},{key:"getParts",value:function(){return this.parts}},{key:"getPartChoices",value:function(e){var t=[],n=this.lib[e];for(var r in n){!0!==n[r].exclude&&t.push(r)}if("stickers"===e){var i=this.getPartCfg("paint",this.getCurrentPartChoice("paint")),o=i.dark;t=t.filter(function(e){var t=-1===e.indexOf("dark")&&-1===e.indexOf("light"),n=o&&-1!==e.indexOf("light"),r=!o&&-1!==e.indexOf("dark");return t||n||r})}return t}},{key:"getCurrentPartChoice",value:function(e){return this.dataParts[e]}},{key:"getPartCfg",value:function(e,t){return this.lib[e][t]}},{key:"setPart",value:function(e,t){if(this.dataParts[e]!==t){this.dataParts[e]=t;var n=this.getPartCfg(e,t),r={partKey:e,partCfgName:t,partCfg:n};l.default.library.updated.dispatch(r)}}},{key:"getMaterialsCfg",value:function(e,t){var n=this.lib[e][t].materials,r={};for(var i in n){var o=n[i],a=this._parseMatConfig(o);r[i]=a}return r}},{key:"_parseMatConfig",value:function(e){var t={};for(var n in e){var r=e[n];if(r){if("string"==typeof r){var i=r.slice(1);s.default.isHex(i)&&(r=parseInt(i,16),r=s.default.MakeFromHex(r))}t[n]=r}}return t}}]),e}();t.default=c,e.exports=t.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(16),a=function(e){return e&&e.__esModule?e:{default:e}}(o),s=function(){function e(t){r(this,e),this.scene=t,this.data=null,this.current=null,this.cfgs={}}return i(e,[{key:"parse",value:function(e){this.data=e;for(var t=0,n=e.length;t<n;t++){var r=e[t];this.cfgs[r.name]=r}}},{key:"init",value:function(){var e=this.cfgs;for(var t in e){e[t].isDefault&&this.setConfig(t)}}},{key:"updateConfig",value:function(e,t,n){this.cfgs[e].parts[t]=n}},{key:"getConfigs",value:function(){var e=[];for(var t in this.cfgs)e.push(t);return e}},{key:"getConfig",value:function(e){return this.cfgs[e]}},{key:"getCurrentConfig",value:function(){return this.current?this.cfgs[this.current]:null}},{key:"setConfig",value:function(e){if(this.current!==e){this.current=e;var t=this.getConfig(e);a.default.configs.updated.dispatch(t)}}}]),e}();t.default=s,e.exports=t.default},function(e,t,n){"use strict";(function(r){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t,n,r,i){var o={};return Object.keys(r).forEach(function(e){o[e]=r[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}Object.defineProperty(t,"__esModule",{value:!0});var s,u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(1),f=n(16),d=i(f),h=n(64),p=i(h),v=n(18),m=(s=function(){function e(t){o(this,e),this.scene=t,this.current=null,this.currentIdx=-1,this.data=[],this.dataMap={},this._bind()}return l(e,[{key:"parse",value:function(e){this.data=e;for(var t=0,n=e.length;t<n;t++){var r=e[t],i=r.name;this.dataMap[i]=r}}},{key:"getViews",value:function(){for(var e=[],t=0,n=this.data.length;t<n;t++){var r=this.data[t];e.push(r.name)}return e}},{key:"getView",value:function(e,t){var n=this.dataMap[e];"number"==typeof e&&(e=(0,v.modAbs)(e,this.data.length),n=this.data[e]);var r=n;if(n.hotspot){var i=this._getNearestViewSide(n),o=i.side,a=i.distance;n.symmetry&&!t&&(t=o),!0===n.symmetry&&(r=u({name:n.name,distance:a},n[t]))}return r}},{key:"getCurrentView",value:function(){return this.current?this.dataMap[this.current]:null}},{key:"updateView",value:function(e,t){var n=this.getView(e,t);if(n&&this.current!==n.name){this.current=n.name;for(var r=0,i=this.data.length;r<i;r++){this.data[r].name===n.name&&(this.currentIdx=r)}d.default.views.updated.dispatch(n)}}},{key:"goInside",value:function(){d.default.interior.inside.dispatch()}},{key:"goOutside",value:function(){d.default.interior.outside.dispatch()}},{key:"resetView",value:function(){if(!this.current||-1===this.currentIdx)return null;this.current=null,d.default.views.reseted.dispatch()}},{key:"prevView",value:function(){this.updateView(this.currentIdx-1)}},{key:"nextView",value:function(){this.updateView(this.currentIdx+1)}},{key:"_bind",value:function(){p.default.downed.add(this._onKeyboardDowned),d.default.views.update.add(this._onViewsUpdate),d.default.views.reset.add(this._onViewsReset)}},{key:"_unbind",value:function(){p.default.downed.remove(this._onKeyboardDowned),d.default.views.update.remove(this._onViewsUpdate),d.default.views.reset.remove(this._onViewsReset)}},{key:"_getNearestViewSide",value:function(e){var t="right",n=this.scene.carScene.views.viewPositions,r=n[e.picking+"-right"],i=n[e.picking+"-left"],o=c.vec3.distance(r,this.scene.camera.position),a=c.vec3.distance(i,this.scene.camera.position),s=Math.min(o,a);return o>a&&(t="left"),{side:t,distance:s}}},{key:"_onKeyboardDowned",value:function(e,t){}},{key:"_onViewsUpdate",value:function(e){var t=e.name,n=e.side;this.updateView(t,n)}},{key:"_onViewsReset",value:function(){this.resetView()}}]),e}(),a(s.prototype,"_onKeyboardDowned",[r],Object.getOwnPropertyDescriptor(s.prototype,"_onKeyboardDowned"),s.prototype),a(s.prototype,"_onViewsUpdate",[r],Object.getOwnPropertyDescriptor(s.prototype,"_onViewsUpdate"),s.prototype),a(s.prototype,"_onViewsReset",[r],Object.getOwnPropertyDescriptor(s.prototype,"_onViewsReset"),s.prototype),s);t.default=m,e.exports=t.default}).call(t,n(2).bind)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.scene,i=t.library,o=t.configs,a=t.views;r(this,e),this.scene=n,this.library=i,this.configs=o,this.views=a}return i(e,[{key:"getDataParts",value:function(){return this.library.dataParts}},{key:"getParts",value:function(){return this.library.getParts()}},{key:"getPartChoices",value:function(e){return this.library.getPartChoices(e)}},{key:"getCurrentPartChoice",value:function(e){return this.library.getCurrentPartChoice(e)}},{key:"setPart",value:function(e,t){this.library.setPart(e,t)}},{key:"getConfigs",value:function(){return this.configs.getConfigs()}},{key:"getCurrentConfig",value:function(){return this.configs.getCurrentConfig()}},{key:"setConfig",value:function(e){this.configs.setConfig(e)}},{key:"updateConfig",value:function(e,t,n){this.configs.updateConfig(e,t,n)}},{key:"getViews",value:function(){return this.views.getViews()}},{key:"getViewsData",value:function(){return this.views.data}},{key:"getCurrentView",value:function(){return this.views.getCurrentView()}},{key:"updateView",value:function(e){this.views.updateView(e)}},{key:"resetView",value:function(){this.views.resetView()}},{key:"toggleViews",value:function(e){this.scene.carScene.toggleViews(e)}},{key:"toggleViewsByRegex",value:function(e,t){this.scene.carScene.views.toggleByRegex(e,t)}},{key:"toggleViewsExterior",value:function(e){this.scene.car.configurator.model.toggleViewsByRegex(/.*/,!1),this.scene.car.configurator.model.toggleViewsByRegex(/wheels|stickers|\binterior\b/,e)}},{key:"toggleViewsInterior",value:function(e){this.scene.car.configurator.model.toggleViewsByRegex(/.*/,!1),this.scene.car.configurator.model.toggleViewsByRegex(/interior_/,e)}},{key:"goInside",value:function(){this.views.goInside()}},{key:"goOutside",value:function(){this.views.goOutside()}}]),e}();t.default=o,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},l=n(255),c=r(l),f=n(20),d=r(f),h=n(81),p=r(h),v=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"init",value:function(e){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"init",this).call(this,e),this.gltfScene=new c.default(this.scene,e),this.scene.sroot.add(this.gltfScene.node)}},{key:"preRender",value:function(e){this.gltfScene.preRender(e)}},{key:"render",value:function(){this.renderExperience()}},{key:"renderExperience",value:function(){this.gltfScene.render(d.default.OPAQUE),this.gltfScene.render(d.default.BLENDED)}},{key:"getLoadables",value:function(){return this.gltfScene.getLoadables()}}]),t}(p.default);t.default=v,e.exports=t.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(71),u=function(e){return e&&e.__esModule?e:{default:e}}(s),l=function(e){function t(e,n){r(this,t);var o=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return o.name=n,o}return o(t,e),a(t,[{key:"getGLTFUrl",value:function(){return this.name+".glb"}}]),t}(u.default);t.default=l,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(6),u=r(s),l=n(14),c=r(l),f=n(7),d=r(f),h=n(8),p=r(h),v=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.iAlbedo=r.inputs.add(new u.default("albedo",3)),r.iSpecular=r.inputs.add(new u.default("specular",3)),r.iGloss=r.inputs.add(new u.default("gloss_base",1)),r.iNormal=r.inputs.add(new u.default("normal",3)),r.iOcclusion=r.inputs.add(new u.default("occlusion",1)),r.iCavity=r.inputs.add(new u.default("cavity",1)),r.iCavityStrength=r.inputs.add(new u.default("cavityStrength",2)),r.iClearcoat=r.inputs.add(new u.default("clearcoat",2)),r.iEmissive=r.inputs.add(new u.default("emissive",1)),r.iEmissiveScale=r.inputs.add(new u.default("emissiveScale",1)),r.iFresnel=r.inputs.add(new u.default("fresnel",3)),r.iSpeckles=r.inputs.add(new u.default("speckles",2)),r.iSpecklesDisp=r.inputs.add(new u.default("specklesDisp",1)),r.iSpecklesScale=r.inputs.add(new u.default("specklesScale",1)),r.conserveEnergy=r.inputs.add(new c.default("conserveEnergy",!1)),r.perVertexIrrad=r.inputs.add(new c.default("perVertexIrrad",!0)),r.glossNearest=r.inputs.add(new c.default("glossNearest",!0)),r.inferBitangent=r.inputs.add(new c.default("inferBitangent",!0)),r.iLodDither=r.inputs.add(new u.default("lodDither",1)),r.lodDitherUniform=new u.default.Uniform("uLodDitherFactor",1),r.gammaMode=new d.default("gammaMode",["GAMMA_NONE","GAMMA_STD","GAMMA_2_2","GAMMA_TB"]),r.inputs.add(r.gammaMode),r.iGamma=r.inputs.add(new u.default("gamma",1)),r.iExposure=r.inputs.add(new u.default("exposure",1)),r.renderMode=p.default.RENDER_MODES.DEFAULT,r._uid="paint",r._vertSrc=n(257)(),r._fragSrc=n(258)(),r}return a(t,e),t}(p.default);t.default=v,e.exports=t.default},function(e,t,n){var r=function(e){var t="";return t+="#define GLSLIFY 1\n#pragma SLOT pv\n\n#if __VERSION__ == 300\n  #define IN in\n  #define OUT out\n#else\n  #define IN attribute\n  #define OUT varying\n#endif\n\nIN vec3 aPosition;\nIN vec2 aTexCoord;\nIN vec3 aNormal;\nIN vec3 aTangent;\n\n#if !inferBitangent\n  IN vec3 aBitangent;\n#endif\n\nuniform mat4 uMVP;\nuniform mat4 uWorldMatrix;\n\nOUT vec2 vTexCoord;\nOUT vec3 vWorldPosition;\nOUT vec3 vNormal;\n\nOUT mediump vec3 vWorldNormal;\n\n#if HAS_normal || HAS_speckles\n  OUT mediump vec3 vWorldTangent;\n  OUT mediump vec3 vWorldBitangent;\n#endif\n\n#if perVertexIrrad\n  OUT vec3 vIrradiance;\n  uniform vec4 uSHCoeffs[7];\n  \n"+n(3)()+"\n#endif\n\nvec3 rotate( mat4 m, vec3 v ) {\n  return m[0].xyz*v.x + m[1].xyz*v.y + m[2].xyz*v.z;\n}\n\nvoid main( void ) {\n  #pragma SLOT v\n\n  vec4 pos = vec4( aPosition, 1.0 );\n\n  gl_Position    = uMVP * pos;\n\n  vWorldPosition = (uWorldMatrix * pos).xyz;\n  vWorldNormal   = rotate( uWorldMatrix, aNormal );\n\n  #if inferBitangent\n    vec3 aBitangent = cross( aNormal, aTangent );\n  #endif\n\n  #if HAS_normal || HAS_speckles\n    vWorldTangent   = rotate( uWorldMatrix, aTangent );\n    vWorldBitangent = rotate( uWorldMatrix, aBitangent );\n  #endif\n\n  #if perVertexIrrad\n    vIrradiance = SampleSH( normalize( vWorldNormal ), uSHCoeffs );\n  #endif\n\n  vTexCoord = aTexCoord;\n  vNormal = aNormal;\n}\n"};r.toString=r,e.exports=r},function(e,t,n){var r=function(e){var t="";return t+="#define GLSLIFY 1\n#if __VERSION__ == 300\n  #define IN in\n  out vec4 FragColor;\n  #define texture2D(a,b) texture( a, b )\n#else\n  #define IN varying\n  #define FragColor gl_FragColor\n#endif\n\nuniform vec3 uCameraPosition;\n\n"+n(25)()+"\n\nIN vec2 vTexCoord;\nIN vec3 vWorldPosition;\n\nIN mediump vec3 vWorldNormal;\nIN vec3 vNormal;\n\n#pragma SLOT pf\n\n#if HAS_normal || HAS_speckles\n  IN mediump vec3 vWorldTangent;\n  IN mediump vec3 vWorldBitangent;\n#endif\n\n// IBL\n// ========\nuniform sampler2D tEnv;\nuniform sampler2D tEnvHi;\n\n"+n(21)()+"\n\n#if perVertexIrrad\n  IN vec3 vIrradiance;\n#else\n  uniform vec4 uSHCoeffs[7];\n  "+n(3)()+"\n#endif\n\n\n// MATH\n// =========\n#define saturate(x) clamp( x, 0.0, 1.0 )\n#define sdot( a, b ) saturate( dot(a,b) )\n\n\n// INCLUDES\n// =========\n"+n(12)()+"\n\n// ------------------------------\n\n#if HAS_normal\nvec3 perturbWorldNormal(vec3 n) {\n  n = 2.0 * n - 1.0;\n  vec3 nrm = gl_FrontFacing ? vWorldNormal : -vWorldNormal;\n  return normalize(vWorldTangent * n.x + vWorldBitangent * n.y + nrm );\n}\n#endif\n\n#if HAS_lodDither\n  float nrand(vec2 n) {\n    return fract(sin(dot(n.xy, vec2(12.9898, 78.233))) * 43758.5453);\n  }\n\n  void LOD_Dithering_Discard(vec2 sPos, float factor){\n    float RandCos = nrand(sPos);\n    float RandomVal = fract(RandCos * 1000.0);\n    lowp float RetVal = (factor < 0.0) ?\n        step( RandomVal, factor + 1.0 ) :\n        step(factor, RandomVal);\n    if(RetVal - .001 < 0.0){\n      discard;\n    }\n  }\n#endif\n\n//                MAIN\n// ===================\n\n#define gloss(k) gloss_base() * gloss_base() * 0.6\n\nvoid main( void ) {\n\n  #if HAS_speckles\n    vec2 vTexCoordSpeck = vTexCoord * specklesScale();\n  #endif\n\n  #pragma SLOT f\n\n  #if HAS_lodDither\n    LOD_Dithering_Discard( gl_FragCoord.xy, lodDither() );\n  #endif\n\n\n  // -----------\n  vec3 worldNormal =\n    #if HAS_normal\n      perturbWorldNormal( normal() );\n    #else\n      gl_FrontFacing ? vWorldNormal : -vWorldNormal;\n    #endif\n  worldNormal = normalize( worldNormal );\n\n\n  // SH Irradiance diffuse coeff\n  // -------------\n  #if perVertexIrrad\n    vec3 diffuseCoef = vIrradiance;\n  #else\n    vec3 diffuseCoef = SampleSH(worldNormal, uSHCoeffs );\n  #endif\n  \n\n  // IBL reflexion\n  // --------------\n  vec3 viewDir = normalize( uCameraPosition - vWorldPosition );\n  vec3 worldReflect = reflect( -viewDir, worldNormal );\n  float NoV = sdot( viewDir, worldNormal );\n\n\n  // Speckles\n  // --------------\n  #if HAS_speckles\n    vec2 speck = (speckles() - 0.5) * specklesDisp();\n    vec3 speckWorldNormal = normalize(vWorldTangent * speck.x + vWorldBitangent * speck.y + worldNormal);\n    vec3 secondaryWorldReflect = reflect(-viewDir, speckWorldNormal);\n  #else\n    vec3 secondaryWorldReflect = worldReflect;\n  #endif\n\n\n  // Clear coat\n  // --------------\n  float Fc = 1.0 - NoV;\n  Fc = Fc * Fc * Fc * Fc * Fc; \n  float F = Fc + ( 1.0 - Fc ) * clearcoat().y;\n  F *= clearcoat().x;\n  vec3 ccSpecular = F * SampleEnvHi( tEnvHi, worldReflect );\n\n\n  // Spec IBL\n  // --------------\n  vec3 specularColor = SpecularIBL( tEnv, secondaryWorldReflect, 1.0 - gloss() );\n\n  // Schlick\n  // --------------\n  vec3 specularSq = specular() * specular() * (1.0 - F);\n  Fc *= gloss() * gloss();\n  #if HAS_fresnel\n    specularColor *= Fc * fresnel() + ( 1.0 - Fc ) * specularSq;\n  #else\n    specularColor *= Fc + ( 1.0 - Fc ) * specularSq;\n  #endif\n  specularColor = ccSpecular + specularColor;\n\n  #pragma SLOT lightsf\n\n  vec3 alb = albedo();\n  #if conserveEnergy\n    alb = alb - alb * specular();\n  #endif\n  vec3 albedoSq = alb * alb;\n\n\n  #if HAS_occlusion\n    diffuseCoef *= occlusion();\n  #endif\n\n\n  #if HAS_cavity\n    #ifndef cavityStrength\n      #define cavityStrength(k) vec2(1.0)\n    #endif\n    diffuseCoef   *= cavity() * cavityStrength().r + (1.0 - cavityStrength().r);\n    specularColor *= cavity() * cavityStrength().g + (1.0 - cavityStrength().g);\n  #endif\n\n\n  #if HAS_emissive\n    float e = emissive();\n    #if HAS_emissiveScale\n      e = e * emissiveScale();\n    #endif\n    diffuseCoef += vec3( e ) * albedo();\n  #endif\n\n\n  FragColor.xyz = diffuseCoef * albedoSq + specularColor;\n\n\n  #if HAS_exposure\n    FragColor.xyz *= vec3( exposure() );\n  #endif\n\n  \n  #if gammaMode( GAMMA_STD ) && HAS_gamma\n    FragColor.xyz = pow( FragColor.xyz, vec3( gamma() ) );\n  #endif\n\n  #if gammaMode( GAMMA_2_2 )\n    FragColor.xyz = pow( FragColor.xyz, vec3( 1.0/2.2 ) );\n  #endif\n\n  #if gammaMode( GAMMA_TB )\n    {\n      vec3 c = FragColor.xyz;\n      vec3 sqrtc = sqrt(c);\n      FragColor.xyz = (sqrtc - sqrtc * c) + c * (0.4672 * c + vec3(0.5328));\n    }\n  #endif\n\n  FragColor.a = 1.0;\n\n  "+n(26)()+"\n\n  // FragColor.rgb = vec3( gloss() );\n  // FragColor.rgb = vec3( albedo() );\n  // FragColor.rgb = vec3( specular() );\n  // FragColor.rgb = vNormal + vec3(.5);\n  \n}\n"};r.toString=r,e.exports=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(6),u=r(s),l=n(14),c=r(l),f=n(7),d=r(f),h=n(8),p=r(h),v=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.iAlbedo=r.inputs.add(new u.default("albedo",3)),r.iSpecular=r.inputs.add(new u.default("specular",3)),r.iGloss=r.inputs.add(new u.default("gloss_base",1)),r.iNormal=r.inputs.add(new u.default("normal",3)),r.iOcclusion=r.inputs.add(new u.default("occlusion",1)),r.iCavity=r.inputs.add(new u.default("cavity",1)),r.iCavityStrength=r.inputs.add(new u.default("cavityStrength",2)),r.iEmissive=r.inputs.add(new u.default("emissive",1)),r.iEmissiveScale=r.inputs.add(new u.default("emissiveScale",1)),r.iFresnel=r.inputs.add(new u.default("fresnel",3)),r.iNoise=r.inputs.add(new u.default("noise",1)),r.iNoiseScale=r.inputs.add(new u.default("noiseScale",2)),r.iNoiseIntensity=r.inputs.add(new u.default("noiseIntensity",2)),r.conserveEnergy=r.inputs.add(new c.default("conserveEnergy",!1)),r.perVertexIrrad=r.inputs.add(new c.default("perVertexIrrad",!0)),r.glossNearest=r.inputs.add(new c.default("glossNearest",!0)),r.inferBitangent=r.inputs.add(new c.default("inferBitangent",!0)),r.iLodDither=r.inputs.add(new u.default("lodDither",1)),r.lodDitherUniform=new u.default.Uniform("uLodDitherFactor",1),r.gammaMode=new d.default("gammaMode",["GAMMA_NONE","GAMMA_STD","GAMMA_2_2","GAMMA_TB"]),r.inputs.add(r.gammaMode),r.iGamma=r.inputs.add(new u.default("gamma",1)),r.iExposure=r.inputs.add(new u.default("exposure",1)),r.renderMode=p.default.RENDER_MODES.DEFAULT,r._uid="plastic",r._vertSrc=n(260)(),r._fragSrc=n(261)(),r}return a(t,e),t}(p.default);t.default=v,e.exports=t.default},function(e,t,n){var r=function(e){var t="";return t+="#define GLSLIFY 1\n#pragma SLOT pv\n\n\n#if __VERSION__ == 300\n  #define IN in\n  #define OUT out\n#else\n  #define IN attribute\n  #define OUT varying\n#endif\n\n\nIN vec3 aPosition;\nIN vec2 aTexCoord;\nIN vec2 aTexCoord1;\nIN vec3 aNormal;\nIN vec3 aTangent;\n\n#if !inferBitangent\n  IN vec3 aBitangent;\n#endif\n\nuniform mat4 uMVP;\nuniform mat4 uWorldMatrix;\n\nOUT vec2 vTexCoord;\nOUT vec2 vTexCoord1;\nOUT vec3 vWorldPosition;\nOUT vec3 vNormal;\n\nOUT mediump vec3 vWorldNormal;\n\n#if HAS_normal\n  OUT mediump vec3 vWorldTangent;\n  OUT mediump vec3 vWorldBitangent;\n#endif\n\n#if perVertexIrrad\n  OUT vec3 vIrradiance;\n  uniform vec4 uSHCoeffs[7];\n  \n"+n(3)()+"\n#endif\n\nvec3 rotate( mat4 m, vec3 v ) {\n  return m[0].xyz*v.x + m[1].xyz*v.y + m[2].xyz*v.z;\n}\n\nvoid main( void ) {\n  #pragma SLOT v\n\n  vec4 pos = vec4( aPosition, 1.0 );\n\n  gl_Position    = uMVP * pos;\n\n  vWorldPosition = (uWorldMatrix * pos).xyz;\n  vWorldNormal   = rotate( uWorldMatrix, aNormal );\n\n  #if inferBitangent\n    vec3 aBitangent = cross( aNormal, aTangent );\n  #endif\n\n  #if HAS_normal\n    vWorldTangent   = rotate( uWorldMatrix, aTangent );\n    vWorldBitangent = rotate( uWorldMatrix, aBitangent );\n  #endif\n\n  #if perVertexIrrad\n    vIrradiance = SampleSH( normalize( vWorldNormal ), uSHCoeffs );\n  #endif\n\n  vTexCoord = aTexCoord;\n  vTexCoord1 = aTexCoord1;\n  vNormal = aNormal;\n}\n"};r.toString=r,e.exports=r},function(e,t,n){var r=function(e){var t="";return t+="#define GLSLIFY 1\n#if __VERSION__ == 300\n  #define IN in\n  out vec4 FragColor;\n  #define texture2D(a,b) texture( a, b )\n#else\n  #define IN varying\n  #define FragColor gl_FragColor\n#endif\n\n\nuniform vec3 uCameraPosition;\n\n"+n(25)()+"\n\nIN vec2 vTexCoord;\nIN vec2 vTexCoord1;\nIN vec3 vWorldPosition;\nIN mediump vec3 vWorldNormal;\nIN vec3 vNormal;\n\n#pragma SLOT pf\n\n#if HAS_normal\n  IN mediump vec3 vWorldTangent;\n  IN mediump vec3 vWorldBitangent;\n#endif\n\n// IBL\n// ========\nuniform sampler2D tEnv;\n\n#if perVertexIrrad\n  IN vec3 vIrradiance;\n#else\n  uniform vec4 uSHCoeffs[7];\n  "+n(3)()+"\n#endif\n\n\n\n// MATH\n// =========\n#define saturate(x) clamp( x, 0.0, 1.0 )\n#define sdot( a, b ) saturate( dot(a,b) )\n\n\n// INCLUDES\n// =========\n\n"+n(12)()+'\n\n\n\n// Schlick approx\n// [Schlick 1994, "An Inexpensive BRDF Model for Physically-Based Rendering"]\n// https://github.com/EpicGames/UnrealEngine/blob/dff3c48be101bb9f84633a733ef79c91c38d9542/Engine/Shaders/BRDF.usf#L168\nvec3 F_Schlick( float VoH,vec3 spec,float glo )\n{\n  float dot = glo*glo * pow( 1.0-VoH, 5.0 );\n  #if HAS_fresnel\n    return( 1.0 - dot )*spec + dot*fresnel();\n  #else\n    return( 1.0 - dot )*spec + dot;\n  #endif\n}\n\n\n// ------------------------------\n//\n\n#if HAS_normal\nvec3 perturbWorldNormal(vec3 n){\n  n = 2.0*n - 1.0;\n  vec3 nrm = gl_FrontFacing ? vWorldNormal : -vWorldNormal;\n  return normalize(vWorldTangent * n.x + vWorldBitangent*n.y + nrm );\n}\n#endif\n\n#if HAS_lodDither\n\n  float nrand(vec2 n) {\n    return fract(sin(dot(n.xy, vec2(12.9898, 78.233)))* 43758.5453);\n  }\n\n\n  void LOD_Dithering_Discard(vec2 sPos, float factor){\n    float RandCos = nrand(sPos);\n    float RandomVal = fract(RandCos * 1000.0);\n    lowp float RetVal = (factor < 0.0) ?\n        step( RandomVal, factor + 1.0 ) :\n        step(factor , RandomVal);\n    if(RetVal - .001 < 0.0){\n      discard;\n    }\n  }\n#endif\n\n//                MAIN\n// ===================\n\n#define spec(k) VAL_specular\n#define gloss(k) VAL_gloss\n\nvoid main( void ){\n\n  #pragma SLOT f\n\n  vec3 VAL_specular = specular();\n  float VAL_gloss   = gloss_base();\n\n  #if HAS_noise\n    vec3 specNoise = texture2D(tNoise, vTexCoord * noiseScale().x).rgb;\n    vec3 glossNoise = texture2D(tNoise, vTexCoord * noiseScale().y).rgb;\n\n    VAL_specular -= noiseIntensity().x * vec3(specNoise.r);\n    // VAL_gloss += noiseIntensity().y * glossNoise.r;\n  #endif\n\n\n  #if HAS_lodDither\n    LOD_Dithering_Discard( gl_FragCoord.xy, lodDither() );\n  #endif\n\n\n  // -----------\n  vec3 worldNormal =\n    #if HAS_normal\n      perturbWorldNormal( normal() );\n    #else\n      gl_FrontFacing ? vWorldNormal : -vWorldNormal;\n    #endif\n  worldNormal = normalize( worldNormal );\n\n\n  // SH Irradiance diffuse coeff\n  // -------------\n  #if perVertexIrrad\n    vec3 diffuseCoef = vIrradiance;\n  #else\n    vec3 diffuseCoef = SampleSH(worldNormal, uSHCoeffs );\n  #endif\n\n\n\n  // IBL reflexion\n  // --------------\n\n  vec3 viewDir = normalize( uCameraPosition - vWorldPosition );\n  vec3 worldReflect = reflect( -viewDir, worldNormal );\n  vec3 specularColor = SpecularIBL( tEnv, worldReflect, 1.0-gloss() );\n\n\n  #pragma SLOT lightsf\n\n\n  float NoV = sdot( viewDir, worldNormal );\n  vec3 specularSq = spec()*spec();\n  specularColor *= F_Schlick( NoV, specularSq, gloss() );\n\n\n  vec3 alb = albedo();\n  #if conserveEnergy\n    alb = alb - alb * spec();\n  #endif\n  vec3 albedoSq = alb*alb;\n\n\n\n  #if HAS_occlusion\n    diffuseCoef *= occlusion();\n  #endif\n\n\n  #if HAS_cavity\n    #ifndef cavityStrength\n      #define cavityStrength(k) vec2(1.0)\n    #endif\n    diffuseCoef   *= cavity() * cavityStrength().r + (1.0-cavityStrength().r);\n    specularColor *= cavity() * cavityStrength().g + (1.0-cavityStrength().g);\n  #endif\n\n\n  #if HAS_emissive\n    float e = emissive();\n    #if HAS_emissiveScale\n      e = e * emissiveScale();\n    #endif\n    diffuseCoef += vec3( e ) * albedo();\n  #endif\n\n  \n\n  FragColor.xyz = diffuseCoef * albedoSq + specularColor;\n\n\n  #if HAS_exposure\n    FragColor.xyz *= vec3( exposure() );\n  #endif\n\n  \n  #if gammaMode( GAMMA_STD ) && HAS_gamma\n    FragColor.xyz = pow( FragColor.xyz, vec3( gamma() ) );\n  #endif\n\n  #if gammaMode( GAMMA_2_2 )\n    FragColor.xyz = pow( FragColor.xyz, vec3( 1.0/2.2 ) );\n  #endif\n\n  #if gammaMode( GAMMA_TB )\n    {\n      vec3 c = FragColor.xyz;\n      vec3 sqrtc = sqrt( c );\n      FragColor.xyz = (sqrtc-sqrtc*c) + c*(0.4672*c+vec3(0.5328));\n    }\n  #endif\n\n  FragColor.a = 1.0;\n\n  '+n(26)()+"\n\n  // FragColor.rgb = vec3( gloss() );\n  // FragColor.rgb = vec3( albedo() );\n  // FragColor.rgb = vec3( specular() );\n  // FragColor.rgb = vNormal + vec3(.5);\n}\n"};r.toString=r,e.exports=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(6),u=r(s),l=n(14),c=r(l),f=n(7),d=r(f),h=n(8),p=r(h),v=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.iAlbedo=r.inputs.add(new u.default("albedo",3)),r.iSpecular=r.inputs.add(new u.default("specular",3)),r.iGloss=r.inputs.add(new u.default("gloss_base",1)),r.iNormal=r.inputs.add(new u.default("normal",3)),r.iOcclusion=r.inputs.add(new u.default("occlusion",1)),r.iCavity=r.inputs.add(new u.default("cavity",1)),r.iCavityStrength=r.inputs.add(new u.default("cavityStrength",2)),r.iEmissive=r.inputs.add(new u.default("emissive",1)),r.iEmissiveScale=r.inputs.add(new u.default("emissiveScale",1)),r.iFresnel=r.inputs.add(new u.default("fresnel",3)),r.iPattern=r.inputs.add(new u.default("pattern",1)),r.iPatternScale=r.inputs.add(new u.default("patternScale",1)),r.iPatternIntensity=r.inputs.add(new u.default("patternIntensity",1)),r.conserveEnergy=r.inputs.add(new c.default("conserveEnergy",!0)),r.perVertexIrrad=r.inputs.add(new c.default("perVertexIrrad",!1)),r.glossNearest=r.inputs.add(new c.default("glossNearest",!1)),r.inferBitangent=r.inputs.add(new c.default("inferBitangent",!0)),r.iLodDither=r.inputs.add(new u.default("lodDither",1)),r.lodDitherUniform=new u.default.Uniform("uLodDitherFactor",1),r.gammaMode=new d.default("gammaMode",["GAMMA_NONE","GAMMA_STD","GAMMA_2_2","GAMMA_TB"]),r.inputs.add(r.gammaMode),r.iGamma=r.inputs.add(new u.default("gamma",1)),r.iExposure=r.inputs.add(new u.default("exposure",1)),r.renderMode=p.default.RENDER_MODES.DEFAULT,r._uid="fabric",r._vertSrc=n(263)(),r._fragSrc=n(264)(),r}return a(t,e),t}(p.default);t.default=v,e.exports=t.default},function(e,t,n){var r=function(e){var t="";return t+="#define GLSLIFY 1\n#pragma SLOT pv\n\n\n#if __VERSION__ == 300\n  #define IN in\n  #define OUT out\n#else\n  #define IN attribute\n  #define OUT varying\n#endif\n\n\nIN vec3 aPosition;\nIN vec2 aTexCoord;\nIN vec3 aNormal;\nIN vec3 aTangent;\n\n#if !inferBitangent\n  IN vec3 aBitangent;\n#endif\n\nuniform mat4 uMVP;\nuniform mat4 uWorldMatrix;\n\nOUT vec2 vTexCoord;\nOUT vec3 vWorldPosition;\nOUT vec3 vNormal;\n\nOUT mediump vec3 vWorldNormal;\n\n#if HAS_normal\n  OUT mediump vec3 vWorldTangent;\n  OUT mediump vec3 vWorldBitangent;\n#endif\n\n#if perVertexIrrad\n  OUT vec3 vIrradiance;\n  uniform vec4 uSHCoeffs[7];\n  \n"+n(3)()+"\n#endif\n\nvec3 rotate( mat4 m, vec3 v ) {\n  return m[0].xyz*v.x + m[1].xyz*v.y + m[2].xyz*v.z;\n}\n\nvoid main( void ) {\n  #pragma SLOT v\n\n  vec4 pos = vec4( aPosition, 1.0 );\n\n  gl_Position    = uMVP * pos;\n\n  vWorldPosition = (uWorldMatrix * pos).xyz;\n  vWorldNormal   = rotate( uWorldMatrix, aNormal );\n\n  #if inferBitangent\n    vec3 aBitangent = cross( aNormal, aTangent );\n  #endif\n\n  #if HAS_normal\n    vWorldTangent   = rotate( uWorldMatrix, aTangent );\n    vWorldBitangent = rotate( uWorldMatrix, aBitangent );\n  #endif\n\n  #if perVertexIrrad\n    vIrradiance = SampleSH( normalize( vWorldNormal ), uSHCoeffs );\n  #endif\n\n  vTexCoord = aTexCoord;\n  vNormal = aNormal;\n}\n"};r.toString=r,e.exports=r},function(e,t,n){var r=function(e){var t="";return t+="#define GLSLIFY 1\n#if __VERSION__ == 300\n  #define IN in\n  out vec4 FragColor;\n  #define texture2D(a,b) texture( a, b )\n#else\n  #define IN varying\n  #define FragColor gl_FragColor\n#endif\n\nuniform vec3 uCameraPosition;\n\n"+n(25)()+"\n\nIN vec2 vTexCoord;\nIN vec3 vWorldPosition;\nIN mediump vec3 vWorldNormal;\nIN vec3 vNormal;\n\n#pragma SLOT pf\n\n#if HAS_normal\n  IN mediump vec3 vWorldTangent;\n  IN mediump vec3 vWorldBitangent;\n#endif\n\nuniform sampler2D tNoise;\n\n// IBL\n// ========\nuniform sampler2D tEnv;\n\n#if perVertexIrrad\n  IN vec3 vIrradiance;\n#else\n  uniform vec4 uSHCoeffs[7];\n  "+n(3)()+"\n#endif\n\n// MATH\n// =========\n#define saturate(x) clamp( x, 0.0, 1.0 )\n#define sdot( a, b ) saturate( dot(a,b) )\n\n\n// INCLUDES\n// =========\n\n"+n(12)()+'\n\n\n\n// Schlick approx\n// [Schlick 1994, "An Inexpensive BRDF Model for Physically-Based Rendering"]\n// https://github.com/EpicGames/UnrealEngine/blob/dff3c48be101bb9f84633a733ef79c91c38d9542/Engine/Shaders/BRDF.usf#L168\nvec3 F_Schlick( float VoH,vec3 spec,float glo )\n{\n  float dot = glo*glo * pow( 1.0-VoH, 5.0 );\n  #if HAS_fresnel\n    return( 1.0 - dot )*spec + dot*fresnel();\n  #else\n    return( 1.0 - dot )*spec + dot;\n  #endif\n}\n\n\n// ------------------------------\n//\n\n#if HAS_normal\nvec3 perturbWorldNormal(vec3 n){\n  n = 2.0*n - 1.0;\n  vec3 nrm = gl_FrontFacing ? vWorldNormal : -vWorldNormal;\n  return normalize(vWorldTangent * n.x + vWorldBitangent*n.y + nrm );\n}\n#endif\n\n#if HAS_lodDither\n\n  float nrand(vec2 n) {\n    return fract(sin(dot(n.xy, vec2(12.9898, 78.233)))* 43758.5453);\n  }\n\n\n  void LOD_Dithering_Discard(vec2 sPos, float factor){\n    float RandCos = nrand(sPos);\n    float RandomVal = fract(RandCos * 1000.0);\n    lowp float RetVal = (factor < 0.0) ?\n        step( RandomVal, factor + 1.0 ) :\n        step(factor , RandomVal);\n    if(RetVal - .001 < 0.0){\n      discard;\n    }\n  }\n#endif\n\n//                MAIN\n// ===================\n\n#define spec(k) VAL_specular\n#define gloss(k) VAL_gloss\n\nvoid main( void ){\n\n  #if HAS_pattern\n    vec2 vTexCoordPattern = vTexCoord * patternScale();\n  #endif\n\n  #pragma SLOT f\n\n  vec3 VAL_specular = specular();\n\n  #if HAS_pattern\n    float pattern = pattern() * patternIntensity();\n    VAL_specular *= -pattern;\n  #endif\n\n  float VAL_gloss   = gloss_base();\n\n  #if HAS_lodDither\n    LOD_Dithering_Discard( gl_FragCoord.xy, lodDither() );\n  #endif\n\n\n  // -----------\n  vec3 worldNormal =\n    #if HAS_normal\n      perturbWorldNormal( normal() );\n    #else\n      gl_FrontFacing ? vWorldNormal : -vWorldNormal;\n    #endif\n  worldNormal = normalize( worldNormal );\n\n\n  // SH Irradiance diffuse coeff\n  // -------------\n  #if perVertexIrrad\n    vec3 diffuseCoef = vIrradiance;\n  #else\n    vec3 diffuseCoef = SampleSH(worldNormal, uSHCoeffs );\n  #endif\n\n  // IBL reflexion\n  // --------------\n\n  vec3 viewDir = normalize( uCameraPosition - vWorldPosition );\n  vec3 worldReflect = reflect( -viewDir, worldNormal );\n  vec3 specularColor = SpecularIBL( tEnv, worldReflect, 1.0-gloss() );\n\n\n  #pragma SLOT lightsf\n\n\n  float NoV = sdot( viewDir, worldNormal );\n  vec3 specularSq = spec()*spec();\n  specularColor *= F_Schlick( NoV, specularSq, gloss() );\n\n\n  vec3 alb = albedo();\n  #if conserveEnergy\n    alb = alb - alb * spec();\n  #endif\n  vec3 albedoSq = alb*alb;\n\n\n\n  #if HAS_occlusion\n    diffuseCoef *= occlusion();\n  #endif\n\n\n  #if HAS_cavity\n    #ifndef cavityStrength\n      #define cavityStrength(k) vec2(1.0)\n    #endif\n    diffuseCoef   *= cavity() * cavityStrength().r + (1.0-cavityStrength().r);\n    specularColor *= cavity() * cavityStrength().g + (1.0-cavityStrength().g);\n  #endif\n\n\n  #if HAS_emissive\n    float e = emissive();\n    #if HAS_emissiveScale\n      e = e * emissiveScale();\n    #endif\n    diffuseCoef += vec3( e ) * albedo();\n  #endif\n\n  \n\n  FragColor.xyz = diffuseCoef * albedoSq + specularColor;\n\n\n  #if HAS_exposure\n    FragColor.xyz *= vec3( exposure() );\n  #endif\n\n  \n  #if gammaMode( GAMMA_STD ) && HAS_gamma\n    FragColor.xyz = pow( FragColor.xyz, vec3( gamma() ) );\n  #endif\n\n  #if gammaMode( GAMMA_2_2 )\n    FragColor.xyz = pow( FragColor.xyz, vec3( 1.0/2.2 ) );\n  #endif\n\n  #if gammaMode( GAMMA_TB )\n    {\n      vec3 c = FragColor.xyz;\n      vec3 sqrtc = sqrt( c );\n      FragColor.xyz = (sqrtc-sqrtc*c) + c*(0.4672*c+vec3(0.5328));\n    }\n  #endif\n\n  FragColor.a = 1.0;\n\n  '+n(26)()+"\n\n  // FragColor.rgb = vec3( gloss() );\n  // FragColor.rgb = vec3( albedo() );\n  // FragColor.rgb = vec3( specular() );\n  // FragColor.rgb = vNormal + vec3(.5);\n\n}\n"};r.toString=r,e.exports=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(6),u=r(s),l=n(14),c=r(l),f=n(7),d=r(f),h=n(20),p=r(h),v=n(8),m=r(v),g=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.iGloss=r.inputs.add(new u.default("gloss",1)),r.iCavity=r.inputs.add(new u.default("cavity",1)),r.iCavityStrength=r.inputs.add(new u.default("cavityStrength",2)),r.perVertexIrrad=r.inputs.add(new c.default("perVertexIrrad",!0)),r.glossNearest=r.inputs.add(new c.default("glossNearest",!0)),r.gammaMode=new d.default("gammaMode",["GAMMA_NONE","GAMMA_STD","GAMMA_2_2","GAMMA_TB"]),r.inputs.add(r.gammaMode),r.iGamma=r.inputs.add(new u.default("gamma",1)),r.iExposure=r.inputs.add(new u.default("exposure",1)),r.iFog=r.inputs.add(new c.default("fog",!1)),r.config.enableCullface(),r.config.enableBlend(),r.config.blendFunc(e.ZERO,e.SRC_COLOR),r.config.enableDepthTest(),r.config.depthMask(!1),r._uid="ground_ao",r._mask=p.default.BLENDED,r._vertSrc=n(266)(),r._fragSrc=n(267)(),r}return a(t,e),t}(m.default);t.default=g,e.exports=t.default},function(e,t,n){var r=function(e){var t="";return t+="#define GLSLIFY 1\n#pragma SLOT pv\n\n#if __VERSION__ == 300\n  #define IN in\n  #define OUT out\n#else\n  #define IN attribute\n  #define OUT varying\n#endif\n\nIN vec3 aPosition;\nIN vec2 aTexCoord;\nIN vec3 aNormal;\n\nuniform mat4 uMVP;\nuniform mat4 uWorldMatrix;\n\nOUT vec2 vTexCoord;\nOUT vec3 vWorldPosition;\n\nOUT mediump vec3 vWorldNormal;\n\n#if perVertexIrrad\n  OUT vec3 vIrradiance;\n  uniform vec4 uSHCoeffs[7];\n  \n  "+n(3)()+"\n#endif\n\nvec3 rotate( mat4 m, vec3 v ) {\n  return m[0].xyz*v.x + m[1].xyz*v.y + m[2].xyz*v.z;\n}\n\nvoid main( void ) {\n\n  #pragma SLOT v\n\n  vec4 pos = vec4( aPosition, 1.0 );\n\n  gl_Position    = uMVP * pos;\n\n  vWorldPosition = (uWorldMatrix * pos).xyz;\n  vWorldNormal   = rotate( uWorldMatrix, aNormal );\n\n  vTexCoord = aTexCoord;\n\n}\n"};r.toString=r,e.exports=r},function(e,t,n){var r=function(e){var t="";return t+="#define GLSLIFY 1\n#if __VERSION__ == 300\n  #define IN in\n  out vec4 FragColor;\n  #define texture2D(a,b) texture( a, b )\n#else\n  #define IN varying\n  #define FragColor gl_FragColor\n#endif\n\nuniform vec3 uCameraPosition;\n\nIN vec2 vTexCoord;\nIN vec3 vWorldPosition;\n\nIN mediump vec3 vWorldNormal;\n\n#pragma SLOT pf\n\n// IBL\n// ========\nuniform sampler2D tEnv;\n\n#if perVertexIrrad\n  IN vec3 vIrradiance;\n#else\n  uniform vec4 uSHCoeffs[7];\n  "+n(3)()+"\n#endif\n\n// MATH\n// =========\n#define saturate(x) clamp( x, 0.0, 1.0 )\n#define sdot( a, b ) saturate( dot(a,b) )\n\n// INCLUDES\n// =========\n"+n(12)()+"\n\n#if fog\n  "+n(34)()+"\n#endif\n\nvoid main( void ) {\n\n  #pragma SLOT f\n\n  vec3 worldNormal = gl_FrontFacing ? vWorldNormal : -vWorldNormal;\n  worldNormal = normalize( worldNormal );\n\n  // SH Irradiance diffuse coeff\n  // -------------\n  #if perVertexIrrad\n    vec3 diffuseCoef = vIrradiance;\n  #else\n    vec3 diffuseCoef = SampleSH(worldNormal, uSHCoeffs );\n  #endif\n\n  // IBL reflexion\n  // --------------\n  vec3 viewDir = normalize( uCameraPosition - vWorldPosition );\n  vec3 worldReflect = reflect( -viewDir, worldNormal );\n\n  vec3 specularColor = SpecularIBL( tEnv, worldReflect, 1.0 - gloss() );\n\n  vec3 lightDir = normalize( vec3( 0.0, 1.0, 1.0 ) );\n  float lighting = dot( lightDir, worldNormal );\n  lighting = 0.85 * pow( lighting, 2.0 );\n  diffuseCoef += vec3( lighting );\n\n  #if HAS_cavity\n    #ifndef cavityStrength\n      #define cavityStrength(k) vec2(1.0)\n    #endif\n    diffuseCoef   *= cavity() * cavityStrength().r + (1.0 - cavityStrength().r);\n    specularColor *= cavity() * cavityStrength().g + (1.0 - cavityStrength().g);\n  #endif\n\n  FragColor.rgb = (diffuseCoef + specularColor * 0.05);\n\n  #if HAS_exposure\n    FragColor.xyz *= vec3( exposure() );\n  #endif\n\n  #if gammaMode( GAMMA_STD ) && HAS_gamma\n    FragColor.xyz = pow( FragColor.xyz, vec3( gamma() ) );\n  #endif\n\n  #if gammaMode( GAMMA_2_2 )\n    FragColor.xyz = pow( FragColor.xyz, vec3( 1.0/2.2 ) );\n  #endif\n\n  #if gammaMode( GAMMA_TB )\n    {\n      vec3 c = FragColor.xyz;\n      vec3 sqrtc = sqrt( c );\n      FragColor.xyz = (sqrtc-sqrtc*c) + c*(0.4672*c+vec3(0.5328));\n    }\n  #endif\n\n  #if fog\n    "+n(35)()+"\n  #endif\n}\n"};r.toString=r,e.exports=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(20),u=r(s),l=n(8),c=r(l),f=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.config.enableCullface().enableBlend().blendFunc(r.gl.SRC_ALPHA,r.gl.ONE_MINUS_SRC_ALPHA).enableDepthTest().depthMask(!1),r._uid="ground-gradient",r._mask=u.default.BLENDED,r._vertSrc=n(269)(),r._fragSrc=n(270)(),r}return a(t,e),t}(c.default);t.default=f,e.exports=t.default},function(e,t){var n=function(e){var t="";return t+="#define GLSLIFY 1\n#pragma SLOT pv\n\n#if __VERSION__ == 300\n  #define IN in\n  #define OUT out\n#else\n  #define IN attribute\n  #define OUT varying\n#endif\n\nattribute vec3 aPosition;\nattribute vec2 aTexCoord;\n\nuniform mat4 uMVP;\nuniform mat4 uWorldMatrix;\n\nOUT vec2 vTexCoord;\nOUT vec3 vWorldPosition;\n\nvoid main( void ) {\n  vec4 pos = vec4( aPosition, 1.0 );\n  gl_Position = uMVP * pos;\n\n  vTexCoord = aTexCoord;\n  vWorldPosition = (uWorldMatrix * pos).xyz;\n}\n"};n.toString=n,e.exports=n},function(e,t){var n=function(e){var t="";return t+="#define GLSLIFY 1\n#if __VERSION__ == 300\n  #define IN in\n  out vec4 FragColor;\n  #define texture2D(a,b) texture( a, b )\n#else\n  #define IN varying\n  #define FragColor gl_FragColor\n#endif\n\nuniform float uAlpha;\n\nIN vec2 vTexCoord;\nIN vec3 vWorldPosition;\n\n#pragma SLOT pf\n\nfloat map(float value, float inMin, float inMax, float outMin, float outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nvoid main( void ) {\n  #pragma SLOT f\n\n  FragColor.rgb = vec3(0.9686274509803922,0.792156862745098,0.49411764705882355);\n  FragColor.a = mix(0.0, 1.0, pow(vTexCoord.x + 0.06, 16.0)) * 0.95 * uAlpha;\n}\n"};n.toString=n,e.exports=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(6),u=r(s),l=n(14),c=r(l),f=n(7),d=r(f),h=n(20),p=r(h),v=n(8),m=r(v),g=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.iAlbedo=r.inputs.add(new u.default("albedo",3)),r.iSpecular=r.inputs.add(new u.default("specular",3)),r.iAlpha=r.inputs.add(new u.default("alpha",1)),r.iAlphaIntensity=r.inputs.add(new u.default("alphaIntensity",1)),r.iGloss=r.inputs.add(new u.default("gloss_base",1)),r.iNormal=r.inputs.add(new u.default("normal",3)),r.iOcclusion=r.inputs.add(new u.default("occlusion",1)),r.iCavity=r.inputs.add(new u.default("cavity",1)),r.iCavityStrength=r.inputs.add(new u.default("cavityStrength",2)),r.iEmissive=r.inputs.add(new u.default("emissive",1)),r.iEmissiveScale=r.inputs.add(new u.default("emissiveScale",1)),r.iFresnel=r.inputs.add(new u.default("fresnel",3)),r.conserveEnergy=r.inputs.add(new c.default("conserveEnergy",!0)),r.perVertexIrrad=r.inputs.add(new c.default("perVertexIrrad",!0)),r.glossNearest=r.inputs.add(new c.default("glossNearest",!1)),r.inferBitangent=r.inputs.add(new c.default("inferBitangent",!0)),r.pureGloss=r.inputs.add(new c.default("pureGloss",!1)),r.iLodDither=r.inputs.add(new u.default("lodDither",1)),r.lodDitherUniform=new u.default.Uniform("uLodDitherFactor",1),r.gammaMode=new d.default("gammaMode",["GAMMA_NONE","GAMMA_STD","GAMMA_2_2","GAMMA_TB"]),r.inputs.add(r.gammaMode),r.iGamma=r.inputs.add(new u.default("gamma",1)),r.iExposure=r.inputs.add(new u.default("exposure",1)),r.renderMode=m.default.RENDER_MODES.DEFAULT,r.config.enableCullface(!0),r.config.enableDepthTest(!0),r.config.depthMask(!1),r.config.enableBlend(),r.config.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),r._uid="sticker",r._mask=p.default.BLENDED,r._vertSrc=n(272)(),r._fragSrc=n(273)(),r}return a(t,e),t}(m.default);t.default=g,e.exports=t.default},function(e,t,n){var r=function(e){var t="";return t+="#define GLSLIFY 1\n#pragma SLOT pv\n\n#if __VERSION__ == 300\n  #define IN in\n  #define OUT out\n#else\n  #define IN attribute\n  #define OUT varying\n#endif\n\nIN vec3 aPosition;\nIN vec2 aTexCoord;\nIN vec3 aNormal;\nIN vec3 aTangent;\n\n#if !inferBitangent\n  IN vec3 aBitangent;\n#endif\n\nuniform mat4 uMVP;\nuniform mat4 uWorldMatrix;\n\nOUT vec2 vTexCoord;\nOUT vec3 vWorldPosition;\nOUT vec3 vNormal;\n\nOUT mediump vec3 vWorldNormal;\n\n#if HAS_normal\n  OUT mediump vec3 vWorldTangent;\n  OUT mediump vec3 vWorldBitangent;\n#endif\n\n#if perVertexIrrad\n  OUT vec3 vIrradiance;\n  uniform vec4 uSHCoeffs[7];\n  \n"+n(3)()+"\n#endif\n\nvec3 rotate( mat4 m, vec3 v ) {\n  return m[0].xyz*v.x + m[1].xyz*v.y + m[2].xyz*v.z;\n}\n\nvoid main( void ) {\n\n  #pragma SLOT v\n\n  vec4 pos = vec4( aPosition, 1.0 );\n\n  gl_Position    = uMVP * pos;\n\n  vWorldPosition = (uWorldMatrix * pos).xyz;\n  vWorldNormal   = rotate( uWorldMatrix, aNormal );\n\n  #if inferBitangent\n    vec3 aBitangent = cross( aNormal, aTangent );\n  #endif\n\n  #if HAS_normal\n    vWorldTangent   = rotate( uWorldMatrix, aTangent );\n    vWorldBitangent = rotate( uWorldMatrix, aBitangent );\n  #endif\n\n  #if perVertexIrrad\n    vIrradiance = SampleSH( normalize( vWorldNormal ), uSHCoeffs );\n  #endif\n\n\n  vTexCoord = aTexCoord;\n  vNormal = aNormal;\n\n}\n"};r.toString=r,e.exports=r},function(e,t,n){var r=function(e){var t="";return t+="#define GLSLIFY 1\n#if __VERSION__ == 300\n  #define IN in\n  out vec4 FragColor;\n  #define texture2D(a,b) texture( a, b )\n#else\n  #define IN varying\n  #define FragColor gl_FragColor\n#endif\n\n\nuniform vec3 uCameraPosition;\n\n"+n(25)()+"\n\nIN vec2 vTexCoord;\nIN vec3 vWorldPosition;\nIN vec3 vNormal;\n\nIN mediump vec3 vWorldNormal;\n\n#pragma SLOT pf\n\n#if HAS_normal\n  IN mediump vec3 vWorldTangent;\n  IN mediump vec3 vWorldBitangent;\n#endif\n\n\n\n// IBL\n// ========\nuniform sampler2D tEnv;\n\n#if pureGloss\n  uniform sampler2D tEnvHi;\n  "+n(21)()+"\n#endif\n\n#if perVertexIrrad\n  IN vec3 vIrradiance;\n#else\n  uniform vec4 uSHCoeffs[7];\n  "+n(3)()+"\n#endif\n\n\n\n// MATH\n// =========\n#define saturate(x) clamp( x, 0.0, 1.0 )\n#define sdot( a, b ) saturate( dot(a,b) )\n\n\n// INCLUDES\n// =========\n\n"+n(12)()+'\n\n\n// Schlick approx\n// [Schlick 1994, "An Inexpensive BRDF Model for Physically-Based Rendering"]\n// https://github.com/EpicGames/UnrealEngine/blob/dff3c48be101bb9f84633a733ef79c91c38d9542/Engine/Shaders/BRDF.usf#L168\nvec3 F_Schlick( float VoH,vec3 spec,float glo )\n{\n  float dot = glo*glo * pow( 1.0-VoH, 5.0 );\n  #if HAS_fresnel\n    return( 1.0 - dot )*spec + dot*fresnel();\n  #else\n    return( 1.0 - dot )*spec + dot;\n  #endif\n}\n\n\n// ------------------------------\n//\n\n#if HAS_normal\nvec3 perturbWorldNormal(vec3 n){\n  n = 2.0*n - 1.0;\n  vec3 nrm = gl_FrontFacing ? vWorldNormal : -vWorldNormal;\n  return normalize(vWorldTangent * n.x + vWorldBitangent*n.y + nrm );\n}\n#endif\n\n#if HAS_lodDither\n\n  float nrand(vec2 n) {\n    return fract(sin(dot(n.xy, vec2(12.9898, 78.233)))* 43758.5453);\n  }\n\n\n  void LOD_Dithering_Discard(vec2 sPos, float factor){\n    float RandCos = nrand(sPos);\n    float RandomVal = fract(RandCos * 1000.0);\n    lowp float RetVal = (factor < 0.0) ?\n        step( RandomVal, factor + 1.0 ) :\n        step(factor , RandomVal);\n    if(RetVal - .001 < 0.0){\n      discard;\n    }\n  }\n#endif\n\n//                MAIN\n// ===================\n\n#define gloss(k) gloss_base()*gloss_base()*.6\n\nvoid main( void ) {\n\n  #pragma SLOT f\n\n  #if HAS_lodDither\n    LOD_Dithering_Discard( gl_FragCoord.xy, lodDither() );\n  #endif\n\n\n  // -----------\n  vec3 worldNormal =\n    #if HAS_normal\n      perturbWorldNormal( normal() );\n    #else\n      gl_FrontFacing ? vWorldNormal : -vWorldNormal;\n    #endif\n  worldNormal = normalize( worldNormal );\n\n\n  // SH Irradiance diffuse coeff\n  // -------------\n  #if perVertexIrrad\n    vec3 diffuseCoef = vIrradiance;\n  #else\n    vec3 diffuseCoef = SampleSH(worldNormal, uSHCoeffs );\n  #endif\n\n\n  // IBL reflexion\n  // --------------\n\n  vec3 viewDir = normalize( uCameraPosition - vWorldPosition );\n  vec3 worldReflect = reflect( -viewDir, worldNormal );\n\n  #if pureGloss\n    vec3 specularColor = SampleEnvHi( tEnvHi, worldReflect );\n  #else\n    vec3 specularColor = SpecularIBL( tEnv, worldReflect, 1.0-gloss() );\n  #endif\n\n  #pragma SLOT lightsf\n\n\n  float NoV = sdot( viewDir, worldNormal );\n  vec3 specularSq = specular()*specular();\n  specularColor *= F_Schlick( NoV, specularSq, gloss() );\n\n\n  vec3 alb = albedo();\n  #if conserveEnergy\n    alb = alb - alb * specular();\n  #endif\n  vec3 albedoSq = alb*alb;\n\n\n  #if HAS_occlusion\n    diffuseCoef *= occlusion();\n  #endif\n\n\n  #if HAS_cavity\n    #ifndef cavityStrength\n      #define cavityStrength(k) vec2(1.0)\n    #endif\n    diffuseCoef   *= cavity() * cavityStrength().r + (1.0-cavityStrength().r);\n    specularColor *= cavity() * cavityStrength().g + (1.0-cavityStrength().g);\n  #endif\n\n\n  #if HAS_emissive\n    float e = emissive();\n    #if HAS_emissiveScale\n      e = e * emissiveScale();\n    #endif\n    diffuseCoef += vec3( e ) * albedo();\n  #endif\n\n\n  FragColor.xyz = diffuseCoef * albedoSq + specularColor;\n\n\n  #if HAS_exposure\n    FragColor.xyz *= vec3( exposure() );\n  #endif\n\n  \n  #if gammaMode( GAMMA_STD ) && HAS_gamma\n    FragColor.xyz = pow( FragColor.xyz, vec3( gamma() ) );\n  #endif\n\n  #if gammaMode( GAMMA_2_2 )\n    FragColor.xyz = pow( FragColor.xyz, vec3( 1.0/2.2 ) );\n  #endif\n\n  #if gammaMode( GAMMA_TB )\n    {\n      vec3 c = FragColor.xyz;\n      vec3 sqrtc = sqrt( c );\n      FragColor.xyz = (sqrtc-sqrtc*c) + c*(0.4672*c+vec3(0.5328));\n    }\n  #endif\n\n  #if HAS_alpha\n    #ifndef alphaIntensity\n      #define alphaIntensity() 1.0\n    #endif\n    FragColor.a = alpha() * alphaIntensity();\n  #else\n    FragColor.a = 1.0;\n  #endif\n  \n  '+n(26)()+"\n\n  // FragColor.rgb = vec3( gloss() );\n  // FragColor.rgb = vec3( albedo() );\n  // FragColor.rgb = vec3( specular() );\n  // FragColor.rgb = vNormal + vec3(.5);\n}\n"};r.toString=r,e.exports=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(6),u=r(s),l=n(14),c=r(l),f=n(7),d=r(f),h=n(8),p=r(h),v=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.iAlbedo=r.inputs.add(new u.default("albedo",3)),r.iSpecular=r.inputs.add(new u.default("specular",3)),r.iAlpha=r.inputs.add(new u.default("alpha",1)),r.iGloss=r.inputs.add(new u.default("gloss_base",1)),r.iNormal=r.inputs.add(new u.default("normal",3)),r.iOcclusion=r.inputs.add(new u.default("occlusion",1)),r.iCavity=r.inputs.add(new u.default("cavity",1)),r.iCavityStrength=r.inputs.add(new u.default("cavityStrength",2)),r.iEmissive=r.inputs.add(new u.default("emissive",1)),r.iEmissiveScale=r.inputs.add(new u.default("emissiveScale",1)),r.iFresnel=r.inputs.add(new u.default("fresnel",3)),r.conserveEnergy=r.inputs.add(new c.default("conserveEnergy",!0)),r.perVertexIrrad=r.inputs.add(new c.default("perVertexIrrad",!0)),r.glossNearest=r.inputs.add(new c.default("glossNearest",!1)),r.inferBitangent=r.inputs.add(new c.default("inferBitangent",!0)),r.pureGloss=r.inputs.add(new c.default("pureGloss",!1)),r.iLodDither=r.inputs.add(new u.default("lodDither",1)),r.lodDitherUniform=new u.default.Uniform("uLodDitherFactor",1),r.gammaMode=new d.default("gammaMode",["GAMMA_NONE","GAMMA_STD","GAMMA_2_2","GAMMA_TB"]),r.inputs.add(r.gammaMode),r.iGamma=r.inputs.add(new u.default("gamma",1)),r.iExposure=r.inputs.add(new u.default("exposure",1)),r.iFog=r.inputs.add(new c.default("fog",!1)),r._uid="road_line",r._vertSrc=n(275)(),r._fragSrc=n(276)(),r}return a(t,e),t}(p.default);t.default=v,e.exports=t.default},function(e,t,n){var r=function(e){var t="";return t+="#define GLSLIFY 1\n#pragma SLOT pv\n\n#if __VERSION__ == 300\n  #define IN in\n  #define OUT out\n#else\n  #define IN attribute\n  #define OUT varying\n#endif\n\nIN vec3 aPosition;\nIN vec2 aTexCoord;\nIN vec2 aTexCoord1;\nIN vec3 aNormal;\nIN vec3 aTangent;\n\n#if !inferBitangent\n  IN vec3 aBitangent;\n#endif\n\nuniform mat4 uMVP;\nuniform mat4 uWorldMatrix;\n\nOUT vec2 vTexCoord;\nOUT vec2 vTexCoord1;\nOUT vec3 vWorldPosition;\n\nOUT mediump vec3 vWorldNormal;\n\n#if HAS_normal\n  OUT mediump vec3 vWorldTangent;\n  OUT mediump vec3 vWorldBitangent;\n#endif\n\n#if perVertexIrrad\n  OUT vec3 vIrradiance;\n  uniform vec4 uSHCoeffs[7];\n  \n"+n(3)()+"\n#endif\n\nvec3 rotate( mat4 m, vec3 v ) {\n  return m[0].xyz*v.x + m[1].xyz*v.y + m[2].xyz*v.z;\n}\n\nvoid main( void ) {\n\n  #pragma SLOT v\n\n  vec4 pos = vec4( aPosition, 1.0 );\n\n  gl_Position    = uMVP * pos;\n\n  vWorldPosition = (uWorldMatrix * pos).xyz;\n  vWorldNormal   = rotate( uWorldMatrix, aNormal );\n\n  #if inferBitangent\n    vec3 aBitangent = cross( aNormal, aTangent );\n  #endif\n\n  #if HAS_normal\n    vWorldTangent   = rotate( uWorldMatrix, aTangent );\n    vWorldBitangent = rotate( uWorldMatrix, aBitangent );\n  #endif\n\n  #if perVertexIrrad\n    vIrradiance = SampleSH( normalize( vWorldNormal ), uSHCoeffs );\n  #endif\n\n\n  vTexCoord = aTexCoord;\n  vTexCoord1 = aTexCoord1;\n\n}\n"};r.toString=r,e.exports=r},function(e,t,n){var r=function(e){var t="";return t+="#define GLSLIFY 1\n#if __VERSION__ == 300\n  #define IN in\n  out vec4 FragColor;\n  #define texture2D(a,b) texture( a, b )\n#else\n  #define IN varying\n  #define FragColor gl_FragColor\n#endif\n\n\nuniform vec3 uCameraPosition;\n\nIN vec2 vTexCoord;\nIN vec2 vTexCoord1;\nIN vec3 vWorldPosition;\n\nIN mediump vec3 vWorldNormal;\n\n#pragma SLOT pf\n\n#if HAS_normal\n  IN mediump vec3 vWorldTangent;\n  IN mediump vec3 vWorldBitangent;\n#endif\n\n\n\n// IBL\n// ========\nuniform sampler2D tEnv;\n\n#if pureGloss\n  uniform sampler2D tEnvHi;\n  "+n(21)()+"\n#endif\n\n#if perVertexIrrad\n  IN vec3 vIrradiance;\n#else\n  uniform vec4 uSHCoeffs[7];\n  "+n(3)()+"\n#endif\n\n\n\n// MATH\n// =========\n#define saturate(x) clamp( x, 0.0, 1.0 )\n#define sdot( a, b ) saturate( dot(a,b) )\n\n\n// INCLUDES\n// =========\n\n"+n(12)()+"\n\n#if fog\n  "+n(34)()+'\n#endif\n\n// Schlick approx\n// [Schlick 1994, "An Inexpensive BRDF Model for Physically-Based Rendering"]\n// https://github.com/EpicGames/UnrealEngine/blob/dff3c48be101bb9f84633a733ef79c91c38d9542/Engine/Shaders/BRDF.usf#L168\nvec3 F_Schlick( float VoH,vec3 spec,float glo )\n{\n  float dot = glo*glo * pow( 1.0-VoH, 5.0 );\n  #if HAS_fresnel\n    return( 1.0 - dot )*spec + dot*fresnel();\n  #else\n    return( 1.0 - dot )*spec + dot;\n  #endif\n}\n\n\n// ------------------------------\n//\n\n#if HAS_normal\nvec3 perturbWorldNormal(vec3 n){\n  n = 2.0*n - 1.0;\n  vec3 nrm = gl_FrontFacing ? vWorldNormal : -vWorldNormal;\n  return normalize(vWorldTangent * n.x + vWorldBitangent*n.y + nrm );\n}\n#endif\n\n#if HAS_lodDither\n\n  float nrand(vec2 n) {\n    return fract(sin(dot(n.xy, vec2(12.9898, 78.233)))* 43758.5453);\n  }\n\n\n  void LOD_Dithering_Discard(vec2 sPos, float factor){\n    float RandCos = nrand(sPos);\n    float RandomVal = fract(RandCos * 1000.0);\n    lowp float RetVal = (factor < 0.0) ?\n        step( RandomVal, factor + 1.0 ) :\n        step(factor , RandomVal);\n    if(RetVal - .001 < 0.0){\n      discard;\n    }\n  }\n#endif\n\n//                MAIN\n// ===================\n\n#define gloss(k) gloss_base()*gloss_base()*.6\n\nvoid main( void ) {\n\n  #pragma SLOT f\n\n  #if HAS_lodDither\n    LOD_Dithering_Discard( gl_FragCoord.xy, lodDither() );\n  #endif\n\n\n  // -----------\n  vec3 worldNormal =\n    #if HAS_normal\n      perturbWorldNormal( normal() );\n    #else\n      gl_FrontFacing ? vWorldNormal : -vWorldNormal;\n    #endif\n  worldNormal = normalize( worldNormal );\n\n\n  // SH Irradiance diffuse coeff\n  // -------------\n  #if perVertexIrrad\n    vec3 diffuseCoef = vIrradiance;\n  #else\n    vec3 diffuseCoef = SampleSH(worldNormal, uSHCoeffs );\n  #endif\n\n\n  // IBL reflexion\n  // --------------\n\n  vec3 viewDir = normalize( uCameraPosition - vWorldPosition );\n  vec3 worldReflect = reflect( -viewDir, worldNormal );\n\n  #if pureGloss\n    vec3 specularColor = SampleEnvHi( tEnvHi, worldReflect );\n  #else\n    vec3 specularColor = SpecularIBL( tEnv, worldReflect, 1.0-gloss() );\n  #endif\n\n  #pragma SLOT lightsf\n\n\n  float NoV = sdot( viewDir, worldNormal );\n  vec3 specularSq = specular()*specular();\n  specularColor *= F_Schlick( NoV, specularSq, gloss() );\n\n\n  vec3 alb = albedo();\n  #if conserveEnergy\n    alb = alb - alb * specular();\n  #endif\n  vec3 albedoSq = alb*alb;\n\n\n  #if HAS_occlusion\n    diffuseCoef *= occlusion();\n  #endif\n\n\n  #if HAS_cavity\n    #ifndef cavityStrength\n      #define cavityStrength(k) vec2(1.0)\n    #endif\n    diffuseCoef   *= cavity() * cavityStrength().r + (1.0-cavityStrength().r);\n    specularColor *= cavity() * cavityStrength().g + (1.0-cavityStrength().g);\n  #endif\n\n\n  #if HAS_emissive\n    float e = emissive();\n    #if HAS_emissiveScale\n      e = e * emissiveScale();\n    #endif\n    diffuseCoef += vec3( e ) * albedo();\n  #endif\n\n\n  FragColor.xyz = diffuseCoef * albedoSq + specularColor;\n\n  #if HAS_exposure\n    FragColor.xyz *= vec3( exposure() );\n  #endif\n\n  \n  #if gammaMode( GAMMA_STD ) && HAS_gamma\n    FragColor.xyz = pow( FragColor.xyz, vec3( gamma() ) );\n  #endif\n\n  #if gammaMode( GAMMA_2_2 )\n    FragColor.xyz = pow( FragColor.xyz, vec3( 1.0/2.2 ) );\n  #endif\n\n  #if gammaMode( GAMMA_TB )\n    {\n      vec3 c = FragColor.xyz;\n      vec3 sqrtc = sqrt( c );\n      FragColor.xyz = (sqrtc-sqrtc*c) + c*(0.4672*c+vec3(0.5328));\n    }\n  #endif\n\n  #if HAS_alpha\n    FragColor.a = alpha();\n  #else\n    FragColor.a = 1.0;\n  #endif\n\n  #if fog\n    '+n(35)()+"\n  #endif\n\n}\n"};r.toString=r,e.exports=r},function(e,t,n){"use strict";(function(r){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u,l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},f=n(1),d=n(6),h=i(d),p=n(14),v=i(p),m=n(7),g=i(m),_=n(15),y=i(_),b=n(20),w=i(b),M=n(8),x=i(M),S=(u=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.iAlbedo=r.inputs.add(new h.default("albedo",3)),r.iSpecular=r.inputs.add(new h.default("specular",3)),r.iAlpha=r.inputs.add(new h.default("alpha",1)),r.iGloss=r.inputs.add(new h.default("gloss_base",1)),r.iNormal=r.inputs.add(new h.default("normal",3)),r.iOcclusion=r.inputs.add(new h.default("occlusion",1)),r.iCavity=r.inputs.add(new h.default("cavity",1)),r.iCavityStrength=r.inputs.add(new h.default("cavityStrength",2)),r.iEmissive=r.inputs.add(new h.default("emissive",1)),r.iEmissiveScale=r.inputs.add(new h.default("emissiveScale",1)),r.iFresnel=r.inputs.add(new h.default("fresnel",3)),r.iNoise=r.inputs.add(new h.default("noise",3)),r.conserveEnergy=r.inputs.add(new v.default("conserveEnergy",!0)),r.perVertexIrrad=r.inputs.add(new v.default("perVertexIrrad",!0)),r.glossNearest=r.inputs.add(new v.default("glossNearest",!1)),r.inferBitangent=r.inputs.add(new v.default("inferBitangent",!0)),r.pureGloss=r.inputs.add(new v.default("pureGloss",!1)),r.iLodDither=r.inputs.add(new h.default("lodDither",1)),r.lodDitherUniform=new h.default.Uniform("uLodDitherFactor",1),r.gammaMode=new g.default("gammaMode",["GAMMA_NONE","GAMMA_STD","GAMMA_2_2","GAMMA_TB"]),r.inputs.add(r.gammaMode),r.iGamma=r.inputs.add(new h.default("gamma",1)),r.iExposure=r.inputs.add(new h.default("exposure",1)),r.config.enableBlend().blendFunc(e.ZERO,e.SRC_COLOR).enableDepthTest(),r.carReflectFbo=null,r.reflect=null,r.resolution=f.vec2.fromValues(y.default.prWidth,y.default.prHeight),r._uid="water",r._mask=w.default.BLENDED,r._vertSrc=n(278)(),r._fragSrc=n(279)(),r._bind(),r}return s(t,e),l(t,[{key:"_bind",value:function(){y.default.resized.add(this._onWindowResized)}},{key:"_unbind",value:function(){y.default.resized.remove(this._onWindowResized)}},{key:"_onWindowResized",value:function(e,t,n){f.vec2.set(this.resolution,e*n,t*n)}},{key:"prepare",value:function(e,n){c(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"prepare",this).call(this,e,n),this.carReflectFbo&&0!==this.carReflectFbo.width?this.prg.tCarReflect(this.carReflectFbo):this.prg.tCarReflect(this.reflect.defaultTex),this.prg.uResolution(this.resolution)}}]),t}(x.default),function(e,t,n,r,i){var o={};return Object.keys(r).forEach(function(e){o[e]=r[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}(u.prototype,"_onWindowResized",[r],Object.getOwnPropertyDescriptor(u.prototype,"_onWindowResized"),u.prototype),u);t.default=S,e.exports=t.default}).call(t,n(2).bind)},function(e,t,n){var r=function(e){var t="";return t+="#define GLSLIFY 1\n#pragma SLOT pv\n\n#if __VERSION__ == 300\n  #define IN in\n  #define OUT out\n#else\n  #define IN attribute\n  #define OUT varying\n#endif\n\nIN vec3 aPosition;\nIN vec2 aTexCoord;\nIN vec3 aNormal;\nIN vec3 aTangent;\n\n#if !inferBitangent\n  IN vec3 aBitangent;\n#endif\n\nuniform mat4 uMVP;\nuniform mat4 uWorldMatrix;\n\nOUT vec2 vTexCoord;\nOUT vec3 vWorldPosition;\n\nOUT mediump vec3 vWorldNormal;\n\n#if HAS_normal\n  OUT mediump vec3 vWorldTangent;\n  OUT mediump vec3 vWorldBitangent;\n#endif\n\n#if perVertexIrrad\n  OUT vec3 vIrradiance;\n  uniform vec4 uSHCoeffs[7];\n  \n"+n(3)()+"\n#endif\n\nvec3 rotate( mat4 m, vec3 v ) {\n  return m[0].xyz*v.x + m[1].xyz*v.y + m[2].xyz*v.z;\n}\n\nvoid main( void ) {\n\n  #pragma SLOT v\n\n  vec4 pos = vec4( aPosition, 1.0 );\n\n  gl_Position    = uMVP * pos;\n\n  vWorldPosition = (uWorldMatrix * pos).xyz;\n  vWorldNormal   = rotate( uWorldMatrix, aNormal );\n\n  #if inferBitangent\n    vec3 aBitangent = cross( aNormal, aTangent );\n  #endif\n\n  #if HAS_normal\n    vWorldTangent   = rotate( uWorldMatrix, aTangent );\n    vWorldBitangent = rotate( uWorldMatrix, aBitangent );\n  #endif\n\n  #if perVertexIrrad\n    vIrradiance = SampleSH( normalize( vWorldNormal ), uSHCoeffs );\n  #endif\n\n\n  vTexCoord = aTexCoord;\n\n}\n"};r.toString=r,e.exports=r},function(e,t,n){var r=function(e){var t="";return t+="#define GLSLIFY 1\n#if __VERSION__ == 300\n  #define IN in\n  out vec4 FragColor;\n  #define texture2D(a,b) texture( a, b )\n#else\n  #define IN varying\n  #define FragColor gl_FragColor\n#endif\n\n\nuniform vec3 uCameraPosition;\nuniform vec2 uResolution;\nuniform sampler2D tCarReflect;\nuniform float uTime;\n\nIN vec2 vTexCoord;\nIN vec3 vWorldPosition;\n\nIN mediump vec3 vWorldNormal;\n\n#pragma SLOT pf\n\n#if HAS_normal\n  IN mediump vec3 vWorldTangent;\n  IN mediump vec3 vWorldBitangent;\n#endif\n\n\n\n// IBL\n// ========\nuniform sampler2D tEnv;\n\n#if pureGloss\n  uniform sampler2D tEnvHi;\n  "+n(21)()+"\n#endif\n\n#if perVertexIrrad\n  IN vec3 vIrradiance;\n#else\n  uniform vec4 uSHCoeffs[7];\n  "+n(3)()+"\n#endif\n\n\n\n// MATH\n// =========\n#define saturate(x) clamp( x, 0.0, 1.0 )\n#define sdot( a, b ) saturate( dot(a,b) )\n\n\n// INCLUDES\n// =========\n\n"+n(12)()+"\n"+n(80)+'\n\n// Schlick approx\n// [Schlick 1994, "An Inexpensive BRDF Model for Physically-Based Rendering"]\n// https://github.com/EpicGames/UnrealEngine/blob/dff3c48be101bb9f84633a733ef79c91c38d9542/Engine/Shaders/BRDF.usf#L168\nvec3 F_Schlick( float VoH,vec3 spec,float glo )\n{\n  float dot = glo*glo * pow( 1.0-VoH, 5.0 );\n  #if HAS_fresnel\n    return( 1.0 - dot )*spec + dot*fresnel();\n  #else\n    return( 1.0 - dot )*spec + dot;\n  #endif\n}\n\n\n// ------------------------------\n//\n\n#if HAS_normal\nvec3 perturbWorldNormal(vec3 n){\n  n = 2.0*n - 1.0;\n  vec3 nrm = gl_FrontFacing ? vWorldNormal : -vWorldNormal;\n  return normalize(vWorldTangent * n.x + vWorldBitangent*n.y + nrm );\n}\n#endif\n\n#if HAS_lodDither\n\n  float nrand(vec2 n) {\n    return fract(sin(dot(n.xy, vec2(12.9898, 78.233)))* 43758.5453);\n  }\n\n\n  void LOD_Dithering_Discard(vec2 sPos, float factor){\n    float RandCos = nrand(sPos);\n    float RandomVal = fract(RandCos * 1000.0);\n    lowp float RetVal = (factor < 0.0) ?\n        step( RandomVal, factor + 1.0 ) :\n        step(factor , RandomVal);\n    if(RetVal - .001 < 0.0){\n      discard;\n    }\n  }\n#endif\n\n//                MAIN\n// ===================\n\n#define gloss(k) gloss_base()*gloss_base()*.6\n\nvoid main( void ) {\n\n  #pragma SLOT f\n\n  #if HAS_lodDither\n    LOD_Dithering_Discard( gl_FragCoord.xy, lodDither() );\n  #endif\n\n\n  // -----------\n  vec3 worldNormal =\n    #if HAS_normal\n      perturbWorldNormal( normal() );\n    #else\n      gl_FrontFacing ? vWorldNormal : -vWorldNormal;\n    #endif\n  worldNormal = normalize( worldNormal );\n\n\n  // SH Irradiance diffuse coeff\n  // -------------\n  #if perVertexIrrad\n    vec3 diffuseCoef = vIrradiance;\n  #else\n    vec3 diffuseCoef = SampleSH(worldNormal, uSHCoeffs );\n  #endif\n\n\n  // IBL reflexion\n  // --------------\n\n  vec3 viewDir = normalize( uCameraPosition - vWorldPosition );\n  vec3 worldReflect = reflect( -viewDir, worldNormal );\n\n  #if pureGloss\n    vec3 specularColor = SampleEnvHi( tEnvHi, worldReflect );\n  #else\n    vec3 specularColor = SpecularIBL( tEnv, worldReflect, 1.0-gloss() );\n  #endif\n\n  #pragma SLOT lightsf\n  \n  vec2 uv = noiseUv(tNoise, gl_FragCoord.xy / uResolution, 0.8, 0.006, uTime, 0.01);\n  vec4 carReflect = texture2D(tCarReflect, uv);\n  specularColor = carReflect.rgb;\n\n\n  float NoV = sdot( viewDir, worldNormal );\n  vec3 specularSq = specular()*specular();\n  specularColor *= F_Schlick( NoV, specularSq, gloss() );\n\n\n  vec3 alb = albedo();\n  #if conserveEnergy\n    alb = alb - alb * specular();\n  #endif\n  vec3 albedoSq = alb*alb;\n\n\n  #if HAS_occlusion\n    diffuseCoef *= occlusion();\n  #endif\n\n\n  #if HAS_cavity\n    #ifndef cavityStrength\n      #define cavityStrength(k) vec2(1.0)\n    #endif\n    diffuseCoef   *= cavity() * cavityStrength().r + (1.0-cavityStrength().r);\n    specularColor *= cavity() * cavityStrength().g + (1.0-cavityStrength().g);\n  #endif\n\n\n  #if HAS_emissive\n    float e = emissive();\n    #if HAS_emissiveScale\n      e = e * emissiveScale();\n    #endif\n    diffuseCoef += vec3( e ) * albedo();\n  #endif\n\n\n  FragColor.xyz = diffuseCoef * albedoSq + specularColor;\n\n  #if HAS_exposure\n    FragColor.xyz *= vec3( exposure() );\n  #endif\n\n  \n  #if gammaMode( GAMMA_STD ) && HAS_gamma\n    FragColor.xyz = pow( FragColor.xyz, vec3( gamma() ) );\n  #endif\n\n  #if gammaMode( GAMMA_2_2 )\n    FragColor.xyz = pow( FragColor.xyz, vec3( 1.0/2.2 ) );\n  #endif\n\n  #if gammaMode( GAMMA_TB )\n    {\n      vec3 c = FragColor.xyz;\n      vec3 sqrtc = sqrt( c );\n      FragColor.xyz = (sqrtc-sqrtc*c) + c*(0.4672*c+vec3(0.5328));\n    }\n  #endif\n\n  #if HAS_alpha\n    FragColor.a = alpha();\n  #else\n    FragColor.a = 1.0;\n  #endif\n\n  FragColor.rgb = carReflect.rgb;\n}\n'};r.toString=r,e.exports=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},l=n(58),c=r(l),f=n(20),d=r(f),h=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r._uid="pilar",r._mask=d.default.BLENDED,r.config.enableDepthTest(!0).enableBlend().blendFunc(r.gl.SRC_ALPHA,r.gl.ONE_MINUS_SRC_ALPHA),r._vertSrc=n(281)(),r._fragSrc=n(282)(),r}return a(t,e),s(t,[{key:"prepare",value:function(e,n){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"prepare",this).call(this,e,n);var r=this.prg;r.uAlpha&&e.alpha&&r.uAlpha(e.alpha)}}]),t}(c.default);t.default=h,e.exports=t.default},function(e,t,n){var r=function(e){var t="";return t+="#define GLSLIFY 1\n#pragma SLOT pv\n\n#if __VERSION__ == 300\n  #define IN in\n  #define OUT out\n#else\n  #define IN attribute\n  #define OUT varying\n#endif\n\nIN vec3 aPosition;\nIN vec2 aTexCoord;\nIN vec3 aNormal;\nIN vec3 aTangent;\n\n#if !inferBitangent\n  IN vec3 aBitangent;\n#endif\n\nuniform mat4 uMVP;\nuniform mat4 uWorldMatrix;\n\nOUT vec2 vTexCoord;\nOUT vec2 vTexCoord1;\nOUT vec3 vWorldPosition;\n\nOUT mediump vec3 vWorldNormal;\n\n#if HAS_normal\n  OUT mediump vec3 vWorldTangent;\n  OUT mediump vec3 vWorldBitangent;\n#endif\n\n#if perVertexIrrad\n  OUT vec3 vIrradiance;\n  uniform vec4 uSHCoeffs[7];\n  \n"+n(3)()+"\n#endif\n\nvec3 rotate( mat4 m, vec3 v ) {\n  return m[0].xyz*v.x + m[1].xyz*v.y + m[2].xyz*v.z;\n}\n\nvoid main( void ) {\n\n  #pragma SLOT v\n\n  vec4 pos = vec4( aPosition, 1.0 );\n\n  gl_Position    = uMVP * pos;\n\n  vWorldPosition = (uWorldMatrix * pos).xyz;\n  vWorldNormal   = rotate( uWorldMatrix, aNormal );\n\n  #if inferBitangent\n    vec3 aBitangent = cross( aNormal, aTangent );\n  #endif\n\n  #if HAS_normal\n    vWorldTangent   = rotate( uWorldMatrix, aTangent );\n    vWorldBitangent = rotate( uWorldMatrix, aBitangent );\n  #endif\n\n  #if perVertexIrrad\n    vIrradiance = SampleSH( normalize( vWorldNormal ), uSHCoeffs );\n  #endif\n\n\n  vTexCoord = aTexCoord;\n\n}\n"};r.toString=r,e.exports=r},function(e,t,n){var r=function(e){var t="";return t+="#define GLSLIFY 1\n#if __VERSION__ == 300\n  #define IN in\n  out vec4 FragColor;\n  #define texture2D(a,b) texture( a, b )\n#else\n  #define IN varying\n  #define FragColor gl_FragColor\n#endif\n\n\nuniform vec3 uCameraPosition;\nuniform float uAlpha;\n\n"+n(25)()+"\n\nIN vec2 vTexCoord;\nIN vec3 vWorldPosition;\n\nIN mediump vec3 vWorldNormal;\n\n#pragma SLOT pf\n\n#if HAS_normal\n  IN mediump vec3 vWorldTangent;\n  IN mediump vec3 vWorldBitangent;\n#endif\n\n\n\n// IBL\n// ========\nuniform sampler2D tEnv;\n\n#if pureGloss\n  uniform sampler2D tEnvHi;\n  "+n(21)()+"\n#endif\n\n#if perVertexIrrad\n  IN vec3 vIrradiance;\n#else\n  uniform vec4 uSHCoeffs[7];\n  "+n(3)()+"\n#endif\n\n\n\n// MATH\n// =========\n#define saturate(x) clamp( x, 0.0, 1.0 )\n#define sdot( a, b ) saturate( dot(a,b) )\n\n\n// INCLUDES\n// =========\n\n"+n(12)()+"\n\n#if fog\n  "+n(34)()+'\n#endif\n\n// Schlick approx\n// [Schlick 1994, "An Inexpensive BRDF Model for Physically-Based Rendering"]\n// https://github.com/EpicGames/UnrealEngine/blob/dff3c48be101bb9f84633a733ef79c91c38d9542/Engine/Shaders/BRDF.usf#L168\nvec3 F_Schlick( float VoH,vec3 spec,float glo )\n{\n  float dot = glo*glo * pow( 1.0-VoH, 5.0 );\n  #if HAS_fresnel\n    return( 1.0 - dot )*spec + dot*fresnel();\n  #else\n    return( 1.0 - dot )*spec + dot;\n  #endif\n}\n\n\n// ------------------------------\n//\n\n#if HAS_normal\nvec3 perturbWorldNormal(vec3 n){\n  n = 2.0*n - 1.0;\n  vec3 nrm = gl_FrontFacing ? vWorldNormal : -vWorldNormal;\n  return normalize(vWorldTangent * n.x + vWorldBitangent*n.y + nrm );\n}\n#endif\n\n#if HAS_lodDither\n\n  float nrand(vec2 n) {\n    return fract(sin(dot(n.xy, vec2(12.9898, 78.233)))* 43758.5453);\n  }\n\n\n  void LOD_Dithering_Discard(vec2 sPos, float factor){\n    float RandCos = nrand(sPos);\n    float RandomVal = fract(RandCos * 1000.0);\n    lowp float RetVal = (factor < 0.0) ?\n        step( RandomVal, factor + 1.0 ) :\n        step(factor , RandomVal);\n    if(RetVal - .001 < 0.0){\n      discard;\n    }\n  }\n#endif\n\n//                MAIN\n// ===================\n\n#define gloss(k) gloss_base()*gloss_base()*.6\n\nvoid main( void ) {\n\n  #pragma SLOT f\n\n  #if HAS_lodDither\n    LOD_Dithering_Discard( gl_FragCoord.xy, lodDither() );\n  #endif\n\n\n  // -----------\n  vec3 worldNormal =\n    #if HAS_normal\n      perturbWorldNormal( normal() );\n    #else\n      gl_FrontFacing ? vWorldNormal : -vWorldNormal;\n    #endif\n  worldNormal = normalize( worldNormal );\n\n\n  // SH Irradiance diffuse coeff\n  // -------------\n  #if perVertexIrrad\n    vec3 diffuseCoef = vIrradiance;\n  #else\n    vec3 diffuseCoef = SampleSH(worldNormal, uSHCoeffs );\n  #endif\n\n\n  // IBL reflexion\n  // --------------\n\n  vec3 viewDir = normalize( uCameraPosition - vWorldPosition );\n  vec3 worldReflect = reflect( -viewDir, worldNormal );\n\n  #if pureGloss\n    vec3 specularColor = SampleEnvHi( tEnvHi, worldReflect );\n    #if HAS_pureGlossAttenuation\n      specularColor *= pureGlossAttenuation();\n    #endif\n  #else\n    vec3 specularColor = SpecularIBL( tEnv, worldReflect, 1.0-gloss() );\n  #endif\n\n  #pragma SLOT lightsf\n\n\n  float NoV = sdot( viewDir, worldNormal );\n  vec3 specularSq = specular()*specular();\n  specularColor *= F_Schlick( NoV, specularSq, gloss() );\n\n\n  vec3 alb = albedo();\n  #if conserveEnergy\n    alb = alb - alb * specular();\n  #endif\n  vec3 albedoSq = alb*alb;\n\n\n  #if HAS_occlusion\n    diffuseCoef *= occlusion();\n  #endif\n\n\n  #if HAS_cavity\n    #ifndef cavityStrength\n      #define cavityStrength(k) vec2(1.0)\n    #endif\n    diffuseCoef   *= cavity() * cavityStrength().r + (1.0-cavityStrength().r);\n    specularColor *= cavity() * cavityStrength().g + (1.0-cavityStrength().g);\n  #endif\n\n\n  #if HAS_emissive\n    float e = emissive();\n    #if HAS_emissiveScale\n      e = e * emissiveScale();\n    #endif\n    diffuseCoef += vec3( e ) * albedo();\n  #endif\n\n\n  FragColor.xyz = diffuseCoef * albedoSq + specularColor;\n\n  #if HAS_exposure\n    FragColor.xyz *= vec3( exposure() );\n  #endif\n\n  \n  #if gammaMode( GAMMA_STD ) && HAS_gamma\n    FragColor.xyz = pow( FragColor.xyz, vec3( gamma() ) );\n  #endif\n\n  #if gammaMode( GAMMA_2_2 )\n    FragColor.xyz = pow( FragColor.xyz, vec3( 1.0/2.2 ) );\n  #endif\n\n  #if gammaMode( GAMMA_TB )\n    {\n      vec3 c = FragColor.xyz;\n      vec3 sqrtc = sqrt( c );\n      FragColor.xyz = (sqrtc-sqrtc*c) + c*(0.4672*c+vec3(0.5328));\n    }\n  #endif\n\n  #if HAS_alpha\n    FragColor.a = alpha();\n  #else\n    FragColor.a = uAlpha;\n  #endif\n\n  #if isWater\n    '+n(70)()+"\n  #else\n    "+n(26)()+"\n  #endif\n\n  #if fog\n    "+n(35)()+"\n  #endif\n}\n"};r.toString=r,e.exports=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},l=n(6),c=r(l),f=n(58),d=r(f),h=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r._uid="clouds",r.iNoise=r.inputs.add(new c.default("noise",3)),r._vertSrc=n(284)(),r._fragSrc=n(285)(),r}return a(t,e),s(t,[{key:"prepare",value:function(e,n){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"prepare",this).call(this,e,n);var r=this.prg;e.channel&&r.uChannel(e.channel)}}]),t}(d.default);t.default=h,e.exports=t.default},function(e,t,n){var r=function(e){var t="";return t+="#define GLSLIFY 1\n#pragma SLOT pv\n\n#if __VERSION__ == 300\n  #define IN in\n  #define OUT out\n#else\n  #define IN attribute\n  #define OUT varying\n#endif\n\nIN vec3 aPosition;\nIN vec2 aTexCoord;\nIN vec2 aTexCoord1;\nIN vec3 aNormal;\nIN vec3 aTangent;\n\n#if !inferBitangent\n  IN vec3 aBitangent;\n#endif\n\nuniform mat4 uMVP;\nuniform mat4 uWorldMatrix;\n\nOUT vec2 vTexCoord;\nOUT vec2 vTexCoord1;\nOUT vec3 vWorldPosition;\n\nOUT mediump vec3 vWorldNormal;\n\n#if HAS_normal\n  OUT mediump vec3 vWorldTangent;\n  OUT mediump vec3 vWorldBitangent;\n#endif\n\n#if perVertexIrrad\n  OUT vec3 vIrradiance;\n  uniform vec4 uSHCoeffs[7];\n  \n"+n(3)()+"\n#endif\n\nvec3 rotate( mat4 m, vec3 v ) {\n  return m[0].xyz*v.x + m[1].xyz*v.y + m[2].xyz*v.z;\n}\n\nvoid main( void ) {\n\n  #pragma SLOT v\n\n  vec4 pos = vec4( aPosition, 1.0 );\n\n  gl_Position    = uMVP * pos;\n\n  vWorldPosition = (uWorldMatrix * pos).xyz;\n  vWorldNormal   = rotate( uWorldMatrix, aNormal );\n\n  #if inferBitangent\n    vec3 aBitangent = cross( aNormal, aTangent );\n  #endif\n\n  #if HAS_normal\n    vWorldTangent   = rotate( uWorldMatrix, aTangent );\n    vWorldBitangent = rotate( uWorldMatrix, aBitangent );\n  #endif\n\n  #if perVertexIrrad\n    vIrradiance = SampleSH( normalize( vWorldNormal ), uSHCoeffs );\n  #endif\n\n\n  vTexCoord = aTexCoord;\n  vTexCoord1 = aTexCoord1;\n\n}\n"};r.toString=r,e.exports=r},function(e,t,n){var r=function(e){var t="";return t+="#define GLSLIFY 1\n#if __VERSION__ == 300\n  #define IN in\n  out vec4 FragColor;\n  #define texture2D(a,b) texture( a, b )\n#else\n  #define IN varying\n  #define FragColor gl_FragColor\n#endif\n\n\nuniform vec3 uCameraPosition;\nuniform float uChannel;\nuniform float uTime;\n\n"+n(25)()+"\n\nIN vec2 vTexCoord;\nIN vec2 vTexCoord1;\nIN vec3 vWorldPosition;\n\nIN mediump vec3 vWorldNormal;\n\n#pragma SLOT pf\n\n#if HAS_normal\n  IN mediump vec3 vWorldTangent;\n  IN mediump vec3 vWorldBitangent;\n#endif\n\n\n\n// IBL\n// ========\nuniform sampler2D tEnv;\n\n#if pureGloss\n  uniform sampler2D tEnvHi;\n  "+n(21)()+"\n#endif\n\n#if perVertexIrrad\n  IN vec3 vIrradiance;\n#else\n  uniform vec4 uSHCoeffs[7];\n  "+n(3)()+"\n#endif\n\n\n\n// MATH\n// =========\n#define saturate(x) clamp( x, 0.0, 1.0 )\n#define sdot( a, b ) saturate( dot(a,b) )\n\n\n// INCLUDES\n// =========\n\n"+n(12)()+"\n\n#if fog\n  "+n(34)()+'\n#endif\n\n// Schlick approx\n// [Schlick 1994, "An Inexpensive BRDF Model for Physically-Based Rendering"]\n// https://github.com/EpicGames/UnrealEngine/blob/dff3c48be101bb9f84633a733ef79c91c38d9542/Engine/Shaders/BRDF.usf#L168\nvec3 F_Schlick( float VoH,vec3 spec,float glo )\n{\n  float dot = glo*glo * pow( 1.0-VoH, 5.0 );\n  #if HAS_fresnel\n    return( 1.0 - dot )*spec + dot*fresnel();\n  #else\n    return( 1.0 - dot )*spec + dot;\n  #endif\n}\n\n\n// ------------------------------\n//\n\n#if HAS_normal\nvec3 perturbWorldNormal(vec3 n){\n  n = 2.0*n - 1.0;\n  vec3 nrm = gl_FrontFacing ? vWorldNormal : -vWorldNormal;\n  return normalize(vWorldTangent * n.x + vWorldBitangent*n.y + nrm );\n}\n#endif\n\n#if HAS_lodDither\n\n  float nrand(vec2 n) {\n    return fract(sin(dot(n.xy, vec2(12.9898, 78.233)))* 43758.5453);\n  }\n\n\n  void LOD_Dithering_Discard(vec2 sPos, float factor){\n    float RandCos = nrand(sPos);\n    float RandomVal = fract(RandCos * 1000.0);\n    lowp float RetVal = (factor < 0.0) ?\n        step( RandomVal, factor + 1.0 ) :\n        step(factor , RandomVal);\n    if(RetVal - .001 < 0.0){\n      discard;\n    }\n  }\n#endif\n\n'+n(80)+"\n\n//                MAIN\n// ===================\n\n#define gloss(k) gloss_base()*gloss_base()*.6\n\nfloat when_eq(float x, float y) {\n  return 1.0 - abs(sign(x - y));\n}\n\nvoid main( void ) {\n  vec2 vTexCoordAlpha = noiseUv(tNoise, vTexCoord, 0.1, 0.05, uTime, 0.0015);\n  vTexCoordAlpha = clamp(vTexCoordAlpha, 0.0, 1.0);\n\n  float alpha = 0.0;\n  alpha += texture2D(tAlpha, vTexCoordAlpha).r * when_eq(uChannel, 1.0);\n  alpha += texture2D(tAlpha, vTexCoordAlpha).g * when_eq(uChannel, 2.0);\n  alpha += texture2D(tAlpha, vTexCoordAlpha).b * when_eq(uChannel, 3.0);\n\n\n  #pragma SLOT f\n\n  #if HAS_lodDither\n    LOD_Dithering_Discard( gl_FragCoord.xy, lodDither() );\n  #endif\n\n  // -----------\n  vec3 worldNormal =\n    #if HAS_normal\n      perturbWorldNormal( normal() );\n    #else\n      gl_FrontFacing ? vWorldNormal : -vWorldNormal;\n    #endif\n  worldNormal = normalize( worldNormal );\n\n\n  // SH Irradiance diffuse coeff\n  // -------------\n  #if perVertexIrrad\n    vec3 diffuseCoef = vIrradiance;\n  #else\n    vec3 diffuseCoef = SampleSH(worldNormal, uSHCoeffs );\n  #endif\n\n\n  // IBL reflexion\n  // --------------\n\n  vec3 viewDir = normalize( uCameraPosition - vWorldPosition );\n  vec3 worldReflect = reflect( -viewDir, worldNormal );\n\n  #if pureGloss\n    vec3 specularColor = SampleEnvHi( tEnvHi, worldReflect );\n    #if HAS_pureGlossAttenuation\n      specularColor *= pureGlossAttenuation();\n    #endif\n  #else\n    vec3 specularColor = SpecularIBL( tEnv, worldReflect, 1.0-gloss() );\n  #endif\n\n  #pragma SLOT lightsf\n\n\n  float NoV = sdot( viewDir, worldNormal );\n  vec3 specularSq = specular()*specular();\n  specularColor *= F_Schlick( NoV, specularSq, gloss() );\n\n\n  vec3 alb = albedo();\n  #if conserveEnergy\n    alb = alb - alb * specular();\n  #endif\n  vec3 albedoSq = alb*alb;\n\n\n  #if HAS_occlusion\n    diffuseCoef *= occlusion();\n  #endif\n\n\n  #if HAS_cavity\n    #ifndef cavityStrength\n      #define cavityStrength(k) vec2(1.0)\n    #endif\n    diffuseCoef   *= cavity() * cavityStrength().r + (1.0-cavityStrength().r);\n    specularColor *= cavity() * cavityStrength().g + (1.0-cavityStrength().g);\n  #endif\n\n\n  #if HAS_emissive\n    float e = emissive();\n    #if HAS_emissiveScale\n      e = e * emissiveScale();\n    #endif\n    diffuseCoef += vec3( e ) * albedo();\n  #endif\n\n\n  FragColor.xyz = diffuseCoef * albedoSq + specularColor;\n\n  #if HAS_exposure\n    FragColor.xyz *= vec3( exposure() );\n  #endif\n\n  \n  #if gammaMode( GAMMA_STD ) && HAS_gamma\n    FragColor.xyz = pow( FragColor.xyz, vec3( gamma() ) );\n  #endif\n\n  #if gammaMode( GAMMA_2_2 )\n    FragColor.xyz = pow( FragColor.xyz, vec3( 1.0/2.2 ) );\n  #endif\n\n  #if gammaMode( GAMMA_TB )\n    {\n      vec3 c = FragColor.xyz;\n      vec3 sqrtc = sqrt( c );\n      FragColor.xyz = (sqrtc-sqrtc*c) + c*(0.4672*c+vec3(0.5328));\n    }\n  #endif\n\n  #if HAS_alpha\n    FragColor.a = alpha * 0.6;\n  #else\n    FragColor.a = 1.0;\n  #endif\n\n  #if isWater\n    "+n(70)()+"\n  #else\n    "+n(26)()+"\n  #endif\n\n  #if fog\n    "+n(35)()+"\n  #endif\n\n  // FragColor.rgb = vec3( sin(uTime), 0., 0. );\n}\n"};r.toString=r,e.exports=r},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t){var n=t.texlib,i=t.material,o=t.cfg,a=t.duration,s=void 0===a?.1:a;r(this,e),this.texlib=n,this.mat=i,this.duration=s,this.props=[],this.propsMap={};for(var u in o)this.mat[u]&&this.addProperty(u,o[u]);this.p=0}return i(e,[{key:"step",value:function(e){if(1!==this.p){this.p+=e/this.duration,this.p>1&&(this.p=1);for(var t=this.mat,n=0,r=this.props.length;n<r;n++){var i=this.props[n];"function"==typeof i.step&&(i.step(this.p),i.apply(t))}}}},{key:"addProperty",value:function(e,t){var n=this.makeProperty(e,t);this.propsMap[e]=n,this.props.push(n)}},{key:"makeProperty",value:function(e,t){var n=void 0,r=t.length;return n="string"==typeof t?new a(this.texlib,t):void 0!==r?new s(r):new u(r),n.set(t),n.name=e,n}},{key:"to",value:function(e){for(var t in e)this.propsMap[t]&&this.propsMap[t].to(e[t],this.mat);this.p=0}}]),e}(),a=function(){function e(t,n){r(this,e),this.texlib=t,this.name="",this.value=""}return i(e,[{key:"set",value:function(e){var t=e+"_"+this.name,n=this.texlib._lib[t];void 0!==n&&(this.value=n)}},{key:"apply",value:function(e){e[this.name].set(this.value)}},{key:"to",value:function(e,t){this.set(e),this.apply(t)}}]),e}(),s=function(){function e(t){r(this,e),this.name="",this.value=new Float32Array(t),this.dest=new Float32Array(t),this.start=new Float32Array(t),this.p=0}return i(e,[{key:"set",value:function(e){this.start.set(e),this.dest.set(e)}},{key:"to",value:function(e){this.start.set(this.value),this.dest.set(e),this.p=0}},{key:"step",value:function(e){var t=1-e;this.value[0]=this.start[0]*t+this.dest[0]*e,this.value[1]=this.start[1]*t+this.dest[1]*e,this.value[2]=this.start[2]*t+this.dest[2]*e}},{key:"apply",value:function(e){"blendColor"===this.name?e.config.blendColor(this.value[0],this.value[1],this.value[2],1):e[this.name].set(this.value[0],this.value[1],this.value[2])}}]),e}(),u=function(){function e(){r(this,e),this.name="",this.value=0,this.dest=0,this.start=0}return i(e,[{key:"set",value:function(e){this.start=e,this.dest=e}},{key:"to",value:function(e){this.start=this.value,this.dest=e,this.p=0}},{key:"step",value:function(e){var t=1-e;this.value=this.start*t+this.dest*e}},{key:"apply",value:function(e){e[this.name].set(this.value)}}]),e}();t.default=o,e.exports=t.default},function(e,t,n){"use strict";(function(r){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u,l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(4),f=i(c),d=n(1),h=n(107),p=i(h),v=d.vec3.create(),m=d.vec3.create(),g=d.vec3.create(),_=d.quat.create(),y=d.vec3.create(),b=0,w=(u=function(e){function t(e,n){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.scene=e,r.car=e.carScene,r.currentPathProgress=0,r.started=!1,r.path=new p.default(e,n),r.add(r.path),r}return s(t,e),l(t,[{key:"init",value:function(){this.path.getPositionAt(v,0),d.vec3.copy(this.car.carContainerNode.position,v)}},{key:"start",value:function(){this.started=!0}},{key:"stop",value:function(){this.started=!1}},{key:"getLoadables",value:function(){var e=this.path.getLoadables();return e.then(this.onLoad),e}},{key:"onLoad",value:function(){this.init()}},{key:"updateCarPosition",value:function(){if(this.started){var e=this.path,t=e.getSpeedAt(this.currentPathProgress);this.currentPathProgress=Math.max(0,Math.min(this.currentPathProgress,1)),this.currentPathProgress+=t;var n=this.currentPathProgress,r=Math.min(n+.01,1),i=Math.min(n+.06,1);if(e.getPositionAt(v,n),e.getPositionAt(m,r),e.getPositionAt(g,i),this.car.wheels){d.vec3.copy(this.car.carContainerNode.position,v);var o=Math.atan2(m[2]-v[2],m[0]-v[0])+Math.PI;d.quat.set(_,0,0,0,1),d.quat.rotateY(_,_,-1*o),d.quat.copy(this.car.carContainerNode.rotation,_),this.car.carContainerNode.invalidate(),this.car.carContainerNode.updateWorldMatrix();var a=Math.atan2(g[2]-v[2],g[0]-v[0])+Math.PI-o;d.quat.set(this.car.wheels.fl.rotation,0,0,0,1),d.quat.set(this.car.wheels.fr.rotation,0,0,0,1),d.quat.set(this.car.wheels.rl.rotation,0,0,0,1),d.quat.set(this.car.wheels.rr.rotation,0,0,0,1),this.car.wheels.fl.rotateZ(-1*a),this.car.wheels.fr.rotateZ(-1*a);var s=v[2]-y[2],u=v[0]-y[0],l=Math.sqrt(s*s+u*u),c=l/Math.PI*4.76758;b+=-c,this.car.wheels.fl.rotateY(b),this.car.wheels.fr.rotateY(b),this.car.wheels.rl.rotateY(b),this.car.wheels.rr.rotateY(b),y[0]=v[0],y[2]=v[2]}}}},{key:"render",value:function(){this.updateCarPosition(),this.path.render()}}]),t}(f.default),function(e,t,n,r,i){var o={};return Object.keys(r).forEach(function(e){o[e]=r[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}(u.prototype,"onLoad",[r],Object.getOwnPropertyDescriptor(u.prototype,"onLoad"),u.prototype),u);t.default=w,e.exports=t.default}).call(t,n(2).bind)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(1),a=function(){function e(t){r(this,e),this._anchors=t,this.numAnchors=t.length/3,this.numSegs=this.numAnchors-3,this._factors=new Float64Array(12*this.numSegs),this._lengths=new Float64Array(this.numSegs),this._lengthsSums=new Float64Array(this.numSegs),this._lengthsSumsInvalid=!0,this.updateFactors(),this.computeLenghtSums(),this.size=this.getSize()}return i(e,[{key:"updateFactors",value:function(){for(var e=0,t=this._anchors,n=this._factors,r=this.numSegs,i=void 0,o=void 0,a=void 0,s=void 0,u=void 0,l=void 0,c=void 0,f=void 0,d=void 0,h=void 0,p=void 0,v=void 0,m=void 0,g=void 0,_=void 0,y=void 0,b=void 0,w=void 0,M=0;M<r;M++){var x=3*M,S=x+3,P=x+6,C=x+9;n[e++]=c=i=t[S],n[e++]=f=.5*(-t[x]+t[P]),n[e++]=d=1*t[x]+-2.5*t[S]+2*t[P]-.5*t[C],n[e++]=h=-.5*t[x++]+1.5*t[S++]-1.5*t[P++]+.5*t[C++],n[e++]=p=o=t[S],n[e++]=v=.5*(-t[x]+t[P]),n[e++]=m=1*t[x]+-2.5*t[S]+2*t[P]-.5*t[C],n[e++]=g=-.5*t[x++]+1.5*t[S++]-1.5*t[P++]+.5*t[C++],n[e++]=_=a=t[S],n[e++]=y=.5*(-t[x]+t[P]),n[e++]=b=1*t[x]+-2.5*t[S]+2*t[P]-.5*t[C],n[e++]=w=-.5*t[x]+1.5*t[S]-1.5*t[P]+.5*t[C],i-=s=c+.25*(f+.25*(d+.25*h)),o-=u=p+.25*(v+.25*(m+.25*g)),a-=l=_+.25*(y+.25*(b+.25*w));var T=Math.sqrt(i*i+o*o+a*a);s-=i=c+.5*(f+.5*(d+.5*h)),u-=o=p+.5*(v+.5*(m+.5*g)),l-=a=_+.5*(y+.5*(b+.5*w)),T+=Math.sqrt(s*s+u*u+l*l),i-=s=c+.75*(f+.75*(d+.75*h)),o-=u=p+.75*(v+.75*(m+.75*g)),a-=l=_+.75*(y+.75*(b+.75*w)),T+=Math.sqrt(i*i+o*o+a*a),P=3*M+6,s-=t[P],u-=t[P+1],l-=t[P+2],T+=Math.sqrt(s*s+u*u+l*l),this._lengths[M]=T}}},{key:"getPositionAt",value:function(e,t){var n=Math.floor(t);t-=n,n*=12;var r=this._factors;return e[0]=r[n+0]+t*(r[n+1]+t*(r[n+2]+t*r[n+3])),e[1]=r[n+4]+t*(r[n+5]+t*(r[n+6]+t*r[n+7])),e[2]=r[n+8]+t*(r[n+9]+t*(r[n+10]+t*r[n+11])),e}},{key:"getPositionAndTangentAt",value:function(e,t,n){var r=Math.floor(n),i=n-r,a=12*r,s=this._factors;e[0]=s[a+0]+i*(s[a+1]+i*(s[a+2]+i*s[a+3])),e[1]=s[a+4]+i*(s[a+5]+i*(s[a+6]+i*s[a+7])),e[2]=s[a+8]+i*(s[a+9]+i*(s[a+10]+i*s[a+11])),i+=1e-4,t[0]=s[a+0]+i*(s[a+1]+i*(s[a+2]+i*s[a+3]))-e[0],t[1]=s[a+4]+i*(s[a+5]+i*(s[a+6]+i*s[a+7]))-e[1],t[2]=s[a+8]+i*(s[a+9]+i*(s[a+10]+i*s[a+11]))-e[2],o.vec3.normalize(t,t)}},{key:"getPositionsAndTangentsAt",value:function(e,t){for(var n=this._factors,r=0;r<t.length;r++){var i=6*r,o=void 0,a=void 0,s=void 0,u=t[r],l=Math.floor(u),c=u-l,f=12*l;e[i+0]=n[f+0]+c*(n[f+1]+c*(n[f+2]+c*n[f+3])),e[i+1]=n[f+4]+c*(n[f+5]+c*(n[f+6]+c*n[f+7])),e[i+2]=n[f+8]+c*(n[f+9]+c*(n[f+10]+c*n[f+11])),c+=.001,o=n[f+0]+c*(n[f+1]+c*(n[f+2]+c*n[f+3]))-e[i+0],a=n[f+4]+c*(n[f+5]+c*(n[f+6]+c*n[f+7]))-e[i+1],s=n[f+8]+c*(n[f+9]+c*(n[f+10]+c*n[f+11]))-e[i+2];var d=Math.sqrt(o*o+a*a+s*s);e[i+3]=o/d,e[i+4]=a/d,e[i+5]=s/d}}},{key:"posToTime",value:function(e){for(var t=this._lengthsSums,n=0,r=t,i=r.length,o=0;o<i;o++)if(n=r[o],e<n)return o+1-(n-e)/this._lengths[o];return-1}},{key:"timeToPos",value:function(e){var t=this._lengthsSums,n=Math.floor(e),r=e-n,i=this._lengths;return 0==n?r*i[n]:t[n-1]+r*i[n]}},{key:"computeLenghtSums",value:function(){if(this._lengthsSumsInvalid){for(var e=this._lengths,t=this._lengthsSums,n=e.length,r=0,i=0;i<n;i++)t[i]=r+=e[i];this._lengthsSumsInvalid=!1}}},{key:"getSize",value:function(){var e=this._lengthsSums;return e[e.length-1]}}]),e}();t.default=a,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(1),l=n(4),c=r(l),f=n(15),d=r(f),h=n(108),p=r(h),v=n(18),m=u.vec3.create(),g=u.mat4.create(),_=[[30,92,111],[219,80,74],[227,181,5],[122,79,79],[86,163,166],[84,13,110],[238,66,102],[255,210,63],[14,173,105],[46,196,182]],y=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.path=e,n.catmull=null,n.chunks=[],n}return a(t,e),s(t,[{key:"init",value:function(){this.catmull=this.path.catmull,this.createSplineChunks()}},{key:"createSplineChunks",value:function(){for(var e=0;e<.9;e+=.1){var t=(0,v.round)(e),n=(0,v.round)(Math.min(e+.1,1));this.createChunk(t,n,.0125)}}},{key:"createChunk",value:function(e,t,n){for(var r=[],i=this.catmull._anchors.length/3-3,o=e;o<t;o+=n)this.catmull.getPositionAt(m,o*i),r.push(m[0],m[1],m[2]);var a=this.path.scene,s=new p.default({scene:a,verts:new Float32Array(r),prg:a.programs.debugPathView});this.chunks.push({verts:r,projVerts:[],colors:[],colorsTweened:[],entity:s,validatedVerts:new Float32Array(r.length/3)})}},{key:"computeProjectedVerts",value:function(){this.path.scene.camera.modelViewProjectionMatrix(g,this._wmatrix);for(var e=0;e<this.chunks.length;e++){var t=this.chunks[e];t.projVerts=[];for(var n=0;n<t.verts.length;n+=3){var r=t.verts,i=r[n],o=r[n+1],a=r[n+2];u.vec3.set(m,i,o,a),u.vec3.transformMat4(m,m,g);var s=(m[0]+1)/2*d.default.prWidth,l=-(m[1]-1)/2*d.default.prHeight;t.projVerts.push(s,l,e)}}}},{key:"render",value:function(){for(var e=0,t=this.chunks.length;e<t;e++){var n=this.chunks[e];n.entity.render(),n.entity.prg.uColor(_[e])}}}]),t}(c.default);t.default=y,e.exports=t.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(19),a=function(e){return e&&e.__esModule?e:{default:e}}(o),s=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];r(this,e),this.buffer=new a.default(t,n).attrib("aPosition",3,t.FLOAT),i&&this.buffer.attrib("aColor",3,t.FLOAT),o&&this.buffer.attrib("aSize",1,t.FLOAT)}return i(e,[{key:"render",value:function(e){this.buffer.attribPointer(e),this.buffer.bind(),this.buffer.drawPoints()}}]),e}();t.default=s,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(1),s=n(30),u=r(s),l=n(18),c=r(l),f=n(54),d=r(f),h=c.default.toDegrees,p=(a.vec3.create(),a.quat.create()),v=a.vec3.create(),m={ROTATION:{X:{MAX:10,DAMPING:.03},Y:{MAX:10,DAMPING:.03}}},g=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=r.loop,s=void 0!==o&&o,l=(r.framerate,r.offsetY),c=void 0===l?0:l,f=r.pointerRotation,d=void 0!==f&&f,h=r.name,p=void 0===h?"":h;i(this,e),this.scene=t,this.loop=s,this.framerate=60,this.offsetY=c,this.pointerRotation=d,this.name=p,this.data=n,this.isLoaded=!0,this.currentTime=0,this.totalFrames=0,this.frames=[],this.currentFrameIdx=0,this.currentFrame=null,this.currentIFrame={camera:{position:a.vec3.create(),rotation:a.vec3.create()},car:{position:a.vec3.create(),rotation:a.vec3.create()},wheel:{rotation:a.vec3.create()},wheels:{fl:{position:a.vec3.create(),rotation:a.vec3.create()},fr:{position:a.vec3.create(),rotation:a.vec3.create()},rl:{position:a.vec3.create(),rotation:a.vec3.create()},rr:{position:a.vec3.create(),rotation:a.vec3.create()}}},this.duration=-1,this.markers={},this.callbacks=[],this.lastMarkerTime=0,this.isLoaded=!1,this.isPlaying=!1,this._cameraRotation={x:0,y:0},this._cameraRotationTarget={x:0,y:0},this._cameraRotationQuat={x:a.quat.create(),y:a.quat.create()},this.markerEnded=new u.default,this.ended=new u.default,this.stopped=new u.default,this._defaultInitialized=!1,this._default={carBody:{},wheels:{fl:{},fr:{},rl:{},rr:{}},steerings:{fl:{},fr:{},rl:{},rr:{}},groundCavity:{}},this._parseMarkers(),this._computeDuration(),this._debug()}return o(e,[{key:"play",value:function(){this.isPlaying=!0}},{key:"playToMarker",value:function(e){this.lastMarkerTime=this.currentTime;var t=this.markers[e];if(void 0===t)return void console.warn("CarPlayerCtrl: Marker '"+e+"' does not exist");this.currentMarker={name:e,time:t},this.play()}},{key:"stop",value:function(){this.isPlaying=!1,this.currentTime=0,this.currentFrameIdx=0,this.currentFrame=null,this.currentMarker=null,this._resetCallbacks(),this.stopped.dispatch()}},{key:"pause",value:function(){this.isPlaying=!1}},{key:"reset",value:function(){var e=this.scene.carScene,t=e.body,n=e.wheels,r=e.steerings,i=e.groundCavity;a.vec3.copy(t.position,this._default.carBody.position),a.quat.copy(t.rotation,this._default.carBody.rotation),t.invalidate(),t.updateWorldMatrix();for(var o in n){var s=n[o];a.vec3.copy(s.position,this._default.wheels[o].position),a.quat.copy(s.rotation,this._default.wheels[o].rotation),s.invalidate(),s.updateWorldMatrix()}for(var u in r){var l=r[u];a.vec3.copy(l.position,this._default.steerings[u].position),a.quat.copy(l.rotation,this._default.steerings[u].rotation),l.invalidate(),l.updateWorldMatrix()}a.vec3.copy(i.position,this._default.groundCavity.position),a.quat.copy(i.rotation,this._default.groundCavity.rotation),i.invalidate(),i.updateWorldMatrix()}},{key:"goTo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.currentFrame=this.frames[e],this._computeIframe(e);for(var t=this.callbacks,n=0,r=t.length;n<r;n++){var i=t[n];e>=i.frame&&!i.called&&(i.called=!0,i.cb())}this.currentFrame.camera&&this._updateCamera(),this.currentFrame.car&&this._updateCar()}},{key:"addFrameCb",value:function(e,t){this.callbacks.push({frame:e,cb:t})}},{key:"removeFrameCb",value:function(e,t){for(var n=this.callbacks,r=0,i=n.length;r<i;r++){var o=n[r];o.frame===e&&o.cb===t&&n.splice(r,1)}}},{key:"preRender",value:function(e){if(this.isPlaying){if(this.currentTime>this.duration){if(!this.loop)return this.ended.dispatch(),void this.stop();this.currentTime=0}else if(this.currentMarker&&this.currentTime>this.currentMarker.time)return this.pause(),void this.markerEnded.dispatch(this.currentMarker.name);this.currentFrameIdx=Math.floor(this.currentTime*this.framerate),this.goTo(this.currentFrameIdx),this.currentTime+=e}}},{key:"_updateCamera",value:function(){var e=(this.scene.moduleCtrl._current.name,this.currentIFrame.camera);if(e){var t=this.scene,n=t.camera,r=t.dt,i=e.position,o=e.rotation;n.position[0]=i[0],n.position[1]=i[1]+this.offsetY,n.position[2]=i[2];var s=1;if(this.currentMarker){var u=this.currentMarker.time-this.lastMarkerTime,l=this.currentMarker.time-this.currentTime;s=c.default.map(l,u,0,-1,1),s=c.default.map(Math.abs(s),1,.7,0,1),s=Math.min(s,1)}this._cameraRotationTarget.x=c.default.map(d.default.client.center.y,1,-1,m.ROTATION.X.MAX*s,-m.ROTATION.X.MAX*s),this._cameraRotationTarget.y=c.default.map(d.default.client.center.x,-1,1,m.ROTATION.Y.MAX*s,-m.ROTATION.Y.MAX*s),this._cameraRotation.x=c.default.damping(this._cameraRotation.x,this._cameraRotationTarget.x,r,m.ROTATION.X.DAMPING),this._cameraRotation.y=c.default.damping(this._cameraRotation.y,this._cameraRotationTarget.y,r,m.ROTATION.Y.DAMPING),a.quat.setAxisAngle(this._cameraRotationQuat.x,[1,0,0],c.default.toRadians(this._cameraRotation.x*s)),a.quat.setAxisAngle(this._cameraRotationQuat.y,[0,1,0],c.default.toRadians(this._cameraRotation.y*s)),c.default.fromEuler(p,h(o[0]),h(o[1]),0),this.pointerRotation&&(a.quat.mul(p,p,this._cameraRotationQuat.x),a.quat.mul(p,p,this._cameraRotationQuat.y)),a.quat.copy(n.rotation,p),n.invalidate(),n.updateWorldMatrix()}}},{key:"_updateCar",value:function(){var e=this.currentIFrame.car,t=this.currentFrame.wheel?this.currentIFrame.wheel:this.currentIFrame.wheels,n=!!this.currentFrame.wheels,r=this.scene.carScene,i=r.carContainerNode,o=r.body,s=r.wheels,u=r.steerings,l=r.groundCavity;if(e&&t&&s&&u){if(!this._defaultInitialized){this._defaultInitialized=!0,this._default.carBody.position=o.position.slice(0),this._default.carBody.rotation=o.rotation.slice(0);for(var f in s){var d=s[f];this._default.wheels[f].position=d.position.slice(0),this._default.wheels[f].rotation=d.rotation.slice(0)}for(var m in u){var g=u[m];this._default.steerings[m].position=g.position.slice(0),this._default.steerings[m].rotation=g.rotation.slice(0)}this._default.groundCavity.position=l.position.slice(0),this._default.groundCavity.rotation=l.rotation.slice(0)}if(n)o.position[0]=e.position[0]/100,o.position[1]=-e.position[2]/100,o.position[2]=(e.position[1]+this.offsetY)/100,c.default.fromEuler(p,h(e.rotation[0]+Math.PI/2),h(e.rotation[1]),h(e.rotation[2])),a.quat.copy(o.rotation,p),o.invalidate(),o.updateWorldMatrix(),l.position[0]=e.position[0]/100,l.position[1]=-e.position[2]/100,l.position[2]=(e.position[1]-.21+this.offsetY)/100,c.default.fromEuler(p,0,0,h(e.rotation[2])),a.quat.copy(l.rotation,p),l.invalidate(),l.updateWorldMatrix(),u.fl.position[0]=t.fl.position[0]/100,u.fl.position[1]=-t.fl.position[2]/100,u.fl.position[2]=(t.fl.position[1]+this.offsetY)/100,u.fr.position[0]=t.fr.position[0]/100,u.fr.position[1]=-t.fr.position[2]/100,u.fr.position[2]=(t.fr.position[1]+this.offsetY)/100,u.rl.position[0]=t.rl.position[0]/100,u.rl.position[1]=-t.rl.position[2]/100,u.rl.position[2]=(t.rl.position[1]+this.offsetY)/100,u.rr.position[0]=t.rr.position[0]/100,u.rr.position[1]=-t.rr.position[2]/100,u.rr.position[2]=(t.rr.position[1]+this.offsetY)/100,this._updateWheelRotation("fl"),this._updateWheelRotation("fr"),this._updateWheelRotation("rl"),this._updateWheelRotation("rr");else{a.vec3.copy(i.position,e.position),c.default.fromEuler(p,h(e.rotation[0]),h(e.rotation[1]),h(e.rotation[2])),a.quat.copy(i.rotation,p),i.invalidate(),i.updateWorldMatrix();var _=i.position[2]-v[2],y=i.position[0]-v[0],b=Math.sqrt(_*_+y*y),w=-b/Math.PI*4.76758;r.rotateWheels(w),v[0]=i.position[0],v[2]=i.position[2]}}}},{key:"_updateWheelRotation",value:function(e){var t=e.indexOf("l")>-1?-1:1,n=(this.currentFrame.wheel?this.currentFrame.wheel:this.currentIFrame.wheels,this.scene.carScene),r=n.wheels,i=n.steerings;c.default.fromEuler(p,h(this.currentFrame.wheels[e].rotation[1]),h(this.currentFrame.wheels[e].rotation[0]),h(this.currentFrame.wheels[e].rotation[2])),a.quat.copy(r[e].rotation,p),c.default.fromEuler(p,h(this.currentFrame.wheels[e].rotation[4]),h(this.currentFrame.wheels[e].rotation[3]),h(this.currentFrame.wheels[e].rotation[5]+Math.PI/2)),-1==t&&a.quat.rotateZ(p,p,Math.PI),a.quat.copy(i[e].rotation,p),this._updateWheelMatrix(e)}},{key:"_updateWheelMatrix",value:function(e){var t=(this.currentFrame.wheel?this.currentFrame.wheel:this.currentIFrame.wheels,this.scene.carScene),n=t.wheels,r=t.steerings;n[e].invalidate(),n[e].updateWorldMatrix(),r[e].invalidate(),r[e].updateWorldMatrix()}},{key:"_computeDuration",value:function(){this.frames=this.data.frames,this.totalFrames=this.data.infos.total,this.duration=this.totalFrames/this.framerate}},{key:"_parseMarkers",value:function(){for(var e=this.data.markers,t=0,n=e.length;t<n;t++){var r=e[t],i=r.name,o=r.frame;this.markers[i]=o/this.framerate}}},{key:"_resetCallbacks",value:function(){for(var e=this.callbacks,t=0,n=e.length;t<n;t++)e[t].called=!1}},{key:"_computeIframe",value:function(e){var t=this.currentFrame,n=this.frames[Math.min(e+1,this.totalFrames-1)];t.car&&(a.vec3.lerp(this.currentIFrame.car.position,t.car.position,n.car.position,0),a.vec3.lerp(this.currentIFrame.car.rotation,t.car.rotation,n.car.rotation,0)),t.camera&&(a.vec3.lerp(this.currentIFrame.camera.position,t.camera.position,n.camera.position,0),a.vec3.lerp(this.currentIFrame.camera.rotation,t.camera.rotation,n.camera.rotation,0)),t.wheel&&a.vec3.lerp(this.currentIFrame.wheel.rotation,t.wheel.rotation,n.wheel.rotation,0),t.wheels&&(a.vec3.lerp(this.currentIFrame.wheels.fl.position,t.wheels.fl.position,n.wheels.fl.position,0),a.vec3.lerp(this.currentIFrame.wheels.fl.rotation,t.wheels.fl.rotation,n.wheels.fl.rotation,0),a.vec3.lerp(this.currentIFrame.wheels.fr.position,t.wheels.fr.position,n.wheels.fr.position,0),a.vec3.lerp(this.currentIFrame.wheels.fr.rotation,t.wheels.fr.rotation,n.wheels.fr.rotation,0),a.vec3.lerp(this.currentIFrame.wheels.rl.position,t.wheels.rl.position,n.wheels.rl.position,0),a.vec3.lerp(this.currentIFrame.wheels.rl.rotation,t.wheels.rl.rotation,n.wheels.rl.rotation,0),a.vec3.lerp(this.currentIFrame.wheels.rr.position,t.wheels.rr.position,n.wheels.rr.position,0),a.vec3.lerp(this.currentIFrame.wheels.rr.rotation,t.wheels.rr.rotation,n.wheels.rr.rotation,0))}},{key:"_debug",value:function(){var e=this;window.addEventListener("keyup",function(t){"xp2-player"===e.name&&32==t.keyCode&&(e.isPlaying=!e.isPlaying,e.isPlaying||console.log(e.currentFrame))})}}]),e}();t.default=g,e.exports=t.default}]);