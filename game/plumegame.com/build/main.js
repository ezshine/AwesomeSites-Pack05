!function(n){var o={};function r(e){if(o[e])return o[e].exports;var t=o[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,r),t.l=!0,t.exports}r.m=n,r.c=o,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=397)}([function(e,t,n){"use strict";var r=n(18);var s=new THREE.Vector3,u=new THREE.Vector3;var o=function(e,t,n,o,r){var i=s.copy(e).sub(t).dot(n),a=Math.abs(i/o*r);return s.copy(e).sub(t),u.copy(n).multiplyScalar(i),s.sub(u).length()<a};n.d(t,"j",function(){return i}),n.d(t,"h",function(){return a}),n.d(t,"i",function(){return c}),n.d(t,"a",function(){return l}),n.d(t,"e",function(){return f}),n.d(t,"f",function(){return p}),n.d(t,"b",function(){return h}),n.d(t,"g",function(){return d}),n.d(t,"d",function(){return y}),n.d(t,"c",function(){return v});var i=r.randomInt,a=r.randomFloat,c=r.randomHexColor,l=(r.parabola,r.clamp),f=r.map,p=(r.lerp,r.modAbs),h=r.distance,d=function(e,t){return{x:e*Math.cos(t),y:e*Math.sin(t)}},y=function(e,t,n){var o=Object(r.modAbs)(t-e,2*Math.PI);return o>Math.PI&&(o-=2*Math.PI),e+o*Object(r.clamp)(n,0,1)},v=o},function(e,y,v){"use strict";(function(e){var t,n=v(8),r=v.n(n),o=v(200),i=v.n(o),a=v(201),s=v.n(a),u=v(202),c=v.n(u),l=v(6);function f(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function p(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var h=50,d=(p((t=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._binded=!1,this.width=window.innerWidth,this.height=window.innerHeight,this.pixelRatio=window.devicePixelRatio,this.prWidth=this.width*this.pixelRatio,this.prHeight=this.height*this.pixelRatio,this.aspect=this.width/this.height,this.isFocused=!0,this.visibility=s()(),this.fullScreen=c.a,this.resolution=new THREE.Vector2,this._createSignals(),this.bind()}var t,n,o;return t=e,(n=[{key:"bind",value:function(){this._binded||(this._handleDebounceResize=i()(this._handleResize,h),window.addEventListener("resize",this._handleDebounceResize,!1),window.addEventListener("blur",this._handleBlur,!1),window.addEventListener("focus",this._handleFocus,!1),this._visibilityUnbind=this.visibility.onChange(this._onVisibilityChange),this.fullScreen.enabled&&(this.fullScreen.on("change",this._onFullScreenChanged),Object(l.a)("fullscreen","fullscreen-on")),this._binded=!0)}},{key:"unbind",value:function(){this._binded&&(window.removeEventListener("resize",this._handleDebounceResize,!1),window.removeEventListener("blur",this._handleBlur,!1),window.removeEventListener("focus",this._handleFocus,!1),this._visibilityUnbind(),this.fullScreen.enabled&&this.fullScreen.off("change",this._onFullScreenChanged),this._binded=!1)}},{key:"_createSignals",value:function(){this.resized=new r.a,this.blurred=new r.a,this.focused=new r.a,this.visibilityChanged=new r.a,this.fullScreenChanged=new r.a}},{key:"_handleResize",value:function(e){this.pixelRatio=window.devicePixelRatio,this.width=window.innerWidth,this.height=window.innerHeight,this.prWidth=this.width*this.pixelRatio,this.prHeight=this.height*this.pixelRatio,this.aspect=this.width/this.height,this.resolution.set(this.width,this.height),this.resized.dispatch(this.width,this.height,this.aspect)}},{key:"_handleBlur",value:function(e){this.isFocused=!1,this.blurred.dispatch(e)}},{key:"_handleFocus",value:function(e){this.isFocused=!0,this.focused.dispatch(e)}},{key:"_onVisibilityChange",value:function(e){this.visibilityChanged.dispatch(e)}},{key:"_onFullScreenChanged",value:function(){this.fullScreenChanged.dispatch(this.fullScreen.isFullscreen)}}])&&f(t.prototype,n),o&&f(t,o),e}()).prototype,"_handleResize",[e],Object.getOwnPropertyDescriptor(t.prototype,"_handleResize"),t.prototype),p(t.prototype,"_handleBlur",[e],Object.getOwnPropertyDescriptor(t.prototype,"_handleBlur"),t.prototype),p(t.prototype,"_handleFocus",[e],Object.getOwnPropertyDescriptor(t.prototype,"_handleFocus"),t.prototype),p(t.prototype,"_onVisibilityChange",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onVisibilityChange"),t.prototype),p(t.prototype,"_onFullScreenChanged",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onFullScreenChanged"),t.prototype),t);y.a=new d}).call(this,v(2).bind)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(398)),r=i(n(399));function i(e){return e&&e.__esModule?e:{default:e}}t.default={bind:o.default,mixin:r.default},e.exports=t.default},function(e,y,v){"use strict";(function(e){var t,r=v(1),i=v(203),a=v(204),s=v(205),u=v(206);function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var n,o,l,f,p,h,d=(n=(t=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._domEl=null,this.navigator=window.navigator,this.userAgent=this.navigator.userAgent.toLowerCase(),this.browser=new a.a,this.device=new s.a,this.os=new i.a,this.supports=new u.a}var t,n,o;return t=e,(n=[{key:"bind",value:function(){r.a.resized.add(this._handleResize),this._addDOMClasses(),this._handleResize()}},{key:"unbind",value:function(){r.a.resized.remove(this._handleResize)}},{key:"_find",value:function(e){return-1!==this.userAgent.indexOf(e)}},{key:"_hasClass",value:function(e){var t=new RegExp(e,"i");return this._domEl.className.match(t)}},{key:"_addClass",value:function(e){if(!this._hasClass(e))return this._domEl.className+=" "+e,this._domEl.className}},{key:"_removeClass",value:function(e){if(this._hasClass(e))return this._domEl.className=this._domEl.className.replace(e,""),this._domEl.className}},{key:"_addDOMClasses",value:function(){this._domEl=window.document.body;var e=this.browser,t=e.name,n=e.version,o=this.os.type,r=this.device.type;this._addClass("".concat(t," ").concat(t,"-").concat(n," ").concat(o," ").concat(r))}},{key:"_handleResize",value:function(){this.device.landscape?(this._removeClass("portrait"),this._addClass("landscape")):(this._removeClass("landscape"),this._addClass("portrait"))}}])&&c(t.prototype,n),o&&c(t,o),e}()).prototype,o="_handleResize",l=[e],f=Object.getOwnPropertyDescriptor(t.prototype,"_handleResize"),p=t.prototype,h={},Object.keys(f).forEach(function(e){h[e]=f[e]}),h.enumerable=!!h.enumerable,h.configurable=!!h.configurable,("value"in h||h.initializer)&&(h.writable=!0),h=l.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},h),p&&void 0!==h.initializer&&(h.value=h.initializer?h.initializer.call(p):void 0,h.initializer=void 0),void 0===h.initializer&&(Object.defineProperty(n,o,h),h=null),t);y.a=new d}).call(this,v(2).bind)},function(e,t,n){"use strict";var o=n(8),r=n.n(o);function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._createSignals(),window.signals=this}var t,n,o;return t=e,(n=[{key:"_createSignals",value:function(){this.context=this._generateGroup(["initialized","audioResume"]),this.loader=this._generateGroup(["show","hide","completed","pageReady"]),this.application=this._generateGroup(["mounted"]),this.router=this._generateGroup(["beforeEach","afterEach"]),this.scene=this._generateGroup(["create","destroy","change","start","pause","instanced","created","destroyed","changed","started","paused"]),this.home=this._generateGroup(["ctaEntered","ctaLeaved","ctaValidated","show"]),this.levelIntro=this._generateGroup(["show","hide"]),this.overlay=this._generateGroup(["show","hide"]),this.shapeOverlay=this._generateGroup(["show","hide","tween","screenCovered"]),this.quality=this._generateGroup(["enter","selected"]),this.pause=this._generateGroup(["show","hide","shown","hidden"]),this.camera=this._generateGroup(["changed"]),this.postPass=this._generateGroup(["vignetteAnimation","burnAnimation"]),this.toastMsg=this._generateGroup(["log"]),this.character=this._generateGroup(["fallen","reseted","collided","keyFound"]),this.enemies=this._generateGroup(["laserHit","cameraHit","lookHit"]),this.instructions=this._generateGroup(["show","hide"]),this.lobby=this._generateGroup(["showLockMsg"]),this.subtitles=this._generateGroup(["add","remove"]),this.konami=this._generateGroup(["toggle","cheated","completed"])}},{key:"_generateGroup",value:function(e){for(var t={},n=0,o=e.length;n<o;n++)t[e[n]]=new r.a;return t}}])&&i(t.prototype,n),o&&i(t,o),e}();t.a=new a},function(e,t,n){"use strict";var a="function"==typeof importScripts;n.d(t,"d",function(){return o}),n.d(t,"b",function(){return r}),n.d(t,"c",function(){return i}),n.d(t,"a",function(){return f});var s=[],u=function(e){return"background: ".concat(e,"; color: #FFFFFF; padding: 3px 10px; font-weight: bold; border-radius: 20px;")},c="background: #cc00c5; color: #FFFFFF; padding: 3px 10px; font-weight: bold; border-radius: 20px;";function o(e,t){for(var n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],o=0,r=s.length;o<r;o++){var i=s[o];if(i.key===e&&i.color===t)return i.log}return function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"Global",n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:l,e={enabled:!(2<arguments.length&&void 0!==arguments[2]&&!arguments[2]),key:t,color:n,log:function(){var e=[];a?(e.push("%cWorker%c %c".concat(t)),e.push(c," ")):e.push("%c".concat(t)),e.push(u(n)),e.push.apply(e,arguments)}};return s.push(e),e.log}(e,t,n)}var l="#000000",r="#007bff",i="#ffc107",f="#dc3545"},function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return a});var o=n(5),r=Object(o.d)("GATracker","#f78fb3",!1);function i(e,t,n,o){"undefined"!=typeof ga&&ga&&ga("send","event",e,t,n,o),r("event -",e,t,n,o)}function a(e,t,n){"undefined"!=typeof ga?ga&&ga("send","pageview",e,t,n):r("pageview -",e)}},function(e,d,y){"use strict";(function(e){var t,n=y(8),r=y.n(n),o=y(88),i=y.n(o),a=y(4),s=y(1),u=y(35),c=y(48);function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function f(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var p={layouts:{qwerty:{up:[38,87],down:[40,83],left:[37,65],right:[39,68]},azerty:{up:[38,90],down:[40,83],left:[37,81],right:[39,68]}}},h=(f((t=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._binded=!1,this.pressedKeys={},this._createSignals(),this.bind()}var t,n,o;return t=e,(n=[{key:"bind",value:function(){this._binded||(window.addEventListener("keydown",this._handleKeyDown,!1),window.addEventListener("keyup",this._handleKeyUp,!1),s.a.blurred.add(this._onWindowBlur),s.a.visibilityChanged.add(this._onVisibilityChange),a.a.scene.changed.add(this._onSceneChange),this._binded=!0)}},{key:"unbind",value:function(){this._binded&&(window.removeEventListener("keydown",this._handleKeyDown,!1),window.removeEventListener("keyup",this._handleKeyUp,!1),s.a.blurred.remove(this._onWindowBlur),s.a.visibilityChanged.remove(this._onVisibilityChange),a.a.scene.changed.remove(this._onSceneChange),this._binded=!1)}},{key:"isDown",value:function(e){for(var t=!1,n=this._getKeyLayout(e),o=0,r=n.length;o<r;o++){var i=n[o];if(this.pressedKeys[i]){t=!0;break}}return t}},{key:"_createSignals",value:function(){this.upped=new r.a,this.downed=new r.a}},{key:"_resetInputs",value:function(){this.pressedKeys={}}},{key:"_getKeyLayout",value:function(e){return"number"==typeof e?this._keyCodeToKeyName(e):"string"==typeof e?this._keyNameToKeyCodes(e):Object(c.isObject)(e)&&void 0!==e.keyCode?this._keyCodeToKeyName(e.keyCode):void 0}},{key:"_keyCodeToKeyName",value:function(e){var t=i()(e),n=u.a.get("global.qwerty")?"qwerty":"azerty",o=p.layouts[n];for(var r in o){if(-1!==o[r].indexOf(e)){t=r;break}}return t}},{key:"_keyNameToKeyCodes",value:function(e){var t=i()(e),n=u.a.get("global.qwerty")?"qwerty":"azerty",o=p.layouts[n][e];return o&&(t=o),Object(c.isArray)(t)?t:[t]}},{key:"_handleKeyDown",value:function(e){this.downNow=(new Date).getTime(),this.pressedKeys[e.keyCode]=!0;var t=this._getKeyLayout(e),n=i()(e);this.downed.dispatch(e,t,n)}},{key:"_handleKeyUp",value:function(e){var t=(new Date).getTime();this.pressDuration=t-this.downNow,delete this.pressedKeys[e.keyCode];var n=this._getKeyLayout(e),o=i()(e);this.upped.dispatch(e,n,o)}},{key:"_onSceneChange",value:function(){this._resetInputs()}},{key:"_onWindowBlur",value:function(){this._resetInputs()}},{key:"_onVisibilityChange",value:function(e){!1===e&&this._resetInputs()}}])&&l(t.prototype,n),o&&l(t,o),e}()).prototype,"_handleKeyDown",[e],Object.getOwnPropertyDescriptor(t.prototype,"_handleKeyDown"),t.prototype),f(t.prototype,"_handleKeyUp",[e],Object.getOwnPropertyDescriptor(t.prototype,"_handleKeyUp"),t.prototype),f(t.prototype,"_onSceneChange",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onSceneChange"),t.prototype),f(t.prototype,"_onWindowBlur",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onWindowBlur"),t.prototype),f(t.prototype,"_onVisibilityChange",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onVisibilityChange"),t.prototype),t);d.a=new h}).call(this,y(2).bind)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},r=function(){function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._listeners=[],this._dispatchNb=0}return r(e,[{key:"add",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{priority:0,once:!1,context:this},n=o({context:this},t,{function:e});if("function"!=typeof n.function)throw new TypeError("Signal.add() : First argument must be a Function");if(-1!==this._getListernerIndex(n.function,n.context))throw new Error("Signal.add() : Listener already exists");return this._listeners.push(n),this._listeners.sort(function(e,t){return e.priority<t.priority}),this}},{key:"once",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return this.add(e,o({},t,{once:!0}))}},{key:"remove",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this;if("function"!=typeof e)throw new TypeError("Signal.remove() : First argument must be a Function");var n=this._getListernerIndex(e,t);return-1!==n&&this._listeners.splice(n,1),this}},{key:"removeAll",value:function(){return this._listeners=[],this}},{key:"dispatch",value:function(){this._dispatchNb++;for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var o=0;o<this._listeners.length;o++){var r,i=this._listeners[o];if(i.once&&this._listeners.splice(o),!1===(r=i.function).call.apply(r,[i.context].concat(t)))break}return this}},{key:"has",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this;return-1!==this._getListernerIndex(e,t)}},{key:"getListenersNb",value:function(){return this._listeners.length}},{key:"getDispatchNb",value:function(){return this._dispatchNb}},{key:"_getListernerIndex",value:function(e,t){for(var n=0,o=this._listeners.length;n<o;n++)if(this._listeners[n].function===e&&this._listeners[n].context===t)return n;return-1}}]),e}();t.default=i,e.exports=t.default},,function(e,f,p){"use strict";(function(e){p(4);var t,r=p(42),n=p(8),i=p.n(n),o=p(5),a=p(6);function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function u(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var c=Object(o.d)("GamepadManager",o.b,!0),l=(u((t=function(){function n(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this._buttonKeys=["button_1","button_2","button_3","button_4","shoulder_top_left","shoulder_top_right","shoulder_bottom_left","shoulder_bottom_right","select","start","stick_button_left","stick_button_right","d_pad_up","d_pad_down","d_pad_left","d_pad_right","vendor"],this.isConnected=!1,this.debug=!1,this.joystickLeft={x:0,y:0},this.joystickLeftIsMoving=!1,this.joystickRight={x:0,y:0},this.joystickRightIsMoving=!1,this.buttonState={};for(var e=0,t=this._buttonKeys.length;e<t;e++)this.buttonState[this._buttonKeys]=0;this._bind(),this._initSignals()}var e,t,o;return e=n,(t=[{key:"isDown",value:function(e){return this.buttonState[e]}},{key:"_bind",value:function(){var o=this;r.a.on("connect",this._onConnect),r.a.on("disconnect",this._onDisconnect),r.a.on("hold","stick_axis_left",this._onStickLeftHold),r.a.on("release","stick_axis_left",this._onStickLeftRelease),r.a.on("hold","stick_axis_right",this._onStickRightHold),r.a.on("release","stick_axis_right",this._onStickRightRelease);for(var e=function(e,t){var n=o._buttonKeys[e];r.a.on("press",n,function(e){o._onButtonPressed(n,e.value,e),o._onButtonDowned(n,e)}),r.a.on("hold",n,function(e){o._onButtonPressed(n,e.value,e)}),r.a.on("release",n,function(e){o._onButtonPressed(n,0,e),o._onButtonUpped(n,e)})},t=0,n=this._buttonKeys.length;t<n;t++)e(t)}},{key:"_initSignals",value:function(){this.connected=new i.a,this.disconnected=new i.a,this.stickLeftMoved=new i.a,this.stickRightMoved=new i.a,this.buttonDowned=new i.a,this.buttonUpped=new i.a,this.buttonPressed=new i.a}},{key:"_onConnect",value:function(e){this.isConnected=!0,this.connected.dispatch(e),c("Connected",e),Object(a.a)("gamepad","gamepad-connected")}},{key:"_onDisconnect",value:function(e){this.isConnected=!1,this.disconnected.dispatch(e),c("Disconnected",e),this.joystickLeft={x:0,y:0},this.joystickRight={x:0,y:0},this.joystickLeftIsMoving=!1,this.joystickRightIsMoving=!1;for(var t=0,n=this._buttonKeys.length;t<n;t++)this.buttonState[this._buttonKeys]=0;Object(a.a)("gamepad","gamepad-disconnected")}},{key:"_onStickLeftHold",value:function(e){this.joystickLeftIsMoving=!0,this.joystickLeft.x=e.value[0],this.joystickLeft.y=e.value[1],this.stickLeftMoved.dispatch(e,this.joystickLeft),this.debug&&c("Joystick left",this.joystickLeft)}},{key:"_onStickLeftRelease",value:function(e){this.joystickLeftIsMoving=!1,this.joystickLeft.x=0,this.joystickLeft.y=0,this.stickLeftMoved.dispatch(e,this.joystickLeft),this.debug&&c("Joystick left",e.value)}},{key:"_onStickRightHold",value:function(e){this.joystickRightIsMoving=!0,this.joystickRight.x=e.value[0],this.joystickRight.y=e.value[1],this.stickRightMoved.dispatch(e,this.joystickRight),this.debug&&c("Joystick right",this.joystickRight)}},{key:"_onStickRightRelease",value:function(e){this.joystickRightIsMoving=!1,this.joystickRight.x=0,this.joystickRight.y=0,this.stickRightMoved.dispatch(e,this.joystickRight),this.debug&&c("Joystick right",e.value)}},{key:"_onButtonDowned",value:function(e,t){this.buttonDowned.dispatch(e,t)}},{key:"_onButtonUpped",value:function(e,t){this.buttonUpped.dispatch(e,t)}},{key:"_onButtonPressed",value:function(e,t,n){this.buttonState[e]=t,this.buttonPressed.dispatch(e,t,n),this.debug&&c("button -> ".concat(e," = ").concat(t))}}])&&s(e.prototype,t),o&&s(e,o),n}()).prototype,"_onConnect",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onConnect"),t.prototype),u(t.prototype,"_onDisconnect",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onDisconnect"),t.prototype),u(t.prototype,"_onStickLeftHold",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onStickLeftHold"),t.prototype),u(t.prototype,"_onStickLeftRelease",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onStickLeftRelease"),t.prototype),u(t.prototype,"_onStickRightHold",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onStickRightHold"),t.prototype),u(t.prototype,"_onStickRightRelease",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onStickRightRelease"),t.prototype),u(t.prototype,"_onButtonDowned",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onButtonDowned"),t.prototype),u(t.prototype,"_onButtonUpped",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onButtonUpped"),t.prototype),u(t.prototype,"_onButtonPressed",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onButtonPressed"),t.prototype),t);f.a=new l}).call(this,p(2).bind)},function(e,t,n){"use strict";var r=n(22),i=n(30);function P(e){return"number"==typeof e?new THREE.Color(e):e}var a=n(0),o=n(322),T=n.n(o),s=n(323),S=n.n(s);function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function C(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function R(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(e){A(t,e,n[e])})}return t}function M(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],0<=t.indexOf(n)||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],0<=t.indexOf(n)||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e,t,n,o){return(c="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(e,t,n,o){var r,i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=L(e)););return e}(e,t);if(i){if((r=Object.getOwnPropertyDescriptor(i,t)).set)return r.set.call(o,n),!0;if(!r.writable)return!1}if(r=Object.getOwnPropertyDescriptor(o,t)){if(!r.writable)return!1;r.value=n,Object.defineProperty(o,t,r)}else A(o,t,n);return!0})(e,t,n,o)}function A(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function L(e){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function D(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var f=function(e){function E(){var e,t,n,o,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=r.color,a=r.diffuse,s=r.diffuseMap,u=r.specular,c=void 0===u?{}:u,l=r.emissive,f=r.normalMap,p=r.normalIntensity,h=void 0===p?1:p,d=r.useShadowMap,y=void 0===d||d,v=r.useVertexColors,m=void 0!==v&&v,_=r.instanced,g=void 0!==_&&_,b=M(r,["color","diffuse","diffuseMap","specular","emissive","normalMap","normalIntensity","useShadowMap","useVertexColors","instanced"]);!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,E),n=this,(t=!(o=L(E).call(this,R({vertexShader:T.a,fragmentShader:S.a},b)))||"object"!==j(o)&&"function"!=typeof o?D(n):o)._scene.materialCtrl.add(D(D(t))),t.whitelistGui=C(t.whitelistGui).concat(["diffuseColor","specularColor","specularShininess","specularStrength","emissive"]);var w=THREE.UniformsUtils.clone(THREE.UniformsLib.lights),O=w.directionalLights,x=w.directionalShadowMap,k=w.directionalShadowMatrix;return t.uniforms=R({},t.uniforms,{uDiffuseColor:{value:P(i||a||new THREE.Color("#ffffff"))},uSpecularColor:{value:P(c.color||new THREE.Color("#000000"))},uSpecularShininess:{value:c.shininess||10},uSpecularStrength:{value:c.strength||1},uEmissive:{value:P(l||new THREE.Color("#000000"))},uDiffuseMap:{value:s||null},uNormalMap:{value:f||null},uNormalIntensity:{value:h},uShadowsColor:{value:new THREE.Color("#000000")},uShadowsIntensity:{value:1},uAmbientColor:{value:new THREE.Color("#ffffff")},uTransition:{value:0},tTransitionNoise:{value:t._textures.get("main.noise.perlin",{wrapping:THREE.RepeatWrapping})},directionalLights:O,directionalShadowMap:x,directionalShadowMatrix:k}),t.defines=R({},t.defines,(A(e={},t._scene.name.replace("-","_").toUpperCase(),!0),A(e,"USE_SHADOW_MAP",y),A(e,"USE_INSTANCES",g),A(e,"USE_DIFFUSE_MAP",!!s),A(e,"USE_NORMAL_MAP",!!f),A(e,"USE_COLOR",m),e)),t.lights=!0,t.transition=1,t}var t,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(E,r["a"]),t=E,(n=[{key:"instanced",get:function(){return this.defines.USE_INSTANCES}},{key:"useVertexColors",get:function(){return this.defines.USE_COLOR}},{key:"diffuseColor",get:function(){return"#".concat(this.uniforms.uDiffuseColor.value.getHexString())},set:function(e){this.uniforms&&this.uniforms.uDiffuseColor.value.set(e)}},{key:"specularColor",get:function(){return"#".concat(this.uniforms.uSpecularColor.value.getHexString())},set:function(e){this.uniforms&&this.uniforms.uSpecularColor.value.set(e)}},{key:"specularShininess",get:function(){return this.uniforms.uSpecularShininess.value},set:function(e){this.uniforms&&(this.uniforms.uSpecularShininess.value=e)}},{key:"specularStrength",get:function(){return this.uniforms.uSpecularStrength.value},set:function(e){this.uniforms&&(this.uniforms.uSpecularStrength.value=e)}},{key:"emissive",set:function(e){this.uniforms&&this.uniforms.uEmissive.value.set(e)},get:function(){return"#".concat(this.uniforms.uEmissive.value.getHexString())}},{key:"diffuseMap",get:function(){if(this.uniforms.uDiffuseMap.value)return this.uniforms.uDiffuseMap.value.name},set:function(e){-1===this.whitelistGui.indexOf("diffuseMap")&&this.whitelistGui.push("diffuseMap"),this.defines.USE_DIFFUSE_MAP=!0,this.uniforms.uDiffuseMap.value=e}},{key:"normalMap",get:function(){if(this.uniforms.uNormalMap.value)return this.uniforms.uNormalMap.value.name},set:function(e){-1===this.whitelistGui.indexOf("normalMap")&&this.whitelistGui.push("normalIntensity","normalMap"),this.defines.USE_NORMAL_MAP=!0,this.uniforms.uNormalMap.value=e}},{key:"normalIntensity",get:function(){return this.uniforms.uNormalIntensity.value},set:function(e){this.uniforms.uNormalIntensity.value=e}},{key:"opacity",get:function(){return this.uniforms.uOpacity.value},set:function(e){this.uniforms&&(!function(e,t,n,o,r){if(!c(e,t,n,o||e)&&r)throw new Error("failed to set property")}(L(E.prototype),"opacity",e,this,!0),"character_main"===this.name&&(i.a.mainLight.shadow.opacity=e))}},{key:"shadows",set:function(e){var t=e.color,n=e.intensity;t&&this.uniforms.uShadowsColor.value.set(t),n&&(this.uniforms.uShadowsIntensity.value=n)}},{key:"ambient",set:function(e){var t=e.color,n=e.intensity;this.uniforms.uAmbientColor.value.set(t).multiplyScalar(n)}},{key:"transition",get:function(){return this.uniforms.uTransition.value},set:function(e){this.uniforms.uTransition.value=Object(a.e)(e,0,1,.64,2.15)}}])&&u(t.prototype,n),o&&u(t,o),E}();t.a=f},function(e,t,n){"use strict";var i=n(87),a=n(29),s=n(3),u=n(16),c=n(31),l=n(33),f=n(4),p=n(50),h=n(35),d=n(21),y=n(38),v=n(32);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function g(e,t,n){return(g="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=b(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var r=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=_(this,b(t).apply(this,arguments)))._tls=[],e._state=a.a,e._context=u.a,e._signals=f.a,e._sounds=p.a,e._save=h.a,e._loader=v.a,e._quality=d.a,e._textures=y.a,e._locales=c.a,e._router=l.a,e}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(t,i["Component"]),n=t,(o=[{key:"data",value:function(){var e={state:this._state,device:s.a.device.type,env:"production"};return e.router=this._router,e}},{key:"mounted",value:function(){this.transition&&this._createTls()}},{key:"beforeDestroy",value:function(){g(b(t.prototype),"beforeDestroy",this).call(this),this._onLoaderComplete&&this._signals.loader.completed.remove(this._onLoaderComplete),this._destroyTls()}},{key:"enter",value:function(){}},{key:"leave",value:function(){}},{key:"_destroyTls",value:function(){for(var e=0,t=this._tls.length;e<t;e++)this._tls[e]&&(this._tls[e].kill(),this._tls[e].clear())}}])&&m(n.prototype,o),r&&m(n,r),t}();t.a=r},function(e,t,n){"use strict";var i=n(29),a=n(16),s=n(33),u=n(32),c=n(26),l=n(1),f=n(4),p=n(35),h=n(38),d=n(37),y=n(21),v=n(50),m=n(49),_=n(79);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function b(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function O(e,t){return(O=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var r=function(e){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=b(this,w(n).call(this)))._state=i.a,t._context=a.a,t._router=s.a,t._loader=u.a,t._gui=c.a,t._window=l.a,t._signals=f.a,t._save=p.a,t._textures=h.a,t._materials=d.a,t._quality=y.a,t._sounds=v.a,t._palette=m.a,t._gltf=_.a,t._tls=[],t._renderer=t._context.renderer,t._scene=e||t._context.scene,t._physics=t._scene.physics,t._physics&&(t._world=t._physics.world,t._pMaterials=t._physics.materials,t._character=t._scene.character,t._character&&(t._charBody=t._character.body)),t}var t,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&O(e,t)}(n,THREE.Object3D),t=n,(o=[{key:"syncMesh",value:function(e){var t=e||this;t.position.copy(this.body.position),t.quaternion.copy(this.body.quaternion)}},{key:"syncBody",value:function(e){var t=e||this;this.body.position.copy(t.position),this.body.quaternion.copy(t.quaternion)}},{key:"addBody",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.body;this._world.add(e)}},{key:"removeBody",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.body;this._world.remove(e)}},{key:"addConstraint",value:function(e){this._world.addConstraint(e)}},{key:"removeConstraint",value:function(e){this._world.removeConstraint(e)}},{key:"destroy",value:function(){this._unbind(),this._destroyTls(),this.traverse(function(e){e.material&&"function"==typeof e.material.dispose&&e.material.dispose(),e.geometry&&"function"==typeof e.geometry.dispose&&e.geometry.dispose(),"function"===e.dispose&&e.dispose()}),this.remove()}},{key:"setSize",value:function(){}},{key:"update",value:function(e,t){}},{key:"_bind",value:function(){}},{key:"_unbind",value:function(){}},{key:"_destroyTls",value:function(){for(var e=0,t=this._tls.length;e<t;e++){var n=this._tls[e];n.kill(),n.clear()}}}])&&g(t.prototype,o),r&&g(t,r),n}();t.a=r},function(e,y,v){"use strict";(function(e){var t,n=v(297);function o(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function r(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function u(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}function c(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var h=function(e){function t(){var e;return a(this,t),(e=c(this,l(t).call(this))).type=d,e}return f(t,n["a"]),u(t,[{key:"constructObject",value:function(){return new d}},{key:"release",value:function(){for(var e=0,t=arguments.length;e<t;e++){var n=arguments[e];n.set(0,0,0),this.objects.push(n)}return this}}]),t}(),d=(r((t=function(e){function r(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;return a(this,r),(e=c(this,l(r).call(this,t,n,o))).isCustom=!0,e.isCannonEnabled=!1,e._x=t,e._y=n,e._z=o,e}return f(r,THREE.Vector3),u(r,[{key:"enableCannon",value:function(){return this.isCannonEnabled||(this.c=new CANNON.Vec3,this.isCannonEnabled=!0,this.syncCannon(),this.c.get=this.get.bind(this),this.c.release=this.release.bind(this)),this.c}},{key:"syncCannon",value:function(){this.isCannonEnabled&&this.c.copy(this)}},{key:"get",value:function(){var e;return(e=r.pool).get.apply(e,arguments)}},{key:"release",value:function(e){var t;return e=arguments.length<1?[this]:arguments,(t=r.pool).release.apply(t,o(e))}},{key:"x",get:function(){return this._x},set:function(e){this._x=e,this.syncCannon()}},{key:"y",get:function(){return this._y},set:function(e){this._y=e,this.syncCannon()}},{key:"z",get:function(){return this._z},set:function(e){this._z=e,this.syncCannon()}}]),r}()).prototype,"get",[e],Object.getOwnPropertyDescriptor(t.prototype,"get"),t.prototype),r(t.prototype,"release",[e],Object.getOwnPropertyDescriptor(t.prototype,"release"),t.prototype),t);d.pool=new h,d.ZERO=new d(0,0,0),d.ONE=new d(1,1,1),d.Y_UP=new d(0,1,0),d.Y_UP.enableCannon(),d.Y_DOWN=new d(0,-1,0),d.Y_DOWN.enableCannon(),y.a=d}).call(this,v(2).bind)},function(e,p,h){"use strict";(function(e){var t,n=h(8),o=h.n(n),r=h(1),i=h(4);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function u(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}function c(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var l=(c((t=function(){function e(){a(this,e),this._binded=!1,this._isTouchDevice="ontouchstart"in window||navigator.maxTouchPoints,this._signals=i.a,this.client=new f(r.a.width/2,r.a.height/2),this.delta=new f,this.movement=new f,this.mouseDownPos=new f,this.mouseUpPos=new f,this.lastPos=new f,this.isDown=!1,this.downNow=0,this.pressDuration=0,this.lastModifier=null,this._domEl=document.body,this._cursors=["grab","grabbing","pointer","move","not-allowed"],this._createSignals(),this.bind()}return u(e,[{key:"bind",value:function(){this._binded||(this._binded=!0,this._domEl.addEventListener("touchstart",this._handleMouseDown,!1),this._domEl.addEventListener("touchend",this._handleMouseUp,!1),this._domEl.addEventListener("touchmove",this._handleMouseMove,!1),this._domEl.addEventListener("mousedown",this._handleMouseDown,!1),this._domEl.addEventListener("mouseup",this._handleMouseUp,!1),this._domEl.addEventListener("mousemove",this._handleMouseMove,!1),this._domEl.addEventListener("mouseleave",this._handleMouseLeave,!1))}},{key:"unbind",value:function(){this._binded&&(this._binded=!1,this._domEl.removeEventListener("touchstart",this._handleMouseDown,!1),this._domEl.removeEventListener("touchend",this._handleMouseUp,!1),this._domEl.removeEventListener("touchmove",this._handleMouseMove,!1),this._domEl.removeEventListener("mousedown",this._handleMouseDown,!1),this._domEl.removeEventListener("mouseup",this._handleMouseUp,!1),this._domEl.removeEventListener("mousemove",this._handleMouseMove,!1),this._domEl.removeEventListener("mouseleave",this._handleMouseLeave,!1))}},{key:"addCursor",value:function(e){if(e!==this.lastModifier){for(var t=0,n=this._cursors.length;t<n;t++){var o=this._cursors[t];this._domEl.classList.toggle("cursor-".concat(o),o===e)}this.lastModifier=e}}},{key:"removeCursor",value:function(e){this.lastModifier=null,this._domEl.classList.remove("cursor-".concat(e))}},{key:"destroy",value:function(){this._unbindSignals(),this.unbind()}},{key:"_createSignals",value:function(){this.upped=new o.a,this.downed=new o.a,this.moved=new o.a,this.leaved=new o.a}},{key:"_setPointerMovement",value:function(e,t){this.movement.x=e-this.mouseDownPos.x,this.movement.y=t-this.mouseDownPos.y}},{key:"_setPointerDelta",value:function(e,t){this.delta.x=e-this.lastPos.x,this.delta.y=t-this.lastPos.y}},{key:"_getClientValues",value:function(e){var t=0,n=0;return this._isTouchDevice?e.changedTouches?(t=e.changedTouches[0].clientX,n=e.changedTouches[0].clientY):e.touches&&(t=e.touches[0].clientX,n=e.touches[0].clientY):(t=e.clientX,n=e.clientY),{clientX:t,clientY:n}}},{key:"_handleMouseDown",value:function(e){var t=this._getClientValues(e),n=t.clientX,o=t.clientY;this.client.set(n,o),this.lastPos.set(n,o),this.mouseDownPos.set(n,o),this.downNow=(new Date).getTime(),this.isDown=!0,this.downed.dispatch(e)}},{key:"_handleMouseUp",value:function(e){var t=this._getClientValues(e),n=t.clientX,o=t.clientY;this.client.set(n,o),this.lastPos.set(n,o),this.mouseUpPos.set(n,o),this._setPointerMovement(n,o),this._setPointerDelta(n,o);var r=(new Date).getTime();this.pressDuration=r-this.downNow,this.isDown=!1,this.upped.dispatch(e)}},{key:"_handleMouseMove",value:function(e){var t=this._getClientValues(e),n=t.clientX,o=t.clientY;this.client.set(n,o),this._setPointerDelta(n,o),this.moved.dispatch(e),this.lastPos.set(n,o)}},{key:"_handleMouseLeave",value:function(e){this.leaved.dispatch(e)}},{key:"domEl",get:function(){return this._domEl}}]),e}()).prototype,"_handleMouseDown",[e],Object.getOwnPropertyDescriptor(t.prototype,"_handleMouseDown"),t.prototype),c(t.prototype,"_handleMouseUp",[e],Object.getOwnPropertyDescriptor(t.prototype,"_handleMouseUp"),t.prototype),c(t.prototype,"_handleMouseMove",[e],Object.getOwnPropertyDescriptor(t.prototype,"_handleMouseMove"),t.prototype),c(t.prototype,"_handleMouseLeave",[e],Object.getOwnPropertyDescriptor(t.prototype,"_handleMouseLeave"),t.prototype),t),f=function(){function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;a(this,n),this.norm={x:e/r.a.width,y:t/r.a.height},this.x=e,this.y=t}return u(n,[{key:"set",value:function(e,t){this.x=e,this.y=t}},{key:"x",set:function(e){this._x=e,this.norm.x=e/r.a.width},get:function(){return this._x}},{key:"y",set:function(e){this._y=e,this.norm.y=e/r.a.height},get:function(){return this._y}}]),n}();p.a=new l}).call(this,h(2).bind)},function(e,h,d){"use strict";(function(e){var t,n=d(20),r=d.n(n),i=d(207),a=d(208),s=d(4),u=d(117),o=d(5);function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function l(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var f=Object(o.d)("Context","#1E304C",!0),p=(l((t=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.renderer=null,this.sceneManager=null,this.raycaster=new THREE.Raycaster,this.scene=null,this._signals=s.a,this._pauseNow=0,this._pauseDuration=0,this._paused=!1}var t,n,o;return t=e,(n=[{key:"_createGUI",value:function(){var e=this;this._guiFolder=this._gui.addFolder("Context");var t=this._guiFolder.addFolder("Log");t.add({log:function(){return f(e.renderer)}},"log").name("Log renderer"),t.add({log:function(){return f(e.sceneManager)}},"log").name("Log scene manager"),t.add({log:function(){return f(e.scene)}},"log").name("Log scene")}},{key:"init",value:function(e){f("Initialized"),this.renderer=new i.a,e.appendChild(this.renderer.domElement),this.sceneManager=new a.a(this,u.a),this._signals.context.initialized.dispatch(),r.a.remove(this._pauseUpdate),r.a.add(this._update)}},{key:"pause",value:function(){this._paused||(this._pauseNow=Date.now(),this._paused=!0,r.a.remove(this._update),r.a.add(this._pauseUpdate))}},{key:"resume",value:function(){this._paused&&(this._paused=!1,this._pauseDuration+=Date.now()-this._pauseNow,r.a.remove(this._pauseUpdate),r.a.add(this._update))}},{key:"destroy",value:function(){f("Destroyed"),r.a.remove(this._update),this.renderer.destroy()}},{key:"_update",value:function(e,t){t-=this._pauseDuration,this.sceneManager.update(e,t)}},{key:"_pauseUpdate",value:function(e,t){t-=this._pauseDuration,this.sceneManager.pauseUpdate(e,t)}}])&&c(t.prototype,n),o&&c(t,o),e}()).prototype,"_update",[e],Object.getOwnPropertyDescriptor(t.prototype,"_update"),t.prototype),l(t.prototype,"_pauseUpdate",[e],Object.getOwnPropertyDescriptor(t.prototype,"_pauseUpdate"),t.prototype),t);h.a=new p}).call(this,d(2).bind)},function(e,t,n){"use strict";function o(e){return e.charAt(0).toUpperCase()+e.slice(1)}n.d(t,"a",function(){return o})},function(e,t,n){e.exports=n(535)},function(t,n,m){var o;!function(e){"use strict";void 0===(o=function(e){var t=m(429),n=m(431),o=m(432),r=m(433),i=m(434),a=m(435),s=m(436),u=m(437),c=m(438),l=m(164),f=[n,o,r,a,s,i,u,t,c].reduce(function(e,t){return t(e)},m(440)),p=m(166)(f);function h(e,t,n,o){var r=f.resolve(e);return arguments.length<2?r:r.then(t,n,o)}function d(o){return function(){for(var e=0,t=arguments.length,n=new Array(t);e<t;++e)n[e]=arguments[e];return p(o,this,n)}}function y(e){for(var t=0,n=arguments.length-1,o=new Array(n);t<n;++t)o[t]=arguments[t+1];return p(e,this,o)}function v(){var t=f._defer();function e(e){t._handler.resolve(e)}function n(e){t._handler.reject(e)}function o(e){t._handler.notify(e)}this.promise=t,this.resolve=e,this.reject=n,this.notify=o,this.resolver={resolve:e,reject:n,notify:o}}return h.promise=function(e){return new f(e)},h.resolve=f.resolve,h.reject=f.reject,h.lift=d,h.try=y,h.attempt=y,h.iterate=f.iterate,h.unfold=f.unfold,h.join=function(){return f.all(arguments)},h.all=function(e){return h(e,f.all)},h.settle=function(e){return h(e,f.settle)},h.any=d(f.any),h.some=d(f.some),h.race=d(f.race),h.map=function(e,t){return h(e,function(e){return f.map(e,t)})},h.filter=function(e,t){return h(e,function(e){return f.filter(e,t)})},h.reduce=d(f.reduce),h.reduceRight=d(f.reduceRight),h.isPromiseLike=function(e){return e&&"function"==typeof e.then},h.Promise=f,h.defer=function(){return new v},h.TimeoutError=l,h}.call(n,m,n,t))||(t.exports=o)}(m(25))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}}(),i=r(n(421)),a=r(n(423));function r(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._listeners=[],this._binded=!1,this._raf=null}return o(e,[{key:"bind",value:function(){if(!0===this._binded)return a.default.warn("Raf instance is already binded");this._binded=!0,this._update=this._update.bind(this),this._baseTime=Date.now(),this._raf=(0,i.default)(this._update)}},{key:"unbind",value:function(){this._binded=!1,null!==this._raf&&(i.default.cancel(this._raf),this._raf=null),this._listeners=[]}},{key:"add",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:60,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,o=3<arguments.length&&void 0!==arguments[3]&&arguments[3];if("function"!=typeof e)return a.default.error("add() : Callback argument must be a function");var r=new Date,i={id:this._listeners.length,callback:e,fps:t,delay:n,once:o,deltaTargeted:1e3/t,lastTime:r.getTime()};return this._listeners.push(i),this._binded||this.bind(),i}},{key:"addOnce",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:60,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;return this.add(e,t,n,!0)}},{key:"remove",value:function(e){if("function"!=typeof e)return a.default.error("remove() : Callback argument must be a function");for(var t=0,n=this._listeners.length;t<n;t++)if(this._listeners[t].callback===e){this._listeners.splice(t,1);break}}},{key:"_update",value:function(){for(var e=Date.now(),t=e-this._baseTime,n=0;n<this._listeners.length;n++){var o=this._listeners[n],r=e-o.lastTime;r<o.deltaTargeted&&o.fps<60||(o.lastTime=e,0<o.delay&&t<o.delay||(o.callback(r,t,e),o.once&&this.remove(o.callback)))}this._binded&&(0,i.default)(this._update)}}]),e}();t.default=new s,e.exports=t.default},function(e,t,n){"use strict";var r=n(1),i=n(3),o=n(5);function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var s=Object(o.d)("PerformanceTest","#55E6C1",!0),u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.context=i.a.supports.webglContext,this.context&&(this.devicePixelRatio=r.a.pixelRatio,this.debugRendererInfo=this.context.getExtension("WEBGL_debug_renderer_info"),this.unmaskedRenderer=this.debugRendererInfo?this.context.getParameter(this.debugRendererInfo.UNMASKED_RENDERER_WEBGL):"",this.gpu=this.getGPU(),this.version=this.getOptimalVersionName(),s("version: ".concat(this.version),this.gpu))}var t,n,o;return t=e,(n=[{key:"getOptimalVersionName",value:function(){if(!this.gpu)return"low";switch(this.gpu.type){case"NVIDIA":case"AMD":return"high";case"Intel":return 7e3<=this.gpu.series||-1<this.gpu.model.indexOf("Pro")?"medium":this.gpu.series<1e3?"medium":"low";default:return"low"}}},{key:"getGPU",value:function(){for(var e=["Intel","NVIDIA","AMD","Adreno","Apple"],t=0;t<e.length;t++){var n=e[t];if(-1<this.unmaskedRenderer.indexOf(n)){var o={type:n,model:null,series:null,generation:null,tier:null,revision:null};o.model=this.unmaskedRenderer.replace(/NVIDIA GeForce |AMD Radeon |Apple | OpenGL Engine/g,"");var r=o.model.split(" ");return o.series=o.type.match(/NVIDIA|AMD/g)?r[r.length-1]:o.model,o.series=o.series.replace(/\D/g,""),o.prefix=1<r.length?r[0]:null,o.generation=o.series.substring(0,o.series.length-2),o.tier=o.series.slice(-2,-1),o.revision=o.series.slice(-1),"Apple"===o.type&&(o.generation=o.series,o.tier=null,o.revision=null),o}}return null}}])&&a(t.prototype,n),o&&a(t,o),e}(),c=n(6);function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p=Object(o.d)("QualityManager","#db3fd3",!0),h=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),f(this,"HIGH","high"),f(this,"MEDIUM","medium"),f(this,"LOW","low"),this.haveBeenSet=!1,this._availableLevels=[this.LOW,this.MEDIUM,this.HIGH],this.performanceTest=new u,this._defaultLevel=this.performanceTest.version||e.MEDIUM,this._currentLevel=this._defaultLevel,this.performanceTest.gpu&&Object(c.a)("quality","quality-gpu",this.performanceTest.gpu.type,this.performanceTest.gpu.model)}var t,n,o;return t=e,(n=[{key:"level",get:function(){return this._currentLevel},set:function(e){this.haveBeenSet=!0,-1!==this._availableLevels.indexOf(e)&&(this._currentLevel=e,p("'".concat(e,"' level set")))}},{key:"default",get:function(){return this._defaultLevel}},{key:"isHigh",get:function(){return!(this._currentLevel!==this.HIGH)}},{key:"isMedium",get:function(){return!(this._currentLevel!==this.MEDIUM)}},{key:"isLow",get:function(){return!(this._currentLevel!==this.LOW)}}])&&l(t.prototype,n),o&&l(t,o),e}();t.a=new h},function(e,t,n){"use strict";var O=n(16),x=n(38),r=n(49),o=n(87),i=n(226),a=n.n(i),s=n(227),u=n.n(s),c=n(228),l=n.n(c),f={basicTransition:a.a,glitchTransition:u.a,directionWrapTransition:l.a},p=n(229),h=n.n(p),d=n(230),y=n.n(d),v=n(231),m=n.n(v),_=n(232),g=n.n(_),b=n(233),w=n.n(b),k=n(234),E=n.n(k),P=n(235),T=n.n(P),S=n(236),j=n.n(S),C=n(237),R=n.n(C),M=n(238),A=n.n(M),L=n(239),D=n.n(L),z=n(240),H=n.n(z),I=n(241),F=n.n(I),N=n(242),U=n.n(N),B=n(243),V=n.n(B),G=n(244),$=n.n(G),q=n(245),W=n.n(q),Y=n(246),K=n.n(Y),X=n(247),J=n.n(X),Z=n(248),Q=n.n(Z),ee=n(249),te=n.n(ee),ne=n(250),oe=n.n(ne),re=n(251),ie=n.n(re),ae=n(252),se=n.n(ae),ue=n(253),ce=n.n(ue),le=n(254),fe=n.n(le),pe=n(255),he=n.n(pe),de=n(256),ye=n.n(de),ve=n(257),me=n.n(ve),_e=n(258),ge=n.n(_e),be=n(259),we=n.n(be),Oe=n(260),xe=n.n(Oe),ke=n(261),Ee=n.n(ke),Pe=n(262),Te=n.n(Pe),Se=n(263),je=n.n(Se),Ce=n(264),Re=n.n(Ce),Me=n(265),Ae=n.n(Me),Le=n(266),De=n.n(Le),ze=n(267),He=n.n(ze),Ie=n(268),Fe=n.n(Ie),Ne=n(269),Ue=n.n(Ne),Be=n(270),Ve=n.n(Be);var Ge=function(r){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},t=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),t.forEach(function(e){var t,n,o;t=r,o=i[n=e],n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o})}return r}({},f,{commonVert:h.a,commonFrag:y.a,skinningVertPars:m.a,skinningVertBase:g.a,skinningVert:w.a,skinningVertNormal:E.a,fogVertPars:T.a,fogVert:j.a,fogFragPars:R.a,fogFrag:A.a,shadowmapVertPars:D.a,shadowmapVert:H.a,shadowmapFragPars:F.a,instancesUtils:U.a,instancesVertPars:V.a,instancesVert:$.a,instancesFragPars:W.a,instancesFrag:K.a,lightsPars:J.a,directionalPars:Q.a,normalPars:te.a,normal:oe.a,levelTransitionPars:ie.a,levelTransition:se.a,levelConeFrag:ce.a,homeLightVert:fe.a,homeLightFrag:he.a,homeWindowsFrag:ye.a,homeLogoVert:me.a,homeLogoFragPars:ge.a,homeLogoFrag:we.a,homeBoardVert:xe.a,lobbyPortalFrag:Ee.a,lobbyPostersFrag:Te.a,level1LaserHitVertPars:je.a,level1LaserHitVert:Re.a,level1BurnFragPars:Ae.a,level1BurnFrag:De.a,level2ScreenFrag:He.a,level3TubeFrag:Fe.a,level4LightFrag:Ue.a,level4LightNormalFrag:Ve.a});function $e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var qe=function(){function u(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u)}var e,t,n;return e=u,(t=[{key:"parse",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:[],r=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null;r=r||O.a.renderer.capabilities.precision;var i=this._getExtensions(o,t),a=this._parseChunks(e,n);return"\n      ".concat(i.join(" "),"\n      ").concat(this._getPrecison(r),"\n      ").concat(a,"\n    ")}},{key:"_getExtensions",value:function(e,t){var n=[];for(var o in e){if(e[o]){var r=We[o];if(r.type===t){var i="#extension ".concat(r.name," : require");n.push(i)}}}return n}},{key:"_getPrecison",value:function(e){return"\n      precision ".concat(e," float;\n      precision ").concat(e," int;\n    ")}},{key:"_parseChunks",value:function(e){for(var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=u.CHUNK_REGEX,o=this._parseTemplate(e,t),r=null;null!==(r=n.exec(o));)if(r.index===n.lastIndex&&n.lastIndex++,"/"!==r.input[r.index-2]){var i=r[0],a=r[1],s=this._parseChunks(Ge[a],t);if(void 0===s)throw new Error("[ShaderParser] Shader chunk '".concat(a,"' not found!"));o=this._parseTemplate(o.replace(i,s),t)}return o}},{key:"_parseTemplate",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=e;Object.keys(t).length&&(n=o.Twig.twig({data:e}).render(t));return n}}])&&$e(e.prototype,t),n&&$e(e,n),u}();qe.VERTEX_SHADER=0,qe.FRAGMENT_SHADER=1,qe.CHUNK_REGEX=/@import\s(.*[a-z])/gi;var We={drawBuffers:{name:"GL_EXT_draw_buffers",type:qe.FRAGMENT_SHADER},derivatives:{name:"GL_OES_standard_derivatives",type:qe.FRAGMENT_SHADER}},Ye=new qe,Ke=n(26),Xe=n(74),Je=n.n(Xe),Ze=n(271),Qe=n.n(Ze);function et(e){return(et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(e){nt(t,e,n[e])})}return t}function nt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ot(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],0<=t.indexOf(n)||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],0<=t.indexOf(n)||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function rt(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function it(e,t){return!t||"object"!==et(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function at(e){return(at=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function st(e,t){return(st=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ut=function(e){function w(e){var t,n,o=e.precision,r=e.vertexShader,i=e.fragmentShader,a=e.skinning,s=void 0!==a&&a,u=e.opacity,c=void 0===u?1:u,l=e.fog,f=void 0===l||l,p=e.whitelistGui,h=void 0===p?["transparent","opacity"]:p,d=e.usePalette,y=void 0!==d&&d,v=e.defines,m=void 0===v?{}:v,_=e.data,g=void 0===_?{}:_,b=ot(e,["precision","vertexShader","fragmentShader","skinning","opacity","fog","whitelistGui","usePalette","defines","data"]);return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,w),(n=it(this,at(w).call(this,b)))._precision=o,n._vertexShader=null,n._fragmentShader=null,n._scene=O.a.scene,n._textures=x.a,n._gui=Ke.a,n.data=g,n.vertexShader=r||Je.a,n.fragmentShader=i||Qe.a,n.uniforms=tt({},n.uniforms,{uOpacity:{value:c},uFogColor:{value:new THREE.Color("#000000")},uFogDistanceDensity:{value:0},uFogHeightDensity:{value:0},uFogHeightPropagation:{value:0},uFogHeightOffset:{value:0},uFogHeightNoise:{value:new THREE.Vector4(0,0,0,0)},uTime:{value:0},tPaletteMap:{value:null}}),n.defines=tt({},m,(nt(t={},"IS_".concat(n.name.toUpperCase()),!0),nt(t,"MAX_BONES",65),nt(t,"USE_FOG",f),nt(t,"USE_PALETTE_MAP",!1),t)),n.skinning=s,n.palette=y,n.whitelistGui=h,n}var t,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&st(e,t)}(w,THREE.RawShaderMaterial),t=w,(n=[{key:"update",value:function(e,t){this.uniforms.uTime.value=t}},{key:"vertexShader",get:function(){return this._vertexShader},set:function(e){this._vertexShader=Ye.parse(e,Ye.VERTEX_SHADER,this.data,this.extensions,this._precision)}},{key:"fragmentShader",set:function(e){this._fragmentShader=Ye.parse(e,Ye.FRAGMENT_SHADER,this.data,this.extensions,this._precision)},get:function(){return this._fragmentShader}},{key:"skinning",get:function(){return this._skinning||!1},set:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this._skinning=e,this.defines.USE_SKINNING=e}},{key:"opacity",get:function(){return this.uniforms.uOpacity.value},set:function(e){this.uniforms&&(this.uniforms.uOpacity.value=e)}},{key:"fog",get:function(){return this.defines.USE_FOG},set:function(e){var t=e.enabled,n=e.color,o=e.distance,r=e.height;n&&this.uniforms.uFogColor.value.set(n),o&&(this.uniforms.uFogDistanceDensity.value=t?o.density:0),r&&(this.uniforms.uFogHeightDensity.value=t?r.density:0,this.uniforms.uFogHeightPropagation.value=r.propagation,this.uniforms.uFogHeightOffset.value=r.offset,r.noise&&(this.uniforms.uFogHeightNoise.value.x=r.noise.speed,this.uniforms.uFogHeightNoise.value.y=r.noise.frequency,this.uniforms.uFogHeightNoise.value.z=r.noise.amplitude,this.uniforms.uFogHeightNoise.value.w=r.noise.offset))}},{key:"palette",set:function(e){e&&(this.defines.USE_PALETTE_MAP=e,this.uniforms.tPaletteMap.value=r.a.paletteTexture)}}])&&rt(t.prototype,n),o&&rt(t,o),w}();t.a=ut},function(e,t,n){"use strict";t.__esModule=!0;var o,r,i,a,s,u,c,l,f,p,h=E(n(458));n(462);var d=E(n(99)),y=E(n(126)),v=E(n(183)),m=E(n(191)),_=E(n(192)),g=E(n(524)),b=E(n(525)),w=E(n(526)),O=E(n(533)),x=E(n(534)),k=E(n(194));function E(e){return e&&e.__esModule?e:{default:e}}var P=new m.default(d.default,d.default.destination);function T(e){return P.find(e)}function S(e){var t=new O.default(d.default,P.gain);return e&&e.forEach(function(e){return t.add(e)}),t}function j(e){var t=v.default.getSupportedFile(e.src||e.url||e.data||e),n=new w.default(Object.assign({},e||{},{src:t,context:d.default,destination:P.gain}));return n.isTouchLocked=A,e&&(n.id=e.id||e.name||"",n.loop=!!e.loop,n.volume=e.volume,n.effects=e.effects||[]),P.add(n),n}function C(e,t){var n=j(e).prepare();return t&&t.add(n.loader),n}function R(t){var e=t.src||t.url||t.data||t,n=void 0,o=void 0;if(v.default.containsURL(e))n=C(t),o=n.loader;else{if(!Array.isArray(e)||!v.default.containsURL(e[0].src||e[0].url)){var r="sono.load: No audio file URLs found in config.";if(!t.onError)throw new Error(r);return t.onError("[ERROR] "+r),null}n=[],o=new _.default.Group,e.forEach(function(e){return n.push(C(e,o))})}return t.onProgress&&o.on("progress",function(e){return t.onProgress(e)}),t.onComplete&&o.once("complete",function(){o.off("progress"),t.onComplete(n)}),o.once("error",function(e){o.off("error"),t.onError?t.onError(e):console.error(e)}),o.start(),n}function M(e){if(v.default.containsURL(e))return R(e);var t=j(e);return t.data=e.data||e,t}var A=(0,x.default)(d.default,function(){A=!1,P.sounds.forEach(function(e){return e.isTouchLocked=!1})}),L=[];function D(){for(;L.length;)L.pop().play()}var z=(0,b.default)(function(){P.sounds.forEach(function(e){e.playing&&(e.pause(),L.push(e))})},D);var H=(f={canPlay:v.default.canPlay,context:d.default,create:M,createGroup:S,createSound:M,destroyAll:function(){return P.destroy(),H},destroy:function(e){return P.find(e,function(e){return e.destroy()}),H},effects:P.effects,extensions:v.default.extensions,fade:function(e,t){return P.fade(e,t),H},file:v.default,gain:P.gain,getOfflineContext:k.default.getOfflineContext,get:T,getSound:T,group:S,hasWebAudio:!d.default.isFake,isSupported:0<v.default.extensions.length,load:R,log:function(){return(0,g.default)(H)},mute:function(){return P.mute(),H},pause:function(e){return P.find(e,function(e){return e.pause()}),H},pauseAll:function(){return P.pause(),H},play:function(e,t,n){return P.find(e,function(e){return e.play(t,n)}),H},register:function(e,t){return(2<arguments.length&&void 0!==arguments[2]?arguments[2]:y.default.prototype)[e]=t,H[e]=t},resumeAll:function(){return P.resume(),H},stop:function(e){return P.find(e,function(e){return e.stop()}),H},stopAll:function(){return P.stop(),H},unMute:function(){return P.unMute(),H},utils:k.default,VERSION:"2.1.6"},(p={})[o="effects"]=p[o]||{},p[o].get=function(){return P.effects},p[r="effects"]=p[r]||{},p[r].set=function(e){P.effects.removeAll().add(e)},"fx",p.fx=p.fx||{},p.fx.get=function(){return this.effects},"fx",p.fx=p.fx||{},p.fx.set=function(e){this.effects=e},p[i="isTouchLocked"]=p[i]||{},p[i].get=function(){return A},p[a="playInBackground"]=p[a]||{},p[a].get=function(){return!z.enabled},p[s="playInBackground"]=p[s]||{},p[s].set=function(e){z.enabled=!e,e||D()},p[u="sounds"]=p[u]||{},p[u].get=function(){return P.sounds.slice(0)},p[c="volume"]=p[c]||{},p[c].get=function(){return P.volume},p[l="volume"]=p[l]||{},p[l].set=function(e){P.volume=e},f.__test={Effects:y.default,Group:m.default,Sound:w.default},(0,h.default)(f,p),f);t.default=H},,function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},function(e,p,h){"use strict";(function(e){var t,r=h(7);function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}n=(t=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._autoOpen=!0,this._bind(),this._init()}var t,n,o;return t=e,(n=[{key:"_bind",value:function(){r.a.upped.add(this._onKeyUp)}},{key:"_unbind",value:function(){r.a.upped.remove(this._onKeyUp)}},{key:"_init",value:function(){this._gui=new dat.GUI({autoPlace:!1,scrollable:!0}),document.body.appendChild(this._gui.domElement)}},{key:"_toggle",value:function(){this._gui.domElement.classList.toggle("dg--is-visible")}},{key:"_onKeyUp",value:function(e,t){r.a.isDown("shift")&&"g"===t&&this._toggle()}},{key:"gui",get:function(){return this._gui}}])&&i(t.prototype,n),o&&i(t,o),e}()).prototype,o="_onKeyUp",a=[e],s=Object.getOwnPropertyDescriptor(t.prototype,"_onKeyUp"),u=t.prototype,c={},Object.keys(s).forEach(function(e){c[e]=s[e]}),c.enumerable=!!c.enumerable,c.configurable=!!c.configurable,("value"in c||c.initializer)&&(c.writable=!0),c=a.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},c),u&&void 0!==c.initializer&&(c.value=c.initializer?c.initializer.call(u):void 0,c.initializer=void 0),void 0===c.initializer&&(Object.defineProperty(n,o,c),c=null);var n,o,a,s,u,c,l,f=function(){return l};l={addFolder:f,removeFolder:f,add:f,addColor:f,remove:f,listen:f,setValue:f,getValue:f,updateDisplay:f,isModified:f,options:f,name:f,onChange:f,onFinishChange:f,destroy:f,open:f,close:f,step:f,min:f,max:f,getRoot:f,getSaveObject:f},p.a=l}).call(this,h(2).bind)},function(e,t,n){"use strict";e.exports=function(){}},,function(e,t,n){"use strict";t.a=new function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.env="production",this.isDev=!1,this.isProd=!0,this.isDying=!1,this.cannonDebugMode=!1,this.actionIsActive=!1,this.pauseDisplayed=!1,this.isOutro=!1,this.keys={"level-1":!1,"level-2":!1,"level-3":!1},this.keysNb=0,this.levelHistory=[];try{this.isIframe=window.self!==window.top}catch(e){this.isIframe=!0}}},function(e,t,n){"use strict";var r=n(4),i=n(79),f=n(14),l=n(16),a=n(0),o=n(5),x=n(36);function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var k=Object(o.d)("LightManager",o.c),E=6,u=new Float32Array(6),c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._signals=r.a,this._gltf=i.a,this._shadowDirLights=[],this._mainLight=null,this._lightsRoot=new THREE.Object3D,this._helpers=[],this._shadowCount=0,this._create()}var t,n,o;return t=e,(n=[{key:"init",value:function(e){var t=e,n=t.name,o=x.a[n].common;if(o.mainLight&&o.shadows){var r=t.character.bbox,i=this._gltf.getObject("terrain","shadow_bounds");if(r&&i){var a=o.mainLight,s=this._mainLight,u=t.character.position;s.color.set(a.color),s.intensity=a.intensity,s.offsetPos.set(a.position.x,a.position.y,a.position.z),s.position.copy(s.offsetPos).add(u),s.target.position.copy(u),s.shadow.whitelist=a.whitelist,s.shadow.camera.offsets=a.shadow.offsets,s.shadow.bounds.copy(r),this._updateShadowCamera(s,a.shadow),this._fitCameraProjectionToBounds(s.shadow.camera,s.shadow.bounds);var c=this._shadowDirLights,l=o.shadows,f=[i];i.children.length&&(f=i.children);var p=Math.min(E,l.count*f.length);this._shadowCount=p;for(var h=[],d=0,y=f.length;d<y;d++){var v=f[d],m=v.geometry;m.boundingBox||(v.updateMatrix(),m.applyMatrix(v.matrix),m.computeBoundingBox());var _=m.boundingBox,g=this._getSplittedBounds(_,l.count);h=h.concat(g)}for(var b=0,w=c.length;b<w;b++){var O=c[b];O.visible=!1,O.shadow.camera.helper.disabled=!0,b<p&&l.enabled&&(O.visible=!0,O.shadow.camera.helper.disabled=!1,O.position.copy(s.offsetPos),O.shadow.blacklist=l.blacklist,O.shadow.bounds=h[b],O.shadow.camera.offsets=l.offsets,this._updateShadowCamera(O,l),this._fitCameraProjectionToBounds(O.shadow.camera,O.shadow.bounds))}}}else k("No configuration found for scene '".concat(n,"'"))}},{key:"destroy",value:function(){for(var e=this._helpers,t=0,n=e.length;t<n;t++){var o=e[t];this._lightsRoot.remove(o)}this._helpers=[]}},{key:"update",value:function(e,t){var n=l.a.scene.character;if(n){var o=this._mainLight,r=n.position,i=f.a.pool.get();i.copy(o.offsetPos).add(r),o.position.copy(i),i.release(),o.target.position.copy(r),o.shadow.boundsHelper.box.copy(o.shadow.bounds),o.shadow.camera.helper.update(),o.shadow.needsUpdate=!0;for(var a=this._shadowDirLights,s=0,u=a.length;s<u;s++){var c=a[s];c.visible&&(c.shadow.camera.helper.update(),c.position.copy(o.offsetPos))}}}},{key:"updateShadows",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.mainLight,n=void 0===t?{}:t,o=e.shadowLights,r=void 0===o?{}:o,i=this._mainLight;this._updateShadowCamera(i,n),this._fitCameraProjectionToBounds(i.shadow.camera,i.shadow.bounds,n.offsets);for(var a=this._shadowDirLights,s=0,u=a.length;s<u;s++){var c=a[s];c.visible&&(this._updateShadowCamera(c,r),this._fitCameraProjectionToBounds(c.shadow.camera,c.shadow.bounds,r.offsets))}}},{key:"toggleShadows",value:function(e){for(var t=this._shadowDirLights,n=0,o=t.length;n<o;n++){var r=t[n];n<this._shadowCount&&(r.visible=e)}}},{key:"_create",value:function(){var e=this._lightsRoot,t=new THREE.DirectionalLight("#ffffff",1);(this._mainLight=t).castShadow=!0,t.offsetPos=new THREE.Vector3,t.shadow.bounds=new THREE.Box3,e.add(t.target),e.add(t);var n=this._createCameraHelper(t.shadow.camera);e.add(n);var o=this._createBoundsHelper(t.shadow.bounds);t.shadow.boundsHelper=o,e.add(o);for(var r=0,i=E;r<i;r++){var a=new THREE.DirectionalLight("#000000",0);a.offsetPos=new THREE.Vector3,a.castShadow=!0,a.visible=!1;var s=this._createCameraHelper(a.shadow.camera);s.disabled=!0,e.add(s),e.add(a.target),e.add(a),this._shadowDirLights.push(a)}}},{key:"_getSplittedBounds",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,n=[],o=f.a.pool.get();e.getCenter(o);var r=f.a.pool.get();e.getSize(r);var i=r.clone();i.z/=t;for(var a=-r.z/2+i.z/2,s=0;s<t;s++){var u=new THREE.Box3,c=f.a.pool.get();c.set(o.x,o.y,o.z+a),u.setFromCenterAndSize(c,i),c.release(),n.push(u);var l=this._createBoundsHelper(u);this._lightsRoot.add(l),a+=r.z/t}return o.release(),r.release(),n}},{key:"_fitCameraProjectionToBounds",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};u[0]=u[1]=u[2]=Number.MAX_VALUE,u[3]=u[4]=u[5]=-Number.MAX_VALUE;for(var o=f.a.pool.get(),r=0;r<8;r++)o.x=1&r?t.max.x:t.min.x,o.y=2&r?t.max.y:t.min.y,o.z=4&r?t.max.z:t.min.z,o.applyMatrix4(e.matrixWorldInverse),u[0]=Math.min(u[0],o.x),u[1]=Math.min(u[1],o.y),u[2]=Math.min(u[2],o.z),u[3]=Math.max(u[3],o.x),u[4]=Math.max(u[4],o.y),u[5]=Math.max(u[5],o.z);o.release(),e.near=-u[5]-(n.near||e.offsets.near),e.far=-u[2]+(n.far||e.offsets.far),e.left=u[0]-(n.left||e.offsets.left),e.right=u[3]+(n.right||e.offsets.right),e.bottom=u[1]-(n.bottom||e.offsets.bottom),e.top=u[4]+(n.top||e.offsets.top),e.updateProjectionMatrix()}},{key:"_updateShadowCamera",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=t.bias,o=t.radius,r=t.mapSize,i=e.shadow,a=i.camera;n&&(i.bias=n),o&&(i.radius=o),r&&(i.mapSize.width=r,i.mapSize.height=r),i.needsUpdate=!0,a.position.copy(e.position),a.lookAt(e.target.position),a.updateMatrixWorld(),a.helper&&(a.updateProjectionMatrix(),a.helper.update())}},{key:"_createCameraHelper",value:function(e){var t=new THREE.CameraHelper(e);return t.name="CameraHelper",t.visible=!1,e.helper=t}},{key:"_createBoundsHelper",value:function(e){var t=new THREE.Box3Helper(e,Object(a.i)());return t.name="BoxHelper",t.visible=!1,this._helpers.push(t),t}},{key:"lightsRoot",get:function(){return this._lightsRoot}},{key:"mainLight",get:function(){return this._mainLight}}])&&s(t.prototype,n),o&&s(t,o),e}();t.a=new c},function(e,t,n){"use strict";t.a={death:{laser:{title:["wasted"],sentences:["Bipbip. The lasers trigger the alarm","Oops... you are a spy, avoid the lasers!","Try harder! Avoid lasers!"]},camera:{title:["wasted"],sentences:["Security spotted you on surveillance cameras","Smile you are on the camera","Avoid cameras next time..."]},look:{title:["wasted"],sentences:["Oops, you have been spotted","Oops, you're going to have trouble","Oh no, they caught you!"]},fall:{title:["wasted"],sentences:["Watch the step!","To infiny and beyond!","Where are you going?!"]}},tutorial:{keyboard:{move_qwerty:"Use [[w-btn]] [[a-btn]] [[s-btn]] [[d-btn]] to run.",move_azerty:"Use [[z-btn]] [[q-btn]] [[s-btn]] [[d-btn]] to run.",jump:"Press [[space-btn]] to jump.",camera:"Drag with your [[pointer]] to move the camera.",jump_forward:"Press [[e-btn]] to jump forward."},gamepad:{move_qwerty:"Use [[leftstick]] to run.",move_azerty:"Use [[leftstick]] to run.",jump:"Press [[Ag-btn]] to jump.",camera:"Drag with [[rightstick]] to move the camera.",jump_forward:"Press [[Xg-btn]] to jump forward."},"level-1":{intro:"The key is in the safe.",avoid:"You have to avoid lasers. Take your time."},"level-2":{intro:"A key is kept in this room by robots.",avoid:"Avoid their beam, otherwise they will trigger the alarm."},"level-3":{intro:"There are many video cameras.",avoid:"Watch out, don't get caught by the cameras."}}}},function(e,O,x){"use strict";(function(e){var t,n=x(8),r=x.n(n),o=x(19),f=x.n(o),p=x(212),i=x(5),h=x(149),l=x(144),d=x(215),y=x(216);function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var s,u,c,v,m,_,g=Object(i.d)("Loader",i.b,!1),b=Object(i.d)("Loader",i.c),w=(s=(t=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._packs=[],this._loading=!1,this._lastPackNamesToLoad=[],this.started=new r.a,this.progressed=new r.a,this.loaded=new r.a,this.completed=new r.a,window.loader=this}var t,n,o;return t=e,(n=[{key:"load",value:function(){var a=this,s=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];"string"==typeof s&&(s=[s]),s=Object(p.a)(s),g("Load :",s),this._loading=!0;var u=f.a.defer();this.started.dispatch(s);for(var t=0,n=this._lastPackNamesToLoad.length;t<n;t++){var o=this._lastPackNamesToLoad[t];if(-1!==s.indexOf(o)||e){var r=this.getPack(o);r.loaded||(r.loading=!0)}else this._abortPack(o)}for(var i=function(e,t){var n=s[e];if(a.checkPackLoading(n))return"continue";if(a.checkPackLoaded(n)){var o=a.getPackResources(n);return a.progressed.dispatch(a._getPacksProgress(s)),a.loaded.dispatch(n,o),a._updateLoadedPack(s,u),"continue"}var r=a._createPack(n);r.loading=!0;var i=h.a.load(r.name,function(e){r.progress=e,a.progressed.dispatch(a._getPacksProgress(s))}).then(a._parseResources).then(function(e){return r.loaded=!0,r.loading=!1,r.resources=e,a.loaded.dispatch(n,e),a._updateLoadedPack(s,u),e});r.promise=i},c=0,l=s.length;c<l;c++)i(c);return this._lastPackNamesToLoad=s,u.promise}},{key:"abortLastPacks",value:function(){for(var e=0,t=this._lastPackNamesToLoad.length;e<t;e++)this._abortPack(this._lastPackNamesToLoad[e])}},{key:"destroy",value:function(){this._packs=[],this._loading=!1,this._lastPackNamesToLoad=[],this.started.removeAll(),this.progressed.removeAll(),this.loaded.removeAll(),this.completed.removeAll()}},{key:"get",value:function(e){for(var t=0,n=this._packs.length;t<n;t++)for(var o=this._packs[t].resources,r=0,i=o.length;r<i;r++){var a=o[r];if(e===a.id)return a.data}return b("Cannot get resource '".concat(e,"'")),null}},{key:"getPack",value:function(e){for(var t=0,n=this._packs.length;t<n;t++){var o=this._packs[t];if(o.name===e)return o}return null}},{key:"getPackResources",value:function(e){var t=this.getPack(e);return t&&t.resources}},{key:"checkPackExists",value:function(e){return!!this.getPack(e)}},{key:"checkPacksLoaded",value:function(e){for(var t=0,n=e.length;t<n;t++)if(!this.checkPackLoaded(e[t]))return!1;return!0}},{key:"checkPackLoaded",value:function(e){var t=this.getPack(e);return!(!t||!t.loaded)}},{key:"checkPackLoading",value:function(e){var t=this.getPack(e);return!(!t||!t.loading)}},{key:"_createPack",value:function(e){var t=this.getPack(e);if(t)return t;var n={name:e,loading:!1,loaded:!1,progress:0,resources:[]};return this._packs.push(n),n}},{key:"_abortPack",value:function(e){var t=this.getPack(e);t.loaded||(h.a.abort(e),t.loading=!1,t.loaded=!1,t.progress=0,t.resources=[])}},{key:"_getPacksProgress",value:function(e){for(var t=e.length,n=0,o=0;o<t;o++){var r=this.getPack(e[o]);r&&(n+=r.progress)}return t?n/t:0}},{key:"_mergePacksResources",value:function(e){var o={};return e.map(function(e){for(var t in e){var n=e[t];o[t]=n}}),o}},{key:"_parseResources",value:function(u){for(var c=[],e=function(e,t){var n=f.a.defer();c.push(n.promise);var o=u[e];switch(o.extension){case"glb":var r=new l.a;r.parse(o.data,null,function(e){o.data=e,r=a=null,n.resolve()});break;case"drc":var i=new l.a,a=new d.a;i.setDRACOLoader(a),i.parse(o.data,null,function(e){o.data=e,i=a=null,n.resolve()});break;case"dds":o.data=y.a.parse(o.data),n.resolve();break;case"json":o.data=JSON.parse(o.data),n.resolve();break;case"png":case"jpg":var s=new Image;s.src=o.data,s.onload=function(){o.data=s,n.resolve()};break;default:n.resolve()}},t=0,n=u.length;t<n;t++)e(t);return f.a.all(c).then(function(){return u})}},{key:"_updateLoadedPack",value:function(e,t){for(var n=e.length,o=0,r=e.length;o<r;o++){var i=e[o];this.checkPackLoaded(i)&&(n-=1)}if(0===n){this._loading=!1;for(var a=[],s=0,u=e.length;s<u;s++){var c=e[s],l=this.getPackResources(c);a.push(l)}var f=this._mergePacksResources(a);this.mergedResources=f,this.completed.dispatch(e,f),t.resolve({packNames:e,resources:f})}}},{key:"isLoading",get:function(){return this._loading}}])&&a(t.prototype,n),o&&a(t,o),e}()).prototype,u="_parseResources",c=[e],v=Object.getOwnPropertyDescriptor(t.prototype,"_parseResources"),m=t.prototype,_={},Object.keys(v).forEach(function(e){_[e]=v[e]}),_.enumerable=!!_.enumerable,_.configurable=!!_.configurable,("value"in _||_.initializer)&&(_.writable=!0),_=c.slice().reverse().reduce(function(e,t){return t(s,u,e)||e},_),m&&void 0!==_.initializer&&(_.value=_.initializer?_.initializer.call(m):void 0,_.initializer=void 0),void 0===_.initializer&&(Object.defineProperty(s,u,_),_=null),t);O.a=new w}).call(this,x(2).bind)},function(e,t,n){"use strict";var o=n(209),i=n.n(o),a=n(4),s=[{path:"/",name:"home",component:"Home",methods:"GET"},{path:"/fallback",name:"fallback",component:"Fallback",methods:"GET"},{path:"/outro",name:"outro",component:"Outro",methods:"GET"},{path:"/lobby",name:"lobby",component:"Lobby",methods:"GET"},{name:"level",path:"/level/:name(1|2|3|4)",component:"Level"},{name:"catch-all",path:"/(.*)",callback:function(){window.location.href="/"}}];function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var r=function(e){function o(){var e,t,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),t=this,e=!(n=l(o).call(this,{routes:s,mode:o.MEMORY_MODE,debugMode:!1}))||"object"!==u(n)&&"function"!=typeof n?p(t):n,window.Router=p(p(e)),e}var t,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(o,i.a),t=o,(n=[{key:"init",value:function(e){this.components=e}},{key:"beforeEach",value:function(e,t,n){a.a.router.beforeEach.dispatch(e,t),e&&e.instance&&e.instance.beforeRouteLeave?e.instance.beforeRouteLeave(e,t,n):n()}},{key:"afterEach",value:function(e,t,n){a.a.router.afterEach.dispatch(e,t),e&&e.instance&&e.instance.$destroy(),t&&t.instance&&t.instance.beforeRouteEnter?t.instance.beforeRouteEnter(e,t,n):n()}}])&&c(t.prototype,n),r&&c(t,r),o}();t.a=new r},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";var o=n(63),i=n.n(o),r=n(26),a=n(5);function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var u=Object(a.d)("SaveManager","#6C7A89",!0),c=function(){function t(){var e=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.categoriesIds=["global","lobby","level-1","level-2","level-3","level-4"],this.levelsIds=[],this.data={},this._setData(),setTimeout(function(){e._createGUI()},0)}var e,n,o;return e=t,(n=[{key:"get",value:function(e){return this._index(this.data,e)}},{key:"set",value:function(e,t){u(e,t),this._index(this.data,e,t);var n=e.split(".")[0];i.a.setItem(n,JSON.stringify(this.data[n]))}},{key:"clear",value:function(){for(var e=0,t=this.categoriesIds.length;e<t;e++)i.a.removeItem(this.categoriesIds[e])}},{key:"_setData",value:function(){for(var e=0,t=this.categoriesIds.length;e<t;e++){var n=this.categoriesIds[e],o=i.a.getItem(n);if(o)this.data[n]=JSON.parse(o);else{if("global"===n){var r=navigator.language||navigator.userLanguage;this.data[n]={qwerty:!r.match(/fr/gi)||!1,sound:!0}}else this.data[n]={seen:!1,done:!1,checkpoint:-1};i.a.setItem(n,JSON.stringify(this.data[n]))}}}},{key:"_index",value:function(e,t,n){return"string"==typeof t?this._index(e,t.split("."),n):1===t.length&&void 0!==n?e[t[0]]=n:0===t.length?e:this._index(e[t[0]],t.slice(1),n)}},{key:"_createGUI",value:function(){var e=this,t=r.a.addFolder("SaveManager");t.add(this.data.global,"qwerty").onChange(function(){i.a.setItem("global",JSON.stringify(e.data.global))}),t.add(this.data.global,"sound").onChange(function(){i.a.setItem("global",JSON.stringify(e.data.global))}),t.add(this,"clear")}}])&&s(e.prototype,n),o&&s(e,o),t}();t.a=new c},function(e,t,n){"use strict";var o=n(217),r=n(218),i=n(219),a=n(220),s=n(221),u=n(222);t.a={home:o,lobby:r,"level-1":i,"level-2":a,"level-3":s,"level-4":u}},function(e,h,d){"use strict";(function(e){var t,r=d(104),i=d(145),a=d(4);function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var n,o,u,c,l,f,p=(n=(t=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._bind()}var t,n,o;return t=e,(n=[{key:"destroy",value:function(){this._unbind()}},{key:"_bind",value:function(){a.a.context.initialized.add(this._init)}},{key:"_unbind",value:function(){a.a.context.initialized.remove(this._init)}},{key:"_init",value:function(){this.depthMaterial=new i.a,this.depthSkinningMaterial=new i.a({skinning:!0}),this.debugMaterial=new r.a({color:16711680,transparent:!0,opacity:.3})}}])&&s(t.prototype,n),o&&s(t,o),e}()).prototype,o="_init",u=[e],c=Object.getOwnPropertyDescriptor(t.prototype,"_init"),l=t.prototype,f={},Object.keys(c).forEach(function(e){f[e]=c[e]}),f.enumerable=!!f.enumerable,f.configurable=!!f.configurable,("value"in f||f.initializer)&&(f.writable=!0),f=u.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},f),l&&void 0!==f.initializer&&(f.value=f.initializer?f.initializer.call(l):void 0,f.initializer=void 0),void 0===f.initializer&&(Object.defineProperty(n,o,f),f=null),t);h.a=new p}).call(this,d(2).bind)},function(e,t,n){"use strict";var r=n(32),l=n(16),i=n(3),o=n(5);function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var s=Object(o.d)("TextureManager","#73505F",!1),u=!1,c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._loader=r.a,this.textures={},this.compressed=!u&&i.a.supports.webgl.textureFormat.compressed,this.format=u?"uncompressed":i.a.supports.webgl.textureFormat.format,this._log()}var t,n,o;return t=e,(n=[{key:"get",value:function(e,t){return e=this._parseResourceId(e,t),this.textures[e]?this.textures[e]:this._createTexture(e,t)}},{key:"_createTexture",value:function(e){var t,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o=n.filtering,r=n.wrapping,i=n.repeat,a=n.mipmaps,s=void 0===a||a;if(this.compressed){t=new THREE.CompressedTexture;var u=this._loader.get(e);if(!u)return null;t.image.width=u.width,t.image.height=u.height,t.mipmaps=u.mipmaps,t.format=u.format}else{var c=this._loader.get(e);if(!c)return null;(t=new THREE.Texture(c)).flipY=!0,t.generateMipmaps=s}return t.name=e,t.minFilter=t.magFilter=o||THREE.LinearFilter,t.wrapS=t.wrapT=r||THREE.ClampToEdgeWrapping,t.anisotropy=l.a.renderer.capabilities.getMaxAnisotropy(),i&&t.repeat.copy(i),t.needsUpdate=!0,this.textures[e]=t}},{key:"_parseResourceId",value:function(e){1<arguments.length&&void 0!==arguments[1]&&arguments[1];var t=e.split("."),n=t.shift();return"".concat(n,"-textures-default-").concat(this.format,".textures.").concat(t.join("."))}},{key:"_log",value:function(){var n=this;setTimeout(function(){var e=n.compressed?"Compressed":"Uncompressed",t=n.compressed?"| ".concat(n.format.toUpperCase()):"";s("".concat(e," ").concat(t))},0)}}])&&a(t.prototype,n),o&&a(t,o),e}();t.a=new c},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var o=function(){function o(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new THREE.Scene,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new THREE.OrthographicCamera(-1,1,1,-1,0,1),n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2),null);!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),this.name="Pass",this.scene=e,this.camera=t,this.quad=n,null!==this.quad&&(this.quad.frustumCulled=!1,null!==this.scene&&this.scene.add(this.quad)),this.needsSwap=!1,this.enabled=!0,this.renderToScreen=!1}var e,t,n;return e=o,(t=[{key:"setUniform",value:function(e,t){this.material.uniforms[e]&&(this.material.uniforms[e].value=t)}},{key:"render",value:function(e,t,n,o,r,i){throw new Error("Render method not implemented!")}},{key:"setSize",value:function(e,t){}},{key:"init",value:function(e,t){}},{key:"destroy",value:function(){for(var e,t=Object.keys(this),n=0;n<t.length;n++)this[e=t[n]]&&"function"==typeof this[e].dispose&&this[e].dispose()}},{key:"material",get:function(){return null!==this.quad?this.quad.material:null},set:function(e){null!==this.quad&&(this.quad.material=e)}}])&&r(e.prototype,t),n&&r(e,n),o}();t.a=o},function(e,E,P){"use strict";(function(e){var t,n,o,i=P(55),a=P(330),s=P(15),u=P(7),c=P(30),l=P(331),f=P(107),p=P(110),h=P(106),d=P(6);function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function v(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function m(e,t,n){return(m="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var w,O,x,k=(o=n=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),v(this,_(t).apply(this,arguments))}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(t,i["a"]),n=t,(o=[{key:"update",value:function(e,t){this._running&&(this.physics&&this.physics.update(e,t),this._cameraCtrl.update(e,t),this._materialCtrl.update(e,t),this._onUpdate(e,t),this.terrain.update(e,t),this.character.update(e,t),c.a.update(e,t),this._levelPostProcessing.update(e,t),this._postProcessing.update(e,t))}},{key:"destroy",value:function(){var e=this;return clearTimeout(this._noKeyTimeout),this._signals.instructions.hide.dispatch(),m(_(t.prototype),"destroy",this).call(this).then(function(){e._levelPostProcessing.destroy(),e._materialCtrl.destroy(),c.a.destroy()})}},{key:"setView",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(this._resetData[e]){var n=this._resetData[e],o=n.charPos,r=n.charDir,i=n.camDir,a=n.camPanY;o&&this.character.setPosition(o,t),r&&this.character.setDirection(r),i&&(this._gameCamera.direction=i),a&&this._gameCamera.setPanY(a)}else console.error("reset data not found: ",e)}},{key:"_init",value:function(){var e=this;this._resetData={spawn:{charPos:new THREE.Vector3(0,3,0)}},this.navMeshes=[],this._gltf.add("terrain","".concat(this.name,".models.terrain")),this._gltf.add("character","main.models.character"),this._state.levelHistory.push(this.name),this._stack.before("GUI","GUI:before",function(){e._levelPostProcessing.init(),e._materialCtrl.init(),e._levelTransition()})}},{key:"_bind",value:function(){u.a.upped.add(this._onKeyUp),this._signals.character.reseted.add(this._onCharReset),this._signals.pause.shown.add(this._onPauseShow),this._signals.pause.hidden.add(this._onPauseHide)}},{key:"_unbind",value:function(){u.a.upped.remove(this._onKeyUp),this._signals.character.reseted.remove(this._onCharReset),this._signals.pause.shown.remove(this._onPauseShow),this._signals.pause.hidden.remove(this._onPauseHide)}},{key:"_createCtrls",value:function(){m(_(t.prototype),"_createCtrls",this).call(this),this._materialCtrl=new p.a(this)}},{key:"_createCameras",value:function(){this._gameCamera=new a.a({name:"Game camera",isDefault:!0}),this.addCamera(this._gameCamera),this._grabTimeout=setTimeout(function(){s.a.addCursor("grab")},5e3)}},{key:"_createPostProcessing",value:function(){m(_(t.prototype),"_createPostProcessing",this).call(this),this._levelPostProcessing=new h.a}},{key:"_createEntities",value:function(){this.character=new l.a(this),this.addEntity(this.character),this.terrain=new f.a(this),this.addEntity(this.terrain),this.addEntity(c.a.lightsRoot)}},{key:"_afterCreate",value:function(){m(_(t.prototype),"_afterCreate",this).call(this),this._signals.overlay.hide.dispatch(),this._signals.levelIntro.show.dispatch(this.name),this.setView("spawn"),window.viewDebug=this._viewDebug,c.a.init(this),this._levelInTl&&this._levelInTl.play(),Object(d.a)("level","level-enter",this.name)}},{key:"_viewDebug",value:function(){var e=new Date,t=e.getHours(),n=e.getMinutes(),o=e.getSeconds(),r=""+(12<t?t-12:t);r+=(n<10?":0":":")+n,r+=(o<10?":0":":")+o,r+=12<=t?" P.M.":" A.M.",console.log("------- ",r),console.log("character position",this.character.position),console.log("character direction",this.character._rotAcceleration),console.log("camera direction",this._gameCamera.direction),console.log("camera panY",this._gameCamera._panY)}},{key:"_levelTransition",value:function(){var e=this;if(-1!==this.name.indexOf("level-")&&"level-4"!==this.name||"lobby"===this.name){var t={v:0};this._levelInTl=new TimelineMax({paused:!0}),this._tls.push(this._levelInTl),this._levelInTl.fromTo(t,2,{v:0},{v:1,delay:.5,ease:Power1.easeOut,onUpdate:function(){return e._materialCtrl.setAllProperties("transition",t.v)}})}}},{key:"_onKeyUp",value:function(e){192===e.keyCode&&this._viewDebug()}},{key:"_onCharReset",value:function(){}},{key:"_onPauseShow",value:function(){}},{key:"_onPauseHide",value:function(){}},{key:"materialCtrl",get:function(){return this._materialCtrl}}])&&y(n.prototype,o),r&&y(n,r),t}(),x=!(O="needsTextures"),O in(w=n)?Object.defineProperty(w,O,{value:x,enumerable:!0,configurable:!0,writable:!0}):w[O]=x,b((t=o).prototype,"_viewDebug",[e],Object.getOwnPropertyDescriptor(t.prototype,"_viewDebug"),t.prototype),b(t.prototype,"_onKeyUp",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onKeyUp"),t.prototype),b(t.prototype,"_onCharReset",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onCharReset"),t.prototype),b(t.prototype,"_onPauseShow",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onPauseShow"),t.prototype),b(t.prototype,"_onPauseHide",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onPauseHide"),t.prototype),t);E.a=k}).call(this,P(2).bind)},function(e,t,n){"use strict";t.__esModule=!0;var p=s(n(86)),o=s(n(142)),h=s(n(140)),r=s(n(141)),i=s(n(553)),d=s(n(23)),a=s(n(195)),y=s(n(554));function s(e){return e&&e.__esModule?e:{default:e}}var v={panningModel:"HRTF",distanceModel:"linear",refDistance:1,maxDistance:1e3,rolloffFactor:1,coneInnerAngle:360,coneOuterAngle:0,coneOuterGain:0};function u(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return(0,a.default)(e)?e:t}function c(e,t){var n=e.x,o=e.y,r=e.z,i=t.x,a=t.y,s=t.z;e.x=o*s-r*a,e.y=r*i-n*s,e.z=n*a-o*i}function l(e){if(0===e.x&&0===e.y&&0===e.z)return e;var t=1/Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z);return e.x*=t,e.y*=t,e.z*=t,e}var m={pool:[],get:function(e,t,n){var o=this.pool.length?this.pool.pop():{x:0,y:0,z:0};return void 0!==e&&isNaN(e)&&"x"in e&&"y"in e&&"z"in e?(o.x=u(e.x),o.y=u(e.y),o.z=u(e.z)):(o.x=u(e),o.y=u(t),o.z=u(n)),o},dispose:function(e){this.pool.push(e)}},f=m.get(0,1,0),_=Math.PI/4,g=Math.PI/2;function b(e,t){var n=m.get(t.x,t.y,t.z);c(n,f),c(n,t),l(n),l(t),e.setOrientation(t.x,t.y,t.z,n.x,n.y,n.z),m.dispose(t),m.dispose(n)}function w(e,t){e.setPosition(t.x,t.y,t.z),m.dispose(t)}var O=function(l){function f(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.panningModel,n=e.distanceModel,o=e.refDistance,r=e.maxDistance,i=e.rolloffFactor,a=e.coneInnerAngle,s=e.coneOuterAngle,u=e.coneOuterGain;(0,p.default)(this,f);var c=(0,h.default)(this,l.call(this,d.default.context.createPanner()));return c._node.panningModel=t||v.panningModel,c._node.distanceModel=n||v.distanceModel,c._node.refDistance=(0,y.default)(o)?o:v.refDistance,c._node.maxDistance=(0,y.default)(r)?r:v.maxDistance,c._node.rolloffFactor=(0,y.default)(i)?i:v.rolloffFactor,c._node.coneInnerAngle=(0,y.default)(a)?a:v.coneInnerAngle,c._node.coneOuterAngle=(0,y.default)(s)?s:v.coneOuterAngle,c._node.coneOuterGain=(0,y.default)(u)?u:v.coneOuterGain,c._node.setPosition(0,0,0),c._node.setOrientation(1,0,0),c.set(0),c}return(0,r.default)(f,l),f.prototype.update=function(e){var t=e.x,n=e.y,o=e.z,r=m.get(t,n,o);!(0,a.default)(t)||(0,a.default)(n)||(0,a.default)(o)||(1<(t=r.x)&&(t=1),t<-1&&(t=-1),g<(o=(t*=_)+g)&&(o=Math.PI-o),r.x=Math.sin(t),r.y=0,r.z=Math.sin(o)),w(this._node,r)},f.prototype.setPosition=function(e,t,n){w(this._node,m.get(e,t,n))},f.prototype.setOrientation=function(e,t,n){b(this._node,m.get(e,t,n))},f.prototype.setListenerPosition=function(e,t,n){w(d.default.context.listener,m.get(e,t,n))},f.prototype.setListenerOrientation=function(e,t,n){b(d.default.context.listener,m.get(e,t,n))},f.prototype.set=function(e,t,n){return this.update({x:e,y:t,z:n})},(0,o.default)(f,[{key:"defaults",get:function(){return v},set:function(e){Object.assign(v,e)}}]),f}(i.default),x=d.default.register("panner",function(e){return new O(e)});Object.defineProperties(x,{defaults:{get:function(){return v},set:function(e){return Object.assign(v,e)}},setListenerPosition:{value:function(e,t,n){return w(d.default.context.listener,m.get(e,t,n))}},setListenerOrientation:{value:function(e,t,n){return b(d.default.context.listener,m.get(e,t,n))}}}),t.default=x},function(e,t,n){"use strict";var o=n(20),r=n.n(o),i=n(3);function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._events={gamepad:[],axes:[]},this._handlers={gamepad:{connect:null,disconnect:null}},this._keyMapping={gamepad:{button_1:0,button_2:1,button_3:2,button_4:3,shoulder_top_left:4,shoulder_top_right:5,shoulder_bottom_left:6,shoulder_bottom_right:7,select:8,start:9,stick_button_left:10,stick_button_right:11,d_pad_up:12,d_pad_down:13,d_pad_left:14,d_pad_right:15,vendor:16},axes:{stick_axis_left:[0,2],stick_axis_right:[2,4]}},this._threshold=.3,this._listeners=[],this._update=this._update.bind(this),this.resume()}var t,n,o;return t=e,(n=[{key:"on",value:function(t,n,o,r){var i=this;-1!==Object.keys(this._handlers.gamepad).indexOf(t)&&"function"==typeof n?(this._handlers.gamepad[t]=n,this._events.gamepad=[]):("string"==typeof t&&t.match(/\s+/)&&(t=t.split(/\s+/g)),"string"==typeof n&&n.match(/\s+/)&&(n=n.split(/\s+/g)),Array.isArray(t)?t.forEach(function(e){i.on(e,n,o,r)}):Array.isArray(n)?n.forEach(function(e){i.on(t,e,o,r)}):this._listeners.push({type:t,button:n,callback:o,options:r}))}},{key:"off",value:function(t,n){var o=this;"string"==typeof t&&t.match(/\s+/)&&(t=t.split(/\s+/g)),"string"==typeof n&&n.match(/\s+/)&&(n=n.split(/\s+/g)),Array.isArray(t)?t.forEach(function(e){o.off(e,n)}):Array.isArray(n)?n.forEach(function(e){o.off(t,e)}):this._listeners=this._listeners.filter(function(e){return e.type!==t&&e.button!==n})}},{key:"trigger",value:function(t,n,o,r){this._listeners&&this._listeners.forEach(function(e){e.type===t&&e.button===n&&e.callback({type:e.type,button:e.button,value:o,player:r,event:e,timestamp:Date.now()})})}},{key:"setCustomMapping",value:function(e,t){if(void 0===this._keyMapping[e])throw new Error('The device "'.concat(e,'" is not supported'));this._keyMapping[e]=t}},{key:"pause",value:function(){r.a.remove(this._update)}},{key:"resume",value:function(){r.a.add(this._update)}},{key:"destroy",value:function(){this.pause(),delete this._listeners}},{key:"_findKeyMapping",value:function(t,n){var o=[];return Object.keys(n).forEach(function(e){n[e]===t?o.push(e):Array.isArray(n[e])&&-1!==n[e].indexOf(t)&&o.push(e)}),o}},{key:"_handleGamepadConnected",value:function(e){this._handlers.gamepad.connect&&this._handlers.gamepad.connect({index:e})}},{key:"_handleGamepadDisconnected",value:function(e){this._handlers.gamepad.disconnect&&this._handlers.gamepad.disconnect({index:e})}},{key:"_handleGamepadEventListener",value:function(o){var r=this;o&&o.connected&&o.buttons.forEach(function(t,e){var n=r._findKeyMapping(e,r._keyMapping.gamepad);n&&n.forEach(function(e){t.pressed?(r._events.gamepad[o.index][e]||(r._events.gamepad[o.index][e]={pressed:!0,hold:!1,released:!1,player:o.index}),r._events.gamepad[o.index][e].value=t.value):!t.pressed&&r._events.gamepad[o.index][e]&&(r._events.gamepad[o.index][e].released=!0,r._events.gamepad[o.index][e].hold=!1)})})}},{key:"_handleGamepadAxisEventListener",value:function(n){var o=this;n&&n.connected&&Object.keys(this._keyMapping.axes).forEach(function(e){var t=Array.prototype.slice.apply(n.axes,o._keyMapping.axes[e]);Math.abs(t[0])>o._threshold||Math.abs(t[1])>o._threshold?o._events.axes[n.index][e]={pressed:!o._events.axes[n.index][e],hold:!!o._events.axes[n.index][e],released:!1,value:t}:o._events.axes[n.index][e]&&(o._events.axes[n.index][e]={pressed:!1,hold:!1,released:!0,value:t})})}},{key:"_handleEvent",value:function(e,t,n){t[e].pressed?(this.trigger("press",e,t[e].value,n),t[e].pressed=!1,t[e].hold=!0):t[e].hold?this.trigger("hold",e,t[e].value,n):t[e].released&&(this.trigger("release",e,t[e].value,n),delete t[e])}},{key:"_update",value:function(){var o=this,e=!!i.a.supports.gamepad&&window.navigator.getGamepads();if(e){for(var t=0,n=e.length;t<n;t++){e[t]?(this._events.gamepad[t]||(this._handleGamepadConnected(t),this._events.gamepad[t]={},this._events.axes[t]={}),this._handleGamepadEventListener(e[t]),this._handleGamepadAxisEventListener(e[t])):this._events.gamepad[t]&&(this._handleGamepadDisconnected(t),this._events.gamepad[t]=null,this._events.axes[t]=null)}this._events.gamepad.forEach(function(t,n){t&&Object.keys(t).forEach(function(e){o._handleEvent(e,t,n)})}),this._events.axes.forEach(function(t,n){t&&Object.keys(t).forEach(function(e){o._handleEvent(e,t,n)})})}}},{key:"threshold",get:function(){return this._threshold},set:function(e){this._threshold=parseFloat(e)}}])&&a(t.prototype,n),o&&a(t,o),e}();t.a=new s},function(e,t,n){var o,r;function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var h={distributions:{BOX:1,SPHERE:2,DISC:3},valueOverLifetimeLength:4};void 0===(r="function"==typeof(o=h)?o.call(t,n,t,e):o)||(e.exports=r),h.TypedArrayHelper=function(e,t,n,o){"use strict";this.componentSize=n||1,this.size=t||1,this.TypedArrayConstructor=e||Float32Array,this.array=new e(t*this.componentSize),this.indexOffset=o||0},h.TypedArrayHelper.constructor=h.TypedArrayHelper,h.TypedArrayHelper.prototype.setSize=function(e,t){"use strict";var n=this.array.length;return t||(e*=this.componentSize),e<n?this.shrink(e):n<e?this.grow(e):void console.info("TypedArray is already of size:",e+".","Will not resize.")},h.TypedArrayHelper.prototype.shrink=function(e){"use strict";return this.array=this.array.subarray(0,e),this.size=e,this},h.TypedArrayHelper.prototype.grow=function(e){"use strict";var t=this.array,n=new this.TypedArrayConstructor(e);return n.set(t),this.array=n,this.size=e,this},h.TypedArrayHelper.prototype.splice=function(e,t){"use strict";e*=this.componentSize,t*=this.componentSize;for(var n=[],o=this.array,r=o.length,i=0;i<r;++i)(i<e||t<=i)&&n.push(o[i]);return this.setFromArray(0,n),this},h.TypedArrayHelper.prototype.setFromArray=function(e,t){"use strict";var n=e+t.length;return n>this.array.length?this.grow(n):n<this.array.length&&this.shrink(n),this.array.set(t,this.indexOffset+e),this},h.TypedArrayHelper.prototype.setVec2=function(e,t){"use strict";return this.setVec2Components(e,t.x,t.y)},h.TypedArrayHelper.prototype.setVec2Components=function(e,t,n){"use strict";var o=this.array,r=this.indexOffset+e*this.componentSize;return o[r]=t,o[r+1]=n,this},h.TypedArrayHelper.prototype.setVec3=function(e,t){"use strict";return this.setVec3Components(e,t.x,t.y,t.z)},h.TypedArrayHelper.prototype.setVec3Components=function(e,t,n,o){"use strict";var r=this.array,i=this.indexOffset+e*this.componentSize;return r[i]=t,r[i+1]=n,r[i+2]=o,this},h.TypedArrayHelper.prototype.setVec4=function(e,t){"use strict";return this.setVec4Components(e,t.x,t.y,t.z,t.w)},h.TypedArrayHelper.prototype.setVec4Components=function(e,t,n,o,r){"use strict";var i=this.array,a=this.indexOffset+e*this.componentSize;return i[a]=t,i[a+1]=n,i[a+2]=o,i[a+3]=r,this},h.TypedArrayHelper.prototype.setMat3=function(e,t){"use strict";return this.setFromArray(this.indexOffset+e*this.componentSize,t.elements)},h.TypedArrayHelper.prototype.setMat4=function(e,t){"use strict";return this.setFromArray(this.indexOffset+e*this.componentSize,t.elements)},h.TypedArrayHelper.prototype.setColor=function(e,t){"use strict";return this.setVec3Components(e,t.r,t.g,t.b)},h.TypedArrayHelper.prototype.setNumber=function(e,t){"use strict";return this.array[this.indexOffset+e*this.componentSize]=t,this},h.TypedArrayHelper.prototype.getValueAtIndex=function(e){"use strict";return this.array[this.indexOffset+e]},h.TypedArrayHelper.prototype.getComponentValueAtIndex=function(e){"use strict";return this.array.subarray(this.indexOffset+e*this.componentSize)},h.ShaderAttribute=function(e,t,n){"use strict";var o=h.ShaderAttribute.typeSizeMap;this.type="string"==typeof e&&o.hasOwnProperty(e)?e:"f",this.componentSize=o[this.type],this.arrayType=n||Float32Array,this.typedArray=null,this.bufferAttribute=null,this.dynamicBuffer=!!t,this.updateMin=0,this.updateMax=0},h.ShaderAttribute.constructor=h.ShaderAttribute,h.ShaderAttribute.typeSizeMap={f:1,v2:2,v3:3,v4:4,c:3,m3:9,m4:16},h.ShaderAttribute.prototype.setUpdateRange=function(e,t){"use strict";this.updateMin=Math.min(e*this.componentSize,this.updateMin*this.componentSize),this.updateMax=Math.max(t*this.componentSize,this.updateMax*this.componentSize)},h.ShaderAttribute.prototype.flagUpdate=function(){"use strict";var e=this.bufferAttribute,t=e.updateRange;t.offset=this.updateMin,t.count=Math.min(this.updateMax-this.updateMin+this.componentSize,this.typedArray.array.length),e.needsUpdate=!0},h.ShaderAttribute.prototype.resetUpdateRange=function(){"use strict";this.updateMin=0,this.updateMax=0},h.ShaderAttribute.prototype.resetDynamic=function(){"use strict";this.bufferAttribute.dynamic=this.dynamicBuffer},h.ShaderAttribute.prototype.splice=function(e,t){"use strict";this.typedArray.splice(e,t),this.forceUpdateAll()},h.ShaderAttribute.prototype.forceUpdateAll=function(){"use strict";this.bufferAttribute.array=this.typedArray.array,this.bufferAttribute.updateRange.offset=0,this.bufferAttribute.updateRange.count=-1,this.bufferAttribute.dynamic=!1,this.bufferAttribute.needsUpdate=!0},h.ShaderAttribute.prototype._ensureTypedArray=function(e){"use strict";null!==this.typedArray&&this.typedArray.size===e*this.componentSize||(null!==this.typedArray&&this.typedArray.size!==e?this.typedArray.setSize(e):null===this.typedArray&&(this.typedArray=new h.TypedArrayHelper(this.arrayType,e,this.componentSize)))},h.ShaderAttribute.prototype._createBufferAttribute=function(e){"use strict";if(this._ensureTypedArray(e),null!==this.bufferAttribute)return this.bufferAttribute.array=this.typedArray.array,81<=parseFloat(THREE.REVISION)&&(this.bufferAttribute.count=this.bufferAttribute.array.length/this.bufferAttribute.itemSize),void(this.bufferAttribute.needsUpdate=!0);this.bufferAttribute=new THREE.BufferAttribute(this.typedArray.array,this.componentSize),this.bufferAttribute.dynamic=this.dynamicBuffer},h.ShaderAttribute.prototype.getLength=function(){"use strict";return null===this.typedArray?0:this.typedArray.array.length},h.shaderChunks={defines:["#define PACKED_COLOR_SIZE 256.0","#define PACKED_COLOR_DIVISOR 255.0"].join("\n"),uniforms:["uniform float deltaTime;","uniform float runTime;","uniform sampler2D texture;","uniform vec4 textureAnimation;","uniform float scale;"].join("\n"),attributes:["attribute vec4 acceleration;","attribute vec3 velocity;","attribute vec4 rotation;","attribute vec3 rotationCenter;","attribute vec4 params;","attribute vec4 size;","attribute vec4 angle;","attribute vec4 color;","attribute vec4 opacity;"].join("\n"),varyings:["varying vec4 vColor;","#ifdef SHOULD_ROTATE_TEXTURE","    varying float vAngle;","#endif","#ifdef SHOULD_CALCULATE_SPRITE","    varying vec4 vSpriteSheet;","#endif"].join("\n"),branchAvoidanceFunctions:["float when_gt(float x, float y) {","    return max(sign(x - y), 0.0);","}","float when_lt(float x, float y) {","    return min( max(1.0 - sign(x - y), 0.0), 1.0 );","}","float when_eq( float x, float y ) {","    return 1.0 - abs( sign( x - y ) );","}","float when_ge(float x, float y) {","  return 1.0 - when_lt(x, y);","}","float when_le(float x, float y) {","  return 1.0 - when_gt(x, y);","}","float and(float a, float b) {","    return a * b;","}","float or(float a, float b) {","    return min(a + b, 1.0);","}"].join("\n"),unpackColor:["vec3 unpackColor( in float hex ) {","   vec3 c = vec3( 0.0 );","   float r = mod( (hex / PACKED_COLOR_SIZE / PACKED_COLOR_SIZE), PACKED_COLOR_SIZE );","   float g = mod( (hex / PACKED_COLOR_SIZE), PACKED_COLOR_SIZE );","   float b = mod( hex, PACKED_COLOR_SIZE );","   c.r = r / PACKED_COLOR_DIVISOR;","   c.g = g / PACKED_COLOR_DIVISOR;","   c.b = b / PACKED_COLOR_DIVISOR;","   return c;","}"].join("\n"),unpackRotationAxis:["vec3 unpackRotationAxis( in float hex ) {","   vec3 c = vec3( 0.0 );","   float r = mod( (hex / PACKED_COLOR_SIZE / PACKED_COLOR_SIZE), PACKED_COLOR_SIZE );","   float g = mod( (hex / PACKED_COLOR_SIZE), PACKED_COLOR_SIZE );","   float b = mod( hex, PACKED_COLOR_SIZE );","   c.r = r / PACKED_COLOR_DIVISOR;","   c.g = g / PACKED_COLOR_DIVISOR;","   c.b = b / PACKED_COLOR_DIVISOR;","   c *= vec3( 2.0 );","   c -= vec3( 1.0 );","   return c;","}"].join("\n"),floatOverLifetime:["float getFloatOverLifetime( in float positionInTime, in vec4 attr ) {","    highp float value = 0.0;","    float deltaAge = positionInTime * float( VALUE_OVER_LIFETIME_LENGTH - 1 );","    float fIndex = 0.0;","    float shouldApplyValue = 0.0;","    value += attr[ 0 ] * when_eq( deltaAge, 0.0 );","","    for( int i = 0; i < VALUE_OVER_LIFETIME_LENGTH - 1; ++i ) {","       fIndex = float( i );","       shouldApplyValue = and( when_gt( deltaAge, fIndex ), when_le( deltaAge, fIndex + 1.0 ) );","       value += shouldApplyValue * mix( attr[ i ], attr[ i + 1 ], deltaAge - fIndex );","    }","","    return value;","}"].join("\n"),colorOverLifetime:["vec3 getColorOverLifetime( in float positionInTime, in vec3 color1, in vec3 color2, in vec3 color3, in vec3 color4 ) {","    vec3 value = vec3( 0.0 );","    value.x = getFloatOverLifetime( positionInTime, vec4( color1.x, color2.x, color3.x, color4.x ) );","    value.y = getFloatOverLifetime( positionInTime, vec4( color1.y, color2.y, color3.y, color4.y ) );","    value.z = getFloatOverLifetime( positionInTime, vec4( color1.z, color2.z, color3.z, color4.z ) );","    return value;","}"].join("\n"),paramFetchingFunctions:["float getAlive() {","   return params.x;","}","float getAge() {","   return params.y;","}","float getMaxAge() {","   return params.z;","}","float getWiggle() {","   return params.w;","}"].join("\n"),forceFetchingFunctions:["vec4 getPosition( in float age ) {","   return modelViewMatrix * vec4( position, 1.0 );","}","vec3 getVelocity( in float age ) {","   return velocity * age;","}","vec3 getAcceleration( in float age ) {","   return acceleration.xyz * age;","}"].join("\n"),rotationFunctions:["#ifdef SHOULD_ROTATE_PARTICLES","   mat4 getRotationMatrix( in vec3 axis, in float angle) {","       axis = normalize(axis);","       float s = sin(angle);","       float c = cos(angle);","       float oc = 1.0 - c;","","       return mat4(oc * axis.x * axis.x + c,           oc * axis.x * axis.y - axis.z * s,  oc * axis.z * axis.x + axis.y * s,  0.0,","                   oc * axis.x * axis.y + axis.z * s,  oc * axis.y * axis.y + c,           oc * axis.y * axis.z - axis.x * s,  0.0,","                   oc * axis.z * axis.x - axis.y * s,  oc * axis.y * axis.z + axis.x * s,  oc * axis.z * axis.z + c,           0.0,","                   0.0,                                0.0,                                0.0,                                1.0);","   }","","   vec3 getRotation( in vec3 pos, in float positionInTime ) {","      if( rotation.y == 0.0 ) {","           return pos;","      }","","      vec3 axis = unpackRotationAxis( rotation.x );","      vec3 center = rotationCenter;","      vec3 translated;","      mat4 rotationMatrix;","      float angle = 0.0;","      angle += when_eq( rotation.z, 0.0 ) * rotation.y;","      angle += when_gt( rotation.z, 0.0 ) * mix( 0.0, rotation.y, positionInTime );","      translated = rotationCenter - pos;","      rotationMatrix = getRotationMatrix( axis, angle );","      return center - vec3( rotationMatrix * vec4( translated, 0.0 ) );","   }","#endif"].join("\n"),rotateTexture:["    vec2 vUv = vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y );","","    #ifdef SHOULD_ROTATE_TEXTURE","       float x = gl_PointCoord.x - 0.5;","       float y = 1.0 - gl_PointCoord.y - 0.5;","       float c = cos( -vAngle );","       float s = sin( -vAngle );","       vUv = vec2( c * x + s * y + 0.5, c * y - s * x + 0.5 );","    #endif","","    #ifdef SHOULD_CALCULATE_SPRITE","        float framesX = vSpriteSheet.x;","        float framesY = vSpriteSheet.y;","        float columnNorm = vSpriteSheet.z;","        float rowNorm = vSpriteSheet.w;","        vUv.x = gl_PointCoord.x * framesX + columnNorm;","        vUv.y = 1.0 - (gl_PointCoord.y * framesY + rowNorm);","    #endif","","    vec4 rotatedTexture = texture2D( texture, vUv );"].join("\n")},h.shaders={vertex:[h.shaderChunks.defines,h.shaderChunks.uniforms,h.shaderChunks.attributes,h.shaderChunks.varyings,THREE.ShaderChunk.common,THREE.ShaderChunk.logdepthbuf_pars_vertex,THREE.ShaderChunk.fog_pars_vertex,h.shaderChunks.branchAvoidanceFunctions,h.shaderChunks.unpackColor,h.shaderChunks.unpackRotationAxis,h.shaderChunks.floatOverLifetime,h.shaderChunks.colorOverLifetime,h.shaderChunks.paramFetchingFunctions,h.shaderChunks.forceFetchingFunctions,h.shaderChunks.rotationFunctions,"void main() {","    highp float age = getAge();","    highp float alive = getAlive();","    highp float maxAge = getMaxAge();","    highp float positionInTime = (age / maxAge);","    highp float isAlive = when_gt( alive, 0.0 );","    #ifdef SHOULD_WIGGLE_PARTICLES","        float wiggleAmount = positionInTime * getWiggle();","        float wiggleSin = isAlive * sin( wiggleAmount );","        float wiggleCos = isAlive * cos( wiggleAmount );","    #endif","    vec3 vel = getVelocity( age );","    vec3 accel = getAcceleration( age );","    vec3 force = vec3( 0.0 );","    vec3 pos = vec3( position );","    float drag = 1.0 - (positionInTime * 0.5) * acceleration.w;","    force += vel;","    force *= drag;","    force += accel * age;","    pos += force;","    #ifdef SHOULD_WIGGLE_PARTICLES","        pos.x += wiggleSin;","        pos.y += wiggleCos;","        pos.z += wiggleSin;","    #endif","    #ifdef SHOULD_ROTATE_PARTICLES","        pos = getRotation( pos, positionInTime );","    #endif","    vec4 mvPosition = modelViewMatrix * vec4( pos, 1.0 );","    highp float pointSize = getFloatOverLifetime( positionInTime, size ) * isAlive;","    #ifdef HAS_PERSPECTIVE","        float perspective = scale / length( mvPosition.xyz );","    #else","        float perspective = 1.0;","    #endif","    float pointSizePerspective = pointSize * perspective;","    #ifdef COLORIZE","       vec3 c = isAlive * getColorOverLifetime(","           positionInTime,","           unpackColor( color.x ),","           unpackColor( color.y ),","           unpackColor( color.z ),","           unpackColor( color.w )","       );","    #else","       vec3 c = vec3(1.0);","    #endif","    float o = isAlive * getFloatOverLifetime( positionInTime, opacity );","    vColor = vec4( c, o );","    #ifdef SHOULD_ROTATE_TEXTURE","        vAngle = isAlive * getFloatOverLifetime( positionInTime, angle );","    #endif","    #ifdef SHOULD_CALCULATE_SPRITE","        float framesX = textureAnimation.x;","        float framesY = textureAnimation.y;","        float loopCount = textureAnimation.w;","        float totalFrames = textureAnimation.z;","        float frameNumber = mod( (positionInTime * loopCount) * totalFrames, totalFrames );","        float column = floor(mod( frameNumber, framesX ));","        float row = floor( (frameNumber - column) / framesX );","        float columnNorm = column / framesX;","        float rowNorm = row / framesY;","        vSpriteSheet.x = 1.0 / framesX;","        vSpriteSheet.y = 1.0 / framesY;","        vSpriteSheet.z = columnNorm;","        vSpriteSheet.w = rowNorm;","    #endif","    gl_PointSize = pointSizePerspective;","    gl_Position = projectionMatrix * mvPosition;",THREE.ShaderChunk.logdepthbuf_vertex,THREE.ShaderChunk.fog_vertex,"}"].join("\n"),fragment:[h.shaderChunks.uniforms,THREE.ShaderChunk.common,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,h.shaderChunks.varyings,h.shaderChunks.branchAvoidanceFunctions,"void main() {","    vec3 outgoingLight = vColor.xyz;","    ","    #ifdef ALPHATEST","       if ( vColor.w < float(ALPHATEST) ) discard;","    #endif",h.shaderChunks.rotateTexture,THREE.ShaderChunk.logdepthbuf_fragment,"    outgoingLight = vColor.xyz * rotatedTexture.xyz;","    gl_FragColor = vec4( outgoingLight.xyz, rotatedTexture.w * vColor.w );",THREE.ShaderChunk.fog_fragment,"}"].join("\n")},h.utils={types:{BOOLEAN:"boolean",STRING:"string",NUMBER:"number",OBJECT:"object"},ensureTypedArg:function(e,t,n){"use strict";return i(e)===t?e:n},ensureArrayTypedArg:function(e,t,n){"use strict";if(Array.isArray(e)){for(var o=e.length-1;0<=o;--o)if(i(e[o])!==t)return n;return e}return this.ensureTypedArg(e,t,n)},ensureInstanceOf:function(e,t,n){"use strict";return void 0!==t&&e instanceof t?e:n},ensureArrayInstanceOf:function(e,t,n){"use strict";if(Array.isArray(e)){for(var o=e.length-1;0<=o;--o)if(void 0!==t&&e[o]instanceof t==!1)return n;return e}return this.ensureInstanceOf(e,t,n)},ensureValueOverLifetimeCompliance:function(e,t,n){"use strict";t=t||3,n=n||3,!1===Array.isArray(e._value)&&(e._value=[e._value]),!1===Array.isArray(e._spread)&&(e._spread=[e._spread]);var o=this.clamp(e._value.length,t,n),r=this.clamp(e._spread.length,t,n),i=Math.max(o,r);e._value.length!==i&&(e._value=this.interpolateArray(e._value,i)),e._spread.length!==i&&(e._spread=this.interpolateArray(e._spread,i))},interpolateArray:function(e,t){"use strict";for(var n=e.length,o=["function"==typeof e[0].clone?e[0].clone():e[0]],r=(n-1)/(t-1),i=1;i<t-1;++i){var a=i*r,s=Math.floor(a),u=Math.ceil(a),c=a-s;o[i]=this.lerpTypeAgnostic(e[s],e[u],c)}return o.push("function"==typeof e[n-1].clone?e[n-1].clone():e[n-1]),o},clamp:function(e,t,n){"use strict";return Math.max(t,Math.min(e,n))},zeroToEpsilon:function(e,t){"use strict";var n=e;return n=t?1e-5*Math.random()*10:1e-5,e<0&&-1e-5<e&&(n=-n),n},lerpTypeAgnostic:function(e,t,n){"use strict";var o,r=this.types;return i(e)===r.NUMBER&&i(t)===r.NUMBER?e+(t-e)*n:e instanceof THREE.Vector2&&t instanceof THREE.Vector2?((o=e.clone()).x=this.lerp(e.x,t.x,n),o.y=this.lerp(e.y,t.y,n),o):e instanceof THREE.Vector3&&t instanceof THREE.Vector3?((o=e.clone()).x=this.lerp(e.x,t.x,n),o.y=this.lerp(e.y,t.y,n),o.z=this.lerp(e.z,t.z,n),o):e instanceof THREE.Vector4&&t instanceof THREE.Vector4?((o=e.clone()).x=this.lerp(e.x,t.x,n),o.y=this.lerp(e.y,t.y,n),o.z=this.lerp(e.z,t.z,n),o.w=this.lerp(e.w,t.w,n),o):e instanceof THREE.Color&&t instanceof THREE.Color?((o=e.clone()).r=this.lerp(e.r,t.r,n),o.g=this.lerp(e.g,t.g,n),o.b=this.lerp(e.b,t.b,n),o):void console.warn("Invalid argument types, or argument types do not match:",e,t)},lerp:function(e,t,n){"use strict";return e+(t-e)*n},roundToNearestMultiple:function(e,t){"use strict";var n;return 0===t?e:0===(n=Math.abs(e)%t)?e:e<0?-(Math.abs(e)-n):e+t-n},arrayValuesAreEqual:function(e){"use strict";for(var t=0;t<e.length-1;++t)if(e[t]!==e[t+1])return!1;return!0},randomFloat:function(e,t){"use strict";return e+t*(Math.random()-.5)},randomVector3:function(e,t,n,o,r){"use strict";var i=n.x+(Math.random()*o.x-.5*o.x),a=n.y+(Math.random()*o.y-.5*o.y),s=n.z+(Math.random()*o.z-.5*o.z);r&&(i=.5*-r.x+this.roundToNearestMultiple(i,r.x),a=.5*-r.y+this.roundToNearestMultiple(a,r.y),s=.5*-r.z+this.roundToNearestMultiple(s,r.z)),e.typedArray.setVec3Components(t,i,a,s)},randomColor:function(e,t,n,o){"use strict";var r=n.r+Math.random()*o.x,i=n.g+Math.random()*o.y,a=n.b+Math.random()*o.z;r=this.clamp(r,0,1),i=this.clamp(i,0,1),a=this.clamp(a,0,1),e.typedArray.setVec3Components(t,r,i,a)},randomColorAsHex:function(){"use strict";var u=new THREE.Color;return function(e,t,n,o){for(var r=n.length,i=[],a=0;a<r;++a){var s=o[a];u.copy(n[a]),u.r+=Math.random()*s.x-.5*s.x,u.g+=Math.random()*s.y-.5*s.y,u.b+=Math.random()*s.z-.5*s.z,u.r=this.clamp(u.r,0,1),u.g=this.clamp(u.g,0,1),u.b=this.clamp(u.b,0,1),i.push(u.getHex())}e.typedArray.setVec4Components(t,i[0],i[1],i[2],i[3])}}(),randomVector3OnSphere:function(e,t,n,o,r,i,a,s){"use strict";var u=2*Math.random()-1,c=6.2832*Math.random(),l=Math.sqrt(1-u*u),f=this.randomFloat(o,r),p=0,h=0,d=0;a&&(f=Math.round(f/a)*a),p=l*Math.cos(c)*f,h=l*Math.sin(c)*f,d=u*f,p*=i.x,h*=i.y,d*=i.z,p+=n.x,h+=n.y,d+=n.z,e.typedArray.setVec3Components(t,p,h,d)},seededRandom:function(e){var t=1e4*Math.sin(e);return t-(0|t)},randomVector3OnDisc:function(e,t,n,o,r,i,a){"use strict";var s=6.2832*Math.random(),u=Math.abs(this.randomFloat(o,r)),c=0,l=0,f=0;a&&(u=Math.round(u/a)*a),c=Math.cos(s)*u,l=Math.sin(s)*u,c*=i.x,l*=i.y,c+=n.x,l+=n.y,f+=n.z,e.typedArray.setVec3Components(t,c,l,f)},randomDirectionVector3OnSphere:function(){"use strict";var u=new THREE.Vector3;return function(e,t,n,o,r,i,a,s){u.copy(i),u.x-=n,u.y-=o,u.z-=r,u.normalize().multiplyScalar(-this.randomFloat(a,s)),e.typedArray.setVec3Components(t,u.x,u.y,u.z)}}(),randomDirectionVector3OnDisc:function(){"use strict";var u=new THREE.Vector3;return function(e,t,n,o,r,i,a,s){u.copy(i),u.x-=n,u.y-=o,u.z-=r,u.normalize().multiplyScalar(-this.randomFloat(a,s)),e.typedArray.setVec3Components(t,u.x,u.y,0)}}(),getPackedRotationAxis:function(){"use strict";var n=new THREE.Vector3,o=new THREE.Vector3,r=new THREE.Color,i=new THREE.Vector3(1,1,1);return function(e,t){return n.copy(e).normalize(),o.copy(t).normalize(),n.x+=.5*-t.x+Math.random()*t.x,n.y+=.5*-t.y+Math.random()*t.y,n.z+=.5*-t.z+Math.random()*t.z,n.normalize().add(i).multiplyScalar(.5),r.setRGB(n.x,n.y,n.z),r.getHex()}}()},h.Group=function(e){"use strict";var t=h.utils,n=t.types;(e=t.ensureTypedArg(e,n.OBJECT,{})).texture=t.ensureTypedArg(e.texture,n.OBJECT,{}),this.uuid=THREE.Math.generateUUID(),this.fixedTimeStep=t.ensureTypedArg(e.fixedTimeStep,n.NUMBER,.016),this.texture=t.ensureInstanceOf(e.texture.value,THREE.Texture,null),this.textureFrames=t.ensureInstanceOf(e.texture.frames,THREE.Vector2,new THREE.Vector2(1,1)),this.textureFrameCount=t.ensureTypedArg(e.texture.frameCount,n.NUMBER,this.textureFrames.x*this.textureFrames.y),this.textureLoop=t.ensureTypedArg(e.texture.loop,n.NUMBER,1),this.textureFrames.max(new THREE.Vector2(1,1)),this.hasPerspective=t.ensureTypedArg(e.hasPerspective,n.BOOLEAN,!0),this.colorize=t.ensureTypedArg(e.colorize,n.BOOLEAN,!0),this.maxParticleCount=t.ensureTypedArg(e.maxParticleCount,n.NUMBER,null),this.blending=t.ensureTypedArg(e.blending,n.NUMBER,THREE.AdditiveBlending),this.transparent=t.ensureTypedArg(e.transparent,n.BOOLEAN,!0),this.alphaTest=parseFloat(t.ensureTypedArg(e.alphaTest,n.NUMBER,0)),this.depthWrite=t.ensureTypedArg(e.depthWrite,n.BOOLEAN,!1),this.depthTest=t.ensureTypedArg(e.depthTest,n.BOOLEAN,!0),this.fog=t.ensureTypedArg(e.fog,n.BOOLEAN,!0),this.scale=t.ensureTypedArg(e.scale,n.NUMBER,300),this.emitters=[],this.emitterIDs=[],this._pool=[],this._poolCreationSettings=null,this._createNewWhenPoolEmpty=0,this._attributesNeedRefresh=!1,this._attributesNeedDynamicReset=!1,this.particleCount=0,this.uniforms={texture:{type:"t",value:this.texture},textureAnimation:{type:"v4",value:new THREE.Vector4(this.textureFrames.x,this.textureFrames.y,this.textureFrameCount,Math.max(Math.abs(this.textureLoop),1))},fogColor:{type:"c",value:null},fogNear:{type:"f",value:10},fogFar:{type:"f",value:200},fogDensity:{type:"f",value:.5},deltaTime:{type:"f",value:0},runTime:{type:"f",value:0},scale:{type:"f",value:this.scale}},this.defines={HAS_PERSPECTIVE:this.hasPerspective,COLORIZE:this.colorize,VALUE_OVER_LIFETIME_LENGTH:h.valueOverLifetimeLength,SHOULD_ROTATE_TEXTURE:!1,SHOULD_ROTATE_PARTICLES:!1,SHOULD_WIGGLE_PARTICLES:!1,SHOULD_CALCULATE_SPRITE:1<this.textureFrames.x||1<this.textureFrames.y},this.attributes={position:new h.ShaderAttribute("v3",!0),acceleration:new h.ShaderAttribute("v4",!0),velocity:new h.ShaderAttribute("v3",!0),rotation:new h.ShaderAttribute("v4",!0),rotationCenter:new h.ShaderAttribute("v3",!0),params:new h.ShaderAttribute("v4",!0),size:new h.ShaderAttribute("v4",!0),angle:new h.ShaderAttribute("v4",!0),color:new h.ShaderAttribute("v4",!0),opacity:new h.ShaderAttribute("v4",!0)},this.attributeKeys=Object.keys(this.attributes),this.attributeCount=this.attributeKeys.length,this.material=new THREE.ShaderMaterial({uniforms:this.uniforms,vertexShader:h.shaders.vertex,fragmentShader:h.shaders.fragment,blending:this.blending,transparent:this.transparent,alphaTest:this.alphaTest,depthWrite:this.depthWrite,depthTest:this.depthTest,defines:this.defines,fog:this.fog}),this.geometry=new THREE.BufferGeometry,this.mesh=new THREE.Points(this.geometry,this.material),null===this.maxParticleCount&&console.warn("SPE.Group: No maxParticleCount specified. Adding emitters after rendering will probably cause errors.")},h.Group.constructor=h.Group,h.Group.prototype._updateDefines=function(){"use strict";for(var e,t=this.emitters,n=t.length-1,o=this.defines;0<=n;--n)e=t[n],o.SHOULD_CALCULATE_SPRITE||(o.SHOULD_ROTATE_TEXTURE=o.SHOULD_ROTATE_TEXTURE||!!Math.max(Math.max.apply(null,e.angle.value),Math.max.apply(null,e.angle.spread))),o.SHOULD_ROTATE_PARTICLES=o.SHOULD_ROTATE_PARTICLES||!!Math.max(e.rotation.angle,e.rotation.angleSpread),o.SHOULD_WIGGLE_PARTICLES=o.SHOULD_WIGGLE_PARTICLES||!!Math.max(e.wiggle.value,e.wiggle.spread);this.material.needsUpdate=!0},h.Group.prototype._applyAttributesToGeometry=function(){"use strict";var e,t,n=this.attributes,o=this.geometry,r=o.attributes;for(var i in n)n.hasOwnProperty(i)&&(e=n[i],(t=r[i])?t.array=e.typedArray.array:o.addAttribute(i,e.bufferAttribute),e.bufferAttribute.needsUpdate=!0);this.geometry.setDrawRange(0,this.particleCount)},h.Group.prototype.addEmitter=function(e){"use strict";if(e instanceof h.Emitter!=!1)if(-1<this.emitterIDs.indexOf(e.uuid))console.error("Emitter already exists in this group. Will not add again.");else{if(null===e.group){var t=this.attributes,n=this.particleCount,o=n+e.particleCount;for(var r in this.particleCount=o,null!==this.maxParticleCount&&this.particleCount>this.maxParticleCount&&console.warn("SPE.Group: maxParticleCount exceeded. Requesting",this.particleCount,"particles, can support only",this.maxParticleCount),e._calculatePPSValue(e.maxAge._value+e.maxAge._spread),e._setBufferUpdateRanges(this.attributeKeys),e._setAttributeOffset(n),e.group=this,e.attributes=this.attributes,t)t.hasOwnProperty(r)&&t[r]._createBufferAttribute(null!==this.maxParticleCount?this.maxParticleCount:this.particleCount);for(var i=n;i<o;++i)e._assignPositionValue(i),e._assignForceValue(i,"velocity"),e._assignForceValue(i,"acceleration"),e._assignAbsLifetimeValue(i,"opacity"),e._assignAbsLifetimeValue(i,"size"),e._assignAngleValue(i),e._assignRotationValue(i),e._assignParamsValue(i),e._assignColorValue(i);return this._applyAttributesToGeometry(),this.emitters.push(e),this.emitterIDs.push(e.uuid),this._updateDefines(e),this.material.needsUpdate=!0,this.geometry.needsUpdate=!0,this._attributesNeedRefresh=!0,this}console.error("Emitter already belongs to another group. Will not add to requested group.")}else console.error("`emitter` argument must be instance of SPE.Emitter. Was provided with:",e)},h.Group.prototype.removeEmitter=function(e){"use strict";var t=this.emitterIDs.indexOf(e.uuid);if(e instanceof h.Emitter!=!1)if(-1!==t){for(var n=e.attributeOffset,o=n+e.particleCount,r=this.attributes.params.typedArray,i=n;i<o;++i)r.array[4*i]=0,r.array[4*i+1]=0;for(var a in this.emitters.splice(t,1),this.emitterIDs.splice(t,1),this.attributes)this.attributes.hasOwnProperty(a)&&this.attributes[a].splice(n,o);this.particleCount-=e.particleCount,e._onRemove(),this._attributesNeedRefresh=!0}else console.error("Emitter does not exist in this group. Will not remove.");else console.error("`emitter` argument must be instance of SPE.Emitter. Was provided with:",e)},h.Group.prototype.getFromPool=function(){"use strict";var e=this._pool,t=this._createNewWhenPoolEmpty;if(e.length)return e.pop();if(t){var n=new h.Emitter(this._poolCreationSettings);return this.addEmitter(n),n}return null},h.Group.prototype.releaseIntoPool=function(e){"use strict";if(e instanceof h.Emitter!=!1)return e.reset(),this._pool.unshift(e),this;console.error("Argument is not instanceof SPE.Emitter:",e)},h.Group.prototype.getPool=function(){"use strict";return this._pool},h.Group.prototype.addPool=function(e,t,n){"use strict";var o;this._poolCreationSettings=t,this._createNewWhenPoolEmpty=!!n;for(var r=0;r<e;++r)o=Array.isArray(t)?new h.Emitter(t[r]):new h.Emitter(t),this.addEmitter(o),this.releaseIntoPool(o);return this},h.Group.prototype._triggerSingleEmitter=function(e){"use strict";var t=this.getFromPool(),n=this;if(null!==t)return e instanceof THREE.Vector3&&(t.position.value.copy(e),t.position.value=t.position.value),t.enable(),setTimeout(function(){t.disable(),n.releaseIntoPool(t)},1e3*Math.max(t.duration,t.maxAge.value+t.maxAge.spread)),this;console.log("SPE.Group pool ran out.")},h.Group.prototype.triggerPoolEmitter=function(e,t){"use strict";if("number"==typeof e&&1<e)for(var n=0;n<e;++n)this._triggerSingleEmitter(t);else this._triggerSingleEmitter(t);return this},h.Group.prototype._updateUniforms=function(e){"use strict";this.uniforms.runTime.value+=e,this.uniforms.deltaTime.value=e},h.Group.prototype._resetBufferRanges=function(){"use strict";for(var e=this.attributeKeys,t=this.attributeCount-1,n=this.attributes;0<=t;--t)n[e[t]].resetUpdateRange()},h.Group.prototype._updateBuffers=function(e){"use strict";for(var t,n,o,r=this.attributeKeys,i=this.attributeCount-1,a=this.attributes,s=e.bufferUpdateRanges;0<=i;--i)n=s[t=r[i]],(o=a[t]).setUpdateRange(n.min,n.max),o.flagUpdate()},h.Group.prototype.tick=function(e){"use strict";var t=this.emitters,n=t.length,o=e||this.fixedTimeStep,r=this.attributeKeys,i=this.attributes;if(this._updateUniforms(o),this._resetBufferRanges(),0!==n||!1!==this._attributesNeedRefresh||!1!==this._attributesNeedDynamicReset){for(var a,s=0;s<n;++s)(a=t[s]).tick(o),this._updateBuffers(a);if(!0===this._attributesNeedDynamicReset){for(s=this.attributeCount-1;0<=s;--s)i[r[s]].resetDynamic();this._attributesNeedDynamicReset=!1}if(!0===this._attributesNeedRefresh){for(s=this.attributeCount-1;0<=s;--s)i[r[s]].forceUpdateAll();this._attributesNeedRefresh=!1,this._attributesNeedDynamicReset=!0}}},h.Group.prototype.dispose=function(){"use strict";return this.geometry.dispose(),this.material.dispose(),this},h.Emitter=function(e){"use strict";var t=h.utils,n=t.types,o=h.valueOverLifetimeLength;for(var r in(e=t.ensureTypedArg(e,n.OBJECT,{})).position=t.ensureTypedArg(e.position,n.OBJECT,{}),e.velocity=t.ensureTypedArg(e.velocity,n.OBJECT,{}),e.acceleration=t.ensureTypedArg(e.acceleration,n.OBJECT,{}),e.radius=t.ensureTypedArg(e.radius,n.OBJECT,{}),e.drag=t.ensureTypedArg(e.drag,n.OBJECT,{}),e.rotation=t.ensureTypedArg(e.rotation,n.OBJECT,{}),e.color=t.ensureTypedArg(e.color,n.OBJECT,{}),e.opacity=t.ensureTypedArg(e.opacity,n.OBJECT,{}),e.size=t.ensureTypedArg(e.size,n.OBJECT,{}),e.angle=t.ensureTypedArg(e.angle,n.OBJECT,{}),e.wiggle=t.ensureTypedArg(e.wiggle,n.OBJECT,{}),e.maxAge=t.ensureTypedArg(e.maxAge,n.OBJECT,{}),e.onParticleSpawn&&console.warn("onParticleSpawn has been removed. Please set properties directly to alter values at runtime."),this.uuid=THREE.Math.generateUUID(),this.type=t.ensureTypedArg(e.type,n.NUMBER,h.distributions.BOX),this.position={_value:t.ensureInstanceOf(e.position.value,THREE.Vector3,new THREE.Vector3),_spread:t.ensureInstanceOf(e.position.spread,THREE.Vector3,new THREE.Vector3),_spreadClamp:t.ensureInstanceOf(e.position.spreadClamp,THREE.Vector3,new THREE.Vector3),_distribution:t.ensureTypedArg(e.position.distribution,n.NUMBER,this.type),_randomise:t.ensureTypedArg(e.position.randomise,n.BOOLEAN,!1),_radius:t.ensureTypedArg(e.position.radius,n.NUMBER,10),_radiusScale:t.ensureInstanceOf(e.position.radiusScale,THREE.Vector3,new THREE.Vector3(1,1,1)),_distributionClamp:t.ensureTypedArg(e.position.distributionClamp,n.NUMBER,0)},this.velocity={_value:t.ensureInstanceOf(e.velocity.value,THREE.Vector3,new THREE.Vector3),_spread:t.ensureInstanceOf(e.velocity.spread,THREE.Vector3,new THREE.Vector3),_distribution:t.ensureTypedArg(e.velocity.distribution,n.NUMBER,this.type),_randomise:t.ensureTypedArg(e.position.randomise,n.BOOLEAN,!1)},this.acceleration={_value:t.ensureInstanceOf(e.acceleration.value,THREE.Vector3,new THREE.Vector3),_spread:t.ensureInstanceOf(e.acceleration.spread,THREE.Vector3,new THREE.Vector3),_distribution:t.ensureTypedArg(e.acceleration.distribution,n.NUMBER,this.type),_randomise:t.ensureTypedArg(e.position.randomise,n.BOOLEAN,!1)},this.drag={_value:t.ensureTypedArg(e.drag.value,n.NUMBER,0),_spread:t.ensureTypedArg(e.drag.spread,n.NUMBER,0),_randomise:t.ensureTypedArg(e.position.randomise,n.BOOLEAN,!1)},this.wiggle={_value:t.ensureTypedArg(e.wiggle.value,n.NUMBER,0),_spread:t.ensureTypedArg(e.wiggle.spread,n.NUMBER,0)},this.rotation={_axis:t.ensureInstanceOf(e.rotation.axis,THREE.Vector3,new THREE.Vector3(0,1,0)),_axisSpread:t.ensureInstanceOf(e.rotation.axisSpread,THREE.Vector3,new THREE.Vector3),_angle:t.ensureTypedArg(e.rotation.angle,n.NUMBER,0),_angleSpread:t.ensureTypedArg(e.rotation.angleSpread,n.NUMBER,0),_static:t.ensureTypedArg(e.rotation.static,n.BOOLEAN,!1),_center:t.ensureInstanceOf(e.rotation.center,THREE.Vector3,this.position._value.clone()),_randomise:t.ensureTypedArg(e.position.randomise,n.BOOLEAN,!1)},this.maxAge={_value:t.ensureTypedArg(e.maxAge.value,n.NUMBER,2),_spread:t.ensureTypedArg(e.maxAge.spread,n.NUMBER,0)},this.color={_value:t.ensureArrayInstanceOf(e.color.value,THREE.Color,new THREE.Color),_spread:t.ensureArrayInstanceOf(e.color.spread,THREE.Vector3,new THREE.Vector3),_randomise:t.ensureTypedArg(e.position.randomise,n.BOOLEAN,!1)},this.opacity={_value:t.ensureArrayTypedArg(e.opacity.value,n.NUMBER,1),_spread:t.ensureArrayTypedArg(e.opacity.spread,n.NUMBER,0),_randomise:t.ensureTypedArg(e.position.randomise,n.BOOLEAN,!1)},this.size={_value:t.ensureArrayTypedArg(e.size.value,n.NUMBER,1),_spread:t.ensureArrayTypedArg(e.size.spread,n.NUMBER,0),_randomise:t.ensureTypedArg(e.position.randomise,n.BOOLEAN,!1)},this.angle={_value:t.ensureArrayTypedArg(e.angle.value,n.NUMBER,0),_spread:t.ensureArrayTypedArg(e.angle.spread,n.NUMBER,0),_randomise:t.ensureTypedArg(e.position.randomise,n.BOOLEAN,!1)},this.particleCount=t.ensureTypedArg(e.particleCount,n.NUMBER,100),this.duration=t.ensureTypedArg(e.duration,n.NUMBER,null),this.isStatic=t.ensureTypedArg(e.isStatic,n.BOOLEAN,!1),this.activeMultiplier=t.ensureTypedArg(e.activeMultiplier,n.NUMBER,1),this.direction=t.ensureTypedArg(e.direction,n.NUMBER,1),this.alive=t.ensureTypedArg(e.alive,n.BOOLEAN,!0),this.particlesPerSecond=0,this.activationIndex=0,this.attributeOffset=0,this.attributeEnd=0,this.age=0,this.activeParticleCount=0,this.group=null,this.attributes=null,this.paramsArray=null,this.resetFlags={position:t.ensureTypedArg(e.position.randomise,n.BOOLEAN,!1)||t.ensureTypedArg(e.radius.randomise,n.BOOLEAN,!1),velocity:t.ensureTypedArg(e.velocity.randomise,n.BOOLEAN,!1),acceleration:t.ensureTypedArg(e.acceleration.randomise,n.BOOLEAN,!1)||t.ensureTypedArg(e.drag.randomise,n.BOOLEAN,!1),rotation:t.ensureTypedArg(e.rotation.randomise,n.BOOLEAN,!1),rotationCenter:t.ensureTypedArg(e.rotation.randomise,n.BOOLEAN,!1),size:t.ensureTypedArg(e.size.randomise,n.BOOLEAN,!1),color:t.ensureTypedArg(e.color.randomise,n.BOOLEAN,!1),opacity:t.ensureTypedArg(e.opacity.randomise,n.BOOLEAN,!1),angle:t.ensureTypedArg(e.angle.randomise,n.BOOLEAN,!1)},this.updateFlags={},this.updateCounts={},this.updateMap={maxAge:"params",position:"position",velocity:"velocity",acceleration:"acceleration",drag:"acceleration",wiggle:"params",rotation:"rotation",size:"size",color:"color",opacity:"opacity",angle:"angle"},this.updateMap)this.updateMap.hasOwnProperty(r)&&(this.updateCounts[this.updateMap[r]]=0,this.updateFlags[this.updateMap[r]]=!1,this._createGetterSetters(this[r],r));this.bufferUpdateRanges={},this.attributeKeys=null,this.attributeCount=0,t.ensureValueOverLifetimeCompliance(this.color,o,o),t.ensureValueOverLifetimeCompliance(this.opacity,o,o),t.ensureValueOverLifetimeCompliance(this.size,o,o),t.ensureValueOverLifetimeCompliance(this.angle,o,o)},h.Emitter.constructor=h.Emitter,h.Emitter.prototype._createGetterSetters=function(e,i){"use strict";var a=this;for(var t in e)if(e.hasOwnProperty(t)){var n=t.replace("_","");Object.defineProperty(e,n,{get:function(e){return function(){return this[e]}}(t),set:function(r){return function(e){var t=a.updateMap[i],n=this[r],o=h.valueOverLifetimeLength;"_rotationCenter"===r?(a.updateFlags.rotationCenter=!0,a.updateCounts.rotationCenter=0):"_randomise"===r?a.resetFlags[t]=e:(a.updateFlags[t]=!0,a.updateCounts[t]=0),a.group._updateDefines(),this[r]=e,Array.isArray(n)&&h.utils.ensureValueOverLifetimeCompliance(a[i],o,o)}}(t)})}},h.Emitter.prototype._setBufferUpdateRanges=function(e){"use strict";this.attributeKeys=e,this.attributeCount=e.length;for(var t=this.attributeCount-1;0<=t;--t)this.bufferUpdateRanges[e[t]]={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY}},h.Emitter.prototype._calculatePPSValue=function(e){"use strict";var t=this.particleCount;this.duration?this.particlesPerSecond=t/(e<this.duration?e:this.duration):this.particlesPerSecond=t/e},h.Emitter.prototype._setAttributeOffset=function(e){this.attributeOffset=e,this.activationIndex=e,this.activationEnd=e+this.particleCount},h.Emitter.prototype._assignValue=function(e,t){"use strict";switch(e){case"position":this._assignPositionValue(t);break;case"velocity":case"acceleration":this._assignForceValue(t,e);break;case"size":case"opacity":this._assignAbsLifetimeValue(t,e);break;case"angle":this._assignAngleValue(t);break;case"params":this._assignParamsValue(t);break;case"rotation":this._assignRotationValue(t);break;case"color":this._assignColorValue(t)}},h.Emitter.prototype._assignPositionValue=function(e){"use strict";var t=h.distributions,n=h.utils,o=this.position,r=this.attributes.position,i=o._value,a=o._spread;switch(o._distribution){case t.BOX:n.randomVector3(r,e,i,a,o._spreadClamp);break;case t.SPHERE:n.randomVector3OnSphere(r,e,i,o._radius,o._spread.x,o._radiusScale,o._spreadClamp.x,o._distributionClamp||this.particleCount);break;case t.DISC:n.randomVector3OnDisc(r,e,i,o._radius,o._spread.x,o._radiusScale,o._spreadClamp.x)}},h.Emitter.prototype._assignForceValue=function(e,t){"use strict";var n,o,r,i,a,s=h.distributions,u=h.utils,c=this[t],l=c._value,f=c._spread;switch(c._distribution){case s.BOX:u.randomVector3(this.attributes[t],e,l,f);break;case s.SPHERE:o=(n=this.attributes.position.typedArray.array)[a=3*e],r=n[a+1],i=n[a+2],u.randomDirectionVector3OnSphere(this.attributes[t],e,o,r,i,this.position._value,c._value.x,c._spread.x);break;case s.DISC:o=(n=this.attributes.position.typedArray.array)[a=3*e],r=n[a+1],i=n[a+2],u.randomDirectionVector3OnDisc(this.attributes[t],e,o,r,i,this.position._value,c._value.x,c._spread.x)}if("acceleration"===t){var p=u.clamp(u.randomFloat(this.drag._value,this.drag._spread),0,1);this.attributes.acceleration.typedArray.array[4*e+3]=p}},h.Emitter.prototype._assignAbsLifetimeValue=function(e,t){"use strict";var n,o=this.attributes[t].typedArray,r=this[t],i=h.utils;i.arrayValuesAreEqual(r._value)&&i.arrayValuesAreEqual(r._spread)?(n=Math.abs(i.randomFloat(r._value[0],r._spread[0])),o.setVec4Components(e,n,n,n,n)):o.setVec4Components(e,Math.abs(i.randomFloat(r._value[0],r._spread[0])),Math.abs(i.randomFloat(r._value[1],r._spread[1])),Math.abs(i.randomFloat(r._value[2],r._spread[2])),Math.abs(i.randomFloat(r._value[3],r._spread[3])))},h.Emitter.prototype._assignAngleValue=function(e){"use strict";var t,n=this.attributes.angle.typedArray,o=this.angle,r=h.utils;r.arrayValuesAreEqual(o._value)&&r.arrayValuesAreEqual(o._spread)?(t=r.randomFloat(o._value[0],o._spread[0]),n.setVec4Components(e,t,t,t,t)):n.setVec4Components(e,r.randomFloat(o._value[0],o._spread[0]),r.randomFloat(o._value[1],o._spread[1]),r.randomFloat(o._value[2],o._spread[2]),r.randomFloat(o._value[3],o._spread[3]))},h.Emitter.prototype._assignParamsValue=function(e){"use strict";this.attributes.params.typedArray.setVec4Components(e,this.isStatic?1:0,0,Math.abs(h.utils.randomFloat(this.maxAge._value,this.maxAge._spread)),h.utils.randomFloat(this.wiggle._value,this.wiggle._spread))},h.Emitter.prototype._assignRotationValue=function(e){"use strict";this.attributes.rotation.typedArray.setVec3Components(e,h.utils.getPackedRotationAxis(this.rotation._axis,this.rotation._axisSpread),h.utils.randomFloat(this.rotation._angle,this.rotation._angleSpread),this.rotation._static?0:1),this.attributes.rotationCenter.typedArray.setVec3(e,this.rotation._center)},h.Emitter.prototype._assignColorValue=function(e){"use strict";h.utils.randomColorAsHex(this.attributes.color,e,this.color._value,this.color._spread)},h.Emitter.prototype._resetParticle=function(e){"use strict";for(var t,n,o=this.resetFlags,r=this.updateFlags,i=this.updateCounts,a=this.attributeKeys,s=this.attributeCount-1;0<=s;--s)n=r[t=a[s]],!0!==o[t]&&!0!==n||(this._assignValue(t,e),this._updateAttributeUpdateRange(t,e),!0===n&&i[t]===this.particleCount?(r[t]=!1,i[t]=0):1==n&&++i[t])},h.Emitter.prototype._updateAttributeUpdateRange=function(e,t){"use strict";var n=this.bufferUpdateRanges[e];n.min=Math.min(t,n.min),n.max=Math.max(t,n.max)},h.Emitter.prototype._resetBufferRanges=function(){"use strict";for(var e,t=this.bufferUpdateRanges,n=this.bufferUpdateKeys,o=this.bufferUpdateCount-1;0<=o;--o)t[e=n[o]].min=Number.POSITIVE_INFINITY,t[e].max=Number.NEGATIVE_INFINITY},h.Emitter.prototype._onRemove=function(){"use strict";this.particlesPerSecond=0,this.attributeOffset=0,this.activationIndex=0,this.activeParticleCount=0,this.group=null,this.attributes=null,this.paramsArray=null,this.age=0},h.Emitter.prototype._decrementParticleCount=function(){"use strict";--this.activeParticleCount},h.Emitter.prototype._incrementParticleCount=function(){"use strict";++this.activeParticleCount},h.Emitter.prototype._checkParticleAges=function(e,t,n,o){"use strict";for(var r,i,a,s,u=t-1;e<=u;--u)0!==(s=n[r=4*u])&&(a=n[r+1],i=n[r+2],1===this.direction?i<=(a+=o)&&(s=a=0,this._decrementParticleCount()):(a-=o)<=0&&(a=i,s=0,this._decrementParticleCount()),n[r]=s,n[r+1]=a,this._updateAttributeUpdateRange("params",u))},h.Emitter.prototype._activateParticles=function(e,t,n,o){"use strict";for(var r,i,a=this.direction,s=e;s<t;++s)0!=n[r=4*s]&&1!==this.particleCount||(this._incrementParticleCount(),n[r]=1,this._resetParticle(s),i=o*(s-e),n[r+1]=-1===a?n[r+2]-i:i,this._updateAttributeUpdateRange("params",s))},h.Emitter.prototype.tick=function(e){"use strict";if(!this.isStatic){null===this.paramsArray&&(this.paramsArray=this.attributes.params.typedArray.array);var t=this.attributeOffset,n=t+this.particleCount,o=this.paramsArray,r=this.particlesPerSecond*this.activeMultiplier*e,i=this.activationIndex;if(this._resetBufferRanges(),this._checkParticleAges(t,n,o,e),!1!==this.alive){if(null!==this.duration&&this.age>this.duration)return this.alive=!1,void(this.age=0);var a=1===this.particleCount?i:0|i,s=Math.min(a+r,this.activationEnd),u=s-this.activationIndex|0,c=0<u?e/u:0;this._activateParticles(a,s,o,c),this.activationIndex+=r,this.activationIndex>n&&(this.activationIndex=t),this.age+=e}else this.age=0}},h.Emitter.prototype.reset=function(e){"use strict";if(this.age=0,!(this.alive=!1)===e){for(var t,n=this.attributeOffset,o=n+this.particleCount,r=this.paramsArray,i=this.attributes.params.bufferAttribute,a=o-1;n<=a;--a)r[t=4*a]=0,r[t+1]=0;i.updateRange.offset=0,i.updateRange.count=-1,i.needsUpdate=!0}return this},h.Emitter.prototype.enable=function(){"use strict";return this.alive=!0,this},h.Emitter.prototype.disable=function(){"use strict";return this.alive=!1,this},h.Emitter.prototype.remove=function(){"use strict";return null!==this.group?this.group.removeEmitter(this):console.error("Emitter does not belong to a group, cannot remove."),this}},,,,function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t,n){e.exports=n(414)},function(e,c,l){"use strict";(function(e){var t,r=l(7),h=l(36),d=l(223),i=l(224),a=l(225);function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function n(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var y=4,v=64,u=new THREE.Color,o=(n((t=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._canvas=document.createElement("canvas"),this._ctx=this._canvas.getContext("2d"),this._scene=null,this._paletteTexture=null,this._materialsCache={}}var t,n,o;return t=e,(n=[{key:"init",value:function(e){var t=h.a[e.name]&&h.a[e.name].palette;if(t){this._scene=e,this._paletteTexture||(this._paletteTexture=new THREE.CanvasTexture(this._canvas)),this._materialsCache={};var n=Object.keys(t).length;n=Object(d.a)(n),n=Math.max(v,n);var o=this._canvas;o.width=o.height=n;var r=this._ctx;r.clearRect(0,0,o.width,o.height),r.fillStyle="#000000",r.fillRect(0,0,o.width,o.height);var i={},a=0,s=0,u=-1;for(var c in t){var l=t[c];for(var f in void 0===this._materialsCache[c]&&(this._materialsCache[c]={}),l){var p=l[f];if(void 0===i[f]){for(;s<=u;)s+=y;u<s&&(u=s),i[f]=s}void 0===this._materialsCache[c][f]&&(this._materialsCache[c][f]={x:a,y:i[f]}),this.updateChannel(c,f,p),s+=y}a+=y,s=0}this._paletteTexture.needsUpdate=!0}}},{key:"updateChannel",value:function(e,t,n){var o=this._materialsCache[e][t],r=o.x,i=o.y,a=this._ctx;a.fillStyle=this._parseChannelValue(n),a.fillRect(r,i,y,y),this._paletteTexture.needsUpdate=!0}},{key:"_bind",value:function(){r.a.upped.add(this._onKeyUp),this._canvas.addEventListener("click",this._onCanvasClicked,!1)}},{key:"_unbind",value:function(){r.a.upped.remove(this._onKeyUp),this._canvas.removeEventListener("click",this._onCanvasClicked,!1)}},{key:"_createDebug",value:function(){var e=this._canvas;e.style.position="absolute",e.style.bottom="0",e.style.left="0",e.style.cursor="pointer",e.classList.add("hide"),document.body.appendChild(e)}},{key:"_toggleDebug",value:function(){this._canvas.classList.toggle("hide")}},{key:"_parseChannelValue",value:function(e){var t=e;return!0===e?t="#ffffff":!1===e?t="#000000":Object(a.a)(e)&&(u.setHSL(0,0,e),t="#".concat(u.getHexString())),t}},{key:"_onKeyUp",value:function(e,t){"p"===t&&this._toggleDebug()}},{key:"_onCanvasClicked",value:function(){var e=this._scene?"".concat(this._scene.name,"-palette"):"palette";Object(i.a)(this._canvas,"".concat(e,".png"))}},{key:"paletteTexture",get:function(){return this._paletteTexture}}])&&s(t.prototype,n),o&&s(t,o),e}()).prototype,"_onKeyUp",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onKeyUp"),t.prototype),n(t.prototype,"_onCanvasClicked",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onCanvasClicked"),t.prototype),t);c.a=new o}).call(this,l(2).bind)},function(e,v,m){"use strict";(function(e){var t,n=m(23),c=m.n(n),r=m(1),i=m(278),o=m(5);function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var s,u,l,f,p,h,d=Object(o.d)("SoundManager","#d38628",!0),y=(s=(t=function(){function t(){for(var e in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),c.a.playInBackground=!0,this.config=i.a,this.state={},this.sonoGroups={},this.config)this.state[e]={created:!1};this._muted=!1,this._bind(),this.create("common")}var e,n,o;return e=t,(n=[{key:"create",value:function(e){if(!this.state[e]||!this.state[e].created){var t=this.config[e],n=[];for(var o in t){var r=t[o],i=r.url,a=r.loop,s=r.volume,u=c.a.create({id:o,url:i,loop:!!a});u._gain.gain.value=void 0===s?1:s,n.push(u)}this.sonoGroups[e]=c.a.group(n),this.state[e].created=!0,d("Group '".concat(e,"' created"))}}},{key:"createSound",value:function(e){var t=e.id,n=e.url,o=e.loop,r=e.volume;if(this.get(t))return this.get(t);var i=c.a.create({id:t,url:n,loop:!!o});return i._gain.gain.value=void 0===r?1:r,i}},{key:"play",value:function(e){c.a.play(e)}},{key:"get",value:function(e){return c.a.get(e)}},{key:"clone",value:function(e){var t=this.get(e),n=t.data,o=t.loop,r=t.volume;return c.a.create({data:n,loop:o,volume:r})}},{key:"destroy",value:function(){this._unbind()}},{key:"mute",value:function(){this._muted||(this._muted=!0,c.a.fade(0,.5))}},{key:"unmute",value:function(){this._muted&&(this._muted=!1,c.a.fade(1,.5))}},{key:"_bind",value:function(){r.a.visibilityChanged.add(this._onVisibilityChange)}},{key:"_unbind",value:function(){r.a.visibilityChanged.remove(this._onVisibilityChange)}},{key:"_onVisibilityChange",value:function(e){e&&!this._wasMuted?this.unmute():(this._wasMuted=this._muted,this.mute())}}])&&a(e.prototype,n),o&&a(e,o),t}()).prototype,u="_onVisibilityChange",l=[e],f=Object.getOwnPropertyDescriptor(t.prototype,"_onVisibilityChange"),p=t.prototype,h={},Object.keys(f).forEach(function(e){h[e]=f[e]}),h.enumerable=!!h.enumerable,h.configurable=!!h.configurable,("value"in h||h.initializer)&&(h.writable=!0),h=l.slice().reverse().reduce(function(e,t){return t(s,u,e)||e},h),p&&void 0!==h.initializer&&(h.value=h.initializer?h.initializer.call(p):void 0,h.initializer=void 0),void 0===h.initializer&&(Object.defineProperty(s,u,h),h=null),t);v.a=new y}).call(this,m(2).bind)},function(e,t,n){"use strict";var r=n(39),i=n(22),o=n(74),a=n.n(o),s=n(292),u=n.n(s);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function f(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d=function(e){function c(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=t.name,o=t.vertexShader,r=t.fragmentShader,i=t.uniforms,a=void 0===i?{}:i,s=t.textureID,u=void 0===s?"tInput":s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(e=f(this,p(c).call(this))).name=n||"ShaderPass",e.textureID=u,e.vertexShader=o,e.fragmentShader=r,e.uniforms=a,e}var t,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(c,r["a"]),t=c,(n=[{key:"init",value:function(e){this.material=new i.a({uniforms:function(r){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},t=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),t.forEach(function(e){var t,n,o;t=r,o=i[n=e],n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o})}return r}({tInput:{value:null}},this.uniforms),vertexShader:this.vertexShader||a.a,fragmentShader:this.fragmentShader||u.a,precision:e.capabilities.precision}),this.quad.material=this.material}},{key:"setSize",value:function(e,t){this.material.uniforms.uResolution&&(this.material.uniforms.uResolution.value=new THREE.Vector2(e,t))}},{key:"render",value:function(e,t,n,o,r){var i=this.material;i.uniforms[this.textureID]&&(i.uniforms[this.textureID].value=t.texture),i.uniforms.uTime&&(i.uniforms.uTime.value=r),e.render(this.scene,this.camera,this.renderToScreen?null:n)}}])&&l(t.prototype,n),o&&l(t,o),c}();t.a=d},function(e,t,n){"use strict";var o=n(76);function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=function(e){function n(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=i(this,a(n).call(this,t))).name=t.name||"Basic camera",e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(n,o["a"]),n}();t.a=u},function(e,t,n){"use strict";var r=n(22),i=n(0),o=n(310),d=n.n(o),a=n(311),y=n.n(a);function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(e){_(t,e,n[e])})}return t}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],0<=t.indexOf(n)||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],0<=t.indexOf(n)||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var c=function(e){function h(e){var t,n,o,r,i=e.instanced,a=void 0!==i&&i,s=e.normalMap,u=e.normalIntensity,c=void 0===u?1:u,l=e.useVertexColors,f=void 0!==l&&l,p=g(e,["instanced","normalMap","normalIntensity","useVertexColors"]);return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),o=this,(n=!(r=b(h).call(this,m({vertexShader:d.a,fragmentShader:y.a},p)))||"object"!==v(r)&&"function"!=typeof r?w(o):r)._scene.materialCtrl.add(w(w(n))),n.uniforms=m({},n.uniforms,{uNormalMap:{value:s||null},uNormalIntensity:{value:c},uTransition:{value:0},tTransitionNoise:{value:n._textures.get("main.noise.perlin",{wrapping:THREE.RepeatWrapping})}}),n.defines=m({},n.defines,(_(t={},n._scene.name.replace("-","_").toUpperCase(),!0),_(t,"IS_NORMAL",!0),_(t,"USE_INSTANCES",a),_(t,"USE_NORMAL_MAP",!!s),_(t,"USE_COLOR",f),t)),n.extensions={derivatives:!0},n.transition=1,n}var t,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(h,r["a"]),t=h,(n=[{key:"transition",get:function(){return this.uniforms.uTransition.value},set:function(e){this.uniforms.uTransition.value=Object(i.e)(e,0,1,.64,2.15)}}])&&s(t.prototype,n),o&&s(t,o),h}();t.a=c},function(e,g,b){"use strict";(function(e){var t,i=b(12),n=b(5);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function s(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function u(e,t,n){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var r,f,p,h,d,y,v=Object(n.d)("AbstractPage",n.b,!0),m=Object(n.d)("AbstractPage",n.a),_=(r=(t=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=s(this,c(t).apply(this,arguments)))._loaded=!1,e._enterTimeout=null,e._signals.loader.completed.add(e._onLoaderComplete),e}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(t,i["a"]),n=t,(o=[{key:"ready",value:function(){this._signals.loader.pageReady.dispatch(this.$name)}},{key:"beforeDestroy",value:function(){u(c(t.prototype),"beforeDestroy",this).call(this),clearTimeout(this._enterTimeout)}},{key:"beforeRouteEnter",value:function(n,o,r){var i=this;this._dependencies=this.getDependencies(o),this._from=n,this._to=o,this._next=r;var e=this._loader.checkPacksLoaded(this._dependencies);this._dependencies&&0!==this._dependencies.length&&!e||(this._signals.loader.completed.dispatch(),this.afterRouteEnter(n,o),r()),this._loader.load(this._dependencies).then(function(e){e.packNames;var t=e.resources;v("Resources loaded :",t),i._signals.loader.completed.dispatch(),i.afterRouteEnter(n,o),r()}).catch(function(e){return m(e)})}},{key:"afterRouteEnter",value:function(e,t){var n=this;t&&this._save.data[t.name]&&this._save.set("".concat(t.name,".seen"),!0),setTimeout(function(){n.$el&&(n.$el.classList.remove("".concat(n.$name,"--animation-in")),clearTimeout(n._enterTimeout),n._enterTimeout=setTimeout(function(){n.$el.classList.remove("".concat(n.$name,"--animation-in-timing"))},2e3))},100)}},{key:"beforeRouteLeave",value:function(e,t,n){n()}},{key:"getDependencies",value:function(e){var t=["main","main-textures-default-".concat(this._textures.format)];return e&&t.push(e.name),t}},{key:"_switchScene",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.$name;this._context.sceneManager.change(e)}},{key:"_onLoaderComplete",value:function(){this._onLoaderComplete&&this._signals.loader.completed.remove(this._onLoaderComplete),this._loaded||(this._loaded=!0,this.ready())}}])&&a(n.prototype,o),r&&a(n,r),t}()).prototype,f="_onLoaderComplete",p=[e],h=Object.getOwnPropertyDescriptor(t.prototype,"_onLoaderComplete"),d=t.prototype,y={},Object.keys(h).forEach(function(e){y[e]=h[e]}),y.enumerable=!!y.enumerable,y.configurable=!!y.configurable,("value"in y||y.initializer)&&(y.writable=!0),y=p.slice().reverse().reduce(function(e,t){return t(r,f,e)||e},y),d&&void 0!==y.initializer&&(y.value=y.initializer?y.initializer.call(d):void 0,y.initializer=void 0),void 0===y.initializer&&(Object.defineProperty(r,f,y),y=null),t);g.a=_}).call(this,b(2).bind)},function(e,t,n){"use strict";var o=n(19),i=n.n(o),a=n(29),s=n(33),u=n(16),r=n(146),c=n.n(r),l=n(48);function f(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var p=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._tasks=e,this._requestId=null,this._runTasks=this._runTasks.bind(this)}var e,n,o;return e=t,(n=[{key:"add",value:function(e){if("function"==typeof e)this._tasks.push(e);else if(Object(l.isArray)(e))for(var t=0,n=e.length;t<n;t++)this.add(e)}},{key:"execute",value:function(){var n=this;return this._tasks.length?i.a.promise(function(e,t){n._requestId=n._request(e)}):i()()}},{key:"clear",value:function(){this._tasks=null,this._requestId&&c.a.cancel(this._requestId)}},{key:"_runTasks",value:function(e,t){for(;this._tasks.length&&0<e.timeRemaining();)this._tasks.shift()();this._tasks.length?this._requestId=this._request(t):t()}},{key:"_request",value:function(t){var n=this;return c.a.request(function(e){return n._runTasks(e,t)})}}])&&f(e.prototype,n),o&&f(e,o),t}();function h(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.order=[],this.rules={}}var t,n,o;return t=e,(n=[{key:"exists",value:function(e){return-1!==this.order.indexOf(e)}},{key:"index",value:function(e){return this.order.indexOf(e)}},{key:"_add",value:function(e){this.exists(e)||(this.order.push(e),this.rules[e]={before:this.order.slice(0,this.order.length-1),after:[]})}},{key:"before",value:function(e,t){this._add(t),this._add(e),this.updateRules(t,e,"before"),this.reorder()}},{key:"after",value:function(e,t){this._add(t),this._add(e),this.updateRules(t,e,"after"),this.reorder()}},{key:"add",value:function(e){this._add(e),this.refreshRules()}},{key:"first",value:function(e){this.order[0]?this.before(this.order[0],e):this.add(e)}},{key:"last",value:function(e){this.order[this.order.length-1]?this.after(this.order[this.order.length-1],e):this.add(e)}},{key:"rule",value:function(e,t,n){if(-1===this.rules[t][e].indexOf(n)){this.rules[t][e].push(n);var o="before"===e?"after":"before",r=this.rules[t][o].indexOf(n);-1!==r&&this.rules[t][o].splice(r,1)}}},{key:"refreshRules",value:function(){for(var e={},t=0,n=this.order.length;t<n;t++)e[this.order[t]]={before:this.order.slice(0,t),after:this.order.slice(t+1,n)};this.rules=e}},{key:"updateRules",value:function(e,t,n){"before"===n?(this.rules[e].after=this.rules[t].after.slice(0),this.rules[e].after.push(t),this.rules[e].before=this.rules[t].before.slice(0)):(this.rules[e].before=this.rules[t].before.slice(0),this.rules[e].before.push(t),this.rules[e].after=this.rules[t].after.slice(0));for(var o=0,r=this.order.length;o<r;o++)-1<this.rules[e].before.indexOf(this.order[o])&&this.rule("after",this.order[o],e),-1<this.rules[e].after.indexOf(this.order[o])&&this.rule("before",this.order[o],e)}},{key:"reorder",value:function(){for(var e,t,n=[this.order[0]],o=0,r=1,i=this.order.length;r<i;r++){e=this.order[r];for(var a=o=0,s=n.length;a<s;a++)t=n[a],-1<this.rules[t].before.indexOf(e)&&o--;var u=Math.max(0,n.length+o);n.splice(u,0,e)}this.order=n,this.refreshRules()}}])&&h(t.prototype,n),o&&h(t,o),e}();function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function m(e,t){return!t||"object"!==y(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function _(e,t,n){return(_="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=g(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var w=function(e){function o(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=m(this,g(o).call(this)))._tasks={},e}var t,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(o,d),t=o,(n=[{key:"_addTask",value:function(e,t){this._tasks[e]=t||null}},{key:"add",value:function(e,t){_(g(o.prototype),"add",this).call(this,e),this._addTask(e,t)}},{key:"first",value:function(e,t){_(g(o.prototype),"first",this).call(this,e),this._addTask(e,t)}},{key:"last",value:function(e,t){_(g(o.prototype),"last",this).call(this,e),this._addTask(e,t)}},{key:"before",value:function(e,t,n){_(g(o.prototype),"before",this).call(this,e,t),this._addTask(t,n)}},{key:"after",value:function(e,t,n){_(g(o.prototype),"after",this).call(this,e,t),this._addTask(t,n)}},{key:"get",value:function(e){var t=this,n=new RegExp("^".concat(e));return this.order.filter(function(e){return e.match(n)}).map(function(e){return t._tasks[e]}).join("\n")}},{key:"getAll",value:function(){var t=this;return this.order.map(function(e){return t._tasks[e]})}}])&&v(t.prototype,n),r&&v(t,r),o}(),O=n(4),x=n(50),k=n(21),E=n(32),P=n(17),T=n(291),S=n(293),j=n(295),C=n(301),R=n(302),M=n(79),A=n(37),L=n(49),D=n(305);function z(e){return(z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function H(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function I(e,t){return!t||"object"!==z(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function F(e){return(F=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function N(e,t){return(N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var U=function(e){function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=I(this,F(o).call(this)))._name=e,n._router=s.a,n._context=u.a,n._state=a.a,n._signals=O.a,n._quality=k.a,n._sounds=x.a,n._gltf=M.a,n._materials=A.a,n._palette=L.a,n._loader=E.a,n._tls=[],n._entities=[],n._renderGui=null,n._running=!1,n.physicsEnabled=t.physics,n.postProcessingEnabled=t.postProcessing,n._renderer=u.a.renderer,n._createStack(),n._bind(),n._init(),n}var t,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&N(e,t)}(o,THREE.Scene),t=o,(n=[{key:"create",value:function(){return(u.a.scene=this)._batcher=new p(this._stack.getAll()),this._batcher.execute()}},{key:"destroy",value:function(){this._unbind(),this._destroyTls(),this._destroyGUI(),this._destroyAudios(),this._cameraCtrl.destroy(),this._helperCtrl.destroy(),this.physics&&this.physics.destroy();for(var e=0,t=this._entities.length;e<t;e++){this._entities[e].destroy&&this._entities[e].destroy()}return i()()}},{key:"start",value:function(){return this._cameraCtrl.start(),i()()}},{key:"pause",value:function(){return this._cameraCtrl.pause(),i()()}},{key:"update",value:function(e,t){this._running&&(this.physics&&this.physics.update(e,t),this._cameraCtrl.update(e,t),this._onUpdate(e,t),this._postProcessing.update(e,t))}},{key:"addEntity",value:function(e){this._entities.push(e),this.add(e)}},{key:"addCamera",value:function(e){this._cameraCtrl.addCamera(e)}},{key:"setSize",value:function(e,t){}},{key:"_init",value:function(){}},{key:"_bind",value:function(){}},{key:"_unbind",value:function(){}},{key:"_onUpdate",value:function(e,t){}},{key:"_createStack",value:function(){var t=this;this._stack=new w;this._stack.add("beforeCreate",function(){return t._beforeCreate()}),["ctrls","cameras","postProcessing","environment","audios","entities","lights","tls","GUI"].forEach(function(e){t._stack.add(e,function(){return t["_create".concat(Object(P.a)(e))]()})}),this._stack.add("afterCreate",function(){return t._afterCreate()}),this.physicsEnabled&&this._stack.first("physics",function(){return t._createPhysics()})}},{key:"_createPhysics",value:function(){this.physics=new R.a(this,this.name)}},{key:"_createCtrls",value:function(){this._cameraCtrl=new j.a(this),this.addEntity(this._cameraCtrl.helpers),this._helperCtrl=new C.a(this)}},{key:"_createCameras",value:function(){this._cameraCtrl.nextCamera()}},{key:"_createPostProcessing",value:function(){this._postProcessing=new T.a(this,this.camera,this.postProcessingEnabled),this.postProcessingEnabled&&(this._renderPass=new S.a(this,this.camera),this._renderPass.renderToScreen=!1,this._postProcessing.addPass(this._renderPass))}},{key:"_createEnvironment",value:function(){}},{key:"_createAudios",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:.25;this._sounds.config[this.name]&&(this._sounds.create(this.name),!1!==e&&(this._themeAudio=this._sounds.get(e||"".concat(this.name,"-theme")),this._themeAudio.play(),this._themeAudio.volume=0,TweenMax.to(this._themeAudio,1,{volume:t})))}},{key:"_createEntities",value:function(){}},{key:"_createLights",value:function(){}},{key:"_createTls",value:function(){}},{key:"_createGUI",value:function(){this._renderGui=new D.a(this)}},{key:"_beforeCreate",value:function(){this._palette.init(this)}},{key:"_afterCreate",value:function(){}},{key:"_destroyGUI",value:function(){this._renderGui.destroy(),this._renderGui=null}},{key:"_destroyAudios",value:function(){var e=this;this._sounds.sonoGroups[this.name]&&this._themeAudio&&TweenMax.to(this._themeAudio,1,{volume:0,omComplete:function(){e._themeAudio.stop()}})}},{key:"_destroyTls",value:function(){for(var e=0,t=this._tls.length;e<t;e++)this._tls[e]&&(this._tls[e].kill(),this._tls[e].clear())}},{key:"name",get:function(){return this._name},set:function(e){this._name=e}},{key:"running",get:function(){return this._running},set:function(e){this._running=e}},{key:"camera",get:function(){return this._cameraCtrl.camera}},{key:"postProcessing",get:function(){return this._postProcessing}},{key:"rtt",get:function(){return this._postProcessing.rtt}}])&&H(t.prototype,n),r&&H(t,r),o}();t.a=U},function(e,t,n){"use strict";var o=n(32);function r(e){return function(e){var t={animations:e.animations,scene:e.scene.clone(!0)},n={};e.scene.traverse(function(e){e.isSkinnedMesh&&(n[e.name]=e)});var o={},r={};for(var i in t.scene.traverse(function(e){e.isBone&&(o[e.name]=e),e.isSkinnedMesh&&(r[e.name]=e)}),n){for(var a=n[i].skeleton,s=r[i],u=[],c=0,l=a.bones.length;c<l;++c){var f=o[a.bones[c].name];u.push(f)}s.bind(new THREE.Skeleton(u,a.boneInverses),s.matrixWorld)}return t}(o.a.get(e))}n.d(t,"a",function(){return r})},function(e,t,n){"use strict";var i=n(13),o=n(41),s=n.n(o),u=n(14),r=n(0);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function l(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function f(e,t,n){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d=function(e){function a(e,t,n,o){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(r=l(this,p(a).call(this,e)))._ctrl=t,r._id=n,r._config=o,r._sound=r._sounds.clone("portal"),r._sound.play(),r._pan=r._sound.effects.add(s()({maxDistance:25}));var i=u.a.pool.get();return i.set(0,0,-1),r._pan.setPosition(o.anchor),r._pan.setOrientation(i.normalize()),i.release(),r._bind(),r}var t,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(a,i["a"]),t=a,(n=[{key:"destroy",value:function(){f(p(a.prototype),"destroy",this).call(this),this._sound&&this._sound.destroy()}},{key:"update",value:function(e,t){if(!this._config.locked){this._updateSound();var n=this._character.position,o=this._config.anchor;Object(r.b)(n.x,n.z,o.x,o.z)<2.2&&this._activate()}}},{key:"_bind",value:function(){}},{key:"_unbind",value:function(){}},{key:"_activate",value:function(){this._ctrl.activate(this._id),this._sounds.get("woosh-2").play()}},{key:"_updateSound",value:function(){var e=this._scene.camera,t=u.a.pool.get();t.set(0,0,-1),t.applyQuaternion(e.quaternion),this._pan.setListenerPosition(e.position),this._pan.setListenerOrientation(t.normalize()),t.release()}}])&&c(t.prototype,n),o&&c(t,o),a}();function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function m(e,t){return!t||"object"!==y(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function _(e,t,n){return(_="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=g(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var w=function(e){function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=m(this,g(o).call(this,e)))._config=t,n._portals={},n._portalsArr=[],n.isActivated=!1,n._bind(),n._createPortals(),n}var t,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(o,i["a"]),t=o,(n=[{key:"destroy",value:function(){_(g(o.prototype),"destroy",this).call(this);for(var e=0,t=this._portalsArr.length;e<t;e++)this._portalsArr[e].destroy()}},{key:"activate",value:function(e){if(!this.isActivated){var t=this._config[e];this.isActivated=!0,this._signals.overlay.show.dispatch(),this._context.pause(this._scene.name),this._router.navigate(t.route)}}},{key:"update",value:function(e,t){if(!this.isActivated)for(var n=0,o=this._portalsArr.length;n<o;n++)this._portalsArr[n].update(e,t)}},{key:"_bind",value:function(){}},{key:"_unbind",value:function(){}},{key:"_createPortals",value:function(){for(var e in this._config){var t=this._config[e],n=new d(this._scene,this,e,t);this.add(n),this._portals[e]=n,this._portalsArr.push(n)}}}])&&v(t.prototype,n),r&&v(t,r),o}();t.a=w},,function(e,t){var n=e.exports={version:"2.5.7"};"number"==typeof __e&&(__e=n)},function(e,t,n){var o=n(85),r=n(172),i=n(122),a=Object.defineProperty;t.f=n(61)?Object.defineProperty:function(e,t,n){if(o(e),t=i(t,!0),o(n),r)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){e.exports=!n(95)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MemoryStorage=t.CookieStorage=t.isSupported=t.storage=void 0;var o=a(n(455)),r=a(n(169)),i=a(n(457));function a(e){return e&&e.__esModule?e:{default:e}}var s=null;(0,o.default)("localStorage")?t.storage=s=window.localStorage:(0,o.default)("sessionStorage")?t.storage=s=window.sessionStorage:(0,o.default)("cookieStorage")?t.storage=s=new r.default:t.storage=s=new i.default,t.default=s,t.storage=s,t.isSupported=o.default,t.CookieStorage=r.default,t.MemoryStorage=i.default},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var o=function(){function n(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.fn=e,this.countdown=t,this.totalTimeRun=0,this.complete=!1,this.startTime=(new Date).getTime(),this.ident=setTimeout(e,t)}var e,t,o;return e=n,(t=[{key:"clear",value:function(){clearTimeout(this.ident)}},{key:"pause",value:function(){clearTimeout(this.ident),this.totalTimeRun=this._timeDiff(this.startTime),this.complete=this.totalTimeRun>=this.countdown}},{key:"resume",value:function(){this.ident=this.complete?-1:setTimeout(this.fn,this.countdown-this.totalTimeRun)}},{key:"_timeDiff",value:function(e,t){return t?t-e:(new Date).getTime()-e}}])&&r(e.prototype,t),o&&r(e,o),n}();t.a=o},,,,,function(e,t,n){"use strict";var r=n(167);function a(){}var i=null,s={};function u(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("Promise constructor's argument is not a function");this._h=0,this._i=0,this._j=null,this._k=null,e!==a&&h(e,this)}function c(e,t){for(;3===e._i;)e=e._j;if(u._l&&u._l(e),0===e._i)return 0===e._h?(e._h=1,void(e._k=t)):1===e._h?(e._h=2,void(e._k=[e._k,t])):void e._k.push(t);var n,o;n=e,o=t,r(function(){var e=1===n._i?o.onFulfilled:o.onRejected;if(null!==e){var t=function(e,t){try{return e(t)}catch(e){return i=e,s}}(e,n._j);t===s?f(o.promise,i):l(o.promise,t)}else 1===n._i?l(o.promise,n._j):f(o.promise,n._j)})}function l(e,t){if(t===e)return f(e,new TypeError("A promise cannot be resolved with itself."));if(t&&("object"==typeof t||"function"==typeof t)){var n=function(e){try{return e.then}catch(e){return i=e,s}}(t);if(n===s)return f(e,i);if(n===e.then&&t instanceof u)return e._i=3,e._j=t,void o(e);if("function"==typeof n)return void h(n.bind(t),e)}e._i=1,e._j=t,o(e)}function f(e,t){e._i=2,e._j=t,u._m&&u._m(e,t),o(e)}function o(e){if(1===e._h&&(c(e,e._k),e._k=null),2===e._h){for(var t=0;t<e._k.length;t++)c(e,e._k[t]);e._k=null}}function p(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function h(e,t){var n=!1,o=function(e,t,n){try{e(t,n)}catch(e){return i=e,s}}(e,function(e){n||(n=!0,l(t,e))},function(e){n||(n=!0,f(t,e))});n||o!==s||(n=!0,f(t,i))}(e.exports=u)._l=null,u._m=null,u._n=a,u.prototype.then=function(e,t){if(this.constructor!==u)return r=e,i=t,new(o=this).constructor(function(e,t){var n=new u(a);n.then(e,t),c(o,new p(r,i,n))});var o,r,i,n=new u(a);return c(this,new p(e,t,n)),n}},function(e,t,n){var o=n(60),r=n(96);e.exports=n(61)?function(e,t,n){return o.f(e,t,r(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){var o=n(495),r=n(129);e.exports=function(e){return o(r(e))}},function(e,t,n){var o=n(134)("wks"),r=n(101),i=n(47).Symbol,a="function"==typeof i;(e.exports=function(e){return o[e]||(o[e]=a&&i[e]||(a?i:r)("Symbol."+e))}).store=o},function(e,t){e.exports="#define GLSLIFY 1\n#define SHADER_NAME Basic-raw\n\nattribute vec3 position;\nattribute vec2 uv;\n\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\n\nvarying vec2 vUv;\n\nvoid main() {\n  vUv = uv;\n  \n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n"},function(e,t,n){"use strict";var o=n(29),r=n(16),i=n(33),a=n(32),s=n(26),u=n(1),c=n(7),l=n(4),f=n(35),p=n(21),h=n(50),d=n(38),y=n(37);t.a=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._state=o.a,this._context=r.a,this._router=i.a,this._loader=a.a,this._gui=s.a,this._window=u.a,this._keyboard=c.a,this._signals=l.a,this._save=f.a,this._textures=d.a,this._materials=y.a,this._quality=p.a,this._sounds=h.a,this._renderer=this._context.renderer,this._scene=t||this._context.scene,this._physics=this._scene.physics}},function(e,f,p){"use strict";(function(e){var t,y=p(29),v=p(1),r=p(7),i=p(16);p(14);function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function m(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function s(e,t,n){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var c=new THREE.Vector2,l=(o((t=function(e){function d(e){var t,n=e.fov,o=void 0===n?75:n,r=e.aspect,i=void 0===r?v.a.aspect:r,a=e.near,s=void 0===a?1:a,u=e.far,c=void 0===u?1e5:u,l=e.name,f=void 0===l?"Camera":l,p=e.isDefault,h=void 0!==p&&p;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(t=m(this,_(d).call(this,o,i,s,c))).name=f,t.isDefault=h,t._state=y.a,t._guiIsCreated=!1,t._helper=null,t._charPos=new THREE.Vector3,t._charPosY=0,t._charPosYTarget=0,t._charDampingFactor=.2,t._cameraDirection=new THREE.Vector3,t._cameraAngle=0,t._bind(),t._createHelper(),t}var t,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(d,THREE.PerspectiveCamera),t=d,(n=[{key:"createGUI",value:function(e){var t=this,n=e.addFolder(this.name);n.add(this,"near",1,1e4,1).name("Near").onChange(function(e){return t.updateProjectionMatrix()}),n.add(this,"far",1,1e4,1).name("Far").onChange(function(e){return t.updateProjectionMatrix()}),n.add(this,"fov",0,180,1).name("FOV").onChange(function(e){return t.updateProjectionMatrix()}),this._helper&&n.add(this._helper,"visible").name("Camera helper");var o=n.addFolder("Position");o.add({log:function(){return console.log(t.position)}},"log").name("Log"),o.add(this.position,"x").step(.1).name("X"),o.add(this.position,"y").step(.1).name("Y"),o.add(this.position,"z").step(.1).name("Z");var r=n.addFolder("Rotation");return r.add({log:function(){return console.log(t.rotation)}},"log").name("Log"),r.add(this.rotation,"x").step(.01).name("X"),r.add(this.rotation,"y").step(.01).name("Y"),r.add(this.rotation,"z").step(.01).name("Z"),n}},{key:"start",value:function(){}},{key:"stop",value:function(){}},{key:"update",value:function(e,t){this._helper&&this._helper.visible&&(this.updateMatrixWorld(),this._helper.update()),this._computeCameraAngle()}},{key:"destroy",value:function(){s(_(d.prototype),"remove",this).call(this),this._unbind(),this._destroyHelper()}},{key:"_bind",value:function(){r.a.downed.add(this._onKeyDown),v.a.resized.add(this._handleWindowResize)}},{key:"_unbind",value:function(){r.a.downed.remove(this._onKeyDown),v.a.resized.remove(this._handleWindowResize)}},{key:"_handleWindowResize",value:function(e,t){this.aspect=e/t,this.updateProjectionMatrix()}},{key:"_onKeyDown",value:function(e,t){}},{key:"_createHelper",value:function(){this._helper=new THREE.CameraHelper(this),this._helper.name="CameraHelper",this._helper.material.fog=!1}},{key:"_destroyHelper",value:function(){this._helper&&this._helper.remove()}},{key:"_computeCameraAngle",value:function(){var e=i.a.scene.character;if(e){var t=e.position,n=e._hipsBonePos;this._charPosY+=(this._charPosYTarget-this._charPosY)*this._charDampingFactor,this._charPosYTarget=e._isJumpimg?n.y:t.y,this._charPos.set(t.x,this._charPosY,t.z),this._cameraDirection.copy(this._charPos).sub(this.position),this._cameraAngle=c.set(this._cameraDirection.x,this._cameraDirection.z).angle()-Math.PI}}},{key:"helper",get:function(){return this._helper}},{key:"cameraAngle",get:function(){return this._cameraAngle}}])&&a(t.prototype,n),o&&a(t,o),d}()).prototype,"_handleWindowResize",[e],Object.getOwnPropertyDescriptor(t.prototype,"_handleWindowResize"),t.prototype),o(t.prototype,"_onKeyDown",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onKeyDown"),t.prototype),t);f.a=l}).call(this,p(2).bind)},function(e,d,y){"use strict";(function(e){var t,i=y(13),a=y(11),s=y(56);function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function l(e,t,n){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var h=null,r=(o((t=function(e){function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=c(this,f(o).call(this,e)))._config=t,n.basePosition=t.basePosition.clone(),n.position.copy(n.basePosition),n._isFounded=!1,n._create(),n._createTl(),n._bind(),n}var t,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(o,i["a"]),t=o,(n=[{key:"destroy",value:function(){l(f(o.prototype),"destroy",this).call(this)}},{key:"update",value:function(e,t){(this.position.copy(this.basePosition),this.position.y+=.4*Math.sin(.001*t),this._mesh.rotation.y+=.001*e,this._mesh.rotation.y%=2*Math.PI,this._mesh.rotation.z=.3+.1*Math.sin(.001*t),this._isFounded)||this._scene.character.position.distanceTo(this.position)<2.1&&(this._isFounded=!0,this._scene.character.canDie=!1,this._tl.play(),this._sounds.play("validate"),this._sounds.play("woosh"))}},{key:"_bind",value:function(){this._signals.pause.shown.add(this._onPauseShow),this._signals.pause.hidden.add(this._onPauseHide)}},{key:"_unbind",value:function(){this._signals.pause.shown.remove(this._onPauseShow),this._signals.pause.hidden.remove(this._onPauseHide)}},{key:"_create",value:function(){if(!h){var e=Object(s.a)("main.models.key").scene.children[0];h=e.geometry.clone()}this._geometry=h,this._material=new a.a({name:"key",diffuse:this._config.diffuse,transparent:!0}),this._mesh=new THREE.Mesh(this._geometry,this._material),this._mesh.name="key",this.add(this._mesh)}},{key:"_createTl",value:function(){var e=this;this._tl=new TimelineMax({paused:!0,onComplete:function(){}}),this._tls.push(this._tl),this._tl.to(this.scale,1,{x:.5,y:.5,z:.5,ease:Elastic.easeOut}).to(this.basePosition,1,{y:5.2,ease:Expo.easeOut,onStart:function(){e._sounds.play("woosh-2"),"level-1"===e._scene.name?e._sounds.play("keys"):e._sounds.play("yipi")}},.7).to(this.scale,1,{x:1.2,y:1.2,z:1.2,ease:Elastic.easeOut},1.6).to(this._material,.7,{opacity:0},1.6).addCallback(function(){e._signals.character.keyFound.dispatch(e._scene.name,function(){e._router.navigate("/lobby")})},1.8)}},{key:"_onPauseShow",value:function(){this._tl&&this._tl.pause()}},{key:"_onPauseHide",value:function(){this._tl&&0<this._tl.progress()&&this._tl.progress()<1&&this._tl.play()}}])&&u(t.prototype,n),r&&u(t,r),o}()).prototype,"_onPauseShow",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onPauseShow"),t.prototype),o(t.prototype,"_onPauseHide",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onPauseHide"),t.prototype),t);d.a=r}).call(this,y(2).bind)},function(e,t,n){"use strict";var i=n(11);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(e){r(t,e,n[e])})}return t}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],0<=t.indexOf(n)||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],0<=t.indexOf(n)||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function l(e,t,n){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var h=function(e){function r(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=t.locked,o=s(t,["locked"]);return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(e=c(this,f(r).call(this,a({side:THREE.DoubleSide,transparent:!0,opacity:.2,useShadowMap:!1},o))))._isLocked=n,e.defines=a({},e.defines,{IS_CONE:!0}),e}var t,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(r,i["a"]),t=r,(n=[{key:"update",value:function(e,t){this._isLocked&&(t*=.2),l(f(r.prototype),"update",this).call(this,e,t)}}])&&u(t.prototype,n),o&&u(t,o),r}();t.a=h},function(e,t,n){"use strict";function r(e,t){var n=e.children;if(t&&"function"!=typeof t){var o=t;t=function(e){return e.name===o}}var r=function e(t){for(var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(e){return!0},o=0,r=t.length;o<r;o++){var i=t[o];if(n(i))return i;if(i.children.length){var a=e(i.children,n);if(a)return a}}return null}(n,t);return t||(r=e),r||null}var i=n(56),o=n(5);function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var s=Object(o.d)("GLTFManager",o.b,!0),u=Object(o.d)("GLTFManager",o.a,!0),c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.refs={},this._currentAssets={},this._currentAssetsArray=[],this._counter=0}var t,n,o;return t=e,(n=[{key:"add",value:function(e,t){var n=Object(i.a)(t);this._currentAssets[e]=n,this._currentAssetsArray.push(n)}},{key:"destroy",value:function(){for(var e=0,t=this._currentAssetsArray.length;e<t;e++)this._dispose(this._currentAssetsArray[e].scene);s("".concat(this._currentAssetsArray.length," assets disposed : ").concat(this._counter," geometries / materials")),this._counter=0,this._currentAssets={},this._currentAssetsArray=[]}},{key:"getAsset",value:function(e){return this._currentAssets[e]?this._currentAssets[e]:(u("Cannot get asset with id '".concat(e,"'")),null)}},{key:"getObject",value:function(e,t){var n=this._currentAssets[e];return n?r(n.scene,t):(u("Cannot get object with id '".concat(e,"'")),null)}},{key:"_dispose",value:function(e){var t=this;e.traverse(function(e){e.geometry&&(t._counter++,e.geometry.dispose()),e.material&&(t._counter++,e.material.dispose())})}}])&&a(t.prototype,n),o&&a(t,o),e}();t.a=new c},,,,function(e,t){var n,o,r=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{o="function"==typeof clearTimeout?clearTimeout:a}catch(e){o=a}}();var u,c=[],l=!1,f=-1;function p(){l&&u&&(l=!1,u.length?c=u.concat(c):f=-1,c.length&&h())}function h(){if(!l){var e=s(p);l=!0;for(var t=c.length;t;){for(u=c,c=[];++f<t;)u&&u[f].run();f=-1,t=c.length}u=null,l=!1,function(t){if(o===clearTimeout)return clearTimeout(t);if((o===a||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(t);try{o(t)}catch(e){try{return o.call(null,t)}catch(e){return o.call(this,t)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function y(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new d(e,t)),1!==c.length||l||s(h)},d.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=y,r.addListener=y,r.once=y,r.off=y,r.removeListener=y,r.removeAllListeners=y,r.emit=y,r.prependListener=y,r.prependOnceListener=y,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,t,n){var y=n(47),v=n(59),m=n(171),_=n(70),g=n(62),b="prototype",w=function(e,t,n){var o,r,i,a=e&w.F,s=e&w.G,u=e&w.S,c=e&w.P,l=e&w.B,f=e&w.W,p=s?v:v[t]||(v[t]={}),h=p[b],d=s?y:u?y[t]:(y[t]||{})[b];for(o in s&&(n=t),n)(r=!a&&d&&void 0!==d[o])&&g(p,o)||(i=r?d[o]:n[o],p[o]=s&&"function"!=typeof d[o]?n[o]:l&&r?m(i,y):f&&d[o]==i?function(o){var e=function(e,t,n){if(this instanceof o){switch(arguments.length){case 0:return new o;case 1:return new o(e);case 2:return new o(e,t)}return new o(e,t,n)}return o.apply(this,arguments)};return e[b]=o[b],e}(i):c&&"function"==typeof i?m(Function.call,i):i,c&&((p.virtual||(p.virtual={}))[o]=i,e&w.R&&h&&!h[o]&&_(h,o,i)))};w.F=1,w.G=2,w.S=4,w.P=8,w.B=16,w.W=32,w.U=64,w.R=128,e.exports=w},function(e,t,n){var o=n(71);e.exports=function(e){if(!o(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){"use strict";t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},r=function(){function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}}(),i=n(405),c=(o=i)&&o.__esModule?o:{default:o},l=n(408),f=n(48),p=n(420);var a=function(){function s(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.el,n=void 0===t?null:t,o=e.name,r=void 0===o?"anonymous":o,i=e.components,a=void 0===i?{}:i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),this.$el="string"==typeof n?document.querySelector(n):n,null===n||(0,l.isElement)(this.$el)?(this.$name=r,this._components=a,this.$parent=null,(this.$root=this).$els={},this.$refs={},this.$props={},this._instances=[],this._isRoot=!0,this._isRoot&&this.$el&&this.template?this.$mount(this.$el):this._isRoot&&this.$el&&(this._callHook("init",this),this._render(),this._callHook("mounted",this))):console.error("Cannot select a valid $el HTMLElement")}return r(s,[{key:"init",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"data",value:function(){return{}}},{key:"$preRenderMount",value:function(e){if(e="string"==typeof e?document.querySelector(e):e,(0,l.isElement)(e))return this.$el=e,this._preRender(),this;console.error("$preRenderMount() : Cannot select a valid $el HTMLElement")}},{key:"$mount",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=arguments[1];if(e="string"==typeof e?document.querySelector(e):e,this._callHook("init",this),this.$el=this._renderTemplate(e,this,{},t),this.$el)return this._render(),this._callHook("mounted",this),this}},{key:"$destroy",value:function(){this._callHook("beforeDestroy",this);for(var e=0,t=this._instances.length;e<t;e++)this._instances[e].$destroy();null!==this.$el&&this.$el.parentNode.removeChild(this.$el),this.$el=null,this.$name=null,this.$parent=null,this.$root=null,this.$els={},this.$refs={},this._components={},this._instances=[],this.destroyed()}},{key:"$debug",value:function(){console.group("%cDebug component '"+this.$name+"'","background: #000000; color: #FFFFFF; padding: 3px 5px;"),console.log("%cAttributes","font-weight: bold"),console.log("$el",this.$el),console.log("$els",this.$els),console.log("$refs",this.$refs),console.log("$props",this.$props),console.log("$parent",this.$parent),console.log("$root",this.$root),console.log(""),console.log("%cTree","font-weight: bold");for(var e=this._getComponentTree(),t=0,n=e.length;t<n;t++){var o=Array(2*t).join(" "),r=t?"➔ ":"",i=e[t],a=t===n-1?"font-weight: bold":"";console.log("%c"+o+r+i,a)}console.groupEnd("Debug component '"+this.$name+"'")}},{key:"$scope",value:function(){for(var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=0,n=e.length;t<n;t++){var o=e[t];if(void 0===this[o])return void console.error("$scope : Cannot bind method '"+o+"' on '"+this.$name+"' component instance");this[o]=this[o].bind(this)}}},{key:"$nextTick",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){};window.requestAnimationFrame(e)}},{key:"_preRender",value:function(){this._callHook("init",this),this.$root=this._getRootInstance(this),this._parseSubComponents(!0),this._parseEls(this.$el,this),this._parseRefs(this.$el,this),this._parseProps(this.$el,this),this._callHook("mounted",this),this.$el.removeAttribute("data-prerendered")}},{key:"_render",value:function(){this._parseSubComponents(!1),this._isRoot&&(this._parseEls(this.$el,this),this._parseRefs(this.$el,this),this._parseProps(this.$el,this))}},{key:"_getRootInstance",value:function(e){if(null===e.$parent)return e;for(var t=e.$parent;null!==t.$parent;)t=t.$parent;return t}},{key:"_getComponentTree",value:function(){var e=[this.$name],t=this.$parent;if(null===t)return e;for(;null!==t;)e.push(t.$name),t=t.$parent;return e.reverse()}},{key:"_walkNode",value:function(e,t){(0,l.isElement)(e)?(0,p.walk)(e,function(e){if(e.nodeType===window.Node.ELEMENT_NODE)return t(e)}):console.error("Node argument must be a HTMLElement")}},{key:"_hasAttribute",value:function(e,t){return"function"==typeof e.getAttribute&&e.getAttribute(t)}},{key:"_getAttribute",value:function(e,t){var n=e.getAttribute(t);return e.removeAttribute(t),n}},{key:"_parseSubComponents",value:function(){var n=this,o=0<arguments.length&&void 0!==arguments[0]&&arguments[0];(0,l.isElement)(this.$el)&&this._walkNode(this.$el,function(e){var t=o?"data-prerendered":"data-component";n._hasAttribute(e,t)&&n.$el!==e&&n._parseSubComponent(e,o)})}},{key:"_parseSubComponent",value:function(e,t){if((0,l.isElement)(e)){var n=t?"data-prerendered":"data-component",o=this._getAttribute(e,n),r=this.components[o];if(void 0!==r){var i=new r;this._instances.push(i),i.$name=o,i.$parent=this,i.$root=this._getRootInstance(i),i._isRoot=!1,this._callHook("init",i);var a=e;if(t)i.$el=e,this._parseEls(e,i),this._parseRefs(e,i),this._parseProps(e,i),i._parseSubComponents(!0);else{var s=this._parseProps(e,i);null!==i.template&&(a=this._renderTemplate(e,i,s)),i.$el=a,this._parseEls(a,i),this._parseRefs(e,i),i._render()}this._callHook("mounted",i)}else console.error("Cannot instanciate a component that does not exist : '"+o+"'")}else console.error("Node argument must be a HTMLElement")}},{key:"_renderTemplate",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},o=arguments[3],r=t.data();if((0,f.isObject)(r)){if(null!==t.template){var i=u({},n,r),a=c.default.twig({data:t.template}).render(i);return this._renderDOM(e,a,o)}console.error("No template to render for component : '"+t.$name+"'")}else console.error("data() method must return an object")}},{key:"_renderDOM",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"replace";e||(e=document.createElement("div"),n="append"),e.insertAdjacentHTML("afterbegin",t);var o=e.firstElementChild;if((0,l.isElement)(o)){if("append"===n)e.appendChild(o);else{if("replace"!==n)return void console.error("Invalid render type");e&&e.parentNode?e.parentNode.replaceChild(o,e):console.warn("No parent node found to replace child")}return o}console.error("Cannot render to DOM new node")}},{key:"_parseEls",value:function(e,n){var o=this;this._walkNode(e,function(e){if(null!==e.getAttribute("data-prerendered"))return!0;if(o._hasAttribute(e,"data-el")){var t=o._getAttribute(e,"data-el");void 0===n.$els[t]?n.$els[t]=e:(0,f.isArray)(n.$els[t])?n.$els[t].push(e):n.$els[t]=[n.$els[t],e]}})}},{key:"_parseRefs",value:function(e,t){if(this._hasAttribute(e,"data-ref")){var n=this._getAttribute(e,"data-ref");if(void 0!==t.$parent.$refs[n])return void console.error("A 'data-ref' already exists with the name '"+n+"' in '"+t.$parent.$name+"' component");t.$parent.$refs[n]=t}}},{key:"_parseProps",value:function(e,t){for(var n=["data-component","data-prerendered","data-ref","data-el"],o=e.attributes,r={},i=0,a=o.length;i<a;i++){var s=o[i].nodeName,u=o[i].nodeValue;-1===n.indexOf(s)&&(0,p.startsWith)(s,"data-")&&(r[s.replace("data-","")]=u)}return t.$props=r}},{key:"_findInstance",value:function(e){for(var t=0,n=this._instances.length;t<n;t++){var o=this._instances[t];if(o.$name===e)return o}return null}},{key:"_callHook",value:function(e,t){try{t[e]()}catch(e){this._logError(e)}}},{key:"_logError",value:function(e){"function"==typeof this.errorHandler?this.errorHandler(e):console.error(e)}},{key:"template",get:function(){return null}},{key:"components",get:function(){return this._components}}]),s}();t.default={Component:a,Twig:c.default},e.exports=t.default},function(e,t){function n(e){if(e&&"object"==typeof e){var t=e.which||e.keyCode||e.charCode;t&&(e=t)}if("number"==typeof e)return a[e];var n,o=String(e);return(n=r[o.toLowerCase()])?n:(n=i[o.toLowerCase()])||(1===o.length?o.charCodeAt(0):void 0)}n.isEventKey=function(e,t){if(e&&"object"==typeof e){var n=e.which||e.keyCode||e.charCode;if(null==n)return!1;if("string"==typeof t){var o;if(o=r[t.toLowerCase()])return o===n;if(o=i[t.toLowerCase()])return o===n}else if("number"==typeof t)return t===n;return!1}};var r=(t=e.exports=n).code=t.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},i=t.aliases={windows:91,"⇧":16,"⌥":18,"⌃":17,"⌘":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91};for(o=97;o<123;o++)r[String.fromCharCode(o)]=o-32;for(var o=48;o<58;o++)r[o-48]=o;for(o=1;o<13;o++)r["f"+o]=o+111;for(o=0;o<10;o++)r["numpad "+o]=o+96;var a=t.names=t.title={};for(o in r)a[r[o]]=o;for(var s in i)r[s]=i[s]},,,,,,,function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t){var n=e.exports={version:"2.5.7"};"number"==typeof __e&&(__e=n)},function(e,t,n){"use strict";t.__esModule=!0;var o=a(n(181)),r=a(n(488)),i=a(n(182));function a(e){return e&&e.__esModule?e:{default:e}}var s=window.AudioContext||window.webkitAudioContext||r.default,u=new s;u||(u=new r.default),i.default&&44100!==u.sampleRate&&((0,o.default)(u),u.close(),u=new s),"suspended"===u.state&&"function"==typeof u.resume&&window.setTimeout(function(){return u.resume()},1e3),t.default=u},function(e,t){e.exports=!0},function(e,t){var n=0,o=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+o).toString(36))}},function(e,t,n){"use strict";e.exports=function(e,t,n,o,r,i,a,s){if(!e){var u;if(void 0===t)u=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[n,o,r,i,a,s],l=0;(u=new Error(t.replace(/%s/g,function(){return c[l++]}))).name="Invariant Violation"}throw u.framesToPop=1,u}}},function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var s=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=r(this,i(t).call(this))).setIndex([0,2,1,0]),e.addAttribute("position",new THREE.Float32BufferAttribute([-1,-1,-1,4,4,-1],2)),e.boundingSphere=new THREE.Sphere,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(t,THREE.BufferGeometry),t}();t.a=s},function(e,t,n){"use strict";var o=n(22),r=n(275),s=n.n(r),i=n(276),u=n.n(i);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],0<=t.indexOf(n)||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],0<=t.indexOf(n)||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function l(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var h=function(e){function a(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=t.color,o=t.opacity,r=void 0===o?1:o,i=c(t,["color","opacity"]);return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(e=l(this,f(a).call(this,i))).vertexShader=s.a,e.fragmentShader=u.a,e.uniforms={uColor:{value:new THREE.Color(n||16777215)},uOpacity:{value:r}},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(a,o["a"]),a}();t.a=h},function(e,t,n){"use strict";var o=n(17);n.d(t,"a",function(){return o.a})},function(e,d,y){"use strict";(function(e){var t,r=y(16),i=y(53),a=y(21),s=y(37),u=y(1),c=y(4),l=y(366),f=y(318),p=y(36);function h(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function n(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var o=(n((t=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._options=e,this._materials=s.a,this._signals=c.a,this._context=r.a,this._renderer=this._context.renderer,this._scene=this._context.scene,this._postProcessing=this._scene._postProcessing,this._camera=this._scene.camera,this._materialsCache={},this._createPasses(),this._bind()}var e,n,o;return e=t,(n=[{key:"init",value:function(){var n=this;a.a.isLow||this._scene.traverse(function(e){if(e.material&&e.visible&&e.isMesh&&!e.noOutlines){var t=e.material;e._defaultMaterial=t,e._normalMaterial=e.customNormalMaterial?e.customNormalMaterial:n._getNormalMaterial(e,t)}})}},{key:"update",value:function(e,t){a.a.isLow||(this._scene.traverse(function(e){e._defaultMaterial&&(e.material=e._normalMaterial),e.noOutlines&&(e.visible=!1)}),this._renderer.render(this._scene,this._camera,this._normalRtt,!0),this._scene.traverse(function(e){e._defaultMaterial&&(e.material=e._defaultMaterial),e.noOutlines&&(e.visible=!0)}))}},{key:"destroy",value:function(){this._bloomPass=null,this._postPass=null,this._scene.traverse(function(e){e._normalMaterial&&"function"==typeof e._normalMaterial.dispose&&e._normalMaterial.dispose()}),this._unbind()}},{key:"_bind",value:function(){u.a.resized.add(this._onWindowResize),this._signals.camera.changed.add(this._onCameraChanged)}},{key:"_unbind",value:function(){u.a.resized.remove(this._onWindowResize),this._signals.camera.changed.remove(this._onCameraChanged)}},{key:"_createPasses",value:function(){var e=p.a[this._scene.name].common.postProcessing;if(a.a.isHigh){var t=e.bloomPass;this._bloomPass=new l.a(t),this._bloomPass.dithering=!0,this._postProcessing.addPass(this._bloomPass)}var n=function(r){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},t=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),t.forEach(function(e){var t,n,o;t=r,o=i[n=e],n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o})}return r}({},this._options);if(!a.a.isLow){var o=this._renderer.getDrawingBufferSize();this._normalRtt=new THREE.WebGLRenderTarget(o.width,o.height,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBFormat,depthBuffer:!0,stencilBuffer:!1,generateMipmaps:!1}),n.normalTexture=this._normalRtt.texture}this._postPass=new f.a(n),this._postProcessing.addPass(this._postPass);var r=e.postPass;this._postPass.outline=r.outline,this._postPass.bloomColor=r.bloomColor,this._postPass.vignette=r.vignette,this._postPass.brightness=r.brightness,this._postPass.saturation=r.saturation,this._postPass.contrast=r.contrast,this._postPass.noise=r.noise,this._postPass.colors=r.colors}},{key:"_getNormalMaterial",value:function(e,t){var n=t.name||e.name;if(this._materialsCache[n])return this._materialsCache[n];var o=new i.a({name:n,transparent:t.transparent,opacity:t.opacity,skinning:t.skinning,instanced:t.instanced,normalMap:t.uniforms.uNormalMap&&t.uniforms.uNormalMap.value,normalIntensity:t.normalIntensity,useVertexColors:t.useVertexColors});return this._materialsCache[n]=o}},{key:"_onWindowResize",value:function(e,t){this._normalRtt&&this._normalRtt.setSize(e,t)}},{key:"_onCameraChanged",value:function(e){this._camera=e}}])&&h(e.prototype,n),o&&h(e,o),t}()).prototype,"_onWindowResize",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onWindowResize"),t.prototype),n(t.prototype,"_onCameraChanged",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onCameraChanged"),t.prototype),t);d.a=o}).call(this,y(2).bind)},function(e,P,T){"use strict";(function(e){var t,i=T(13),_=T(108),g=T(11),b=T(368),h=T(14),s=T(325),c=T(0);function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function u(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function l(e,t,n){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var o,r,d,y,v,m,w={bodyDistance:8,fixedBodyDistance:15,sphereBodyDistance:5},O={minIntersectionCheck:20,areaSubdivideThreshold:100,areaSubdivideSafeThreshold:5},x=new THREE.Triangle,k=(new THREE.Quaternion).setFromAxisAngle(new THREE.Vector3(1,0,0),1.5*Math.PI),E=(o=(t=function(e){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=u(this,f(n).call(this,e)))._bodies=[],t._faceBodies=[],t._fixedBodies=[],t._sphereBodies=[],t._instancedEntities=[],t.nonInstances=[],t._sphereMath=new THREE.Sphere(new THREE.Vector3,4),t._init(),t}var t,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(n,i["a"]),t=n,(o=[{key:"destroy",value:function(){l(f(n.prototype),"destroy",this).call(this)}},{key:"update",value:function(e,t){var n=this._charBody;n&&(this._sphereMath.center.copy(n.position),this._updateFaceBodies(),this._updateSphereBodies())}},{key:"_init",value:function(){this._initInstances(),this._initNonInstances(),this._initNavMesh(),this._initPoints(),this._initCollisionGround(),this._initCollisionSphere()}},{key:"_initInstances",value:function(){var e=this._gltf.getObject("terrain","instances");if(e)for(var t=e.children,n=0,o=t.length;n<o;n++){for(var r=t[n].name,i=this._gltf.getObject("terrain","".concat(r,"_base")),a=this._gltf.getObject("terrain","".concat(r,"_instances")).children,s=i.geometry,u=a.length,c=[],l=[],f=[],p=[],h=0;h<u;h++){var d=a[h];c.push(new THREE.Vector4(d.position.x,d.position.y,d.position.z,1)),l.push(new THREE.Vector3(d.scale.x,d.scale.z,d.scale.y)),f.push(d.quaternion.multiply(k)),p.push(d.userData.custom||0)}var y={name:r,instanced:!0};void 0!==s.attributes.color&&(y.useVertexColors=!0);var v={name:r,geometry:s,material:new g.a(y),nb:u,positions:c,scales:l,orientations:f,customs:p},m=r.match(/cog/i)?new b.a(this._scene,v):new _.a(this._scene,v);this.add(m),this._instancedEntities.push(m)}}},{key:"_initNonInstances",value:function(){var e=this._gltf.getObject("terrain","non_instances");if(e)for(var t=e.children,n=t.length;n--;){var o=t[n];if(o.isMesh){var r=new g.a({name:o.name.toLowerCase(),useVertexColors:!!o.geometry.attributes.color});o.material=r}else o.traverse(function(e){e.isMesh&&(e.material=new g.a({name:e.name.toLowerCase(),useVertexColors:!!e.geometry.attributes.color}))});o.castShadow=!0,o.receiveShadow=!0,this.nonInstances.push(o),this.add(o)}}},{key:"_initNavMesh",value:function(){var e=this._gltf.getObject("terrain","nav_mesh");e&&(e.visible=!1,this.add(e),this._scene.navMeshes.push(e))}},{key:"_initPoints",value:function(){var t=this,e=this._gltf.getObject("terrain","points");e&&(this.points={},e.traverse(function(e){t.points[e.name]=e}))}},{key:"_initCollisionGround",value:function(){var e=this._gltf.getObject("terrain","collision_ground");if(e){e.visible=!1,this.add(e),this._scene.navMeshes.push(e);var t=new THREE.Geometry;t.fromBufferGeometry(e.geometry);for(var n=t.faces,o=t.vertices,r=0,i=n.length;r<i;r++){var a=n[r],s=[a.a,a.b,a.c],u=[o[a.a],o[a.b],o[a.c]];x.set(u[0],u[1],u[2]),x.getArea()>O.areaSubdivideThreshold||x.getArea()<O.areaSubdivideThreshold&&O.areaSubdivideThreshold-x.getArea()<O.areaSubdivideSafeThreshold?this._subdivideFace(u,[0,1,2]):this._createFaceBody(o,s,x.getArea())}t.dispose()}}},{key:"_initCollisionSphere",value:function(){var e=this._gltf.getObject("terrain","collision_sphere");if(e){e.traverse(function(e){e.visible=!1}),e.visible=!1,this.add(e);for(var t=e.children,n=0,o=t.length;n<o;n++){var r=t[n];r.geometry.computeBoundingSphere();var i=r.geometry.boundingSphere.radius,a=new CANNON.Body({mass:0,shape:new CANNON.Sphere(i),material:this._pMaterials.ground,angularDamping:0,linearDamping:0,collisionFilterGroup:this._physics.group.terrain});a.position.copy(r.position),a.quaternion.copy(r.quaternion),a.added=!1,a.name=r.name,a.radius=i,this._bodies.push(a),this._sphereBodies.push(a),this._scene.navMeshes.push(r)}}}},{key:"_initCollisionObjects",value:function(){var e=this._gltf.getObject("terrain","collision_objects"),t=[];e.traverse(function(e){e.geometry&&t.push(e)});for(var n=0,o=t.length;n<o;n++){var r=t[n],i=r.geometry;i.computeBoundingBox();var a=i.boundingBox,s=h.a.pool.get();a.getSize(s);var u=new CANNON.Body({mass:0,shape:new CANNON.Box(new CANNON.Vec3(.5*s.x*r.scale.x,.5*s.y*r.scale.y,.5*s.z*r.scale.z)),material:this._pMaterials.rock});u.position.copy(r.position),u.quaternion.copy(r.quaternion),u.added=!0,u.distancePos=u.position,u.name=r.name,u.entityType="box",u.verticesPos=[];var c=(new THREE.Geometry).fromBufferGeometry(i);r.updateMatrix(),c.applyMatrix(r.matrix);for(var l=c.vertices,f=0,p=l.length;f<p;f+=3)u.verticesPos.push(l[f].clone());this._bodies.push(u),this._sphereBodies.push(u),this._world.add(u),c.dispose(),s.release(),this._scene.navMeshes.push(r),r.visible=!1,this.add(r)}}},{key:"_createFaceBody",value:function(e){for(var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[0,1,2],n=2<arguments.length?arguments[2]:void 0,o=[],r=0,i=t.length;r<i;r++){var a=e[t[r]];o.push((new CANNON.Vec3).copy(a))}var s=new CANNON.ConvexPolyhedron(o,[[0,1,2]]),u=new CANNON.Body({mass:0,shape:s,material:this._pMaterials.ground,collisionFilterGroup:this._physics.group.terrain}),c=new CANNON.Vec3;c.x=(o[0].x+o[1].x+o[2].x)/3,c.y=(o[0].y+o[1].y+o[2].y)/3,c.z=(o[0].z+o[1].z+o[2].z)/3,u.facePos=c,u.vertices=o,u.position.copy(this.position),u.added=!1,u.entityType="face",u.area=n,this._faceBodies.push(u),this._bodies.push(u)}},{key:"_subdivideFace",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,o=h.a.pool.get();x.getMidpoint(o);for(var r=[[e[t[0]],e[t[1]],o],[e[t[0]],o,e[t[2]]],[e[t[1]],e[t[2]],o]],i=0,a=r.length;i<a;i++)x.set(e[t[0]],e[t[1]],e[t[2]]),x.getArea()>O.areaSubdivideThreshold||x.getArea()<O.areaSubdivideThreshold&&O.areaSubdivideThreshold-x.getArea()<O.areaSubdivideSafeThreshold?this._subdivideFace(r[i],t,n++):this._createFaceBody(r[i],t,x.getArea());o.release()}},{key:"_updateFaceBodies",value:function(){for(var e=this._charBody,t=0,n=this._faceBodies.length;t<n;t++){var o=this._faceBodies[t],r=o.facePos,i=o.vertices,a=Object(c.b)(e.position.x,e.position.z,r.x,r.z)<O.minIntersectionCheck&&Object(s.a)(this._sphereMath,i[0],i[1],i[2]);a&&!o.added?(this.addBody(o),o.added=!0):!a&&o.added&&(this.removeBody(o),o.added=!1)}}},{key:"_updateFixedBodies",value:function(){for(var e=this._charBody,t=0,n=this._fixedBodies.length;t<n;t++){for(var o=this._fixedBodies[t],r=!1,i=o.verticesPos,a=0,s=i.length;a<s;a++){var u=i[a];if(r=Object(c.b)(e.position.x,e.position.z,u.x,u.z)<w.fixedBodyDistance)break}r&&!o.added?(this.addBody(o),o.added=!0):!r&&o.added&&(this.removeBody(o),o.added=!1)}}},{key:"_updateSphereBodies",value:function(){for(var e=this._charBody,t=this._sphereBodies,n=0,o=t.length;n<o;n++){var r=t[n],i=r.position,a=Object(c.b)(e.position.x,e.position.z,i.x,i.z)<w.sphereBodyDistance+r.radius;a&&!r.added?(this.addBody(r),r.added=!0):!a&&r.added&&(this.removeBody(r),r.added=!1)}}}])&&a(t.prototype,o),r&&a(t,r),n}()).prototype,r="update",d=[e],y=Object.getOwnPropertyDescriptor(t.prototype,"update"),v=t.prototype,m={},Object.keys(y).forEach(function(e){m[e]=y[e]}),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=d.slice().reverse().reduce(function(e,t){return t(o,r,e)||e},m),v&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(v):void 0,m.initializer=void 0),void 0===m.initializer&&(Object.defineProperty(o,r,m),m=null),t);P.a=E}).call(this,T(2).bind)},function(e,t,n){"use strict";var r=n(13),v=n(109);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function m(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var s=function(e){function y(e,t){var n,o=t.name,r=void 0===o?"":o,i=t.geometry,a=t.material,s=t.nb,u=void 0===s?0:s,c=t.positions,l=t.scales,f=t.orientations,p=t.customs,h=t.customDepthMaterial,d=t.customNormalMaterial;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,y),(n=m(this,_(y).call(this,e))).name=r,n._geometry=i,n._material=a,n._instanceNb=u,n._positions=c||n._scaffold("positions"),n._scales=l||n._scaffold("scales"),n._orientations=f||n._scaffold("orientations"),n._customs=p||n._scaffold("customs"),n._geometry.isInstancedBufferGeometry=!0,n._geometry.maxInstancedCount=n._instanceNb,n._geometry.computeBoundingBox(),n._bbox=n._geometry.boundingBox,n._bboxSize=new THREE.Vector3,n._geometry.boundingBox.getSize(n._bboxSize),n._mesh=new THREE.Mesh(i,a),n._mesh.name=r,n._mesh.customDepthMaterial=h||new v.a({name:r}),n._mesh.castShadow=!0,n._mesh.receiveShadow=!0,n._mesh.frustumCulled=!1,d&&(n._mesh.customNormalMaterial=d),n.add(n._mesh),n._init(),n}var t,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(y,r["a"]),t=y,(n=[{key:"_scaffold",value:function(e){var t,n=[];switch(e){case"positions":t=new THREE.Vector4(0,0,0,1);break;case"scales":t=new THREE.Vector3(1,1,1);break;case"orientations":t=new THREE.Quaternion;break;case"customs":t=0}for(var o=0,r=this._instanceNb;o<r;o++){var i="function"==typeof t.clone?t.clone():t;n.push(i)}return n}},{key:"_init",value:function(){for(var e=new THREE.InstancedBufferAttribute(new Float32Array(this._instanceNb),1,!0),t=0,n=e.count;t<n;t++)e.setX(t,t);this._geometry.addAttribute("id",e);var o=new THREE.InstancedBufferAttribute(new Float32Array(4*this._instanceNb),4,!0);o.copyVector4sArray(this._positions),this._geometry.addAttribute("instancePosition",o);var r=new THREE.InstancedBufferAttribute(new Float32Array(3*this._instanceNb),3,!0);r.copyVector3sArray(this._scales),this._geometry.addAttribute("instanceScale",r);var i=new THREE.InstancedBufferAttribute(new Float32Array(4*this._instanceNb),4,!0);i.copyVector4sArray(this._orientations),this._geometry.addAttribute("instanceOrientation",i);var a=new THREE.InstancedBufferAttribute(new Float32Array(this._instanceNb),1,!0);a.copyArray(this._customs),this._geometry.addAttribute("instanceCustom",a)}},{key:"nb",get:function(){return this._instanceNb}},{key:"positions",get:function(){return this._positions}},{key:"scales",get:function(){return this._scales}},{key:"orientations",get:function(){return this._orientations}},{key:"customs",get:function(){return this._customs}},{key:"bbox",get:function(){return this._bbox}}])&&i(t.prototype,n),o&&i(t,o),y}();t.a=s},function(e,t,n){"use strict";var o=n(22),r=n(324),i=n.n(r);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(e){u(t,e,n[e])})}return t}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var p=function(e){function r(){var e,t,n,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),t=this,(e=!(n=c(r).call(this,s({vertexShader:i.a,fragmentShader:THREE.ShaderChunk.depth_frag},o)))||"object"!==a(n)&&"function"!=typeof n?f(t):n)._scene.materialCtrl.add(f(f(e))),e.uniforms=s({},e.uniforms,THREE.UniformsUtils.clone(THREE.ShaderLib.depth.uniforms)),e.defines=s({},e.defines,{USE_INSTANCES:!0,DEPTH_PACKING:THREE.RGBADepthPacking}),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(r,o["a"]),r}();t.a=p},function(e,t,n){"use strict";var o=n(328),i=n.n(o),a=n(75),s=n(36);function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var m={mapsWhitelist:["diffuseMap","normalMap"]},p=function(e){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=c(this,l(n).call(this,e)))._materials=[],t._config=s.a[e.name],t._defaultConfig=i()(t._config),t}var t,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(n,a["a"]),t=n,(o=[{key:"init",value:function(){var e=this._config.common;for(var t in e){var n=e[t];"background"===t?this._scene.background=new THREE.Color(n):this.setAllProperties(t,n)}var o=this._config.objects;for(var r in o)for(var i=o[r],a=this._materials,s=0,u=a.length;s<u;s++){var c=a[s];if(c.name===r)for(var l in i){var f=i[l];if(-1!==m.mapsWhitelist.indexOf(l)){var p=f.split("."),h=p[0],d=p[1],y=l.replace(/map/gi,""),v=this._textures.get("".concat(h,".").concat(d,".").concat(y),{wrapping:THREE.RepeatWrapping});v.name=f,c[l]=v}else void 0!==f&&(c[l]=f)}}}},{key:"add",value:function(e){this._materials.push(e)}},{key:"get",value:function(e){for(var t=[],n=this._materials,o=0,r=n.length;o<r;o++){var i=n[o];i.name===e&&t.push(i)}return t}},{key:"setAllProperties",value:function(e,t){for(var n=this._materials,o=0,r=n.length;o<r;o++){n[o][e]=t}}},{key:"setAllUniforms",value:function(e,t){for(var n=this._materials,o=0,r=n.length;o<r;o++){var i=n[o];i.uniforms[e]&&(i.uniforms[e].value=t)}}},{key:"setAllUniformsComponent",value:function(e,t,n){for(var o=this._materials,r=0,i=o.length;r<i;r++){var a=o[r];a.uniforms[e]&&(a.uniforms[e].value[t]=n)}}},{key:"update",value:function(e,t){for(var n=this._materials,o=0,r=n.length;o<r;o++){n[o].update(e,t)}}},{key:"destroy",value:function(){this._materials=this._config=this._defaultConfig=null}},{key:"defaultConfig",get:function(){return this._defaultConfig}},{key:"materials",get:function(){return this._materials}}])&&u(t.prototype,o),r&&u(t,r),n}();t.a=p},function(e,g,b){"use strict";(function(e){var t,r=b(13),l=b(0),c=b(340),f=b(11),p=b(14),n=(b(23),b(41)),i=b.n(n);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function h(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function s(e,t,n){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var v=0,m=null,_=(u((t=function(e){function u(e,t,n,o,r,i){var a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(a=h(this,d(u).call(this,e)))._canHit=!1,a.isHiting=!1,a._config=function(r){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},t=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),t.forEach(function(e){var t,n,o;t=r,o=i[n=e],n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o})}return r}({},o),a._hitLookAtY=1.5,a._coneRotSpeed=1,a._baseConeRotAmp=a._coneRotAmp=3,a._ctrl=t,a._path=n,a._bones={},a._lookAtPos=new THREE.Vector3,a._radius=i||20,a._height=r||7.5,a._progress=a._config.baseProgress,a._speed=a._config.speed,a._group=new THREE.Object3D,a._friction=1,a.add(a._group);var s=Object(c.a)(n.points,3).map(function(e){return(new THREE.Vector3).fromArray(e)});return a._curve=new THREE.CatmullRomCurve3(s,!0),m||(m=new THREE.PlaneBufferGeometry(1,1,1,1)).addAttribute("uv2",new THREE.BufferAttribute(m.attributes.uv.array,2)),a._shadow=new THREE.Mesh(m,new f.a({name:"robot_shadow",transparent:!0,opacity:.25,useShadowMap:!1,diffuse:0,diffuseMap:a._textures.get("level-2.shadow")})),a._shadow.noOutlines=!0,a._shadow.rotation.x=-Math.PI/2,a._shadow.position.y=.01+Object(l.h)(0,.01,3),a.add(a._shadow),a._create(),a._createHelper(),setTimeout(function(){a._canHit=!0},2e3),v++,a}var t,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(u,r["a"]),t=u,(n=[{key:"reset",value:function(){this._lookTween&&this._lookTween.kill(),this._friction=1,this._progress=this._config.baseProgress,TweenMax.set(this,{_coneRotAmp:this._baseConeRotAmp}),this.isHiting=!1,this._canHit=!0}},{key:"destroy",value:function(){s(d(u.prototype),"destroy",this).call(this),clearTimeout(this._initFriction),clearTimeout(this._playTimeout),this._unbind(),this._sound&&this._sound.destroy()}},{key:"update",value:function(e,t){this.isHiting||(this._progress=Object(l.f)(this._progress+3e-5*e*this._speed,1));var n=Object(l.f)(this._progress+.01,1),o=this._scene.character.position;if(this._curve.getPointAt(this._progress,this.position),this._cone.position.copy(this._cone.basePosition),this.isHiting){var r=p.a.pool.get().copy(o);r.y+=this._hitLookAtY,this._lookTween=TweenMax.to(this._lookAtPos,.5,{x:o.x,z:o.z}),r.release()}else this._curve.getPointAt(n,this._lookAtPos),this._cone.rotation.y=.05*Math.sin(.0024*t*this._coneRotSpeed+.34123)*this._coneRotAmp,this._cone.rotation.z=(this._cone.rotation.z+.001*e)%(2*Math.PI);if(this.lookAt(this._lookAtPos),this.syncBody(this),this.body.position.y+=this.body.offsetY,!this.isHiting){var i=p.a.pool.get(),a=p.a.pool.get(),s=p.a.pool.get();a.copy(o),a.y-=1.5,this._cone.getWorldDirection(s),this._cone.getWorldPosition(this._cone.worldPos);var u=Object(l.c)(a,this._cone.worldPos,s,this._height,this._radius);i.release(),a.release(),s.release();var c=Object(l.b)(this.body.position.x,this.body.position.z,o.x,o.z);c<4?this.body.added||(this.body.added=!0,this.addBody()):this.body.added&&(this.body.added=!1,this.removeBody()),this._canHit&&(u&&c<this._height||c<3.5)&&this._hit(),this._sound&&this._updateSound()}}},{key:"_bind",value:function(){this._signals.pause.shown.add(this._onPauseShow),this._signals.pause.hidden.add(this._onPauseHide)}},{key:"_unbind",value:function(){this._signals.pause.shown.remove(this._onPauseShow),this._signals.pause.hidden.remove(this._onPauseHide)}},{key:"_initBones",value:function(){for(var e in this._bones){var t=this._bones[e];t.baseRot=t.rotation.clone(),t.offset={x:Object(l.h)(-100,100),y:Object(l.h)(-100,100),z:Object(l.h)(-100,100)}}}},{key:"_initCone",value:function(e,t){var n=new THREE.Mesh(e,t);n.position.z=.5*this._height,this._cone=new THREE.Object3D,this._cone.worldPos=new THREE.Vector3,this._cone.add(n),this.add(this._cone),this._coneTargetObj=new THREE.Object3D,this._cone.add(this._coneTargetObj),this._coneTargetObj.position.z=1,this._coneTargetObj.worldPos=new THREE.Vector3}},{key:"_hit",value:function(){this._friction=.07,this.isHiting=!0,TweenMax.to(this,.5,{_coneRotAmp:0}),TweenMax.to(this._cone.rotation,.5,{x:0}),this._ctrl.robotHit(this)}},{key:"_create",value:function(){var e=this;this._sound=this._sounds.clone("robot"),this._sound.currentTime=Object(l.h)(0,this._sound.duration),this._playTimeout=setTimeout(function(){e._sound.play()},4e3),this._pan=this._sound.effects.add(i()({maxDistance:27})),this._bind()}},{key:"_createHelper",value:function(){var e=this._curve.getPoints(50),t=(new THREE.BufferGeometry).setFromPoints(e),n=new THREE.LineBasicMaterial({color:16711680}),o=new THREE.Line(t,n);o.name="CurveHelper",o.visible=!1,this._scene.add(o)}},{key:"_createDebugGUI",value:function(){this._guiFolder=this._gui.addFolder("".concat(this._type," - ").concat(v)),this._guiFolder.add(this,"_speed",0,5,.001).name("speed"),this._guiFolder.add(this,"_progress",0,1,.01).name("progress");var e=this._guiFolder.addFolder("cone");if(e.add(this._cone.basePosition,"x",-1,1,.001),e.add(this._cone.basePosition,"y",-3,10,.001),e.add(this._cone.basePosition,"z",-3,3,.001),this._bones)for(var t in this._bones){var n=this._bones[t],o=this._guiFolder.addFolder(t);o.add(n.baseRot,"x",-Math.PI,Math.PI,.001),o.add(n.baseRot,"y",-Math.PI,Math.PI,.001),o.add(n.baseRot,"z",-Math.PI,Math.PI,.001)}}},{key:"_createTls",value:function(){}},{key:"_updateSound",value:function(){var e=p.a.pool.get();e.set(0,0,-1),e.applyQuaternion(this.quaternion),this._pan.setPosition(this.position),this._pan.setOrientation(e.normalize()),e.release();var t=p.a.pool.get();t.set(0,0,-1),t.applyQuaternion(this._scene.camera.quaternion),this._pan.setListenerPosition(this._scene.camera.position),this._pan.setListenerOrientation(t.normalize()),t.release()}},{key:"_onPauseShow",value:function(){this._sound.volume=0}},{key:"_onPauseHide",value:function(){this._sound.volume=1}}])&&a(t.prototype,n),o&&a(t,o),u}()).prototype,"_onPauseShow",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onPauseShow"),t.prototype),u(t.prototype,"_onPauseHide",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onPauseHide"),t.prototype),t);g.a=_}).call(this,b(2).bind)},function(e,f,p){"use strict";(function(e){var t,i=p(12);function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function s(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function u(e,t,n){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var r=(o((t=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),s(this,c(t).apply(this,arguments))}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(t,i["a"]),n=t,(o=[{key:"init",value:function(){this.$name="subtitles"}},{key:"mounted",value:function(){u(c(t.prototype),"mounted",this).call(this),this._bind()}},{key:"data",value:function(){return function(r){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},t=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),t.forEach(function(e){var t,n,o;t=r,o=i[n=e],n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o})}return r}({},u(c(t.prototype),"data",this),{pageName:this._router.currentRoute.name})}},{key:"beforeDestroy",value:function(){this._unbind()}},{key:"_createTls",value:function(){}},{key:"_bind",value:function(){this._signals.subtitles.add.add(this._onSubtitleAdd),this._signals.subtitles.remove.add(this._onSubtitleRemove)}},{key:"_unbind",value:function(){this._signals.subtitles.add.remove(this._onSubtitleAdd),this._signals.subtitles.remove.remove(this._onSubtitleRemove)}},{key:"_onSubtitleAdd",value:function(e){this.$el.classList.add("subtitles--is-visible"),this.$els.text.innerHTML=e}},{key:"_onSubtitleRemove",value:function(){this.$el.classList.remove("subtitles--is-visible")}},{key:"template",get:function(){return p(564)}},{key:"components",get:function(){return{}}}])&&a(n.prototype,o),r&&a(n,r),t}()).prototype,"_onSubtitleAdd",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onSubtitleAdd"),t.prototype),o(t.prototype,"_onSubtitleRemove",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onSubtitleRemove"),t.prototype),t);f.a=r}).call(this,p(2).bind)},function(e,t,n){var o;"undefined"!=typeof self&&self,o=function(){return function(n){var o={};function r(e){if(o[e])return o[e].exports;var t=o[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,r),t.l=!0,t.exports}return r.m=n,r.c=o,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=5)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(!isNaN(e))return e;var t=e.match(/^(?:(\d{2,}):)?(\d{2}):(\d{2})[,.](\d{3})$/);if(!t)throw new Error('Invalid SRT or VTT time format: "'+e+'"');var n=t[1]?36e5*parseInt(t[1],10):0,o=6e4*parseInt(t[2],10),r=1e3*parseInt(t[3],10),i=parseInt(t[4],10);return n+o+r+i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(isNaN(e))return e;var t=new Date(0,0,0,0,0,0,e),n=(0,a.default)(2,t.getHours()),o=(0,a.default)(2,t.getMinutes()),r=(0,a.default)(2,t.getSeconds()),i=e-(36e5*n+6e4*o+1e3*r);return n+":"+o+":"+r+","+(0,a.default)(3,i)};var o,r=n(2),a=(o=r)&&o.__esModule?o:{default:o}},function(e,t){e.exports=function n(o,e,t){return void 0===e?function(e,t){return n(o,e,t)}:(void 0===t&&(t="0"),0<(o-=e.toString().length)?new Array(o+(/\./.test(e)?2:1)).join(t)+e:e+"")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(isNaN(e))return e;var t=new Date(0,0,0,0,0,0,e),n=(0,a.default)(2,t.getHours()),o=(0,a.default)(2,t.getMinutes()),r=(0,a.default)(2,t.getSeconds()),i=e-(36e5*n+6e4*o+1e3*r);return n+":"+o+":"+r+"."+(0,a.default)(3,i)};var o,r=n(2),a=(o=r)&&o.__esModule?o:{default:o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=a.exec(e),n={start:(0,i.default)(t[1]),end:(0,i.default)(t[2])};t[3]&&(n.settings=t[3]);return n};var o,r=n(0),i=(o=r)&&o.__esModule?o:{default:o};var a=/^((?:\d{2,}:)?\d{2}:\d{2}[,.]\d{3}) --> ((?:\d{2,}:)?\d{2}:\d{2}[,.]\d{3})(?: (.*))?$/},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(0);Object.defineProperty(t,"toMS",{enumerable:!0,get:function(){return f(o).default}});var r=n(1);Object.defineProperty(t,"toSrtTime",{enumerable:!0,get:function(){return f(r).default}});var i=n(3);Object.defineProperty(t,"toVttTime",{enumerable:!0,get:function(){return f(i).default}});var a=n(6);Object.defineProperty(t,"parse",{enumerable:!0,get:function(){return f(a).default}});var s=n(7);Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return f(s).default}});var u=n(8);Object.defineProperty(t,"stringifyVtt",{enumerable:!0,get:function(){return f(u).default}});var c=n(9);Object.defineProperty(t,"resync",{enumerable:!0,get:function(){return f(c).default}});var l=n(4);function f(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"parseTimestamps",{enumerable:!0,get:function(){return f(l).default}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(!e)return[];var r=e.trim().concat("\n").replace(/\r\n/g,"\n").replace(/\n{3,}/g,"\n\n").replace(/^WEBVTT.*\n(?:.*: .*\n)*\n/,"").split("\n");return r.reduce(function(e,t,n){var o=e[e.length-1];return!o.index&&/^\d+$/.test(t)?o.index=parseInt(t,10):o.hasOwnProperty("start")?""===t?(delete o.index,n!==r.length-1&&e.push({})):o.text=o.text?o.text+"\n"+t:t:Object.assign(o,(0,i.default)(t)),e},[{}])};var o,r=n(4),i=(o=r)&&o.__esModule?o:{default:o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.map(function(e,t){return(0<t?"\n":"")+[t+1,(0,i.default)(e.start)+" --\x3e "+(0,i.default)(e.end),e.text].join("\n")}).join("\n")+"\n"};var o,r=n(1),i=(o=r)&&o.__esModule?o:{default:o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return"WEBVTT\n\n"+e.map(function(e,t){return(0<t?"\n":"")+[t+1,(0,i.default)(e.start)+" --\x3e "+(0,i.default)(e.end)+(e.settings?" "+e.settings:""),e.text].join("\n")}).join("\n")+"\n"};var o,r=n(3),i=(o=r)&&o.__esModule?o:{default:o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,o){return e.map(function(e){var t=(0,i.default)(e.start)+o,n=(0,i.default)(e.end)+o;return Object.assign({},e,{start:t,end:n})})};var o,r=n(0),i=(o=r)&&o.__esModule?o:{default:o}}])},e.exports=o()},function(e,t,n){"use strict";var i=n(54),a=n(359),s=n(360),u=n(361),c=n(362),l=n(117);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function p(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function h(e,t,n){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var r=function(e){function r(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(e=p(this,d(r).apply(this,arguments))).sceneName=null,e}var t,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(r,i["a"]),t=r,(n=[{key:"ready",value:function(){h(d(r.prototype),"ready",this).call(this),this.sceneName&&(this._switchScene(this.sceneName),this._appEl=document.body.querySelector("#application"),this._appEl.classList.add("cursor-grab"))}},{key:"getDependencies",value:function(e){var t=h(d(r.prototype),"getDependencies",this).call(this),n=this._textures.format,o=this.sceneName;return t.push(o),l.a[o].needsTextures&&t.push("".concat(o,"-textures-default-").concat(n)),t}},{key:"components",get:function(){return{Pause:a.a,PauseBtn:s.a,DeathOverlay:u.a,KeyCounter:c.a}}}])&&f(t.prototype,n),o&&f(t,o),r}();t.a=r},function(e,t,i){"use strict";var a=i(12);function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function u(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function c(e,t,n){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var o=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),u(this,l(t).apply(this,arguments))}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,a["a"]),n=t,(o=[{key:"init",value:function(){this.$name="credits"}},{key:"mounted",value:function(){c(l(t.prototype),"mounted",this).call(this)}},{key:"beforeDestroy",value:function(){c(l(t.prototype),"beforeDestroy",this).call(this),this._unbind()}},{key:"_bind",value:function(){}},{key:"_unbind",value:function(){}},{key:"template",get:function(){return i(567)}},{key:"components",get:function(){return{}}}])&&s(n.prototype,o),r&&s(n,r),t}();t.a=o},function(e,t,i){"use strict";var a=i(12);function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function u(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function c(e,t,n){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var o=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),u(this,l(t).apply(this,arguments))}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,a["a"]),n=t,(o=[{key:"init",value:function(){this.$name="xmas-love"}},{key:"mounted",value:function(){c(l(t.prototype),"mounted",this).call(this)}},{key:"beforeDestroy",value:function(){c(l(t.prototype),"beforeDestroy",this).call(this),this._unbind()}},{key:"_bind",value:function(){}},{key:"_unbind",value:function(){}},{key:"template",get:function(){return i(568)}},{key:"components",get:function(){return{}}}])&&s(n.prototype,o),r&&s(n,r),t}();t.a=o},function(e,t,n){"use strict";var i=n(55),a=n(52),s=n(13),u=n(1);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function l(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function f(e,t,n){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d=function(e){function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=l(this,p(o).call(this,e)))._options=t,n.position.z=-100,n._init(),n._bind(),n}var t,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(o,s["a"]),t=o,(n=[{key:"destroy",value:function(){f(p(o.prototype),"destroy",this).call(this)}},{key:"setSize",value:function(){var e=u.a.aspect,t=this._scene.camera,n=2*Math.abs(this.position.z-t.position.z)*Math.tan(.5*t.fov*(Math.PI/180)),o=n*e;this.mesh.scale.x=1.3*o,this.mesh.scale.y=1.3*n}},{key:"update",value:function(e,t){}},{key:"_bind",value:function(){}},{key:"_unbind",value:function(){}},{key:"_init",value:function(){this.geometry=new THREE.PlaneBufferGeometry(1,1,1,1),this.material=new THREE.MeshBasicMaterial({color:new THREE.Color(this._options.color)}),this.mesh=new THREE.Mesh(this.geometry,this.material),this.add(this.mesh)}}])&&c(t.prototype,n),r&&c(t,r),o}();function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function v(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function m(e,t,n){return(m="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var b=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=v(this,_(t).call(this,"white",{physics:!1,postProcessing:!1})))._progress=0,e}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(t,i["a"]),n=t,(o=[{key:"destroy",value:function(){return m(_(t.prototype),"destroy",this).call(this)}},{key:"setSize",value:function(e,t){this.background.setSize(e,t)}},{key:"_createPostProcessing",value:function(){m(_(t.prototype),"_createPostProcessing",this).call(this)}},{key:"_createCameras",value:function(){this._gameCamera=new a.a({isDefault:!0}),this.addCamera(this._gameCamera)}},{key:"_createEntities",value:function(){this.background=new d(this,{color:16777215}),this.addEntity(this.background)}},{key:"_afterCreate",value:function(){m(_(t.prototype),"_afterCreate",this).call(this),this._signals.scene.changed.dispatch(this,this.camera)}},{key:"_onUpdate",value:function(e,t){}}])&&y(n.prototype,o),r&&y(n,r),t}(),w=n(309);function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function x(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function k(e,t){return!t||"object"!==O(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function E(e,t,n){return(E="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=P(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function P(e){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function T(e,t){return(T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var S=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),k(this,P(t).call(this,"outro",{physics:!1,postProcessing:!0}))}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&T(e,t)}(t,i["a"]),n=t,(o=[{key:"setSize",value:function(e,t){this.background.setSize(e,t)}},{key:"_init",value:function(){E(P(t.prototype),"_init",this).call(this),document.title="Outro - Plume and the forgotten letter | WebGL game"}},{key:"_createCameras",value:function(){this._gameCamera=new a.a({isDefault:!0}),this.addCamera(this._gameCamera)}},{key:"_createPostProcessing",value:function(){E(P(t.prototype),"_createPostProcessing",this).call(this)}},{key:"_createEntities",value:function(){this.background=new d(this,{color:1064249}),this.addEntity(this.background)}},{key:"_afterCreate",value:function(){E(P(t.prototype),"_afterCreate",this).call(this),this._signals.scene.changed.dispatch(this,this.camera)}},{key:"_onUpdate",value:function(e,t){}}])&&x(n.prototype,o),r&&x(n,r),t}(),j=n(329),C=n(333),R=n(337),M=n(342),A=n(40),L=n(11);n(26);function D(e){return(D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function z(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function H(e,t){return!t||"object"!==D(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function I(e,t,n){return(I="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=F(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function F(e){return(F=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function N(e,t){return(N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var U=function(e){function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),H(this,F(i).call(this,"level-4",{physics:!0,postProcessing:!0}))}var t,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&N(e,t)}(i,A["a"]),t=i,(n=[{key:"_init",value:function(){I(F(i.prototype),"_init",this).call(this),this._doorIsOpenning=!1,this._resetData={spawn:{charPos:new THREE.Vector3(0,2.62,24.8),charDir:0,camDir:1.57,camPanY:.99}},document.title="Outro - Plume and the forgotten letter | WebGL game"}},{key:"_createCameras",value:function(){I(F(i.prototype),"_createCameras",this).call(this),this._gameCamera.radius=6}},{key:"_createPostProcessing",value:function(){I(F(i.prototype),"_createPostProcessing",this).call(this)}},{key:"_createEntities",value:function(){I(F(i.prototype),"_createEntities",this).call(this);for(var e=new L.a({name:"door"}),t=this._gltf.getObject("terrain","props").children,n=t.length;n--;){var o=t[n],r=o.name;"door_left"===r&&(this._doorLeft=o),"door_right"===r&&(this._doorRight=o),"door_left"!==r&&"door_right"!==r||(o.material=e,this.add(o))}}},{key:"_createAudios",value:function(){I(F(i.prototype),"_createAudios",this).call(this,!1)}},{key:"_afterCreate",value:function(){var e=this;I(F(i.prototype),"_afterCreate",this).call(this),setTimeout(function(){e._sounds.play("where_is_santa")},1300)}},{key:"_openDoor",value:function(){var e=this;this._signals.konami.completed.dispatch(),this._doorIsOpenning=!0,TweenMax.to(this._doorLeft.rotation,3.5,{z:-1.8,ease:Expo.easeOut}),TweenMax.to(this._doorRight.rotation,3.5,{z:1.8,ease:Expo.easeOut,delay:.2}),this._sounds.play("chest"),setTimeout(function(){e._sounds.play("door")},100),setTimeout(function(){e._sounds.play("fragment")},200),setTimeout(function(){e._sounds.play("woosh"),e._sounds.play("long-woosh")},1500),this._signals.postPass.burnAnimation.dispatch(1.2,2,function(){setTimeout(function(){e._router.navigate("/outro")},500)})}},{key:"_onUpdate",value:function(e,t){!this._doorIsOpenning&&this.character.position.z<5&&this._openDoor()}}])&&z(t.prototype,n),o&&z(t,o),i}();t.a={white:b,home:w.a,outro:S,lobby:j.a,"level-1":C.a,"level-2":R.a,"level-3":M.a,"level-4":U}},,,,function(n,o,u){(function(s){var t;!function(e){"use strict";void 0===(t=function(e){var t,n="undefined"!=typeof setTimeout&&setTimeout,o=function(e,t){return setTimeout(e,t)},r=function(e){return clearTimeout(e)},i=function(e){return n(e,0)};if(void 0!==s&&"[object process]"===Object.prototype.toString.call(s))i=function(e){return s.nextTick(e)};else if(t="undefined"!=typeof MutationObserver&&MutationObserver||"undefined"!=typeof WebKitMutationObserver&&WebKitMutationObserver)i=function(e){var t,n=document.createTextNode("");new e(function(){var e=t;t=void 0,e()}).observe(n,{characterData:!0});var o=0;return function(e){t=e,n.data=o^=1}}(t);else if(!n){var a=u(430);o=function(e,t){return a.setTimer(t,e)},r=a.cancelTimer,i=a.runOnLoop||a.runOnContext}return{setTimer:o,clearTimer:r,asap:i}}.call(o,u,o,n))||(n.exports=t)}(u(25))}).call(this,u(83))},function(e,t,n){var r=n(71);e.exports=function(e,t){if(!r(e))return e;var n,o;if(t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;if("function"==typeof(n=e.valueOf)&&!r(o=n.call(e)))return o;if(!t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){e.exports=!n(125)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){"use strict";t.__esModule=!0;var o,r=n(86),i=(o=r)&&o.__esModule?o:{default:o};var a=function(){function t(e){var n=this;(0,i.default)(this,t),this.context=e,this._destination=null,this._source=null,this._nodes=[],this._nodes.has=function(e){return n.has(e)},this._nodes.add=function(e){return n.add(e)},this._nodes.remove=function(e){return n.remove(e)},this._nodes.toggle=function(e,t){return n.toggle(e,t)},this._nodes.removeAll=function(){return n.removeAll()},Object.keys(t.prototype).forEach(function(e){n._nodes.hasOwnProperty(e)||"function"!=typeof t.prototype[e]||(n._nodes[e]=n[e].bind(n))})}return t.prototype.setSource=function(e){return this._source=e,this._updateConnections(),e},t.prototype.setDestination=function(e){return this._connectToDestination(e),e},t.prototype.has=function(e){return!!e&&-1<this._nodes.indexOf(e)},t.prototype.add=function(e){if(!e)return null;if(this.has(e))return e;if(Array.isArray(e)){for(var t=void 0,n=0;n<e.length;n++)t=this.add(e[n]);return t}return this._nodes.push(e),this._updateConnections(),e},t.prototype.remove=function(e){if(!e)return null;if(!this.has(e))return e;for(var t=this._nodes.length,n=0;n<t;n++)if(e===this._nodes[n]){this._nodes.splice(n,1);break}return e.disconnect(),this._updateConnections(),e},t.prototype.toggle=function(e,t){t=!!t;var n=this.has(e);return 1<arguments.length&&n===t||(n?this.remove(e):this.add(e)),this},t.prototype.removeAll=function(){for(;this._nodes.length;){this._nodes.pop().disconnect()}return this._updateConnections(),this},t.prototype.destroy=function(){this.removeAll(),this.context=null,this._destination=null,this._source&&this._source.disconnect(),this._source=null},t.prototype._connect=function(e,t){e.disconnect(),e.connect(t._in||t)},t.prototype._connectToDestination=function(e){var t=this._nodes[this._nodes.length-1]||this._source;t&&this._connect(t,e),this._destination=e},t.prototype._updateConnections=function(){if(this._source){for(var e=void 0,t=void 0,n=0;n<this._nodes.length;n++)e=this._nodes[n],t=0===n?this._source:this._nodes[n-1],this._connect(t,e);this._destination&&this._connectToDestination(this._destination)}},t}();t.default=a},function(e,t,n){"use strict";t.__esModule=!0;var o=a(n(489)),r=a(n(506)),i="function"==typeof r.default&&"symbol"==typeof o.default?function(e){return typeof e}:function(e){return e&&"function"==typeof r.default&&e.constructor===r.default&&e!==r.default.prototype?"symbol":typeof e};function a(e){return e&&e.__esModule?e:{default:e}}t.default="function"==typeof r.default&&"symbol"===i(o.default)?function(e){return void 0===e?"undefined":i(e)}:function(e){return e&&"function"==typeof r.default&&e.constructor===r.default&&e!==r.default.prototype?"symbol":void 0===e?"undefined":i(e)}},function(e,t){var n=Math.ceil,o=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(0<e?o:n)(e)}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t){e.exports={}},function(e,t,o){var r=o(85),i=o(494),a=o(135),s=o(133)("IE_PROTO"),u=function(){},c="prototype",l=function(){var e,t=o(173)("iframe"),n=a.length;for(t.style.display="none",o(499).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),l=e.F;n--;)delete l[c][a[n]];return l()};e.exports=Object.create||function(e,t){var n;return null!==e?(u[c]=r(e),n=new u,u[c]=null,n[s]=e):n=l(),void 0===t?n:i(n,t)}},function(e,t,n){var o=n(186),r=n(135);e.exports=Object.keys||function(e){return o(e,r)}},function(e,t,n){var o=n(134)("keys"),r=n(101);e.exports=function(e){return o[e]||(o[e]=r(e))}},function(e,t,n){var o=n(59),r=n(47),i="__core-js_shared__",a=r[i]||(r[i]={});(e.exports=function(e,t){return a[e]||(a[e]=void 0!==t?t:{})})("versions",[]).push({version:o.version,mode:n(100)?"pure":"global",copyright:"© 2018 Denis Pushkarev (zloirock.ru)"})},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){var o=n(60).f,r=n(62),i=n(73)("toStringTag");e.exports=function(e,t,n){e&&!r(e=n?e:e.prototype,i)&&o(e,i,{configurable:!0,value:t})}},function(e,t,n){t.f=n(73)},function(e,t,n){var o=n(47),r=n(59),i=n(100),a=n(137),s=n(60).f;e.exports=function(e){var t=r.Symbol||(r.Symbol=i?{}:o.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:a.f(e)})}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,n){"use strict";t.__esModule=!0;var o,r=n(127),i=(o=r)&&o.__esModule?o:{default:o};t.default=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":(0,i.default)(t))&&"function"!=typeof t?e:t}},function(e,t,n){"use strict";t.__esModule=!0;var o=a(n(516)),r=a(n(520)),i=a(n(127));function a(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":(0,i.default)(t)));e.prototype=(0,r.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(o.default?(0,o.default)(e,t):e.__proto__=t)}},function(e,t,n){"use strict";t.__esModule=!0;var o,r=n(170),i=(o=r)&&o.__esModule?o:{default:o};t.default=function(){function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),(0,i.default)(e,o.key,o)}}return function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}}()},,function(e,t,n){"use strict";function o(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager,this.dracoLoader=null}function r(){var n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}o.prototype={constructor:o,crossOrigin:"Anonymous",load:function(e,t,n,o){var r=this,i=void 0!==this.path?this.path:THREE.LoaderUtils.extractUrlBase(e),a=new THREE.FileLoader(r.manager);a.setResponseType("arraybuffer"),a.load(e,function(e){try{r.parse(e,i,t,o)}catch(e){if(void 0===o)throw e;o(e)}},n,o)},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this},setDRACOLoader:function(e){return this.dracoLoader=e,this},parse:function(e,t,i,n){var o,r={};if("string"==typeof e)o=e;else if(THREE.LoaderUtils.decodeText(new Uint8Array(e,0,4))===l){try{r[w.KHR_BINARY_GLTF]=new h(e)}catch(e){return void(n&&n(e))}o=r[w.KHR_BINARY_GLTF].content}else o=THREE.LoaderUtils.decodeText(new Uint8Array(e));var a=JSON.parse(o);void 0===a.asset||a.asset.version[0]<2?n&&n(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported. Use LegacyGLTFLoader instead.")):(a.extensionsUsed&&(0<=a.extensionsUsed.indexOf(w.KHR_LIGHTS)&&(r[w.KHR_LIGHTS]=new u(a)),0<=a.extensionsUsed.indexOf(w.KHR_MATERIALS_UNLIT)&&(r[w.KHR_MATERIALS_UNLIT]=new c(a)),0<=a.extensionsUsed.indexOf(w.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS)&&(r[w.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]=new y),0<=a.extensionsUsed.indexOf(w.KHR_DRACO_MESH_COMPRESSION)&&(r[w.KHR_DRACO_MESH_COMPRESSION]=new d(this.dracoLoader)),0<=a.extensionsUsed.indexOf(w.MSFT_TEXTURE_DDS)&&(r[w.MSFT_TEXTURE_DDS]=new s)),new U(a,r,{path:t||this.path||"",crossOrigin:this.crossOrigin,manager:this.manager}).parse(function(e,t,n,o,r){i({scene:e,scenes:t,cameras:n,animations:o,asset:r})},n))}};var w={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS:"KHR_lights",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};function s(){if(!THREE.DDSLoader)throw new Error("THREE.GLTFLoader: Attempting to load .dds texture without importing THREE.DDSLoader");this.name=w.MSFT_TEXTURE_DDS,this.ddsLoader=new THREE.DDSLoader}function u(e){this.name=w.KHR_LIGHTS,this.lights={};var t=(e.extensions&&e.extensions[w.KHR_LIGHTS]||{}).lights||{};for(var n in t){var o,r=t[n],i=(new THREE.Color).fromArray(r.color);switch(r.type){case"directional":(o=new THREE.DirectionalLight(i)).target.position.set(0,0,1),o.add(o.target);break;case"point":o=new THREE.PointLight(i);break;case"spot":o=new THREE.SpotLight(i),r.spot=r.spot||{},r.spot.innerConeAngle=void 0!==r.spot.innerConeAngle?r.spot.innerConeAngle:0,r.spot.outerConeAngle=void 0!==r.spot.outerConeAngle?r.spot.outerConeAngle:Math.PI/4,o.angle=r.spot.outerConeAngle,o.penumbra=1-r.spot.innerConeAngle/r.spot.outerConeAngle,o.target.position.set(0,0,1),o.add(o.target);break;case"ambient":o=new THREE.AmbientLight(i)}o&&(o.decay=2,void 0!==r.intensity&&(o.intensity=r.intensity),o.name=r.name||"light_"+n,this.lights[n]=o)}}function c(e){this.name=w.KHR_MATERIALS_UNLIT}c.prototype.getMaterialType=function(e){return THREE.MeshBasicMaterial},c.prototype.extendParams=function(e,t,n){var o=[];e.color=new THREE.Color(1,1,1),e.opacity=1;var r=t.pbrMetallicRoughness;if(r){if(Array.isArray(r.baseColorFactor)){var i=r.baseColorFactor;e.color.fromArray(i),e.opacity=i[3]}void 0!==r.baseColorTexture&&o.push(n.assignTexture(e,"map",r.baseColorTexture.index))}return Promise.all(o)};var l="glTF",f=12,p={JSON:1313821514,BIN:5130562};function h(e){this.name=w.KHR_BINARY_GLTF,this.content=null,this.body=null;var t=new DataView(e,0,f);if(this.header={magic:THREE.LoaderUtils.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==l)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected. Use LegacyGLTFLoader instead.");for(var n=new DataView(e,f),o=0;o<n.byteLength;){var r=n.getUint32(o,!0);o+=4;var i=n.getUint32(o,!0);if(o+=4,i===p.JSON){var a=new Uint8Array(e,f+o,r);this.content=THREE.LoaderUtils.decodeText(a)}else if(i===p.BIN){var s=f+o;this.body=e.slice(s,s+r)}o+=r}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}function d(e){if(!e)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=w.KHR_DRACO_MESH_COMPRESSION,this.dracoLoader=e}function y(){return{name:w.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return THREE.ShaderMaterial},extendParams:function(e,t,n){var o=t.extensions[this.name],r=THREE.ShaderLib.standard,i=THREE.UniformsUtils.clone(r.uniforms),a=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),s=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),u=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),c=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),l=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","material.specularRoughness = clamp( 1.0 - glossinessFactor, 0.04, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n"),f=r.fragmentShader.replace("#include <specularmap_fragment>","").replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",a).replace("#include <metalnessmap_pars_fragment>",s).replace("#include <roughnessmap_fragment>",u).replace("#include <metalnessmap_fragment>",c).replace("#include <lights_physical_fragment>",l);delete i.roughness,delete i.metalness,delete i.roughnessMap,delete i.metalnessMap,i.specular={value:(new THREE.Color).setHex(1118481)},i.glossiness={value:.5},i.specularMap={value:null},i.glossinessMap={value:null},e.vertexShader=r.vertexShader,e.fragmentShader=f,e.uniforms=i,e.defines={STANDARD:""},e.color=new THREE.Color(1,1,1),e.opacity=1;var p=[];if(Array.isArray(o.diffuseFactor)){var h=o.diffuseFactor;e.color.fromArray(h),e.opacity=h[3]}if(void 0!==o.diffuseTexture&&p.push(n.assignTexture(e,"map",o.diffuseTexture.index)),e.emissive=new THREE.Color(0,0,0),e.glossiness=void 0!==o.glossinessFactor?o.glossinessFactor:1,e.specular=new THREE.Color(1,1,1),Array.isArray(o.specularFactor)&&e.specular.fromArray(o.specularFactor),void 0!==o.specularGlossinessTexture){var d=o.specularGlossinessTexture.index;p.push(n.assignTexture(e,"glossinessMap",d)),p.push(n.assignTexture(e,"specularMap",d))}return Promise.all(p)},createMaterial:function(e){var t=new THREE.ShaderMaterial({defines:e.defines,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms,fog:!0,lights:!0,opacity:e.opacity,transparent:e.transparent});return t.isGLTFSpecularGlossinessMaterial=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t.extensions.derivatives=!0,t},cloneMaterial:function(e){var t=e.clone();t.isGLTFSpecularGlossinessMaterial=!0;for(var n=this.specularGlossinessParams,o=0,r=n.length;o<r;o++)t[n[o]]=e[n[o]];return t},refreshUniforms:function(e,t,n,o,r,i){if(!0===r.isGLTFSpecularGlossinessMaterial){var a,s,u,c=r.uniforms,l=r.defines;if(c.opacity.value=r.opacity,c.diffuse.value.copy(r.color),c.emissive.value.copy(r.emissive).multiplyScalar(r.emissiveIntensity),c.map.value=r.map,c.specularMap.value=r.specularMap,c.alphaMap.value=r.alphaMap,c.lightMap.value=r.lightMap,c.lightMapIntensity.value=r.lightMapIntensity,c.aoMap.value=r.aoMap,c.aoMapIntensity.value=r.aoMapIntensity,r.map?a=r.map:r.specularMap?a=r.specularMap:r.displacementMap?a=r.displacementMap:r.normalMap?a=r.normalMap:r.bumpMap?a=r.bumpMap:r.glossinessMap?a=r.glossinessMap:r.alphaMap?a=r.alphaMap:r.emissiveMap&&(a=r.emissiveMap),void 0!==a)if(a.isWebGLRenderTarget&&(a=a.texture),void 0!==a.matrix){if(!0===a.matrixAutoUpdate){s=a.offset,u=a.repeat;var f=a.rotation,p=a.center;a.matrix.setUvTransform(s.x,s.y,u.x,u.y,f,p.x,p.y)}c.uvTransform.value.copy(a.matrix)}else s=a.offset,u=a.repeat,c.offsetRepeat.value.set(s.x,s.y,u.x,u.y);c.envMap.value=r.envMap,c.envMapIntensity.value=r.envMapIntensity,c.flipEnvMap.value=r.envMap&&r.envMap.isCubeTexture?-1:1,c.refractionRatio.value=r.refractionRatio,c.specular.value.copy(r.specular),c.glossiness.value=r.glossiness,c.glossinessMap.value=r.glossinessMap,c.emissiveMap.value=r.emissiveMap,c.bumpMap.value=r.bumpMap,c.normalMap.value=r.normalMap,c.displacementMap.value=r.displacementMap,c.displacementScale.value=r.displacementScale,c.displacementBias.value=r.displacementBias,null!==c.glossinessMap.value&&void 0===l.USE_GLOSSINESSMAP&&(l.USE_GLOSSINESSMAP="",l.USE_ROUGHNESSMAP=""),null===c.glossinessMap.value&&void 0!==l.USE_GLOSSINESSMAP&&(delete l.USE_GLOSSINESSMAP,delete l.USE_ROUGHNESSMAP)}}}}function O(e,t,n,o){THREE.Interpolant.call(this,e,t,n,o)}d.prototype.decodePrimitive=function(e,t){var n=this.dracoLoader,o=e.extensions[this.name].bufferView,r=e.extensions[this.name].attributes,i={};for(var a in r)a in b&&(i[b[a]]=r[a]);return t.getDependency("bufferView",o).then(function(t){return new Promise(function(e){n.decodeDracoFile(t,e,i)})})},((O.prototype=Object.create(THREE.Interpolant.prototype)).constructor=O).prototype.interpolate_=function(e,t,n,o){for(var r=this.resultBuffer,i=this.sampleValues,a=this.valueSize,s=2*a,u=3*a,c=o-t,l=(n-t)/c,f=l*l,p=f*l,h=e*u,d=h-u,y=2*p-3*f+1,v=p-2*f+l,m=-2*p+3*f,_=p-f,g=0;g!==a;g++){var b=i[d+g+a],w=i[d+g+s]*c,O=i[h+g+a],x=i[h+g]*c;r[g]=y*b+v*w+m*O+_*x}return r};var x=0,k=1,E=2,P=3,T=4,S=5,j=6,C=(Number,THREE.Matrix3,THREE.Matrix4,THREE.Vector2,THREE.Vector3,THREE.Vector4,THREE.Texture,{5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array}),v={9728:THREE.NearestFilter,9729:THREE.LinearFilter,9984:THREE.NearestMipMapNearestFilter,9985:THREE.LinearMipMapNearestFilter,9986:THREE.NearestMipMapLinearFilter,9987:THREE.LinearMipMapLinearFilter},m={33071:THREE.ClampToEdgeWrapping,33648:THREE.MirroredRepeatWrapping,10497:THREE.RepeatWrapping},_={6406:THREE.AlphaFormat,6407:THREE.RGBFormat,6408:THREE.RGBAFormat,6409:THREE.LuminanceFormat,6410:THREE.LuminanceAlphaFormat},g={5121:THREE.UnsignedByteType,32819:THREE.UnsignedShort4444Type,32820:THREE.UnsignedShort5551Type,33635:THREE.UnsignedShort565Type},R=(THREE.BackSide,THREE.FrontSide,THREE.NeverDepth,THREE.LessDepth,THREE.EqualDepth,THREE.LessEqualDepth,THREE.GreaterEqualDepth,THREE.NotEqualDepth,THREE.GreaterEqualDepth,THREE.AlwaysDepth,THREE.AddEquation,THREE.SubtractEquation,THREE.ReverseSubtractEquation,THREE.ZeroFactor,THREE.OneFactor,THREE.SrcColorFactor,THREE.OneMinusSrcColorFactor,THREE.SrcAlphaFactor,THREE.OneMinusSrcAlphaFactor,THREE.DstAlphaFactor,THREE.OneMinusDstAlphaFactor,THREE.DstColorFactor,THREE.OneMinusDstColorFactor,THREE.SrcAlphaSaturateFactor,{SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16}),b={POSITION:"position",NORMAL:"normal",TEXCOORD_0:"uv",TEXCOORD0:"uv",TEXCOORD:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",COLOR0:"color",COLOR:"color",WEIGHTS_0:"skinWeight",WEIGHT:"skinWeight",JOINTS_0:"skinIndex",JOINT:"skinIndex"},M={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},A={CUBICSPLINE:THREE.InterpolateSmooth,LINEAR:THREE.InterpolateLinear,STEP:THREE.InterpolateDiscrete},L="OPAQUE",D="MASK",z="BLEND";function H(e,t){return"string"!=typeof e||""===e?"":/^(https?:)?\/\//i.test(e)?e:/^data:.*,.*$/i.test(e)?e:/^blob:.*$/i.test(e)?e:t+e}function I(e,t,n,o){for(var r=e.geometry,i=n.targets,a=!1,s=!1,u=0,c=i.length;u<c;u++){if(void 0!==(p=i[u]).POSITION&&(a=!0),void 0!==p.NORMAL&&(s=!0),a&&s)break}if(a||s){var l=[],f=[];for(u=0,c=i.length;u<c;u++){var p=i[u],h="morphTarget"+u;if(a){if(void 0!==p.POSITION){var d=N(o[p.POSITION]);d.name=h;for(var y=r.attributes.position,v=0,m=d.count;v<m;v++)d.setXYZ(v,d.getX(v)+y.getX(v),d.getY(v)+y.getY(v),d.getZ(v)+y.getZ(v))}else d=r.attributes.position;l.push(d)}if(s){if(void 0!==p.NORMAL){var _;(_=N(o[p.NORMAL])).name=h;var g=r.attributes.normal;for(v=0,m=_.count;v<m;v++)_.setXYZ(v,_.getX(v)+g.getX(v),_.getY(v)+g.getY(v),_.getZ(v)+g.getZ(v))}else _=r.attributes.normal;f.push(_)}}if(a&&(r.morphAttributes.position=l),s&&(r.morphAttributes.normal=f),e.updateMorphTargets(),void 0!==t.weights)for(u=0,c=t.weights.length;u<c;u++)e.morphTargetInfluences[u]=t.weights[u];if(t.extras&&Array.isArray(t.extras.targetNames)){var b=t.extras.targetNames;if(e.morphTargetInfluences.length===b.length){e.morphTargetDictionary={};for(u=0,c=b.length;u<c;u++)e.morphTargetDictionary[b[u]]=u}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}}function i(e,t){if(e.indices!==t.indices)return!1;var n=e.attributes||{},o=t.attributes||{},r=Object.keys(n),i=Object.keys(o);if(r.length!==i.length)return!1;for(var a=0,s=r.length;a<s;a++){var u=r[a];if(n[u]!==o[u])return!1}return!0}function F(e,t){for(var n=0,o=e.length;n<o;n++){var r=e[n];if(i(r.primitive,t))return r.promise}return null}function N(e){if(e.isInterleavedBufferAttribute){for(var t=e.count,n=e.itemSize,o=e.array.slice(0,t*n),r=0;r<t;++r)o[r]=e.getX(r),2<=n&&(o[r+1]=e.getY(r)),3<=n&&(o[r+2]=e.getZ(r)),4<=n&&(o[r+3]=e.getW(r));return new THREE.BufferAttribute(o,n,e.normalized)}return e.clone()}function U(e,t,n){this.json=e||{},this.extensions=t||{},this.options=n||{},this.cache=new r,this.primitiveCache=[],this.textureLoader=new THREE.TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new THREE.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer")}function B(e,t,n){var o=t.attributes;for(var r in o){var i=b[r],a=n[o[r]];i&&(i in e.attributes||e.addAttribute(i,a))}void 0===t.indices||e.index||e.setIndex(n[t.indices])}U.prototype.parse=function(a,e){var s=this.json;this.cache.removeAll(),this.markDefs(),this.getMultiDependencies(["scene","animation","camera"]).then(function(e){var t=e.scenes||[],n=t[s.scene||0],o=e.animations||[],r=s.asset,i=e.cameras||[];a(n,t,i,o,r)}).catch(e)},U.prototype.markDefs=function(){for(var e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[],o={},r={},i=0,a=t.length;i<a;i++)for(var s=t[i].joints,u=0,c=s.length;u<c;u++)e[s[u]].isBone=!0;for(var l=0,f=e.length;l<f;l++){var p=e[l];void 0!==p.mesh&&(void 0===o[p.mesh]&&(o[p.mesh]=r[p.mesh]=0),o[p.mesh]++,void 0!==p.skin&&(n[p.mesh].isSkinnedMesh=!0))}this.json.meshReferences=o,this.json.meshUses=r},U.prototype.getDependency=function(e,t){var n=e+":"+t,o=this.cache.get(n);if(!o){switch(e){case"scene":o=this.loadScene(t);break;case"node":o=this.loadNode(t);break;case"mesh":o=this.loadMesh(t);break;case"accessor":o=this.loadAccessor(t);break;case"bufferView":o=this.loadBufferView(t);break;case"buffer":o=this.loadBuffer(t);break;case"material":o=this.loadMaterial(t);break;case"texture":o=this.loadTexture(t);break;case"skin":o=this.loadSkin(t);break;case"animation":o=this.loadAnimation(t);break;case"camera":o=this.loadCamera(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(n,o)}return o},U.prototype.getDependencies=function(n){var e=this.cache.get(n);if(!e){var o=this,t=this.json[n+("mesh"===n?"es":"s")]||[];e=Promise.all(t.map(function(e,t){return o.getDependency(n,t)})),this.cache.add(n,e)}return e},U.prototype.getMultiDependencies=function(e){for(var n={},t=[],o=0,r=e.length;o<r;o++){var i=e[o],a=this.getDependencies(i);a=a.then(function(e,t){n[e]=t}.bind(this,i+("mesh"===i?"es":"s"))),t.push(a)}return Promise.all(t).then(function(){return n})},U.prototype.loadBuffer=function(e){var n=this.json.buffers[e],o=this.fileLoader;if(n.type&&"arraybuffer"!==n.type)throw new Error("THREE.GLTFLoader: "+n.type+" buffer type is not supported.");if(void 0===n.uri&&0===e)return Promise.resolve(this.extensions[w.KHR_BINARY_GLTF].body);var r=this.options;return new Promise(function(e,t){o.load(H(n.uri,r.path),e,void 0,function(){t(new Error('THREE.GLTFLoader: Failed to load buffer "'+n.uri+'".'))})})},U.prototype.loadBufferView=function(e){var o=this.json.bufferViews[e];return this.getDependency("buffer",o.buffer).then(function(e){var t=o.byteLength||0,n=o.byteOffset||0;return e.slice(n,n+t)})},U.prototype.loadAccessor=function(e){var O=this,x=this.json,k=this.json.accessors[e];if(void 0===k.bufferView&&void 0===k.sparse)return null;var t=[];return void 0!==k.bufferView?t.push(this.getDependency("bufferView",k.bufferView)):t.push(null),void 0!==k.sparse&&(t.push(this.getDependency("bufferView",k.sparse.indices.bufferView)),t.push(this.getDependency("bufferView",k.sparse.values.bufferView))),Promise.all(t).then(function(e){var t,n,o=e[0],r=R[k.type],i=C[k.componentType],a=i.BYTES_PER_ELEMENT,s=a*r,u=k.byteOffset||0,c=x.bufferViews[k.bufferView].byteStride,l=!0===k.normalized;if(c&&c!==s){var f="InterleavedBuffer:"+k.bufferView+":"+k.componentType,p=O.cache.get(f);p||(t=new i(o),p=new THREE.InterleavedBuffer(t,c/a),O.cache.add(f,p)),n=new THREE.InterleavedBufferAttribute(p,r,u/a,l)}else t=null===o?new i(k.count*r):new i(o,u,k.count*r),n=new THREE.BufferAttribute(t,r,l);if(void 0!==k.sparse){var h=R.SCALAR,d=C[k.sparse.indices.componentType],y=k.sparse.indices.byteOffset||0,v=k.sparse.values.byteOffset||0,m=new d(e[1],y,k.sparse.count*h),_=new i(e[2],v,k.sparse.count*r);null!==o&&n.setArray(n.array.slice());for(var g=0,b=m.length;g<b;g++){var w=m[g];if(n.setX(w,_[g*r]),2<=r&&n.setY(w,_[g*r+1]),3<=r&&n.setZ(w,_[g*r+2]),4<=r&&n.setW(w,_[g*r+3]),5<=r)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return n})},U.prototype.loadTexture=function(e){var n,t=this,o=this.json,r=this.options,i=this.textureLoader,a=window.URL||window.webkitURL,s=o.textures[e],u=s.extensions||{},c=(n=u[w.MSFT_TEXTURE_DDS]?o.images[u[w.MSFT_TEXTURE_DDS].source]:o.images[s.source]).uri,l=!1;return void 0!==n.bufferView&&(c=t.getDependency("bufferView",n.bufferView).then(function(e){l=!0;var t=new Blob([e],{type:n.mimeType});return c=a.createObjectURL(t)})),Promise.resolve(c).then(function(n){var o=THREE.Loader.Handlers.get(n);return o||(o=u[w.MSFT_TEXTURE_DDS]?t.extensions[w.MSFT_TEXTURE_DDS].ddsLoader:i),new Promise(function(e,t){o.load(H(n,r.path),e,void 0,t)})}).then(function(e){!0===l&&a.revokeObjectURL(c),e.flipY=!1,void 0!==s.name&&(e.name=s.name),u[w.MSFT_TEXTURE_DDS]||(e.format=void 0!==s.format?_[s.format]:THREE.RGBAFormat),void 0!==s.internalFormat&&e.format!==_[s.internalFormat]&&console.warn("THREE.GLTFLoader: Three.js does not support texture internalFormat which is different from texture format. internalFormat will be forced to be the same value as format."),e.type=void 0!==s.type?g[s.type]:THREE.UnsignedByteType;var t=(o.samplers||{})[s.sampler]||{};return e.magFilter=v[t.magFilter]||THREE.LinearFilter,e.minFilter=v[t.minFilter]||THREE.LinearMipMapLinearFilter,e.wrapS=m[t.wrapS]||THREE.RepeatWrapping,e.wrapT=m[t.wrapT]||THREE.RepeatWrapping,e})},U.prototype.assignTexture=function(t,n,e){return this.getDependency("texture",e).then(function(e){t[n]=e})},U.prototype.loadMaterial=function(e){this.json;var t,n=this.extensions,o=this.json.materials[e],r={},i=o.extensions||{},a=[];if(i[w.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var s=n[w.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];t=s.getMaterialType(o),a.push(s.extendParams(r,o,this))}else if(i[w.KHR_MATERIALS_UNLIT]){var u=n[w.KHR_MATERIALS_UNLIT];t=u.getMaterialType(o),a.push(u.extendParams(r,o,this))}else{t=THREE.MeshStandardMaterial;var c=o.pbrMetallicRoughness||{};if(r.color=new THREE.Color(1,1,1),r.opacity=1,Array.isArray(c.baseColorFactor)){var l=c.baseColorFactor;r.color.fromArray(l),r.opacity=l[3]}if(void 0!==c.baseColorTexture&&a.push(this.assignTexture(r,"map",c.baseColorTexture.index)),r.metalness=void 0!==c.metallicFactor?c.metallicFactor:1,r.roughness=void 0!==c.roughnessFactor?c.roughnessFactor:1,void 0!==c.metallicRoughnessTexture){var f=c.metallicRoughnessTexture.index;a.push(this.assignTexture(r,"metalnessMap",f)),a.push(this.assignTexture(r,"roughnessMap",f))}}!0===o.doubleSided&&(r.side=THREE.DoubleSide);var p=o.alphaMode||L;return p===z?r.transparent=!0:(r.transparent=!1,p===D&&(r.alphaTest=void 0!==o.alphaCutoff?o.alphaCutoff:.5)),void 0!==o.normalTexture&&t!==THREE.MeshBasicMaterial&&(a.push(this.assignTexture(r,"normalMap",o.normalTexture.index)),r.normalScale=new THREE.Vector2(1,1),void 0!==o.normalTexture.scale&&r.normalScale.set(o.normalTexture.scale,o.normalTexture.scale)),void 0!==o.occlusionTexture&&t!==THREE.MeshBasicMaterial&&(a.push(this.assignTexture(r,"aoMap",o.occlusionTexture.index)),void 0!==o.occlusionTexture.strength&&(r.aoMapIntensity=o.occlusionTexture.strength)),void 0!==o.emissiveFactor&&t!==THREE.MeshBasicMaterial&&(r.emissive=(new THREE.Color).fromArray(o.emissiveFactor)),void 0!==o.emissiveTexture&&t!==THREE.MeshBasicMaterial&&a.push(this.assignTexture(r,"emissiveMap",o.emissiveTexture.index)),Promise.all(a).then(function(){var e;return e=t===THREE.ShaderMaterial?n[w.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(r):new t(r),void 0!==o.name&&(e.name=o.name),e.normalScale&&(e.normalScale.y=-e.normalScale.y),e.map&&(e.map.encoding=THREE.sRGBEncoding),e.emissiveMap&&(e.emissiveMap.encoding=THREE.sRGBEncoding),o.extras&&(e.userData=o.extras),e})},U.prototype.loadGeometries=function(u){var c=this,l=this.extensions,f=this.primitiveCache;return this.getDependencies("accessor").then(function(t){for(var e=[],n=0,o=u.length;n<o;n++){var r=u[n],i=F(f,r);if(i)e.push(i);else if(r.extensions&&r.extensions[w.KHR_DRACO_MESH_COMPRESSION]){var a=l[w.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(r,c).then(function(e){return B(e,r,t),e});f.push({primitive:r,promise:a}),e.push(a)}else{var s=new THREE.BufferGeometry;B(s,r,t);a=Promise.resolve(s);f.push({primitive:r,promise:a}),e.push(a)}}return Promise.all(e)})},U.prototype.loadMesh=function(m){var _=this,g=(this.json,this.extensions),b=this.json.meshes[m];return this.getMultiDependencies(["accessor","material"]).then(function(d){var y=new THREE.Group,v=b.primitives;return _.loadGeometries(v).then(function(e){for(var t=0,n=v.length;t<n;t++){var o=v[t],r=e[t],i=void 0===o.material?new THREE.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:THREE.FrontSide}):d.materials[o.material];i.aoMap&&void 0===r.attributes.uv2&&void 0!==r.attributes.uv&&(console.log("THREE.GLTFLoader: Duplicating UVs to support aoMap."),r.addAttribute("uv2",new THREE.BufferAttribute(r.attributes.uv.array,2)));var a,s=void 0!==r.attributes.color,u=void 0===r.attributes.normal,c=!0===b.isSkinnedMesh,l=void 0!==o.targets;if(s||u||c||l)if(i.isGLTFSpecularGlossinessMaterial)i=g[w.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].cloneMaterial(i);else i=i.clone();if(s&&(i.vertexColors=THREE.VertexColors,i.needsUpdate=!0),u&&(i.flatShading=!0),o.mode===T||o.mode===S||o.mode===j||void 0===o.mode)c?(a=new THREE.SkinnedMesh(r,i),i.skinning=!0):a=new THREE.Mesh(r,i),o.mode===S?a.drawMode=THREE.TriangleStripDrawMode:o.mode===j&&(a.drawMode=THREE.TriangleFanDrawMode);else if(o.mode===k||o.mode===P||o.mode===E){var f="LineBasicMaterial:"+i.uuid,p=_.cache.get(f);p||(p=new THREE.LineBasicMaterial,THREE.Material.prototype.copy.call(p,i),p.color.copy(i.color),p.lights=!1,_.cache.add(f,p)),i=p,a=o.mode===k?new THREE.LineSegments(r,i):o.mode===P?new THREE.Line(r,i):new THREE.LineLoop(r,i)}else{if(o.mode!==x)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+o.mode);f="PointsMaterial:"+i.uuid;var h=_.cache.get(f);h||(h=new THREE.PointsMaterial,THREE.Material.prototype.copy.call(h,i),h.color.copy(i.color),h.map=i.map,h.lights=!1,_.cache.add(f,h)),i=h,a=new THREE.Points(r,i)}if(a.name=b.name||"mesh_"+m,l&&(I(a,b,o,d.accessors),i.morphTargets=!0,void 0!==a.geometry.morphAttributes.normal&&(i.morphNormals=!0)),void 0!==b.extras&&(a.userData=b.extras),void 0!==o.extras&&(a.geometry.userData=o.extras),!0===i.isGLTFSpecularGlossinessMaterial&&(a.onBeforeRender=g[w.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].refreshUniforms),!(1<v.length))return a;a.name+="_"+t,y.add(a)}return y})})},U.prototype.loadCamera=function(e){var t,n=this.json.cameras[e],o=n[n.type];if(o)return"perspective"===n.type?t=new THREE.PerspectiveCamera(THREE.Math.radToDeg(o.yfov),o.aspectRatio||1,o.znear||1,o.zfar||2e6):"orthographic"===n.type&&(t=new THREE.OrthographicCamera(o.xmag/-2,o.xmag/2,o.ymag/2,o.ymag/-2,o.znear,o.zfar)),void 0!==n.name&&(t.name=n.name),n.extras&&(t.userData=n.extras),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")},U.prototype.loadSkin=function(e){var t=this.json.skins[e],n={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(n):this.getDependency("accessor",t.inverseBindMatrices).then(function(e){return n.inverseBindMatrices=e,n})},U.prototype.loadAnimation=function(b){this.json;var w=this.json.animations[b];return this.getMultiDependencies(["accessor","node"]).then(function(e){for(var t=[],n=0,o=w.channels.length;n<o;n++){var r=w.channels[n],i=w.samplers[r.sampler];if(i){var a=r.target,s=void 0!==a.node?a.node:a.id,u=void 0!==w.parameters?w.parameters[i.input]:i.input,c=void 0!==w.parameters?w.parameters[i.output]:i.output,l=e.accessors[u],f=e.accessors[c],p=e.nodes[s];if(p){var h;switch(p.updateMatrix(),p.matrixAutoUpdate=!0,M[a.path]){case M.weights:h=THREE.NumberKeyframeTrack;break;case M.rotation:h=THREE.QuaternionKeyframeTrack;break;case M.position:case M.scale:default:h=THREE.VectorKeyframeTrack}var d=p.name?p.name:p.uuid,y=void 0!==i.interpolation?A[i.interpolation]:THREE.InterpolateLinear,v=[];M[a.path]===M.weights?p.traverse(function(e){!0===e.isMesh&&!0===e.material.morphTargets&&v.push(e.name?e.name:e.uuid)}):v.push(d);for(var m=0,_=v.length;m<_;m++){var g=new h(v[m]+"."+M[a.path],THREE.AnimationUtils.arraySlice(l.array,0),THREE.AnimationUtils.arraySlice(f.array,0),y);"CUBICSPLINE"===i.interpolation&&(g.createInterpolant=function(e){return new O(this.times,this.values,this.getValueSize()/3,e)},g.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),t.push(g)}}}}s=void 0!==w.name?w.name:"animation_"+b;return new THREE.AnimationClip(s,void 0,t)})},U.prototype.loadNode=function(e){this.json;var s=this.extensions,u=this.json.meshReferences,c=this.json.meshUses,l=this.json.nodes[e];return this.getMultiDependencies(["mesh","skin","camera","light"]).then(function(e){var t;if(!0===l.isBone)t=new THREE.Bone;else if(void 0!==l.mesh){var n=e.meshes[l.mesh];if(t=n.clone(),!0===n.isGroup)for(var o=0,r=n.children.length;o<r;o++){var i=n.children[o];i.material&&!0===i.material.isGLTFSpecularGlossinessMaterial&&(t.children[o].onBeforeRender=i.onBeforeRender)}else n.material&&!0===n.material.isGLTFSpecularGlossinessMaterial&&(t.onBeforeRender=n.onBeforeRender);1<u[l.mesh]&&(t.name+="_instance_"+c[l.mesh]++)}else if(void 0!==l.camera)t=e.cameras[l.camera];else if(l.extensions&&l.extensions[w.KHR_LIGHTS]&&void 0!==l.extensions[w.KHR_LIGHTS].light){t=s[w.KHR_LIGHTS].lights[l.extensions[w.KHR_LIGHTS].light]}else t=new THREE.Object3D;if(void 0!==l.name&&(t.name=THREE.PropertyBinding.sanitizeNodeName(l.name)),l.extras&&(t.userData=l.extras),void 0!==l.matrix){var a=new THREE.Matrix4;a.fromArray(l.matrix),t.applyMatrix(a)}else void 0!==l.translation&&t.position.fromArray(l.translation),void 0!==l.rotation&&t.quaternion.fromArray(l.rotation),void 0!==l.scale&&t.scale.fromArray(l.scale);return t})},U.prototype.loadScene=function(){function b(e,t,n,o,r){var i=o[e],a=n.nodes[e];if(void 0!==a.skin)for(var s=!0===i.isGroup?i.children:[i],u=0,c=s.length;u<c;u++){for(var l=s[u],f=r[a.skin],p=[],h=[],d=0,y=f.joints.length;d<y;d++){var v=f.joints[d],m=o[v];if(m){p.push(m);var _=new THREE.Matrix4;void 0!==f.inverseBindMatrices&&_.fromArray(f.inverseBindMatrices.array,16*d),h.push(_)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',v)}l.bind(new THREE.Skeleton(p,h),l.matrixWorld)}if(t.add(i),a.children){var g=a.children;for(u=0,c=g.length;u<c;u++){b(g[u],i,n,o,r)}}}return function(e){var a=this.json,s=this.extensions,u=this.json.scenes[e];return this.getMultiDependencies(["node","skin"]).then(function(e){var t=new THREE.Scene;void 0!==u.name&&(t.name=u.name),u.extras&&(t.userData=u.extras);for(var n=u.nodes||[],o=0,r=n.length;o<r;o++)b(n[o],t,a,e.nodes,e.skins);if(u.extensions&&u.extensions[w.KHR_LIGHTS]&&void 0!==u.extensions[w.KHR_LIGHTS].light){var i=s[w.KHR_LIGHTS].lights;t.add(i[u.extensions[w.KHR_LIGHTS].light])}return t})}}(),t.a=o},function(e,t,n){"use strict";var r=n(22),o=n(277),i=n.n(o);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(e){u(t,e,n[e])})}return t}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(e){function o(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=c(this,l(o).call(this,t))).vertexShader=i.a,e.fragmentShader=THREE.ShaderChunk.depth_frag;var n=THREE.UniformsUtils.clone(THREE.ShaderLib.depth.uniforms);return e.uniforms=s({},e.uniforms,n),e.defines=s({},e.defines,{DEPTH_PACKING:THREE.RGBADepthPacking}),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(o,r["a"]),o}();t.a=p},function(o,r,e){(function(j){var e,t,n;t=[],void 0===(n="function"==typeof(e=function(){"use strict";var r,i,a,e,t,n,o,s,u="undefined"!=typeof window?window:null!=typeof j?j:this||{},c=u.cancelRequestAnimationFrame&&u.requestAnimationFrame||setTimeout,l=u.cancelRequestAnimationFrame||clearTimeout,f=[],p=0,h=!1,d=7,y=35,v=125,m=0,_=0,g=0,b={get didTimeout(){return!1},timeRemaining:function(){var e=d-(Date.now()-_);return e<0?0:e}},w=(t=function(){d=22,v=66,y=0},s=function(){var e=Date.now()-o;e<99?n=setTimeout(s,99-e):(n=null,t())},function(){o=Date.now(),n||(n=setTimeout(s,99))});function O(){125!=v&&(d=7,v=125,y=35,h&&(h&&(e&&l(e),a&&clearTimeout(a),h=!1),E())),w()}function x(){e=null,a=setTimeout(P,0)}function k(){a=null,c(x)}function E(){h||(i=v-(Date.now()-_),r=Date.now(),h=!0,y&&i<y&&(i=y),9<i?a=setTimeout(k,i):(i=0,k()))}function P(){var e,t,n,o=9<d?9:1;if(_=Date.now(),h=!1,a=null,2<p||_-i-50<r)for(t=0,n=f.length;t<n&&b.timeRemaining()>o;t++)e=f.shift(),g++,e&&e(b);f.length?E():p=0}function T(e){return m++,f.push(e),E(),m}function S(e){var t=e-1-g;f[t]&&(f[t]=null)}if(u.requestIdleCallback&&u.cancelIdleCallback)try{u.requestIdleCallback(function(){},{timeout:0})}catch(e){!function(n){var e,t;if(u.requestIdleCallback=function(e,t){return t&&"number"==typeof t.timeout?n(e,t.timeout):n(e)},u.IdleCallbackDeadline&&(e=IdleCallbackDeadline.prototype)){if(!(t=Object.getOwnPropertyDescriptor(e,"timeRemaining"))||!t.configurable||!t.get)return;Object.defineProperty(e,"timeRemaining",{value:function(){return t.get.call(this)},enumerable:!0,configurable:!0})}}(u.requestIdleCallback)}else u.requestIdleCallback=T,u.cancelIdleCallback=S,u.document&&document.addEventListener&&(u.addEventListener("scroll",O,!0),u.addEventListener("resize",O),document.addEventListener("focus",O,!0),document.addEventListener("mouseover",O,!0),["click","keypress","touchstart","mousedown"].forEach(function(e){document.addEventListener(e,O,{capture:!0,passive:!0})}),u.MutationObserver&&new MutationObserver(O).observe(document.documentElement,{childList:!0,subtree:!0,attributes:!0}));return{request:T,cancel:S}})?e.apply(r,t):e)||(o.exports=n)}).call(this,e(34))},function(e,x,k){"use strict";(function(e){var t,r=k(13),a=k(18),s=k(11),u=k(335),c=k(336),l=k(14),n=(k(23),k(41)),f=k.n(n);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function h(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function d(e,t,n){return(d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=y(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function i(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var m=null,_=new THREE.Raycaster,g=new THREE.BoxBufferGeometry(.2,.4,.2),b=new THREE.PlaneBufferGeometry(1,1,1,1),w=0,O=(i((t=function(e){function i(e,t,n,o){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(r=h(this,y(i).call(this,e))).basePosition=o.position.clone(),r.index=n,r._ctrl=t,r._config=o,r._rotation=o.rotation||0,r._intersectables=[r._scene.character.hitBox],r._scene.traverse(function(e){"all_no_shadows"===e.name&&r._intersectables.push(e)}),r.target=r._config.direction.clone(),r._offset=[Object(a.randomFloat)(-1,1),Object(a.randomFloat)(-1,1),Object(a.randomFloat)(-1,1),Object(a.randomFloat)(-1,1)],r._distance=1e-4,r._isIntersecting=!1,r._canUpdate=!0,r._create(),r._createGUI(),r._createTls(),r._bind(),r.raycast(),w++,r}var t,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(i,r["a"]),t=i,(n=[{key:"destroy",value:function(){d(y(i.prototype),"destroy",this).call(this),this._sound&&this._sound.destroy()}},{key:"update",value:function(e,t){this._canUpdate&&this.position.copy(this.basePosition);var n=.2*t,o=Math.sin(n)+Math.sin(.4*n+.434);o*=.4,this._hitMesh.scale.set(o,o,o),this._isIntersecting?(this._hitMesh.visible=!0,this._tube.scale.y=this._distance,this._hitMesh.position.y=-this._distance,this._hitMesh.rotation.x=Math.sin(n+this._offset[3]),this._hitMesh.rotation.y=Math.sin(.4325*n+this._offset[0]),this._hitMesh.rotation.z=Math.sin(.123*n+this._offset[1]),this._laserHitMaterial.uniforms.uExplode.value=Math.sin(n+54.43255+this._offset[2])):(this._hitMesh.visible=!1,this._tube.scale.y=.001),this._laserHitMaterial.update(e,t),this._sound&&this._updateSound()}},{key:"_bind",value:function(){this._signals.character.reseted.add(this._onCharReset),this._signals.pause.shown.add(this._onPauseShow),this._signals.pause.hidden.add(this._onPauseHide)}},{key:"_unbind",value:function(){clearTimeout(this._canUpdateTimeout),this._signals.character.reseted.remove(this._onCharReset),this._signals.pause.shown.remove(this._onPauseShow),this._signals.pause.hidden.remove(this._onPauseHide)}},{key:"_create",value:function(){var e=this;m||(m=new THREE.CylinderBufferGeometry(.03,.03,1,10)),this._mesh=new THREE.Mesh(g,new s.a({name:"laser_box"})),this._group=new THREE.Object3D,this._tube=new THREE.Object3D,this._tube.scale.y=10,this._tubeMesh=new THREE.Mesh(m,new s.a({name:"laser"})),this._tubeMesh.position.y-=.5,this._tube.add(this._tubeMesh),this._mesh.add(this._tube);var t=new THREE.SphereBufferGeometry(.3);this._laserHitMaterial=new c.a({name:"laser_hit"}),this._hitMesh=new THREE.Mesh(t,this._laserHitMaterial),this._group.add(this._mesh),this._group.add(this._hitMesh),this._group.rotation.z=this._rotation,this.add(this._group),this._config.burn&&(this._bMat=new u.a({color:0,name:"laser_burn"}),this._bPlane=new THREE.Mesh(b,this._bMat),this._bPlane.noOutlines=!0,this._bPlane.position.x=this._config.burn.position||0,this._bPlane.position.y=-.02,this._bPlane.position.z=this.basePosition.z,this._bPlane.rotation.x=-Math.PI/2,this._bPlane.scale.x=this._config.burn.scale,this._bPlane.scale.y=.7,this._scene.add(this._bPlane)),this._sound=this._sounds.clone("laser"),this._sound.currentTime=Object(a.randomFloat)(0,this._sound.duration),this._playTimeout=setTimeout(function(){e._sound.play()},4e3),this._pan=this._sound.effects.add(f()({maxDistance:20}))}},{key:"_updateSound",value:function(){var e=l.a.pool.get(),t=l.a.pool.get();this._hitMesh.getWorldPosition(t),e.set(0,0,-1),e.applyQuaternion(this.quaternion),this._pan.setPosition(t),this._pan.setOrientation(e.normalize()),e.release(),t.release();var n=l.a.pool.get();n.set(0,0,-1),n.applyQuaternion(this._scene.camera.quaternion),this._pan.setListenerPosition(this._scene.camera.position),this._pan.setListenerOrientation(n.normalize()),n.release()}},{key:"_createTls",value:function(){this._tl=new TimelineMax({repeat:-1}),this._tls.push(this._tl),this._config.setTl&&this._config.setTl(this._tl,this)}},{key:"_createGUI",value:function(){if(this._bPlane){var e=this._ctrl.guiFolder.addFolder("Laser - ".concat(w));e.add(this._bPlane.position,"x",-100,100,.01).name("position"),e.add(this._bPlane.scale,"x",3,30,.01).name("scale X")}}},{key:"raycast",value:function(){_.set(this.position,this.target,0,10);var e=_.intersectObjects(this._intersectables,!0),t=e[0];e.length?(this._isIntersecting=!0,this._distance=t.distance,"all_no_shadows"!==t.object.name&&this._signals.enemies.laserHit.dispatch()):(this._isIntersecting=!1,this._distance=.001)}},{key:"_onCharReset",value:function(){var e=this;this._canUpdate=!1,clearTimeout(this._canUpdateTimeout),this._canUpdateTimeout=setTimeout(function(){e._canUpdate=!0},2e3)}},{key:"_onPauseShow",value:function(){this._sound.volume=0}},{key:"_onPauseHide",value:function(){this._sound.volume=.4}}])&&p(t.prototype,n),o&&p(t,o),i}()).prototype,"_onCharReset",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onCharReset"),t.prototype),i(t.prototype,"_onPauseShow",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onPauseShow"),t.prototype),i(t.prototype,"_onPauseHide",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onPauseHide"),t.prototype),t);x.a=O}).call(this,k(2).bind)},function(e,t,n){"use strict";var h={};n.r(h),n.d(h,"parseColor",function(){return r}),n.d(h,"parseVector2",function(){return i}),n.d(h,"parseVector3",function(){return a}),n.d(h,"parseVector4",function(){return u}),n.d(h,"parseString",function(){return l}),n.d(h,"parseNumber",function(){return f}),n.d(h,"parseBoolean",function(){return p}),n.d(h,"parseDefault",function(){return c});var o=n(8),d=n.n(o),s=n(26),y=n(17);function r(e,t,n,o,r){return e.addColor(t,o).name(Object(y.a)(r))}function i(e,t,n,o,r){var i;switch(r){case"uRadialBlur":(i=e.addFolder(Object(y.a)(r))).add(t[o],"x",0,1,.01).name("X").step(.1),i.add(t[o],"y",0,5,.01).name("Y").step(.1);break;default:(i=e.addFolder(Object(y.a)(r))).add(t[o],"x").name("X").step(.1),i.add(t[o],"y").name("Y").step(.1)}return i}function a(e,t,n,o,r){var i=new d.a,a=e.addFolder(Object(y.a)(r)),s=a.add(t[o],"x").name("X").step(.1).onChange(function(e){return i.dispatch(e)}),u=a.add(t[o],"y").name("Y").step(.1).onChange(function(e){return i.dispatch(e)}),c=a.add(t[o],"z").name("Z").step(.1).onChange(function(e){return i.dispatch(e)});switch(o){case"position":s.min(-3e3).max(3e3),u.min(-3e3).max(3e3),c.min(-3e3).max(3e3)}return i}function u(e,t,n,o,r){var i=e.addFolder(Object(y.a)(r));return i.add(t[o],"x").name("X").step(.1),i.add(t[o],"y").name("Y").step(.1),i.add(t[o],"z").name("Z").step(.1),i.add(t[o],"w").name("W").step(.1),i}function c(e,t,n,o,r){return e.add(t,o).name(Object(y.a)(r))}function l(e,t,n,o,r){return"#"===n.charAt(0)?e.addColor(t,o).name(Object(y.a)(r)):c(e,t,0,o,r)}function f(e,t,n,o,r){switch(r){case"intensity":return e.add(t,o,0,50,.01).name(Object(y.a)(r));case"opacity":return e.add(t,o,0,1,.01).name(Object(y.a)(r));case"bias":return e.add(t,o,0,.1,.001).name(Object(y.a)(r));case"progress":return e.add(t,o,0,1,.01).name(Object(y.a)(r));case"offsetFloat":return e.add(t,o,-1,1,.01).name(Object(y.a)(r));case"explode":return e.add(t,o,0,1,.01).name(Object(y.a)(r));default:return c(e,t,0,o,r)}}var p=c;n.d(t,"a",function(){return _});var v={color:/color/gi,boolean:/transparent|fog|visible|enabled/gi,vector3:/position|scale|rotation/gi,number:/intensity|size|near|far|width|height|progress|bias|boost/gi,string:/map/gi},m={distance:"number",strength:"number",radius:"number",threshold:"number",opacity:"number",specularShininess:"number",specularStrength:"number",emissive:"color",offset:"vector3",offsetFloat:"number",explode:"number"};function _(e){var u=e.object,t=e.folder,n=e.propertiesWhitelist,c=void 0===n?[]:n,o=e.folderName,r=void 0===o?null:o,i=e.changeCb,l=void 0===i?null:i;r||(r=void 0!==u.uuid?"".concat(u.type,"  [").concat(u.uuid.slice(0,3),"]"):void 0!==u.type?u.type:"Folder"),t||(t=s.a.addFolder(r));var f=t.addFolder(r),a=function(t){var e=u[t];if(-1===(c.length&&c.indexOf(t))||void 0===e)return p=t,"continue";var n=void 0;for(var o in v){var r=v[o];t.match(r)&&(n=o)}if(n||(n=m[t]),!n)return p=t,"continue";var i=t,a=u;"u"===t.charAt(0)&&(a=e,i=t,t="value");var s=(0,h["parse".concat(Object(y.a)(n))])(f,a,e,t,i);l&&"function"==typeof s.onChange&&s.onChange(function(e){return l(t,e)}),s instanceof d.a&&s.add(function(e){return l(t,e)}),p=t};for(var p in u)a(p);return f}},function(e,t,n){"use strict";var r=n(213);function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._worker=null,this._initialized=!1}var t,n,o;return t=e,(n=[{key:"add",value:function(){var e;return(e=this._eventWorker).add.apply(e,arguments)}},{key:"addOnce",value:function(){var e;return(e=this._eventWorker).addOnce.apply(e,arguments)}},{key:"dispatch",value:function(){var e;(e=this._eventWorker).dispatch.apply(e,arguments)}},{key:"destroy",value:function(){this._worker.terminate()}},{key:"_init",value:function(){this._initialized||(this._initialized=!0,this._eventWorker=new r.a(this._worker))}},{key:"worker",get:function(){return this._worker},set:function(e){this._worker=e,this._init()}}])&&i(t.prototype,n),o&&i(t,o),e}(),o=n(214),s=n.n(o);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function l(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var h=function(){},d=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=l(this,f(t).call(this))).worker=new s.a,e}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(t,a),n=t,(o=[{key:"load",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:h;return this.dispatch("load",e),this.add("progress:".concat(e),t),this.addOnce("loaded:".concat(e))}},{key:"abort",value:function(e){this.dispatch("abort",e),this._eventWorker.remove("loaded:".concat(e)),this._eventWorker.remove("progress:".concat(e))}}])&&c(n.prototype,o),r&&c(n,r),t}();t.a=new d},,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.isElement=function(e){if("HTMLElement"in window)return e&&e instanceof window.HTMLElement;return!(!e||"object"!==(void 0===e?"undefined":o(e))||1!==e.nodeType||"string"!=typeof e.nodeName)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isArray=function(e){return!(!e||e.constructor!==Array)}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.camelToKebab=function(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},t.capitalize=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},t.isBrowser=function(){return!(void 0!==e&&"node"===e.title)}}).call(this,n(83))},function(t,n,o){var r;!function(e){"use strict";void 0===(r=function(){function t(e){Error.call(this),this.message=e,this.name=t.name,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,t)}return(t.prototype=Object.create(Error.prototype)).constructor=t}.call(n,o,n,t))||(t.exports=r)}(o(25))},function(t,n,o){var r;!function(e){"use strict";void 0===(r=function(){return{pending:e,fulfilled:o,rejected:n,inspect:function(e){var t=e.state();return 0===t?{state:"pending"}:0<t?o(e.value):n(e.value)}};function e(){return{state:"pending"}}function n(e){return{state:"rejected",reason:e}}function o(e){return{state:"fulfilled",value:e}}}.call(n,o,n,t))||(t.exports=r)}(o(25))},function(t,n,o){var r;!function(e){"use strict";void 0===(r=function(){return e.tryCatchResolve=t,e;function e(a,s){return arguments.length<2&&(s=t),function(e,t,n){var o=a._defer(),r=n.length,i=new Array(r);return u({f:e,thisArg:t,args:n,params:i,i:r-1,call:s},o._handler),o};function u(e,t){if(e.i<0)return s(e.f,e.thisArg,e.params,t);a._handler(e.args[e.i]).fold(n,e,void 0,t)}function n(e,t,n){e.params[e.i]=t,e.i-=1,u(e,n)}}function t(e,t,n,o){try{o.resolve(e.apply(t,n))}catch(e){o.reject(e)}}}.call(n,o,n,t))||(t.exports=r)}(o(25))},function(p,e,t){"use strict";(function(e){function t(e){o.length||(n(),!0),o[o.length]=e}p.exports=t;var n,o=[],r=0;function i(){for(;r<o.length;){var e=r;if(r+=1,o[e].call(),1024<r){for(var t=0,n=o.length-r;t<n;t++)o[t]=o[t+r];o.length-=r,r=0}}o.length=0,r=0,!1}var a,s,u,c=void 0!==e?e:self,l=c.MutationObserver||c.WebKitMutationObserver;function f(o){return function(){var e=setTimeout(n,0),t=setInterval(n,50);function n(){clearTimeout(e),clearInterval(t),o()}}}n="function"==typeof l?(a=1,s=new l(i),u=document.createTextNode(""),s.observe(u,{characterData:!0}),function(){a=-a,u.data=a}):f(i),t.requestFlush=n,t.makeRequestCallFromTimer=f}).call(this,t(34))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}}();t.hasCookies=function(){var e=new u;try{var t="__test";e.setItem(t,"1");var n=e.getItem(t);return e.removeItem(t),"1"===n}catch(e){return!1}};var r,i=n(456),a=(r=i)&&r.__esModule?r:{default:r};var s="lS_",u=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.cookieOptions=Object.assign({path:"/"},e),s=void 0===e.prefix?s:e.prefix}return o(t,[{key:"getItem",value:function(e){var t=a.default.parse(document.cookie);return t&&t.hasOwnProperty(s+e)?t[s+e]:null}},{key:"setItem",value:function(e,t){return document.cookie=a.default.serialize(s+e,t,this.cookieOptions),t}},{key:"removeItem",value:function(e){var t=Object.assign({},this.cookieOptions,{maxAge:-1});return document.cookie=a.default.serialize(s+e,"",t),null}},{key:"clear",value:function(){var e=a.default.parse(document.cookie);for(var t in e)0===t.indexOf(s)&&this.removeItem(t.substr(s.length));return null}}]),t}();t.default=u},function(e,t,n){e.exports={default:n(459),__esModule:!0}},function(e,t,n){var i=n(461);e.exports=function(o,r,e){if(i(o),void 0===r)return o;switch(e){case 1:return function(e){return o.call(r,e)};case 2:return function(e,t){return o.call(r,e,t)};case 3:return function(e,t,n){return o.call(r,e,t,n)}}return function(){return o.apply(r,arguments)}}},function(e,t,n){e.exports=!n(61)&&!n(95)(function(){return 7!=Object.defineProperty(n(173)("div"),"a",{get:function(){return 7}}).a})},function(e,t,n){var o=n(71),r=n(47).document,i=o(r)&&o(r.createElement);e.exports=function(e){return i?r.createElement(e):{}}},function(e,t,n){var o=n(465),r=n(470);e.exports=n(124)?function(e,t,n){return o.f(e,t,r(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t){var n=0,o=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+o).toString(36))}},function(e,t,n){var o=n(178),r=n(179);e.exports=function(e){return o(r(e))}},function(e,t,n){var o=n(477);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==o(e)?e.split(""):Object(e)}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t){var n=Math.ceil,o=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(0<e?o:n)(e)}},function(e,t,n){"use strict";t.__esModule=!0,t.default=function(e){var t=e.createBuffer(1,1,e.sampleRate),n=e.createBufferSource();n.buffer=t,n.connect(e.destination),n.start(0),n.stop(0),n.disconnect()}},function(e,t,n){"use strict";t.__esModule=!0,t.default=navigator&&/(iPhone|iPad|iPod)/i.test(navigator.userAgent)},function(e,t,n){"use strict";t.__esModule=!0;var o,r=n(127),i=(o=r)&&o.__esModule?o:{default:o};var a=[],s={},u=document.createElement("audio");function c(e){if("string"!=typeof e)return"";if("data:"===e.slice(0,5)){var t=e.match(/data:audio\/(ogg|mp3|opus|wav|m4a)/i);if(t&&1<t.length)return t[1].toLowerCase()}var n=(e=(e=e.split("?")[0]).slice(e.lastIndexOf("/")+1)).split(".");return 1===n.length||""===n[0]&&2===n.length?"":n.pop().toLowerCase()}function l(e){return!!(e&&window.ArrayBuffer&&e instanceof window.ArrayBuffer)}function f(e){return!!(e&&window.HTMLMediaElement&&e instanceof window.HTMLMediaElement)}function p(e){return!(!e||"string"!=typeof e||!(-1<e.indexOf(".")||"data:"===e.slice(0,5)))}function h(e){return e.src||e.url||e.data||e}u&&([{ext:"ogg",type:'audio/ogg; codecs="vorbis"'},{ext:"mp3",type:"audio/mpeg;"},{ext:"opus",type:'audio/ogg; codecs="opus"'},{ext:"wav",type:'audio/wav; codecs="1"'},{ext:"m4a",type:"audio/x-m4a;"},{ext:"m4a",type:"audio/aac;"}].forEach(function(e){var t=!!u.canPlayType(e.type);t&&-1===a.indexOf(e.ext)&&a.push(e.ext),s[e.ext]=t}),u=null),t.default={canPlay:s,containsURL:function(e){if(!e||f(e))return!1;var t=h(e);return p(t)||l(t)||Array.isArray(t)&&p(t[0])},extensions:a,getFileExtension:c,getSrc:h,getSupportedFile:function(n){var o=void 0;if(Array.isArray(n))for(var e=0;e<n.length;e++){var t=c(o=n[e]);if(-1<a.indexOf(t))break}else"object"===(void 0===n?"undefined":(0,i.default)(n))&&Object.keys(n).some(function(e){var t=c(o=n[e]);return-1<a.indexOf(t)});return o||n},isAudioBuffer:function(e){return!!(e&&window.AudioBuffer&&e instanceof window.AudioBuffer)},isArrayBuffer:l,isMediaElement:f,isMediaStream:function(e){return!!(e&&"function"==typeof e.getAudioTracks&&e.getAudioTracks().length&&window.MediaStreamTrack&&e.getAudioTracks()[0]instanceof window.MediaStreamTrack)},isOscillatorType:function(e){return!(!e||"string"!=typeof e||"sine"!==e&&"square"!==e&&"sawtooth"!==e&&"triangle"!==e)},isURL:p}},function(e,t,n){"use strict";var g=n(100),b=n(84),w=n(185),O=n(70),x=n(130),k=n(493),E=n(136),P=n(500),T=n(73)("iterator"),S=!([].keys&&"next"in[].keys()),j="values",C=function(){return this};e.exports=function(e,t,n,o,r,i,a){k(n,t,o);var s,u,c,l=function(e){if(!S&&e in d)return d[e];switch(e){case"keys":case j:return function(){return new n(this,e)}}return function(){return new n(this,e)}},f=t+" Iterator",p=r==j,h=!1,d=e.prototype,y=d[T]||d["@@iterator"]||r&&d[r],v=y||l(r),m=r?p?l("entries"):v:void 0,_="Array"==t&&d.entries||y;if(_&&(c=P(_.call(new e)))!==Object.prototype&&c.next&&(E(c,f,!0),g||"function"==typeof c[T]||O(c,T,C)),p&&y&&y.name!==j&&(h=!0,v=function(){return y.call(this)}),g&&!a||!S&&!h&&d[T]||O(d,T,v),x[t]=v,x[f]=C,r)if(s={values:p?v:l(j),keys:i?v:l("keys"),entries:m},a)for(u in s)u in d||w(d,u,s[u]);else b(b.P+b.F*(S||h),t,s);return s}},function(e,t,n){e.exports=n(70)},function(e,t,n){var a=n(62),s=n(72),u=n(496)(!1),c=n(133)("IE_PROTO");e.exports=function(e,t){var n,o=s(e),r=0,i=[];for(n in o)n!=c&&a(o,n)&&i.push(n);for(;t.length>r;)a(o,n=t[r++])&&(~u(i,n)||i.push(n));return i}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var o=n(186),r=n(135).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return o(e,r)}},function(e,t,n){var o=n(139),r=n(96),i=n(72),a=n(122),s=n(62),u=n(172),c=Object.getOwnPropertyDescriptor;t.f=n(61)?c:function(e,t){if(e=i(e),t=a(t,!0),u)try{return c(e,t)}catch(e){}if(s(e,t))return r(!o.f.call(e,t),e[t])}},function(e,t,n){"use strict";t.__esModule=!0,t.default=i;var o,r=n(126),c=(o=r)&&o.__esModule?o:{default:o};function i(r,e){var i=[],t=new c.default(r),a=r.createGain(),n=1,s=null;function o(t,e){var n=void 0;return t||0===t?(i.some(function(e){return(e===t||e.id===t)&&(n=e,!0)}),n&&e?e(n):n):n}function u(e){return o(e,function(e){return i.splice(i.indexOf(e),1)}),s}return r&&(t.setSource(a),t.setDestination(e||r.destination)),s={add:function(e){return e.gain.disconnect(),e.gain.connect(a),i.push(e),e.once("destroy",u),s},find:o,remove:u,play:function(t,n){return i.forEach(function(e){return e.play(t,n)}),s},pause:function(){return i.forEach(function(e){e.playing&&e.pause()}),s},resume:function(){return i.forEach(function(e){e.paused&&e.play()}),s},stop:function(){return i.forEach(function(e){return e.stop()}),s},seek:function(t){return i.forEach(function(e){return e.seek(t)}),s},setVolume:function(e){return s.volume=e,s},mute:function(){return n=s.volume,s.volume=0,s},unMute:function(){return s.volume=n||1,s},fade:function(t,n){if(r){var e=a.gain,o=r.currentTime;e.cancelScheduledValues(o),e.setValueAtTime(e.value,o),e.linearRampToValueAtTime(t,o+n)}else i.forEach(function(e){return e.fade(t,n)});return s},load:function(){i.forEach(function(e){return e.load()})},unload:function(){i.forEach(function(e){return e.unload()})},destroy:function(){for(;i.length;)i.pop().destroy()},gain:a,get effects(){return t._nodes},set effects(e){t.removeAll().add(e)},get fx(){return this.effects},set fx(e){this.effects=e},get sounds(){return i},get volume(){return a.gain.value},set volume(t){isNaN(t)||(t=Math.min(Math.max(t,0),1),r?(a.gain.cancelScheduledValues(r.currentTime),a.gain.value=t,a.gain.setValueAtTime(t,r.currentTime)):a.gain.value=t,i.forEach(function(e){e.context||(e.groupVolume=t)}))}}}i.Effects=c.default},function(e,t,n){"use strict";t.__esModule=!0,t.default=i;var o,r=n(193),b=(o=r)&&o.__esModule?o:{default:o};var w=["","ABORTED","NETWORK","DECODE","SRC_NOT_SUPPORTED"];function i(t,n){var o=new b.default,r=null,i=null,a=!1,s=0,u=null,c=null;function l(){o.off(),i&&"function"==typeof i.removeEventListener&&(i.removeEventListener("load",m),i.removeEventListener("canplaythrough",m),i.removeEventListener("error",h),i.onerror=null),u&&(u.removeEventListener("progress",p),u.removeEventListener("load",v),u.removeEventListener("error",h))}function f(e){o.emit("progress",1),o.emit("loaded",e),o.emit("complete",e),l()}function p(e){e.lengthComputable&&(s=e.loaded/e.total,o.emit("progress",s))}function h(){d();var e="";u?e=u.status+" "+u.statusText:i&&i.error&&(e=w[i.error.code]),o.listenerCount("error")&&o.emit("error",new Error("Load Error: "+e+" "+t)),l()}function d(){window.clearTimeout(c)}function y(e){r.decodeAudioData(e,function(e){u=null,s=1,f(i=e)},h)}function v(){400<=u.status?h():y(u.response)}function m(){d(),i&&(i.readyState?(s=1,f(i)):h())}function e(){d(),l(),u&&4!==u.readyState&&u.abort(),u=null}function _(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];!t||n&&!e||(r?t instanceof window.ArrayBuffer?y(t):((u=new XMLHttpRequest).open("GET",t,!0),u.responseType="arraybuffer",u.addEventListener("progress",p),u.addEventListener("load",v),u.addEventListener("error",h),u.send()):(i&&i.tagName||(i=document.createElement("audio")),a||(d(),c=window.setTimeout(m,3e3),i.addEventListener("canplaythrough",m,!1),i.addEventListener("load",m,!1)),i.addEventListener("error",h,!1),i.preload="auto",i.onerror=h,i.src=t,i.load(),a&&f(i)))}var g={on:o.on.bind(o),once:o.once.bind(o),off:o.off.bind(o),load:function(e){t=e,_()},start:_,cancel:e,destroy:function(){e(),r=i=u=null}};return Object.defineProperties(g,{data:{get:function(){return i}},progress:{get:function(){return s}},audioContext:{set:function(e){r=e}},isTouchLocked:{set:function(e){a=e}},url:{get:function(){return t}}}),Object.freeze(g)}i.Group=function(){var n=new b.default,t=[],o=0,r=0,e=null;function i(e){var t=o+e;n.emit("progress",t/r)}function a(){o++,c(),n.emit("progress",o/r),u()}function s(e){c(),n.listenerCount("error")&&n.emit("error",e),u()}function u(){if(0===t.length)return e=null,void n.emit("complete");(e=t.pop()).on("progress",i),e.once("loaded",a),e.once("error",s),e.start()}function c(){e.off("progress",i),e.off("loaded",a),e.off("error",s)}return Object.freeze({on:n.on.bind(n),once:n.once.bind(n),off:n.off.bind(n),add:function(e){return t.push(e),r++,e},start:function(){r=t.length,u()}})}},function(e,t,n){"use strict";t.__esModule=!0;var o=a(n(86)),r=a(n(140)),i=a(n(141));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(){return(0,o.default)(this,t),(0,r.default)(this,e.call(this))}return(0,i.default)(t,e),t.prototype.off=function(e,t){return t?this.removeListener(e,t):e?this.removeAllListeners(e):this.removeAllListeners()},t}(a(n(523)).default.EventEmitter);t.default=s},function(e,t,n){"use strict";t.__esModule=!0;var o,r=n(99),a=(o=r)&&o.__esModule?o:{default:o};var i=void 0;t.default={getOfflineContext:function(e,t,n){if(i)return i;e=e||2,t=(n=n||44100)||e;var o=window.OfflineAudioContext||window.webkitOfflineAudioContext;return i=o?new o(e,t,n):null},cloneBuffer:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:e.length;if(!a.default||a.default.isFake)return e;for(var o=e.numberOfChannels,r=a.default.createBuffer(o,n,e.sampleRate),i=0;i<o;i++)r.getChannelData(i).set(e.getChannelData(i).slice(t,t+n));return r},reverseBuffer:function(e){for(var t=e.numberOfChannels,n=0;n<t;n++)Array.prototype.reverse.call(e.getChannelData(n));return e},ramp:function(e,t,n,o,r){a.default.isFake||(e.setValueAtTime(t,a.default.currentTime),r?e.linearRampToValueAtTime(n,a.default.currentTime+o):e.exponentialRampToValueAtTime(n,a.default.currentTime+o))},getFrequency:function(e){if(a.default.isFake)return 0;var t=a.default.sampleRate/2,n=Math.log(t/40)/Math.LN2;return t*Math.pow(2,n*(e-1))},timeCode:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:":",n=Math.floor(e/60),o=Math.floor(e%3600%60);return(n<10?"0"+n:n)+t+(o<10?"0"+o:o)}}},function(e,t,n){"use strict";t.__esModule=!0,t.default=function(e){return"number"==typeof e&&!isNaN(e)&&isFinite(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clamp=function(e,t,n){return Math.min(n,Math.max(t,e))}},,function(e,h,d){"use strict";(function(e){var t,r=d(199),i=d(365),a=d(3);function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var n,o,u,c,l,f,p=(n=(t=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,(n=[{key:"onDOMContentLoaded",value:function(){this._checkSupported()&&this._init()}},{key:"_init",value:function(){a.a.bind(),i.a.addFunctions(),this._fancyLog(),(new r.a).$mount("#application")}},{key:"_checkSupported",value:function(){return!0}},{key:"_fancyLog",value:function(){var e="background: #FFFFFF; color: #393df1; padding: 3px 5px; font-weight: bold;",t="background: #FFFFFF; color: #30336b; padding: 3px 5px; font-weight: bold;";console.log(""),console.log("%c💌 Plume and the forgotten letter","background: #FFFFFF; color: #9166d1; padding: 3px 5px; font-weight: bold;"),console.log("%c🚀 Made with three.js and cannon.js","background: #FFFFFF; font-style: italic; color: #bfa4e8; padding: 3px 5px;"),console.log(""),console.log("%c🙌 Team:",e),console.log("%c - Fabien Motte: Creative developer",e),console.log("%c - Patrick Heng: Creative developer",e),console.log("%c - Alexadre Delalleau: 3D Modeling - Motion -  Art Direction",e),console.log("%c - Nicolas Mathis: 3D Modeling - Art Direction",e),console.log("%c - Louis Gabriel Gonzalez | Mohave : Music",e),console.log(""),console.log("%c🧐 Debug shortcuts:",t),console.log("%c - SHIFT + C: Change camera",t),console.log("%c - SHIFT + O: Toggle cannon.js collisions",t),console.log("%c - SHIFT + Alt/Option: Save character position",t),console.log("%c - SHIFT + T: Teleport character at saved position",t),console.log("%c - SHIFT + Click: Teleport character to raycast point",t),console.log("")}}])&&s(t.prototype,n),o&&s(t,o),e}()).prototype,o="onDOMContentLoaded",u=[e],c=Object.getOwnPropertyDescriptor(t.prototype,"onDOMContentLoaded"),l=t.prototype,f={},Object.keys(c).forEach(function(e){f[e]=c[e]}),f.enumerable=!!f.enumerable,f.configurable=!!f.configurable,("value"in f||f.initializer)&&(f.writable=!0),f=u.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},f),l&&void 0!==f.initializer&&(f.value=f.initializer?f.initializer.call(l):void 0,f.initializer=void 0),void 0===f.initializer&&(Object.defineProperty(n,o,f),f=null),t);h.a=p}).call(this,d(2).bind)},function(e,j,C){"use strict";(function(e){var t,i=C(3),a=C(12),s=C(345),u=C(347),c=C(348),l=C(349),f=C(350),p=C(351),h=C(352),d=C(353),y=C(354),v=C(355),m=C(6),_=C(369);function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function b(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function w(e,t,n){return(w="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=O(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function x(e,t){return(x=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var o,r,k,E,P,T,S=(o=(t=function(e){function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),b(this,O(n).apply(this,arguments))}var t,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&x(e,t)}(n,a["a"]),t=n,(o=[{key:"init",value:function(){this.$name="application"}},{key:"mounted",value:function(){var e=this;w(O(n.prototype),"mounted",this).call(this),this._signals.application.mounted.dispatch(this.$el),this._konamiDetect=Object(s.a)(this._onKonamiCode),this._state.isIframe&&this.$el.classList.add("is-iframe"),this.$nextTick(function(){e._router.init(_.a),e._router.mount(e.$els.router),i.a.device.desktop||e._router.navigate("/fallback")});var t=navigator.language||navigator.userLanguage;Object(m.a)("init","init-lang",t)}},{key:"_onKonamiCode",value:function(){this._signals.konami.toggle.dispatch(),this._state.konamiIsActivated=!0,this._signals.toastMsg.log.dispatch("konami","speed run toggle")}},{key:"template",get:function(){return C(576)}},{key:"components",get:function(){return{Preloader:u.a,GL:c.a,Quality:l.a,ToastMsg:f.a,Instructions:p.a,SoundBars:h.a,Fullscreen:d.a,GamepadInfos:y.a,Speedrun:v.a}}}])&&g(t.prototype,o),r&&g(t,r),n}()).prototype,r="_onKonamiCode",k=[e],E=Object.getOwnPropertyDescriptor(t.prototype,"_onKonamiCode"),P=t.prototype,T={},Object.keys(E).forEach(function(e){T[e]=E[e]}),T.enumerable=!!T.enumerable,T.configurable=!!T.configurable,("value"in T||T.initializer)&&(T.writable=!0),T=k.slice().reverse().reduce(function(e,t){return t(o,r,e)||e},T),P&&void 0!==T.initializer&&(T.value=T.initializer?T.initializer.call(P):void 0,T.initializer=void 0),void 0===T.initializer&&(Object.defineProperty(o,r,T),T=null),t);j.a=S}).call(this,C(2).bind)},function(r,e,t){(function(e){var i=NaN,a="[object Symbol]",s=/^\s+|\s+$/g,u=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,l=/^0o[0-7]+$/i,f=parseInt,t="object"==typeof e&&e&&e.Object===Object&&e,n="object"==typeof self&&self&&self.Object===Object&&self,o=t||n||Function("return this")(),p=Object.prototype.toString,_=Math.max,g=Math.min,b=function(){return o.Date.now()};function w(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function O(e){if("number"==typeof e)return e;if("symbol"==typeof(t=e)||(n=t)&&"object"==typeof n&&p.call(t)==a)return i;var t,n;if(w(e)){var o="function"==typeof e.valueOf?e.valueOf():e;e=w(o)?o+"":o}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(s,"");var r=c.test(e);return r||l.test(e)?f(e.slice(2),r?2:8):u.test(e)?i:+e}r.exports=function(o,r,e){var i,a,s,u,c,l,f=0,p=!1,h=!1,t=!0;if("function"!=typeof o)throw new TypeError("Expected a function");function d(e){var t=i,n=a;return i=a=void 0,f=e,u=o.apply(n,t)}function y(e){var t=e-l;return void 0===l||r<=t||t<0||h&&s<=e-f}function v(){var e,t,n=b();if(y(n))return m(n);c=setTimeout(v,(t=r-((e=n)-l),h?g(t,s-(e-f)):t))}function m(e){return c=void 0,t&&i?d(e):(i=a=void 0,u)}function n(){var e,t=b(),n=y(t);if(i=arguments,a=this,l=t,n){if(void 0===c)return f=e=l,c=setTimeout(v,r),p?d(e):u;if(h)return c=setTimeout(v,r),d(l)}return void 0===c&&(c=setTimeout(v,r)),u}return r=O(r)||0,w(e)&&(p=!!e.leading,s=(h="maxWait"in e)?_(O(e.maxWait)||0,r):s,t="trailing"in e?!!e.trailing:t),n.cancel=function(){void 0!==c&&clearTimeout(c),i=l=a=c=void(f=0)},n.flush=function(){return void 0===c?u:m(b())},n}}).call(this,t(34))},function(e,t,n){"use strict";var o=n(400),r=n(402),i=n(404);function a(){}e.exports=function(){var t=i(o);return t?{visible:n,onChange:r(function(e){o.addEventListener(t.event,function(){e(n())})})}:{visible:function(){return!0},onChange:a};function n(){return!o[t.hidden]}}},function(a,e,t){!function(){"use strict";var i="undefined"!=typeof window&&void 0!==window.document?window.document:{},e=a.exports,n="undefined"!=typeof Element&&"ALLOW_KEYBOARD_INPUT"in Element,o=function(){for(var e,t=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],n=0,o=t.length,r={};n<o;n++)if((e=t[n])&&e[1]in i){for(n=0;n<e.length;n++)r[t[0][n]]=e[n];return r}return!1}(),r={change:o.fullscreenchange,error:o.fullscreenerror},t={request:function(e){var t=o.requestFullscreen;e=e||i.documentElement,/ Version\/5\.1(?:\.\d+)? Safari\//.test(navigator.userAgent)?e[t]():e[t](n?Element.ALLOW_KEYBOARD_INPUT:{})},exit:function(){i[o.exitFullscreen]()},toggle:function(e){this.isFullscreen?this.exit():this.request(e)},onchange:function(e){this.on("change",e)},onerror:function(e){this.on("error",e)},on:function(e,t){var n=r[e];n&&i.addEventListener(n,t,!1)},off:function(e,t){var n=r[e];n&&i.removeEventListener(n,t,!1)},raw:o};o?(Object.defineProperties(t,{isFullscreen:{get:function(){return Boolean(i[o.fullscreenElement])}},element:{enumerable:!0,get:function(){return i[o.fullscreenElement]}},enabled:{enumerable:!0,get:function(){return Boolean(i[o.fullscreenEnabled])}}}),e?a.exports=t:window.screenfull=t):e?a.exports=!1:window.screenfull=!1}()},function(e,t,n){"use strict";var r=n(3);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,(n=[{key:"type",get:function(){var e="";return this.osx?e="osx":this.windows?e="windows":this.linux?e="linux":this.android?e="android":this.ios&&(e="ios"),e}},{key:"osx",get:function(){return r.a._find("mac os x")}},{key:"windows",get:function(){return r.a._find("windows")}},{key:"linux",get:function(){return r.a._find("linux")}},{key:"ios",get:function(){return r.a.device.iphone||r.a.device.ipod||r.a.device.ipad}},{key:"android",get:function(){return r.a._find("android")}},{key:"cordova",get:function(){return window.cordova&&"file:"===window.location.protocol}},{key:"nodeWebkit",get:function(){return"object"===i(window.process)}}])&&a(t.prototype,n),o&&a(t,o),e}();t.a=o},function(e,t,n){"use strict";var r=n(3);function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,(n=[{key:"_getVersion",value:function(){var e,t,n,o;return n=void 0,(t=(o=r.a.userAgent).match(/(edge(?=\/))\/?\s*(\d+)/i)||[]).length?{name:t[1],version:t[2]}:(e=o.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[],/trident/i.test(e[1])?{name:"IE ",version:(n=/\brv[ :]+(\d+)/g.exec(o)||[])[1]||""}:"Chrome"===e[1]&&null!==(n=o.match(/\bOPR\/(\d+)/))?{name:"Opera",version:n[1]}:(e=e[2]?[e[1],e[2]]:[r.a.navigator.appName,r.a.navigator.appVersion,"-?"],null!==(n=o.match(/version\/(\d+)/i))&&e.splice(1,1,n[1]),e[1]))}},{key:"chrome",get:function(){return r.a._find("chrome")&&!this.edge}},{key:"firefox",get:function(){return r.a._find("firefox")}},{key:"safari",get:function(){return r.a._find("safari")}},{key:"edge",get:function(){return r.a._find("edge")}},{key:"opera",get:function(){return r.a._find("opera")||r.a._find("opr")}},{key:"ie",get:function(){return null!==new RegExp("trident/.*rv:([0-9]{1,}[0-9]{0,})").exec(r.a.userAgent)||null!==new RegExp("msie").exec(r.a.userAgent)}},{key:"ie11",get:function(){return r.a._find("msie 11.0")}},{key:"ie10",get:function(){return r.a._find("msie 10.0")}},{key:"ie9",get:function(){return r.a._find("msie 9.0")}},{key:"ie8",get:function(){return r.a._find("msie 8.0")}},{key:"ie7",get:function(){return r.a._find("msie 7.0")}},{key:"ie6",get:function(){return r.a._find("msie 6.0")}},{key:"lteIE11",get:function(){return this.ie11||this.ie10||this.ie9||this.ie8||this.ie7||this.ie6}},{key:"name",get:function(){var e="";return this.chrome?e="chrome":this.firefox?e="firefox":this.safari?e="safari":this.edge?e="edge":this.opera?e="opera":this.ie&&(e="ie"),e}},{key:"version",get:function(){return this._getVersion()}}])&&i(t.prototype,n),o&&i(t,o),e}();t.a=o},function(e,t,n){"use strict";var r=n(3);function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,(n=[{key:"type",get:function(){var e="";return this.mobile?e="mobile":this.tablet?e="tablet":this.desktop&&(e="desktop"),e}},{key:"orientation",get:function(){var e="portrait";return this.landscape&&(e="landscape"),e}},{key:"portrait",get:function(){return 1<window.innerHeight/window.innerWidth}},{key:"landscape",get:function(){return window.innerHeight/window.innerWidth<1}},{key:"nexus5",get:function(){return r.a._find("nexus 5")}},{key:"iphone",get:function(){return r.a._find("iphone")}},{key:"iphone4",get:function(){return this.iphone&&480===window.screen.height}},{key:"iphone5",get:function(){return this.iphone&&568===window.screen.height}},{key:"ipod",get:function(){return r.a._find("ipod")}},{key:"ipad",get:function(){return r.a._find("ipad")}},{key:"android",get:function(){return r.a._find("android")}},{key:"androidPhone",get:function(){return this.android&&r.a._find("mobile")}},{key:"androidTablet",get:function(){return this.android&&!r.a._find("mobile")}},{key:"blackberry",get:function(){return r.a._find("blackberry")||r.a._find("bb10")||r.a._find("rim")}},{key:"blackberryPhone",get:function(){return this.blackberry&&!r.a._find("tablet")}},{key:"blackberryTablet",get:function(){return this.blackberry&&r.a._find("tablet")}},{key:"windows",get:function(){return r.a._find("windows")}},{key:"windowsPhone",get:function(){return this.windows&&r.a._find("phone")}},{key:"windowsTablet",get:function(){return this.windows&&r.a._find("touch")&&!this.windowsPhone}},{key:"mobile",get:function(){return this.androidPhone||this.iphone||this.ipod||this.windowsPhone||this.blackberryPhone}},{key:"tablet",get:function(){return this.ipad||this.androidTablet||this.blackberryTablet||this.windowsTablet}},{key:"desktop",get:function(){return!this.tablet&&!this.mobile}}])&&i(t.prototype,n),o&&i(t,o),e}();t.a=o},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._webglContext=this._getWebglContext()}var t,n,o;return t=e,(n=[{key:"_getWebglContext",value:function(){return document.createElement("canvas").getContext("webgl")||document.createElement("canvas").getContext("experimental-webgl")}},{key:"_webglSupported",value:function(){return!!this._webglContext}},{key:"_getWebglExtension",value:function(e,t){var n=["","WEBKIT_","MOZ_"],o=null;for(var r in n)if(o=e.getExtension(n[r]+t))break;return o}},{key:"_webglExtensions",value:function(){var e=this._webglContext;return e?{dxt:this._getWebglExtension(e,"WEBGL_compressed_texture_s3tc")}:null}},{key:"_webglTextureFormat",value:function(){var e=this._webglExtensions(),t="uncompressed";return e&&e.dxt&&e.dxt.COMPRESSED_RGB_S3TC_DXT1_EXT&&(t="dxt"),{format:t,compressed:"uncompressed"!==t}}},{key:"gamepad",get:function(){return void 0!==window.navigator.getGamepads}},{key:"canvas",get:function(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))}},{key:"webgl",get:function(){return{supported:this._webglSupported(),extensions:this._webglExtensions(),textureFormat:this._webglTextureFormat()}}},{key:"blob",get:function(){return!!window.Blob}},{key:"worker",get:function(){return"undefined"!=typeof Worker}},{key:"webglContext",get:function(){return this._webglContext}}])&&r(t.prototype,n),o&&r(t,o),e}();t.a=o},function(e,y,v){"use strict";(function(e){var t,i=v(1);function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function s(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var o,r,l,f,p,h,d=(o=(t=function(e){function n(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{antialias:!1,alpha:!1,powerPreference:"high-performance"};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=s(this,u(n).call(this,t))).setPixelRatio(1),e.setClearColor(0,0),e.shadowMap.enabled=!0,e._bind(),e._setSize(),e}var t,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(n,THREE.WebGLRenderer),t=n,(o=[{key:"destroy",value:function(){this._unbind(),this.dispose()}},{key:"_bind",value:function(){i.a.resized.add(this._onWindowResize)}},{key:"_unbind",value:function(){i.a.resized.remove(this._onWindowResize)}},{key:"_setSize",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:i.a.width,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:i.a.height;this.setSize(e,t)}},{key:"_onWindowResize",value:function(e,t){this._setSize(e,t)}}])&&a(t.prototype,o),r&&a(t,r),n}()).prototype,r="_onWindowResize",l=[e],f=Object.getOwnPropertyDescriptor(t.prototype,"_onWindowResize"),p=t.prototype,h={},Object.keys(f).forEach(function(e){h[e]=f[e]}),h.enumerable=!!h.enumerable,h.configurable=!!h.configurable,("value"in h||h.initializer)&&(h.writable=!0),h=l.slice().reverse().reduce(function(e,t){return t(o,r,e)||e},h),p&&void 0!==h.initializer&&(h.value=h.initializer?h.initializer.call(p):void 0,h.initializer=void 0),void 0===h.initializer&&(Object.defineProperty(o,r,h),h=null),t);y.a=d}).call(this,v(2).bind)},function(e,y,v){"use strict";(function(e){var t,n=v(19),s=v.n(n),r=v(33),u=v(4),i=v(1),a=v(26),c=v(210),o=v(5);function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function f(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var p=Object(o.d)("SceneManager","#8a3ebc",!1),h=Object(o.d)("SceneManager",o.c),d=(f((t=function(){function n(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this._scenesMap=t,this._context=e,this._scenes=[],this._current=null,this._last=null,this._changeOrder=[],this._guiFolder=null,this.renderScene=new c.a,this._bind()}var e,t,o;return e=n,(t=[{key:"create",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];this._context.resume();var n=this._scenesMap[e],o=this.get(e);if(n){if(o&&t)return h("Create() : Scene '".concat(e,"' is already created")),s()(o);var r=s()();o&&!t&&(r=this.destroy(e));var i=new n(e);return this._scenes.push(i),u.a.scene.instanced.dispatch(i),r.then(function(){return i.create()}).then(function(){return p("Scene '".concat(e,"' created")),u.a.scene.created.dispatch(i),i})}h("Create() : Scene '".concat(e,"' does not exist"))}},{key:"destroy",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:r.a.pageInstance.sceneName,n=this.get(t);return n?n.destroy().then(function(){return p("Scene '".concat(t,"' destroyed")),u.a.scene.destroyed.dispatch(n),e._scenes.splice(e._scenes.indexOf(n),1),n}):(h("Destroy() : Scene '".concat(t,"' does not exist")),s()())}},{key:"change",value:function(){var t=this,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],o=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],r=!(3<arguments.length&&void 0!==arguments[3])||arguments[3],i=this._current,a=s()();return i?(a=e?this.destroy(i.name):this.pause(i.name),p("Scene changed from '".concat(i.name,"' to '").concat(n,"'"))):p("Scene changed to '".concat(n,"'")),a.then(function(){return t._changeOrder.push(n),u.a.overlay.show.dispatch(.5),s()(t.get(n)||t.create(n))}).then(function(e){return t._current&&t._current===e?(h("Change() : Current scene is already '".concat(n,"'")),s()()):t._changeOrder[t._changeOrder.length-1]!==e.name?s()():(t._last=t._current,t._current=e,t._context.scene=e,r?t.swap(t._last,t._current):t.setVisible(t._current),t._last&&t._last._postProcessing&&t._last._postProcessing.destroy(),u.a.scene.changed.dispatch(e,e.camera),t._updateGUI(),o||!e.running?t.start(t._current.name):e)})}},{key:"start",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:r.a.pageInstance.sceneName,t=this.get(e);return t?t.running?(h("Start() : Scene '".concat(e,"' already started")),s()()):(t.running=!0,t.start().then(function(){return p("Scene '".concat(e,"' started")),u.a.scene.started.dispatch(t),t})):(h("Start() : Scene '".concat(e,"' does not exist")),s()())}},{key:"pause",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:r.a.pageInstance.sceneName,t=this.get(e);return t?t.running?(t.running=!1,t.pause().then(function(){return p("Scene '".concat(e,"' paused")),u.a.scene.paused.dispatch(t),t})):(h("Pause() : Scene '".concat(e,"' already paused")),s()()):(h("Pause() : Scene '".concat(e,"' does not exist")),s()())}},{key:"update",value:function(e,t){for(var n=this._scenes,o=0,r=n.length;o<r;o++){var i=n[o];i.running&&i.update(e,t)}this.renderScene.update(e,t)}},{key:"pauseUpdate",value:function(e,t){this.renderScene.update(e,t)}},{key:"get",value:function(){for(var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=0,n=this._scenes.length;t<n;t++){var o=this._scenes[t];if(o.name.toLowerCase()===e)return o}return null}},{key:"createGUI",value:function(){}},{key:"destroyGUI",value:function(){this._guiFolder&&a.a.removeFolder(this._guiFolder)}},{key:"setVisible",value:function(e){this.renderScene.rtt1=e.rtt.texture,this.renderScene.rtt2=e.rtt.texture,this.setSize(),TweenMax.set(this.renderScene,{progress:1,ease:Expo.easeOut})}},{key:"swap",value:function(e,t){e&&(this.renderScene.rtt1=e.rtt.texture),this.renderScene.rtt2=t.rtt.texture,this.setSize(),TweenMax.delayedCall(.7,function(){u.a.overlay.hide.dispatch(1)}),TweenMax.set(this.renderScene,{progress:1})}},{key:"setSize",value:function(){var e=i.a.width,t=i.a.height;this._last&&this.renderScene.delta<1&&this._last.setSize(e,t),this._current&&this._current.setSize(e,t)}},{key:"_bind",value:function(){u.a.scene.create.add(this.create),u.a.scene.destroy.add(this.destroy),u.a.scene.change.add(this.change),u.a.scene.start.add(this.start),u.a.scene.pause.add(this.pause),i.a.resized.add(this._onResize)}},{key:"_unbind",value:function(){u.a.scene.create.remove(this.create),u.a.scene.destroy.remove(this.destroy),u.a.scene.change.remove(this.change),u.a.scene.start.remove(this.start),u.a.scene.pause.remove(this.pause),i.a.resized.remove(this._onResize)}},{key:"_updateGUI",value:function(){}},{key:"_onResize",value:function(){this.setSize()}},{key:"scene",get:function(){return this._current}}])&&l(e.prototype,t),o&&l(e,o),n}()).prototype,"create",[e],Object.getOwnPropertyDescriptor(t.prototype,"create"),t.prototype),f(t.prototype,"destroy",[e],Object.getOwnPropertyDescriptor(t.prototype,"destroy"),t.prototype),f(t.prototype,"change",[e],Object.getOwnPropertyDescriptor(t.prototype,"change"),t.prototype),f(t.prototype,"start",[e],Object.getOwnPropertyDescriptor(t.prototype,"start"),t.prototype),f(t.prototype,"pause",[e],Object.getOwnPropertyDescriptor(t.prototype,"pause"),t.prototype),f(t.prototype,"_onResize",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onResize"),t.prototype),t);y.a=d}).call(this,v(2).bind)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}}(),d=u(n(443)),_=u(n(8)),i=u(n(451)),a=u(n(452)),y=u(n(453)),s=n(577),g=n(454);function u(e){return e&&e.__esModule?e:{default:e}}var v="background: #FF925E; color: #FFFFFF; padding: 3px 5px;",c=function(){function m(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.routes,n=void 0===t?[]:t,o=e.components,r=void 0===o?{}:o,i=e.basePath,a=void 0===i?"/":i,s=e.mode,u=void 0===s?m.BROWSER_MODE:s,c=e.locale,l=void 0===c?"":c,f=e.preRendered,p=void 0!==f&&f,h=e.restoreScroll,d=void 0!==h&&h,y=e.debugMode,v=void 0!==y&&y;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,m),this.routes=n,this.components=r,this.basePath=(0,g.stripTrailingSlash)(a),this.mode=u,this.locale=(0,g.stripSlashes)(l),this.preRendered=p,this.restoreScroll=d,this.debugMode=v,this.history=null,this.routeData=[],this.action=m.REPLACE_ACTION,this.lastRoute=null,this.currentRoute=null,this.pageInstance=null,this.isFirstRoute=!0,this.routeChanged=new _.default,this.beforeEachChanged=new _.default,this.afterEachChanged=new _.default,this._mountEl=null,this._createHistory(),this._bind(),this._parseRoutes(),this._parseAnchors()}return r(m,[{key:"mount",value:function(e){this._mountEl="string"==typeof e?document.querySelector(e):e,this._firstRoute()}},{key:"navigate",value:function(){var e,n=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},o=(0,g.isString)(t)?t:t.path,r=t.query||null,i=t.hash||null,a=t.name||null,s=t.silent||!1,u=t.params||null,c=this.locale?(0,g.addLeadingSlash)(this.locale):"";if(null!==a&&(o=this._matchRouteByName(a).path),null!==o)if(o=this._cleanPath(o),null!==(e=this._match(o))){var l=e.route,f=e.callback,p=e.component;if(u&&"object"===(void 0===u?"undefined":h(u))&&(l.params=(0,y.default)(l.params,u)),l=(0,y.default)(l,{query:r,hash:i}),!this._isRouteEqual(this.currentRoute,l))if("function"==typeof f||"function"==typeof p)new d.default(function(e,t){"function"==typeof n.beforeEach?(n.beforeEach(n.lastRoute,l,e),n.beforeEachChanged.dispatch(n.lastRoute,l,e)):e(!0)}).then(function(){if(!(0<arguments.length&&void 0!==arguments[0])||arguments[0]){n.currentRoute=l;var e={pathname:""+c+o,search:r,hash:i,state:l};if(!0===s?(n.action=m.REPLACE_ACTION,n.history.replace(e)):(n.action=m.PUSH_ACTION,n.history.push(e)),"function"==typeof p){var t=new p;n.currentRoute.instance=t}new d.default(function(e,t){"function"==typeof n.afterEach?(n.afterEach(n.lastRoute,n.currentRoute,e),n.afterEachChanged.dispatch(n.lastRoute,n.currentRoute,e)):e(!0)}).then(function(){!(0<arguments.length&&void 0!==arguments[0])||arguments[0]?("function"==typeof f&&f.call(n,n.currentRoute),"function"==typeof p&&(n.pageInstance=n.currentRoute.instance,n.preRendered&&n.isFirstRoute?n.pageInstance.$preRenderMount(n._mountEl.firstElementChild):n.pageInstance.$mount(n._mountEl,"append")),n._parseAnchors(),null===n.lastRoute?(n.isFirstRoute=!1,n.lastRoute=l):n.lastRoute=n.currentRoute):n.debugMode&&console.log("%cRouter.hooks",v,"afterEach stopped route change")})}else n.debugMode&&console.log("%cRouter.hooks",v,"beforeEach stopped route change")}).catch(function(e){return console.log("%cRouter.hooks",v,e)});else this.debugMode&&console.log("%cRouter.navigate",v,"Cancel because no callback or component found")}else console.error("Router.navigate : No matching route found with path : '"+o+"'");else console.error("Router.navigate : Cannot get route path")}},{key:"go",value:function(e){this.history.go(e)}},{key:"back",value:function(){this.history.goBack()}},{key:"forward",value:function(){this.history.goForward()}},{key:"replace",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};e.silent=!0,this.navigate(e)}},{key:"beforeEach",value:function(e,t,n){e&&e.instance&&e.instance.$destroy(),n()}},{key:"afterEach",value:function(e,t,n){n()}},{key:"_createHistory",value:function(){var e={basename:this.basePath};this.debugMode&&console.log("%cRouter",v,"Browser history mode : "+this.mode),!0===(0,g.supportsBrowserHistory)()&&this.mode===m.BROWSER_MODE?this.history=(0,s.createBrowserHistory)(o({keyLength:6},e)):this.mode===m.HASH_MODE?this.history=(0,s.createHashHistory)(o({hashType:"slash"},e)):this.mode===m.MEMORY_MODE?this.history=(0,s.createMemoryHistory)({keyLength:6}):console.error("Router : Unknown history browser mode : '"+this.mode+"'"),g.supportsScrollRestoration&&(window.history.scrollRestoration=this.restoreScroll?"auto":"manual")}},{key:"_bind",value:function(){this._anchorLink=this._anchorLink.bind(this),this._handleListen=this._handleListen.bind(this),this._handleHashChange=this._handleHashChange.bind(this),this.mode===m.HASH_MODE?window.addEventListener("hashchange",this._handleHashChange,!1):this.unlisten=this.history.listen(this._handleListen)}},{key:"_unbind",value:function(){this.mode===m.HASH_MODE?window.removeEventListener("hashchange",this._handleHashChange,!1):"function"==typeof this.unlisten&&this.unlisten()}},{key:"_handleListen",value:function(e,t){if((t=t.toLowerCase())===m.POP_ACTION){var n=e.state,o=n.path,r=n.query,i=n.hash;this.replace({path:o,query:r,hash:i})}this._dispatchRouteChange()}},{key:"_handleHashChange",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.oldURL,n=void 0===t?window.location.hash:t,o=e.newURL,r=void 0===o?window.location.hash:o;if(0!==(0,g.getHashPath)(n).length){if(this.action===m.POP_ACTION){var i=this._match((0,g.getHashPath)(r)).route,a=i.path,s=i.query,u=i.hash;this.replace({path:a,query:s,hash:u})}this.lastRoute=this._match((0,g.getHashPath)(n)).route,this.currentRoute=this._match((0,g.getHashPath)(r)).route,this._dispatchRouteChange()}}},{key:"_dispatchRouteChange",value:function(){if(this.routeChanged.dispatch(this.lastRoute,this.currentRoute),this.debugMode&&this.action!==m.POP_ACTION){var e="%cRouter.routeChange ("+this.action+")",t=(0,g.generateSpaces)(e);console.log(e,v,"Last route :",this.lastRoute),console.log(t,"Current route :",this.currentRoute)}this.action=m.POP_ACTION}},{key:"_firstRoute",value:function(){var e=this.history.location,t=e.pathname,n=e.search,o=e.hash;this.navigate({path:t,query:n,hash:o,silent:!0}),this.mode===m.HASH_MODE&&this._handleHashChange()}},{key:"_parseRoutes",value:function(){for(var e=0,t=this.routes.length;e<t;e++){var n=[];this.routeData.push({route:this.routes[e],regexp:(0,i.default)(this.routes[e].path,n),keys:n})}}},{key:"_getFullPath",value:function(e){var t=e.basePath,n=void 0===t?this.basePath:t,o=e.locale,r=void 0===o?null:o,i=e.path,a=void 0===i?null:i,s=e.query,u=void 0===s?null:s,c=e.hash,l=void 0===c?null:c;return""+(n=n||"")+(r=r?(0,g.addLeadingSlash)(r):"")+(a=a||"")+(u=u||"")+(l=l||"")}},{key:"_matchRouteByName",value:function(e){if(void 0!==e&&(0,g.isString)(e)){var t=(0,a.default)(this.routes,{name:e});return void 0!==t?t:null}console.error("Router._matchRouteByName : Name argument is required and must be a string")}},{key:"_match",value:function(e){if(void 0!==e&&(0,g.isString)(e)){for(var t=0,n=this.routeData.length;t<n;t++){var o=this.routeData[t].regexp.exec(e);if(null!==o){for(var r=o.splice(1),i={},a=0,s=r.length;a<s;a++)i[this.routeData[t].keys[a].name]=r[a];var u=this.history.location,c=u.query,l=u.hash;c=c||null,l=l||null;var f=this.routeData[t].route,p=f.name,h=f.callback,d=this.routeData[t].route.component;return{route:{name:p,path:e,params:i,query:c,hash:l},component:this.components[d],callback:h}}}return null}console.error("Router._match : Path argument is required and must be a string")}},{key:"_isRouteEqual",value:function(e,t){return null!==e&&null!==t&&e.name===t.name&&JSON.stringify(e.params)===JSON.stringify(t.params)&&(this.debugMode&&console.log("%cRouter.navigate",v,"Cancel because same route",t),!0)}},{key:"_parseAnchors",value:function(){for(var e=document.getElementsByTagName("a"),t=0,n=e.length;t<n;t++){var o=e[t];"function"==typeof o.getAttribute&&"internal"===o.getAttribute("rel")&&(o.removeEventListener("click",this._anchorLink,!1),o.addEventListener("click",this._anchorLink,!1))}}},{key:"_anchorLink",value:function(e){e.preventDefault();var t=e.currentTarget.getAttribute("href");t&&this.navigate((0,g.addLeadingSlash)(t))}},{key:"_cleanPath",value:function(e){if(void 0!==e&&(0,g.isString)(e)){var t=e;return(0,g.startsWith)(t,this.basePath)&&(t=t.slice(this.basePath.length)),0===t.indexOf((0,g.addLeadingSlash)(this.locale))&&0!==this.locale.length&&(t=t.substr(this.locale.length+1)),"/"!==t&&(t=(0,g.stripTrailingSlash)(t)),t}console.error("Router._cleanPath : Path argument is required and must be a string")}}]),m}();c.BROWSER_MODE="browser",c.HASH_MODE="hash",c.MEMORY_MODE="memory",c.PUSH_ACTION="push",c.REPLACE_ACTION="replace",c.POP_ACTION="pop",t.default=c,e.exports=t.default},function(e,w,O){"use strict";(function(e){var t,i=O(16),a=O(371),s=O(274),u=O(282),c=O(286),l=O(372),f=O(1);function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function h(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var o,r,v,m,_,g,b=(o=(t=function(e){function o(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=h(this,d(o).call(this)))._entities=[],e._renderer=i.a.renderer;var t=f.a.width,n=f.a.height;return e._camera=new THREE.OrthographicCamera(t/-2,t/2,n/2,n/-2,-100,100),e._bind(),e._init(),e._setSize(),e}var t,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(o,THREE.Scene),t=o,(n=[{key:"update",value:function(e,t){this._transitionQuad.update(e,t),this._levelIntro.update(e,t),this._overlay.update(e,t),this._shapeOverlay.update(e,t),this._renderer.render(this,this._camera),this._fboViewer.render()}},{key:"_bind",value:function(){f.a.resized.add(this._onWindowResize)}},{key:"_unbind",value:function(){f.a.resized.remove(this._onWindowResize)}},{key:"_init",value:function(){this._transitionQuad=new a.a,this.material=this._transitionQuad.material,this.add(this._transitionQuad),this._entities.push(this._transitionQuad),this._fboViewer=new l.a({renderer:this._renderer,margin:4}),this._overlay=new u.a(this),this.add(this._overlay),this._entities.push(this._overlay),this._shapeOverlay=new c.a(this),this.add(this._shapeOverlay),this._entities.push(this._shapeOverlay),this._levelIntro=new s.a(this),this.add(this._levelIntro),this._entities.push(this._levelIntro)}},{key:"_setSize",value:function(){var e=f.a.width,t=f.a.height;this._camera.left=e/-2,this._camera.right=e/2,this._camera.top=t/2,this._camera.bottom=t/-2,this._camera.updateProjectionMatrix(),this._overlay.setSize(e,t),this._shapeOverlay.setSize(e,t),this._levelIntro.setSize(e,t),this._fboViewer.resize()}},{key:"_onWindowResize",value:function(e,t){this._setSize()}},{key:"rtt1",get:function(){return this._transitionQuad.rtt1},set:function(e){this._transitionQuad.rtt1=e}},{key:"rtt2",get:function(){return this._transitionQuad.rtt2},set:function(e){this._transitionQuad.rtt2=e}},{key:"progress",get:function(){return this.material.uniforms.uProgress.value},set:function(e){this.material.uniforms.uProgress.value=e}}])&&p(t.prototype,n),r&&p(t,r),o}()).prototype,r="_onWindowResize",v=[e],m=Object.getOwnPropertyDescriptor(t.prototype,"_onWindowResize"),_=t.prototype,g={},Object.keys(m).forEach(function(e){g[e]=m[e]}),g.enumerable=!!g.enumerable,g.configurable=!!g.configurable,("value"in g||g.initializer)&&(g.writable=!0),g=v.slice().reverse().reduce(function(e,t){return t(o,r,e)||e},g),_&&void 0!==g.initializer&&(g.value=g.initializer?g.initializer.call(_):void 0,g.initializer=void 0),void 0===g.initializer&&(Object.defineProperty(o,r,g),g=null),t);w.a=b}).call(this,O(2).bind)},function(e,b,w){"use strict";(function(e){var t,i=w(1),a=w(22),n=w(272),s=w.n(n),o=w(273),u=w.n(o);function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function l(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var h,d,y,v,m,_,g=(h=(t=function(e){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=l(this,f(n).call(this,function(r){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},t=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),t.forEach(function(e){var t,n,o;t=r,o=i[n=e],n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o})}return r}({vertexShader:s.a,fragmentShader:u.a,data:{transition:"basic"}},e)))).uniforms={tDiffuse1:{value:null},tDiffuse2:{value:null},uProgress:{value:0},uTime:{value:0},uResolution:{value:new THREE.Vector2(i.a.width,i.a.height)}},t._bind(),t}var t,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(n,a["a"]),t=n,(o=[{key:"update",value:function(e,t){this.uniforms.uTime.value=t}},{key:"_bind",value:function(){i.a.resized.add(this._onWindowResize)}},{key:"_unbind",value:function(){i.a.resized.remove(this._onWindowResize)}},{key:"_onWindowResize",value:function(e,t){this.uniforms.uResolution.value.x=e,this.uniforms.uResolution.value.y=t}}])&&c(t.prototype,o),r&&c(t,r),n}()).prototype,d="_onWindowResize",y=[e],v=Object.getOwnPropertyDescriptor(t.prototype,"_onWindowResize"),m=t.prototype,_={},Object.keys(v).forEach(function(e){_[e]=v[e]}),_.enumerable=!!_.enumerable,_.configurable=!!_.configurable,("value"in _||_.initializer)&&(_.writable=!0),_=y.slice().reverse().reduce(function(e,t){return t(h,d,e)||e},_),m&&void 0!==_.initializer&&(_.value=_.initializer?_.initializer.call(m):void 0,_.initializer=void 0),void 0===_.initializer&&(Object.defineProperty(h,d,_),_=null),t);b.a=g}).call(this,w(2).bind)},function(e,t,n){"use strict";function o(e){return e.filter(function(e,t,n){return n.indexOf(e)===t})}n.d(t,"a",function(){return o})},function(e,h,d){"use strict";(function(e){var t,r=d(19),n=d(5);function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var o,a,s,u,c,l,f=Object(n.d)("EventWorker",n.b,!1),p=(o=(t=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._ctx=e,this._binded=!1,this._listeners=[]}var e,n,o;return e=t,(n=[{key:"add",value:function(e,t){this._binded||this._bind(),this._listeners.push({eventName:e,cb:t}),f("'".concat(e,"' added"))}},{key:"addOnce",value:function(e){var t=Object(r.defer)();return this._binded||this._bind(),this._listeners.push({eventName:e,cb:t.resolve}),f("'".concat(e,"' added once")),t.promise}},{key:"remove",value:function(e){var t=this._getListener(e),n=this._listeners.indexOf(t);-1<n&&this._listeners.splice(n,1),f("'".concat(e,"' removed"))}},{key:"dispatch",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;this._ctx.postMessage({eventName:e,payload:t}),f("'".concat(e,"' dispatched with payload :"),t)}},{key:"_bind",value:function(){this._binded=!0,this._ctx.addEventListener("message",this._onWorkerMessage)}},{key:"_getListener",value:function(e){for(var t=0,n=this._listeners.length;t<n;t++){var o=this._listeners[t];if(o.eventName===e)return o}return null}},{key:"_onWorkerMessage",value:function(e){for(var t=e.data,n=t.eventName,o=t.payload||null,r=0,i=this._listeners.length;r<i;r++){var a=this._listeners[r];a.eventName===n&&a.cb(o)}}}])&&i(e.prototype,n),o&&i(e,o),t}()).prototype,a="_onWorkerMessage",s=[e],u=Object.getOwnPropertyDescriptor(t.prototype,"_onWorkerMessage"),c=t.prototype,l={},Object.keys(u).forEach(function(e){l[e]=u[e]}),l.enumerable=!!l.enumerable,l.configurable=!!l.configurable,("value"in l||l.initializer)&&(l.writable=!0),l=s.slice().reverse().reduce(function(e,t){return t(o,a,e)||e},l),c&&void 0!==l.initializer&&(l.value=l.initializer?l.initializer.call(c):void 0,l.initializer=void 0),void 0===l.initializer&&(Object.defineProperty(o,a,l),l=null),t);h.a=p}).call(this,d(2).bind)},function(e,t){e.exports=function(){return new Worker("./build/7a3da3cf6186c4eae32d.worker.js")}},function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=function(e){this.manager=e||THREE.DefaultLoadingManager,this.materials=null,this.verbosity=0,this.attributeOptions={},this.drawMode=THREE.TrianglesDrawMode,this.nativeAttributeMap={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"}};i.prototype={constructor:i,load:function(e,t,n,o){var r=this,i=new THREE.FileLoader(r.manager);i.setPath(this.path),i.setResponseType("arraybuffer"),void 0!==this.crossOrigin&&(i.crossOrigin=this.crossOrigin),i.load(e,function(e){r.decodeDracoFile(e,t)},n,o)},setPath:function(e){this.path=e},setCrossOrigin:function(e){this.crossOrigin=e},setVerbosity:function(e){this.verbosity=e},setDrawMode:function(e){this.drawMode=e},setSkipDequantization:function(e,t){var n=!0;void 0!==t&&(n=t),this.getAttributeOptions(e).skipDequantization=n},decodeDracoFile:function(t,n,o){var r=this;i.getDecoderModule().then(function(e){r.decodeDracoFileInternal(t,e.decoder,n,o||{})})},decodeDracoFileInternal:function(e,t,n,o){var r=new t.DecoderBuffer;r.Init(new Int8Array(e),e.byteLength);var i=new t.Decoder,a=i.GetEncodedGeometryType(r);if(a===t.TRIANGULAR_MESH)0<this.verbosity&&console.log("Loaded a mesh.");else{if(a!==t.POINT_CLOUD){var s="DRACOLoader: Unknown geometry type.";throw console.error(s),new Error(s)}0<this.verbosity&&console.log("Loaded a point cloud.")}n(this.convertDracoGeometryTo3JS(t,i,a,r,o))},addAttributeToGeometry:function(e,t,n,o,r,i,a){if(0===r.ptr){var s="DRACOLoader: No attribute "+o;throw console.error(s),new Error(s)}var u=r.num_components(),c=new e.DracoFloat32Array;t.GetAttributeFloatForAllPoints(n,r,c);var l=n.num_points()*u;a[o]=new Float32Array(l);for(var f=0;f<l;f++)a[o][f]=c.GetValue(f);i.addAttribute(o,new THREE.Float32BufferAttribute(a[o],u)),e.destroy(c)},convertDracoGeometryTo3JS:function(e,t,n,o,r){var i,a,s;if(!0===this.getAttributeOptions("position").skipDequantization&&t.SkipAttributeTransform(e.POSITION),!(a=n===e.TRIANGULAR_MESH?(i=new e.Mesh,t.DecodeBufferToMesh(o,i)):(i=new e.PointCloud,t.DecodeBufferToPointCloud(o,i))).ok()||0===i.ptr){var u="DRACOLoader: Decoding failed: ";throw u+=a.error_msg(),console.error(u),e.destroy(t),e.destroy(i),new Error(u)}e.destroy(o),n===e.TRIANGULAR_MESH?(s=i.num_faces(),0<this.verbosity&&console.log("Number of faces loaded: "+s.toString())):s=0;var c=i.num_points(),l=i.num_attributes();0<this.verbosity&&(console.log("Number of points loaded: "+c.toString()),console.log("Number of attributes loaded: "+l.toString()));var f=t.GetAttributeId(i,e.POSITION);if(-1===f){var p="DRACOLoader: No position attribute found.";throw console.error(p),e.destroy(t),e.destroy(i),new Error(p)}var h=t.GetAttribute(i,f),d={},y=new THREE.BufferGeometry;for(var v in this.nativeAttributeMap)if(void 0===r[v]){var m=t.GetAttributeId(i,e[this.nativeAttributeMap[v]]);if(-1!==m){0<this.verbosity&&console.log("Loaded "+v+" attribute.");var _=t.GetAttribute(i,m);this.addAttributeToGeometry(e,t,i,v,_,y,d)}}for(var g in r){var b=r[g],w=t.GetAttributeByUniqueId(i,b);this.addAttributeToGeometry(e,t,i,g,w,y,d)}if(n===e.TRIANGULAR_MESH)if(this.drawMode===THREE.TriangleStripDrawMode){var O=new e.DracoInt32Array;d.indices=new Uint32Array(O.size());for(var x=0;x<O.size();++x)d.indices[x]=O.GetValue(x);e.destroy(O)}else{var k=3*s;d.indices=new Uint32Array(k);for(var E=new e.DracoInt32Array,P=0;P<s;++P){t.GetFaceFromMesh(i,P,E);var T=3*P;d.indices[T]=E.GetValue(0),d.indices[T+1]=E.GetValue(1),d.indices[T+2]=E.GetValue(2)}e.destroy(E)}y.drawMode=this.drawMode,n===e.TRIANGULAR_MESH&&y.setIndex(new(65535<d.indices.length?THREE.Uint32BufferAttribute:THREE.Uint16BufferAttribute)(d.indices,1));var S=new e.AttributeQuantizationTransform;if(S.InitFromAttribute(h)){y.attributes.position.isQuantized=!0,y.attributes.position.maxRange=S.range(),y.attributes.position.numQuantizationBits=S.quantization_bits(),y.attributes.position.minValues=new Float32Array(3);for(var j=0;j<3;++j)y.attributes.position.minValues[j]=S.min_value(j)}return e.destroy(S),e.destroy(t),e.destroy(i),y},isVersionSupported:function(t,n){i.getDecoderModule().then(function(e){n(e.decoder.isVersionSupported(t))})},getAttributeOptions:function(e){return void 0===this.attributeOptions[e]&&(this.attributeOptions[e]={}),this.attributeOptions[e]}},i.decoderPath="./assets/misc/draco/",i.decoderConfig={},i.decoderModulePromise=null,i.setDecoderPath=function(e){i.decoderPath=e},i.setDecoderConfig=function(e){var t=i.decoderConfig.wasmBinary;i.decoderConfig=e||{},i.releaseDecoderModule(),t&&(i.decoderConfig.wasmBinary=t)},i.releaseDecoderModule=function(){i.decoderModulePromise=null},i.getDecoderModule=function(){var e=i.decoderPath,n=i.decoderConfig,t=i.decoderModulePromise;return t||(t=(t="undefined"!=typeof DracoDecoderModule?Promise.resolve():"object"!==("undefined"==typeof WebAssembly?"undefined":o(WebAssembly))||"js"===n.type?i._loadScript(e+"draco_decoder_gtlf.js"):(n.wasmBinaryFile=e+"draco_decoder_gltf.wasm",i._loadScript(e+"draco_wasm_wrapper_gltf.js").then(function(){return i._loadArrayBuffer(n.wasmBinaryFile)}).then(function(e){n.wasmBinary=e}))).then(function(){return new Promise(function(t){n.onModuleLoaded=function(e){t({decoder:e})},DracoDecoderModule(n)})}),i.decoderModulePromise=t)},i._loadScript=function(e){var t=document.getElementById("decoder_script");null!==t&&t.parentNode.removeChild(t);var n=document.getElementsByTagName("head")[0],o=document.createElement("script");return o.id="decoder_script",o.type="text/javascript",o.src=e,new Promise(function(e){o.onload=e,n.appendChild(o)})},i._loadArrayBuffer=function(n){var o=new THREE.FileLoader;return o.setResponseType("arraybuffer"),new Promise(function(e,t){o.load(n,e,void 0,t)})},t.a=i},function(e,t,n){"use strict";var o=function e(){this._parser=e.parse};((o.prototype=Object.create(THREE.CompressedTextureLoader.prototype)).constructor=o).parse=function(e,t){var n={mipmaps:[],width:0,height:0,format:null,mipmapCount:1};function o(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}function r(e,t,n,o){for(var r=n*o*4,i=new Uint8Array(e,t,r),a=new Uint8Array(r),s=0,u=0,c=0;c<o;c++)for(var l=0;l<n;l++){var f=i[u],p=i[++u],h=i[++u],d=i[++u];u++,a[s]=h,a[++s]=p,a[++s]=f,a[++s]=d,s++}return a}var i,a=o("DXT1"),s=o("DXT3"),u=o("DXT5"),c=o("ETC1"),l=new Int32Array(e,0,31);if(542327876!==l[0])return console.error("DDSLoader.parse: Invalid magic number in DDS header."),n;if(4&!l[20])return console.error("DDSLoader.parse: Unsupported format, must contain a FourCC code."),n;var f,p=l[21],h=!1;switch(p){case a:i=8,n.format=THREE.RGB_S3TC_DXT1_Format;break;case s:i=16,n.format=THREE.RGBA_S3TC_DXT3_Format;break;case u:i=16,n.format=THREE.RGBA_S3TC_DXT5_Format;break;case c:i=8,n.format=THREE.RGB_ETC1_Format;break;default:if(!(32===l[22]&&16711680&l[23]&&65280&l[24]&&255&l[25]&&4278190080&l[26]))return console.error("DDSLoader.parse: Unsupported FourCC code ",(f=p,String.fromCharCode(255&f,f>>8&255,f>>16&255,f>>24&255))),n;h=!0,i=64,n.format=THREE.RGBAFormat}n.mipmapCount=1,131072&l[2]&&!1!==t&&(n.mipmapCount=Math.max(1,l[7]));var d=l[28];if(n.isCubemap=!!(512&d),n.isCubemap&&(!(1024&d)||!(2048&d)||!(4096&d)||!(8192&d)||!(16384&d)||!(32768&d)))return console.error("DDSLoader.parse: Incomplete cubemap faces"),n;n.width=l[4],n.height=l[3];for(var y=l[1]+4,v=n.isCubemap?6:1,m=0;m<v;m++)for(var _=n.width,g=n.height,b=0;b<n.mipmapCount;b++){if(h)var w=(O=r(e,y,_,g)).length;else{w=Math.max(4,_)/4*Math.max(4,g)/4*i;var O=new Uint8Array(e,y,w)}var x={data:O,width:_,height:g};n.mipmaps.push(x),y+=w,_=Math.max(_>>1,1),g=Math.max(g>>1,1)}return n},t.a=o},function(e){e.exports={common:{mainLight:{color:"#fcfcfc",intensity:.36,whitelist:["character_main"],position:{x:-28.3,y:14.5,z:20.4},shadow:{mapSize:512,bias:-1e-4,radius:0,offsets:{near:0,far:30,left:.5,right:.5,bottom:0,top:1}}},postProcessing:{postPass:{outline:{thickness:.015,amount:12},bloomColor:"#0f0f0f",vignette:1.2,brightness:1,saturation:1,contrast:1,colors:{dark:"#40444f",light:"#ffffff"},noise:{dark:{scale:1,intensity:.11,speed:20},light:{scale:1,intensity:.07,speed:20}}},bloomPass:{resolutionScale:1,kernelSize:4,intensity:.6,distinction:.92,blend:!0,screenMode:!0}},shadows:{enabled:!0,color:"#4f4f4f",intensity:1,blacklist:["character_main"],bias:6e-4,radius:0,mapSize:4096,count:1,offsets:{near:0,far:0,left:0,right:0,bottom:0,top:0}},background:"#303030",fog:{enabled:!0,color:"#303030",distance:{density:.008},height:{density:.793,propagation:4.3108,offset:-1.16,noise:{speed:.0011,frequency:.16,amplitude:.285,offset:0}}},ambient:{color:"#383838",intensity:0}},objects:{instances_tree_1:{transparent:!1,opacity:1,diffuseColor:"#d1d1d1",specularColor:"#000000",specularShininess:10,specularStrength:1,emissive:"#000000"},all:{palette:!0},logo_u_letter:{palette:!0},logo_lock:{palette:!0},character_main:{transparent:!1,opacity:1,diffuseColor:"#ffffff",specularColor:"#000000",specularShininess:10,specularStrength:1,emissive:"#111111"}},palette:{house:{diffuseColor:"#ffffff",specularColor:"#000000",emissive:"#161616",opacity:1},light:{diffuseColor:"#ffffff",specularColor:"#000000",emissive:"#ffffff",opacity:1,isLight:!0},snow:{diffuseColor:"#ffffff",specularColor:"#000000",emissive:"#c1c1c1",opacity:1},trees:{diffuseColor:"#ffffff",specularColor:"#000000",emissive:"#000000",opacity:1},windows_lobby:{diffuseColor:"#ffffff",specularColor:"#000000",emissive:"#dedede",opacity:1,isWindows:!0},windows_level_03:{diffuseColor:"#ffffff",specularColor:"#000000",emissive:"#dedede",opacity:1,isWindows:!0},windows_level_02:{diffuseColor:"#ffffff",specularColor:"#000000",emissive:"#dedede",opacity:1,isWindows:!0},windows_level_01:{diffuseColor:"#ffffff",specularColor:"#000000",emissive:"#dedede",opacity:1,isWindows:!0},logo:{diffuseColor:"#ffffff",specularColor:"#000000",emissive:"#b7b7b7",opacity:1,isLogo:!0},logo_lock:{diffuseColor:"#ffffff",specularColor:"#000000",emissive:"#ffffff",opacity:1,isLogo:!0,isLogoLock:!0},board:{diffuseColor:"#ffffff",specularColor:"#000000",emissive:"#161616",opacity:1,isBoard:!0}}}},function(e){e.exports={common:{mainLight:{color:"#fcfcfc",intensity:1,whitelist:["character_main"],position:{x:20.4,y:14.5,z:44.8},shadow:{mapSize:512,bias:-1e-4,radius:0,offsets:{near:0,far:30,left:.5,right:.5,bottom:0,top:1}}},postProcessing:{postPass:{outline:{thickness:.015,amount:12},bloomColor:"#000000",vignette:1.2,brightness:1,saturation:1,contrast:1,colors:{dark:"#20283d",light:"#ffffff"},noise:{dark:{scale:1,intensity:.11,speed:20},light:{scale:1,intensity:.07,speed:20}}},bloomPass:{resolutionScale:1,kernelSize:4,intensity:.31,distinction:.98,blend:!0,screenMode:!0}},shadows:{enabled:!0,color:"#595857",intensity:.7,blacklist:["character_main","all_no_shadows"],bias:35e-5,radius:0,mapSize:4096,count:2,offsets:{near:0,far:0,left:0,right:0,bottom:0,top:0}},background:"#262626",fog:{enabled:!0,color:"#262626",distance:{density:.033},height:{density:.6076,propagation:4.3131,offset:.56,noise:{speed:.0011,frequency:.2,amplitude:.3,offset:0}}},ambient:{color:"#383838",intensity:.33}},objects:{character_main:{transparent:!1,opacity:1,diffuseColor:"#b7b7b7",specularColor:"#000000",specularShininess:10,specularStrength:1,emissive:"#2b2b2b"},all:{palette:!0},all_transparent:{palette:!0,transparent:!0},all_no_shadows:{palette:!0,diffuseMap:"lobby.posters"}},palette:{ground:{diffuseColor:"#f2f2f2",specularColor:"#000000",emissive:"#000000",opacity:1},portal_01:{diffuseColor:"#ffffff",specularColor:"#000000",emissive:"#680000",opacity:.8,color1:"#450100",color2:"#ffd518",isPortal:!0,isLocked:!1},portal_02:{diffuseColor:"#ffffff",specularColor:"#000000",emissive:"#338ce0",opacity:.8,color1:"#2b3f4e",color2:"#f69817",isPortal:!0,isLocked:!1},portal_03:{diffuseColor:"#ffffff",specularColor:"#000000",emissive:"#492a16",opacity:.8,color1:"#3e1c0c",color2:"#228de9",isPortal:!0,isLocked:!1},portal_04:{diffuseColor:"#ffffff",specularColor:"#000000",emissive:"#000000",opacity:.8,color1:"#000000",color2:"#ffffff",isPortal:!0,isLocked:!0},portal_box_01:{diffuseColor:"#692b2a",specularColor:"#000000",emissive:"#692b2a",opacity:1},portal_box_02:{diffuseColor:"#2b3f4e",specularColor:"#000000",emissive:"#2b3f4e",opacity:1},portal_box_03:{diffuseColor:"#6b4726",specularColor:"#000000",emissive:"#0e0500",opacity:1},portal_box_04:{diffuseColor:"#ffffff",specularColor:"#000000",emissive:"#666666",opacity:1},poster_frame_01:{diffuseColor:"#ffffff",specularColor:"#000000",emissive:"#000000",opacity:1},poster_frame_02:{diffuseColor:"#ffffff",specularColor:"#000000",emissive:"#000000",opacity:1},objects:{diffuseColor:"#4c4c4c",specularColor:"#000000",emissive:"#232323",opacity:1},objects_color_01:{diffuseColor:"#ffffff",specularColor:"#000000",emissive:"#c1c1c1",opacity:1},objects_color_02:{diffuseColor:"#ffffff",specularColor:"#000000",emissive:"#ffffff",opacity:1},garlands:{diffuseColor:"#ffffff",specularColor:"#ffffff",emissive:"#ffffff",opacity:1},walls:{diffuseColor:"#ffffff",specularColor:"#000000",emissive:"#000000",opacity:1}}}},function(e){e.exports={common:{mainLight:{color:"#1e0e0e",intensity:2.15,whitelist:["character_main"],position:{x:1.9,y:1.5,z:1.9},shadow:{mapSize:512,bias:-1e-4,radius:0,offsets:{near:0,far:30,left:.5,right:.5,bottom:0,top:1}}},postProcessing:{postPass:{outline:{thickness:.015,amount:12},bloomColor:"#232323",vignette:1.2,brightness:1.14,saturation:.727,contrast:.965,colors:{dark:"#0a0909",light:"#b56b6b"},noise:{dark:{scale:1,intensity:.11,speed:20},light:{scale:1,intensity:.07,speed:20}}},bloomPass:{resolutionScale:1,kernelSize:5,intensity:2.16,distinction:2.53,blend:!0,screenMode:!0}},shadows:{enabled:!0,color:"#000000",intensity:.7,blacklist:["character_main","all_no_shadows","key"],bias:1e-4,radius:0,mapSize:4096,count:2,offsets:{near:0,far:0,left:0,right:0,bottom:0,top:0}},background:"#351111",fog:{enabled:!0,color:"#351111",distance:{density:.0094},height:{density:.44,propagation:4.3131,offset:.45,noise:{speed:.0011,frequency:.2,amplitude:.3,offset:0}}},ambient:{color:"#f40000",intensity:.25}},objects:{all:{palette:!0},all_transparent:{palette:!0,transparent:!0},all_no_shadows:{palette:!0},character_main:{transparent:!1,opacity:1,diffuseColor:"#f2f2f2",specularColor:"#000000",specularShininess:10,specularStrength:1,emissive:"#111111"},laser_box:{transparent:!1,opacity:1,diffuseColor:"#ffffff",specularColor:"#000000",specularShininess:10,specularStrength:1,emissive:"#ff1010"},laser:{transparent:!1,opacity:1,diffuseColor:"#ffffff",specularColor:"#ffffff",specularShininess:10,specularStrength:1,emissive:"#ff1010"},laser_hit:{transparent:!1,opacity:1,diffuseColor:"#ffffff",specularColor:"#000000",specularShininess:10,specularStrength:1,emissive:"#ff0000"},laser_burn:{transparent:!0,opacity:1,diffuseColor:"#ffffff",specularColor:"#000000",specularShininess:10,specularStrength:1,emissive:"#000000"},key:{transparent:!0,opacity:1,diffuseColor:"#ffffff",specularColor:"#000000",specularShininess:10,specularStrength:1,emissive:"#ffb055"},laser_circle_burn:{transparent:!0,opacity:1,diffuseColor:"#ffffff",specularColor:"#000000",specularShininess:10,specularStrength:1,emissive:"#000000"}},palette:{ground:{diffuseColor:"#f2f2f2",specularColor:"#000000",emissive:"#1c1c1c",opacity:1},objects:{diffuseColor:"#b7b7b7",specularColor:"#000000",emissive:"#050505",opacity:1},objects_color_01:{diffuseColor:"#0c0c0c",specularColor:"#000000",emissive:"#ffa900",opacity:1},objects_color_02:{diffuseColor:"#ffffff",specularColor:"#000000",emissive:"#ffa900",opacity:1},portal:{diffuseColor:"#ffffff",specularColor:"#000000",emissive:"#680000",opacity:.8,color1:"#450100",color2:"#ffd518",isPortal:!0,isLocked:!1},walls:{diffuseColor:"#757575",specularColor:"#000000",emissive:"#000000",opacity:1}}}},function(e){e.exports={common:{mainLight:{color:"#666666",intensity:1,whitelist:["character_main"],position:{x:1.9,y:1.5,z:1.9},shadow:{mapSize:512,bias:-1e-4,radius:0,offsets:{near:0,far:30,left:.5,right:.5,bottom:0,top:1}}},postProcessing:{postPass:{outline:{thickness:.015,amount:12},bloomColor:"#161616",vignette:1.2,brightness:1,saturation:1,contrast:1,colors:{dark:"#000000",light:"#9dc4e0"},noise:{dark:{scale:1,intensity:.11,speed:20},light:{scale:1,intensity:.07,speed:20}}},bloomPass:{resolutionScale:1,kernelSize:5,intensity:1.5,distinction:1.8,blend:!0,screenMode:!0}},shadows:{enabled:!0,color:"#547593",intensity:.7,blacklist:["character_main","all_no_shadows","key"],bias:1e-4,radius:0,mapSize:4096,count:2,offsets:{near:0,far:0,left:0,right:0,bottom:0,top:0}},background:"#2c343a",fog:{enabled:!0,color:"#2c343a",distance:{density:.0089},height:{density:.6076,propagation:4.3131,offset:.56,noise:{speed:.0011,frequency:.2,amplitude:.3,offset:0}}},ambient:{color:"#9ecfea",intensity:.25}},objects:{all:{palette:!0},all_transparent:{palette:!0,transparent:!0},all_no_shadows:{palette:!0},character_main:{transparent:!1,opacity:1,diffuseColor:"#ffffff",specularColor:"#000000",specularShininess:10,specularStrength:1,emissive:"#000000"},key:{transparent:!0,opacity:1,diffuseColor:"#ffffff",specularColor:"#000000",specularShininess:10,specularStrength:1,emissive:"#bf5000"},instances_cog_1:{transparent:!1,opacity:1,diffuseColor:"#e5e5e5",specularColor:"#000000",specularShininess:10,specularStrength:1,emissive:"#bf5000"},instances_cog_2:{transparent:!1,opacity:1,diffuseColor:"#d6d6d6",specularColor:"#000000",specularShininess:10,specularStrength:1,emissive:"#bf5000"},instances_cog_3:{transparent:!1,opacity:1,diffuseColor:"#dbdbdb",specularColor:"#000000",specularShininess:10,specularStrength:1,emissive:"#bf5000"},robot_small:{transparent:!1,opacity:1,diffuseColor:"#7a7a7a",specularColor:"#000000",specularShininess:10,specularStrength:1,emissive:"#8c8c8c"},robot_small_cone:{transparent:!0,opacity:.2,diffuseColor:"#ffffff",specularColor:"#000000",specularShininess:10,specularStrength:1,emissive:"#bf5000"},robot_big:{transparent:!1,opacity:1,diffuseColor:"#7a7a7a",specularColor:"#000000",specularShininess:10,specularStrength:1,emissive:"#8c8c8c"},robot_big_cone:{transparent:!0,opacity:.2,diffuseColor:"#ffffff",specularColor:"#000000",specularShininess:10,specularStrength:1,emissive:"#bf5000"},robot_shadow:{transparent:!0,opacity:.25,diffuseColor:"#ffffff",specularColor:"#000000",specularShininess:10,specularStrength:1,emissive:"#ffffff"}},palette:{portal:{diffuseColor:"#ffffff",specularColor:"#000000",emissive:"#338ce0",opacity:.8,color1:"#2b3f4e",color2:"#f69817",isPortal:!0,isLocked:!1},objects:{diffuseColor:"#ffffff",specularColor:"#000000",emissive:"#000000",opacity:1},screens:{diffuseColor:"#ffffff",specularColor:"#000000",emissive:"#ffffff",opacity:1,isScreen:!0},room:{diffuseColor:"#ffffff",specularColor:"#000000",emissive:"#000000",opacity:1}}}},function(e){e.exports={common:{mainLight:{color:"#919191",intensity:1,whitelist:["character_main"],position:{x:1.9,y:1.5,z:1.9},shadow:{mapSize:512,bias:-1e-4,radius:0,offsets:{near:0,far:30,left:.5,right:.5,bottom:0,top:1}}},postProcessing:{postPass:{outline:{thickness:.015,amount:12},bloomColor:"#161616",vignette:1.2,brightness:1,saturation:1,contrast:1,colors:{dark:"#000000",light:"#e0c09d"},noise:{dark:{scale:1,intensity:.11,speed:20},light:{scale:1,intensity:.07,speed:20}}},bloomPass:{resolutionScale:1,kernelSize:5,intensity:.6,distinction:2.5,blend:!0,screenMode:!0}},shadows:{enabled:!0,color:"#547593",intensity:.7,blacklist:["character_main","all_no_shadows","key"],bias:1e-4,radius:0,mapSize:4096,count:2,offsets:{near:0,far:0,left:0,right:0,bottom:0,top:0}},background:"#66423b",fog:{enabled:!0,color:"#66423b",distance:{density:.0205},height:{density:1,propagation:4.0791,offset:.69,noise:{speed:.0011,frequency:.2,amplitude:.3,offset:0}}},ambient:{color:"#ad91c4",intensity:.26}},objects:{character_main:{transparent:!1,opacity:1,diffuseColor:"#c69277",specularColor:"#000000",specularShininess:10,specularStrength:1,emissive:"#000000"},all:{palette:!0,diffuseMap:"level-3.posters"},all_transparent:{palette:!0,transparent:!0},all_no_shadows:{palette:!0},camera:{transparent:!1,opacity:1,diffuseColor:"#ffffff",specularColor:"#000000",specularShininess:10,specularStrength:1,emissive:"#ffffff"},camera_cone:{transparent:!0,opacity:.2,diffuseColor:"#ffffff",specularColor:"#000000",specularShininess:10,specularStrength:1,emissive:"#ffffff"},camera_head:{transparent:!1,opacity:1},camera_support:{transparent:!1,opacity:1},key:{transparent:!0,opacity:1,diffuseColor:"#f0e68c",specularColor:"#000000",specularShininess:10,specularStrength:1,emissive:"#000000"}},palette:{portal:{diffuseColor:"#ffffff",specularColor:"#000000",emissive:"#492a16",opacity:.8,color1:"#3e1c0c",color2:"#228de9",isPortal:!0,isLocked:!1},ground:{diffuseColor:"#501f1f",specularColor:"#000000",emissive:"#000000",opacity:1},jar_sticker:{diffuseColor:"#ffffff",specularColor:"#000000",emissive:"#262626",opacity:1},objects_color_01:{diffuseColor:"#ffffff",specularColor:"#b9b9b9",emissive:"#ffffff",opacity:1},objects_color_02:{diffuseColor:"#80afd7",specularColor:"#888888",emissive:"#348dec",opacity:1},objects_noise:{diffuseColor:"#ffffff",specularColor:"#000000",emissive:"#000000",opacity:1,isNoise:!0,color1:"#348dec",color2:"#80afd7"},frames:{transparent:!1,diffuseColor:"#ffffff",specularColor:"#000000",emissive:"#000000",opacity:1},objects_transparent:{diffuseColor:"#ffffff",specularColor:"#8e8e8e",emissive:"#1d1d1d",opacity:.62},objects_jelly:{diffuseColor:"#4b1a1a",specularColor:"#989898",emissive:"#282828",opacity:.8},walls:{diffuseColor:"#501f1f",specularColor:"#000000",emissive:"#000000",opacity:1},objects_normal:{diffuseColor:"#835858",specularColor:"#000000",emissive:"#000000",opacity:1}}}},function(e){e.exports={common:{mainLight:{color:"#ffffff",intensity:3.49,whitelist:["character_main"],position:{x:0,y:2,z:0},shadow:{mapSize:512,bias:-1e-4,radius:0,offsets:{near:0,far:30,left:.5,right:.5,bottom:0,top:1}}},postProcessing:{postPass:{outline:{thickness:.015,amount:12},bloomColor:"#000000",vignette:1.2,brightness:1,saturation:1,contrast:1,colors:{dark:"#000000",light:"#ffffff"},noise:{dark:{scale:1,intensity:.11,speed:20},light:{scale:1,intensity:.07,speed:20}}},bloomPass:{resolutionScale:1,kernelSize:5,intensity:1.25,distinction:1.01,blend:!0,screenMode:!0}},shadows:{enabled:!0,color:"#000000",intensity:1,blacklist:["character_main","all_no_shadows","all_transparent"],bias:1e-4,radius:0,mapSize:4096,count:2,offsets:{near:0,far:0,left:0,right:0,bottom:0,top:0}},background:"#000000",fog:{enabled:!0,color:"#777777",distance:{density:.0133},height:{density:.9404,propagation:1.4009,offset:.55,noise:{speed:.003,frequency:.2,amplitude:.3,offset:0}}},ambient:{color:"#000000",intensity:1}},objects:{character_main:{transparent:!1,opacity:1,diffuseColor:"#3a3a3a",specularColor:"#000000",specularShininess:10,specularStrength:1,emissive:"#000000"},door:{transparent:!1,opacity:1,diffuseColor:"#ffffff",specularColor:"#000000",specularShininess:10,specularStrength:1,emissive:"#000000"},all:{palette:!0},all_transparent:{palette:!0,transparent:!0},all_no_shadows:{palette:!0}},palette:{ground:{diffuseColor:"#000000",specularColor:"#000000",emissive:"#000000",opacity:1},walls:{diffuseColor:"#ffffff",specularColor:"#000000",emissive:"#000000",opacity:1},object_color:{diffuseColor:"#ffffff",specularColor:"#b7b7b7",emissive:"#5b5b5b",opacity:1},object_light:{diffuseColor:"#ffffff",specularColor:"#ffffff",emissive:"#ffffff",opacity:1},object_glass:{diffuseColor:"#ffffff",specularColor:"#ffffff",emissive:"#ffffff",opacity:.33}}}},function(e,t,n){"use strict";function o(e){return 0===e?1:(e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,(e|=e>>16)+1)}n.d(t,"a",function(){return o})},function(e,t,n){"use strict";function o(e,t){var n,o=document.createElement("a");o.download=t,o.href=e.toDataURL("image/png;base64"),document.createEvent?((n=document.createEvent("MouseEvents")).initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),o.dispatchEvent(n)):o.fireEvent&&o.fireEvent("onclick")}n.d(t,"a",function(){return o})},function(e,t,n){"use strict";function o(e){return!isNaN(parseFloat(e))&&isFinite(e)}n.d(t,"a",function(){return o})},function(e,t){e.exports="#define GLSLIFY 1\nvec4 transition (vec2 uv) {\n  return mix(getFromColor(uv), getToColor(uv), step(0.0, uProgress));\n}\n"},function(e,t){e.exports="#define GLSLIFY 1\nvec4 transition(vec2 p) {\n  vec2 block = floor(p.xy / vec2(16));\n  vec2 uv_noise = block / vec2(64);\n  uv_noise += floor(vec2(uProgress) * vec2(1200.0, 3500.0)) / vec2(64);\n  \n  vec2 dist = uProgress > 0.0 ? (fract(uv_noise) - 0.5) * 0.3 *(1.0 -uProgress) : vec2(0.0);\n  vec2 red = p + dist * 0.2;\n  vec2 green = p + dist * .3;\n  vec2 blue = p + dist * .5;\n\n  return vec4(\n    mix(getFromColor(red), getToColor(red), uProgress).r,\n    mix(getFromColor(green), getToColor(green), uProgress).g,\n    mix(getFromColor(blue), getToColor(blue), uProgress).b,\n    1.0\n  );\n}\n"},function(e,t){e.exports="#define GLSLIFY 1\nuniform float uSmoothness;\nuniform vec2 uCenter;\nuniform vec2 uDirection;\n\nvec4 transition (vec2 uv) {\n  vec2 v = normalize(uDirection);\n  v /= abs(v.x) + abs(v.y);\n  float d = v.x * uCenter.x + v.y * uCenter.y;\n  float m = 1.0 - smoothstep(-uSmoothness, 0.0, v.x * uv.x + v.y * uv.y - (d - 0.5 + uProgress * (1.0 + uSmoothness)));\n  return mix(getFromColor((uv - 0.5) * (1.0 - m) + 0.5), getToColor((uv - 0.5) * m + 0.5), m);\n}\n"},function(e,t){e.exports="#define GLSLIFY 1\nmat4 rotationMatrix(vec3 axis, float angle) {\n    axis = normalize(axis);\n    float s = sin(angle);\n    float c = cos(angle);\n    float oc = 1.0 - c;\n    \n    return mat4(oc * axis.x * axis.x + c,           oc * axis.x * axis.y - axis.z * s,  oc * axis.z * axis.x + axis.y * s,  0.0,\n                oc * axis.x * axis.y + axis.z * s,  oc * axis.y * axis.y + c,           oc * axis.y * axis.z - axis.x * s,  0.0,\n                oc * axis.z * axis.x - axis.y * s,  oc * axis.y * axis.z + axis.x * s,  oc * axis.z * axis.z + c,           0.0,\n                0.0,                                0.0,                                0.0,                                1.0);\n}\n"},function(e,t){e.exports="#define GLSLIFY 1\n#define PI 3.14159265359\n#define RECIPROCAL_PI 0.31830988618\n#define LOG2 1.442695\n#define LUMINANCE vec3(0.2125, 0.7154, 0.0721)\n#define saturate(a) clamp(a, 0.0, 1.0)\n\nstruct IncidentLight {\n  vec3 color;\n  vec3 direction;\n  bool visible;\n};\n\nstruct ReflectedLight {\n  vec3 directDiffuse;\n  vec3 indirectDiffuse;\n  vec3 directSpecular;\n};\n\nstruct GeometricContext {\n  vec3 position;\n  vec3 normal;\n  vec3 viewDir;\n};\n\nstruct DefaultMaterial {\n  vec3 diffuseColor;\n  \n  vec3 specularColor;\n  float specularShininess;\n  float specularStrength;\n};\n\nstruct AmbientIrradiance {\n  vec3 color;\n};\n\nfloat when_and(float a, float b) {\n  return a * b;\n}\n\nfloat when_eq(float x, float y) {\n  return 1.0 - abs(sign(x - y));\n}\n\nfloat when_gt(float x, float y) {\n  return max(sign(x - y), 0.0);\n}\n\nfloat when_lt(float x, float y) {\n  return max(sign(y - x), 0.0);\n}\n\nfloat when_ge(float x, float y) {\n  return 1.0 - when_lt(x, y);\n}\n"},function(e,t){e.exports="#define GLSLIFY 1\n#ifdef USE_SKINNING\n\tattribute vec4 skinIndex;\n\tattribute vec4 skinWeight;\n\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform mat4 boneMatrices[MAX_BONES];\n\n\tmat4 getBoneMatrix(const in float i) {\n\t\tmat4 bone = boneMatrices[int(i)];\n\t\treturn bone;\n\t}\n#endif\n"},function(e,t){e.exports="#define GLSLIFY 1\n#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif\n"},function(e,t){e.exports="#define GLSLIFY 1\n#ifdef USE_SKINNING\n\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n\n#endif\n"},function(e,t){e.exports="#define GLSLIFY 1\n#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n"},function(e,t){e.exports="#define GLSLIFY 1\n#ifdef USE_FOG\n  varying float vFogDepth;\n  varying vec4 vWorldPosition;\n#endif\n"},function(e,t){e.exports="#define GLSLIFY 1\n#ifdef USE_FOG\n  vFogDepth = -mvPosition.z;\n  vWorldPosition = worldPosition;\n#endif\n"},function(e,t){e.exports="#define GLSLIFY 1\n#ifdef USE_FOG\n\tuniform vec3 uFogColor;\n\tuniform float uFogDistanceDensity;\n\tuniform float uFogHeightDensity;\n\tuniform float uFogHeightPropagation;\n\tuniform float uFogHeightOffset;\n\tuniform vec4 uFogHeightNoise; // speed - frequency - amplitude - offset\n\tuniform float uTime;\n\n  varying float vFogDepth;\n\tvarying vec4 vWorldPosition;\n#endif\n"},function(e,t){e.exports="#define GLSLIFY 1\n#ifdef USE_FOG\n  // --- Fog distance\n  float fogExp2Factor = 1.0 - max(0.0, exp2(-uFogDistanceDensity * uFogDistanceDensity * vFogDepth * vFogDepth * LOG2));\n  gl_FragColor.rgb = mix(gl_FragColor.rgb, uFogColor, fogExp2Factor);\n\n  // --- Fog height\n  float time = uTime * uFogHeightNoise.x;\n  float frequency = uFogHeightNoise.y;\n  float amplitude = uFogHeightNoise.z;\n  float offset = uFogHeightNoise.w;\n\n  float worldPos = vWorldPosition.y;\n  worldPos += (cos(vWorldPosition.x * frequency + time) + sin(vWorldPosition.z * frequency + offset + time)) / 2.0;\n  worldPos *= amplitude;\n  \n  float fogHeightFactor = max(0.0, worldPos * uFogHeightPropagation + uFogHeightOffset);\n  fogHeightFactor = exp2(-fogHeightFactor * fogHeightFactor);\n  gl_FragColor.rgb = mix(gl_FragColor.rgb, uFogColor, fogHeightFactor * uFogHeightDensity);\n#endif\n"},function(e,t){e.exports="#define GLSLIFY 1\n#ifdef USE_SHADOW_MAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[NUM_DIR_LIGHTS];\n\t\tvarying vec4 vDirectionalShadowCoord[NUM_DIR_LIGHTS];\n\t#endif\n#endif\n"},function(e,t){e.exports="#define GLSLIFY 1\n#ifdef USE_SHADOW_MAP\n\t#if NUM_DIR_LIGHTS > 0\n    #pragma unroll_loop\n    for (int i = 0; i < NUM_DIR_LIGHTS; i++) {\n      vDirectionalShadowCoord[i] = directionalShadowMatrix[i] * worldPosition;\n    }\n\t#endif\n#endif\n"},function(e,t){e.exports="#define GLSLIFY 1\n#ifdef USE_SHADOW_MAP\n\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[NUM_DIR_LIGHTS];\n\t\tvarying vec4 vDirectionalShadowCoord[NUM_DIR_LIGHTS];\n\t#endif\n\n\tconst float UnpackDownscale = 255. / 256.; // 0..1 -> fraction (excluding 1)\n\n\tconst vec3 PackFactors = vec3(256. * 256. * 256., 256. * 256.,  256.);\n\tconst vec4 UnpackFactors = UnpackDownscale / vec4(PackFactors, 1.);\n\n\tconst float ShiftRight8 = 1. / 256.;\n\n\tfloat unpackRGBAToDepth(const in vec4 v) {\n\t\treturn dot(v, UnpackFactors);\n\t}\n\n\tfloat texture2DCompare(sampler2D depths, vec2 uv, float compare) {\n\t\treturn step(compare, unpackRGBAToDepth(texture2D(depths, uv)));\n\t}\n\n\tfloat getShadow(sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, float shadowOpacity, vec4 shadowCoord) {\n\t\tfloat shadow = 1.0;\n\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\n\t\tbvec4 inFrustumVec = bvec4 (shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0);\n\t\tbool inFrustum = all(inFrustumVec);\n\n\t\tbvec2 frustumTestVec = bvec2(inFrustum, shadowCoord.z <= 1.0);\n\n\t\tbool frustumTest = all(frustumTestVec);\n\n\t\tif (frustumTest) {\n\t\t\tvec2 texelSize = vec2(1.0) / shadowMapSize;\n\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare(shadowMap, shadowCoord.xy + vec2(dx0, dy0), shadowCoord.z) +\n\t\t\t\ttexture2DCompare(shadowMap, shadowCoord.xy + vec2(0.0, dy0), shadowCoord.z) +\n\t\t\t\ttexture2DCompare(shadowMap, shadowCoord.xy + vec2(dx1, dy0), shadowCoord.z) +\n\t\t\t\ttexture2DCompare(shadowMap, shadowCoord.xy + vec2(dx0, 0.0), shadowCoord.z) +\n\t\t\t\ttexture2DCompare(shadowMap, shadowCoord.xy, shadowCoord.z) +\n\t\t\t\ttexture2DCompare(shadowMap, shadowCoord.xy + vec2(dx1, 0.0), shadowCoord.z) +\n\t\t\t\ttexture2DCompare(shadowMap, shadowCoord.xy + vec2(dx0, dy1), shadowCoord.z) +\n\t\t\t\ttexture2DCompare(shadowMap, shadowCoord.xy + vec2(0.0, dy1), shadowCoord.z) +\n\t\t\t\ttexture2DCompare(shadowMap, shadowCoord.xy + vec2(dx1, dy1), shadowCoord.z)\n\t\t\t) * (1.0 / 9.0);\n\n\t\t\tshadow = mix(1.0 - shadowOpacity, 1.0, shadow);\n\t\t}\n\n\t\treturn shadow;\n\t}\n\n#endif\n\nfloat getShadowMask() {\n  float shadow = 1.0;\n\n  #ifdef USE_SHADOW_MAP\n\n    #if NUM_DIR_LIGHTS > 0\n\n\t\t\tDirectionalLight directionalLight;\n\n\t\t\t#pragma unroll_loop\n\t\t\tfor (int i = 0; i < NUM_DIR_LIGHTS; i++) {\n\t\t\t\tdirectionalLight = directionalLights[i];\n\t\t\t\tshadow *= bool(directionalLight.shadow)\n\t\t\t\t\t? getShadow(directionalShadowMap[i], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, directionalLight.shadowOpacity, vDirectionalShadowCoord[i])\n\t\t\t\t\t: 1.0;\n\t\t\t}\n\n    #endif\n\n  #endif\n\n  return shadow;\n}\n"},function(e,t){e.exports="#define GLSLIFY 1\nmat3 quatToMat(vec4 q) {\n  mat3 mat;\n\n  float sqw = q.w * q.w;\n  float sqx = q.x * q.x;\n  float sqy = q.y * q.y;\n  float sqz = q.z * q.z;\n  \n  // invs (inverse square length) is only required if quaternion is not already normalised\n  float invs = 1.0 / (sqx + sqy + sqz + sqw);\n  mat[0][0] = ( sqx - sqy - sqz + sqw) * invs; // since sqw + sqx + sqy + sqz =1/invs*invs\n  mat[1][1] = (-sqx + sqy - sqz + sqw) * invs;\n  mat[2][2] = (-sqx - sqy + sqz + sqw) * invs;\n  \n  float tmp1 = q.x * q.y;\n  float tmp2 = q.z * q.w;\n  mat[1][0] = 2.0 * (tmp1 + tmp2) * invs;\n  mat[0][1] = 2.0 * (tmp1 - tmp2) * invs;\n  \n  tmp1 = q.x * q.z;\n  tmp2 = q.y * q.w;\n  mat[2][0] = 2.0 * (tmp1 - tmp2) * invs;\n  mat[0][2] = 2.0 * (tmp1 + tmp2) * invs;\n  tmp1 = q.y * q.z;\n  tmp2 = q.x * q.w;\n  mat[2][1] = 2.0 * (tmp1 + tmp2) * invs;\n  mat[1][2] = 2.0 * (tmp1 - tmp2) * invs;\n\n  return mat;\n}\n\nvec4 quatFromAxisAngle(vec3 axis, float angle) {\n  vec4 qr;\n  float half_angle = (angle * 0.5) * 3.14159265359 / 180.0;\n  qr.x = axis.x * sin(half_angle);\n  qr.y = axis.y * sin(half_angle);\n  qr.z = axis.z * sin(half_angle);\n  qr.w = cos(half_angle);\n  return qr;\n}\n\nvec4 quatMult(vec4 q1, vec4 q2) {\n  vec4 qr;\n  qr.x = (q1.w * q2.x) + (q1.x * q2.w) + (q1.y * q2.z) - (q1.z * q2.y);\n  qr.y = (q1.w * q2.y) - (q1.x * q2.z) + (q1.y * q2.w) + (q1.z * q2.x);\n  qr.z = (q1.w * q2.z) + (q1.x * q2.y) - (q1.y * q2.x) + (q1.z * q2.w);\n  qr.w = (q1.w * q2.w) - (q1.x * q2.x) - (q1.y * q2.y) - (q1.z * q2.z);\n  return qr;\n}\n"},function(e,t){e.exports="#define GLSLIFY 1\n#ifdef USE_INSTANCES\n  @import instancesUtils\n\n  attribute float id;\n  attribute vec4 instancePosition;\n  attribute vec3 instanceScale;\n  attribute vec4 instanceOrientation;\n  attribute float instanceCustom;\n#endif\n\n#ifdef IS_COG\n  uniform float uCogSpeed;\n#endif\n"},function(e,t){e.exports="#define GLSLIFY 1\n#ifdef USE_INSTANCES\n  vec4 instanceQuat = instanceOrientation;\n#endif\n\n#ifdef IS_COG\n  vec4 cogQuat = quatFromAxisAngle(vec3(0.0, 0.0, 1.0), uCogSpeed * instanceCustom * uTime);\n  instanceQuat = quatMult(instanceQuat, cogQuat);\n#endif\n\n#ifdef USE_INSTANCES\n  mat3 orientation = quatToMat(instanceQuat);\n\n  transformed *= instanceScale;\n  transformed *= orientation;\n  transformed += instancePosition.xyz;\n\n  objectNormal *= instanceScale;\n  objectNormal *= orientation;\n#endif\n"},function(e,t){e.exports="#define GLSLIFY 1\n#ifdef USE_INSTANCES\n  varying float vInstanceOpacity;\n#endif\n"},function(e,t){e.exports="#define GLSLIFY 1\n#ifdef USE_INSTANCES\n  opacity = vInstanceOpacity;\n#endif\n"},function(e,t){e.exports="#define GLSLIFY 1\n@import directionalPars\n\nfloat getHatchPattern(float scale) {\n  return when_eq(0.0, mod(gl_FragCoord.x + gl_FragCoord.y, scale));\n}\n\nfloat getDotPattern(float offset) {\n  return 1.0 - when_gt(mod(gl_FragCoord.x, 2.0001) + mod(gl_FragCoord.y + offset, 2.0), 1.0);\n}\n\nvec3 getSketchIrradiance(const in DefaultMaterial material, const in vec3 normal, const in vec3 lightDirection) {\n  float dotNL = saturate(dot(normal, lightDirection));\n\n  vec3 thresholds = vec3(0.2, 0.35, 0.5);\n\n  float threshold1 = when_lt(dotNL, thresholds.x);\n  float threshold2 = when_and(when_lt(dotNL, thresholds.y), when_ge(dotNL, thresholds.x));\n  float threshold3 = when_and(when_lt(dotNL, thresholds.z), when_ge(dotNL, thresholds.y));\n  float threshold4 = when_ge(dotNL, thresholds.z);\n\n  vec3 mask1 = mix(vec3(1.0), vec3(0.,0.,0.), threshold1);\n  vec3 mask2 = mix(vec3(1.0), vec3(0.4980392156862745,0.4980392156862745,0.4980392156862745), threshold2);\n  vec3 mask3 = mix(vec3(1.0), vec3(0.6980392156862745,0.6980392156862745,0.6980392156862745), threshold3);\n  vec3 masks = mask1 * mask2 * mask3;\n\n  vec3 pattern1 = mix(vec3(1.0), vec3(0.6,0.6,0.6), when_and(threshold2, getHatchPattern(3.0)));\n  vec3 pattern2 = mix(vec3(1.0), vec3(0.6,0.6,0.6), when_and(threshold3, getHatchPattern(4.0)));\n  vec3 pattern3 = mix(vec3(1.0), vec3(0.6980392156862745,0.6980392156862745,0.6980392156862745), when_and(threshold4, getDotPattern(2.0)));\n  vec3 patterns = pattern1 * pattern2 * pattern3;\n  \n  return masks * patterns;\n}\n\nvec3 getDirectSpecular(const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess) {\n  vec3 halfDir = normalize(incidentLight.direction + geometry.viewDir);\n  float dotNH = dot(geometry.normal, halfDir);\n\n  float spec = max(0.0, pow(abs(dotNH), shininess));\n  return mix(0.0, 1.0, step(0.5, spec)) * specularColor;\n}\n\nvoid indirect(const in AmbientIrradiance ambient, const in DefaultMaterial material, inout ReflectedLight reflectedLight) {\n  vec3 irradiance = ambient.color * material.diffuseColor;\n\n  reflectedLight.indirectDiffuse = irradiance;\n}\n\nvoid direct(const in IncidentLight directLight, const in GeometricContext geometry, const in DefaultMaterial material, inout ReflectedLight reflectedLight) {\n  vec3 irradiance = getSketchIrradiance(material, geometry.normal, directLight.direction) * directLight.color;\n\n  reflectedLight.directDiffuse += irradiance * material.diffuseColor;\n  reflectedLight.directSpecular += irradiance * getDirectSpecular(directLight, geometry, material.specularColor, material.specularShininess) * material.specularStrength;\n}\n"},function(e,t){e.exports="#define GLSLIFY 1\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowOpacity;\n\t};\n\n\tuniform DirectionalLight directionalLights[NUM_DIR_LIGHTS];\n#endif\n"},function(e,t){e.exports="#define GLSLIFY 1\n#ifdef USE_NORMAL_MAP\n\tuniform sampler2D uNormalMap;\n\tuniform float uNormalIntensity;\n\n\tvec3 perturbNormal2Arb(vec3 eye_pos, vec3 surf_norm, vec2 coords) {\n\t\tvec3 q0 = vec3(dFdx(eye_pos.x), dFdx(eye_pos.y), dFdx(eye_pos.z));\n\t\tvec3 q1 = vec3(dFdy(eye_pos.x), dFdy(eye_pos.y), dFdy(eye_pos.z));\n\t\tvec2 st0 = dFdx(vUv.st);\n\t\tvec2 st1 = dFdy(vUv.st);\n\n\t\tfloat scale = sign(st1.t * st0.s - st0.t * st1.s);\n\n\t\tvec3 S = normalize((q0 * st1.t - q1 * st0.t) * scale);\n\t\tvec3 T = normalize((- q0 * st1.s + q1 * st0.s) * scale);\n\t\tvec3 N = normalize(surf_norm);\n\t\tmat3 tsn = mat3(S, T, N);\n\n\t\tvec3 mapN = texture2D(uNormalMap, coords).xyz * 2.0 - 1.0;\n\n\t\tmapN.xy *= vec2(uNormalIntensity);\n\t\tmapN.xy *= (float(gl_FrontFacing) * 2.0 - 1.0);\n\n\t\treturn normalize(tsn * mapN);\n\t}\n#endif\n"},function(e,t){e.exports="#define GLSLIFY 1\n#ifdef USE_NORMAL_MAP\n  normal = perturbNormal2Arb(-vViewPosition, normal, uv);\n#endif\n"},function(e,t){e.exports="#define GLSLIFY 1\nuniform float uTransition;\nuniform sampler2D tTransitionNoise;\n\nvec3 blendNormal(vec3 normal){\n\tvec3 blending = abs(normal);\n\tblending = normalize(max(blending, 0.00001));\n\tblending /= vec3(blending.x + blending.y + blending.z);\n\treturn blending;\n}\n\nvec3 triplanarMapping (sampler2D texture, vec3 normal, vec3 position) {\n  vec3 normalBlend = blendNormal(normal);\n\tvec3 xColor = vec3(texture2D(texture, position.yz).r);\n\tvec3 yColor = vec3(texture2D(texture, position.xz).r);\n\tvec3 zColor = vec3(texture2D(texture, position.xy).r);\n\n  return (xColor * normalBlend.x + yColor * normalBlend.y + zColor * normalBlend.z);\n}\n"},function(e,t){e.exports="#define GLSLIFY 1\nfloat noiseTransition = dot(triplanarMapping(tTransitionNoise, vWorldNormal, vWorldPosition.xyz * 0.03), LUMINANCE) * uTransition;\n\n#ifndef IS_CHARACTER_MAIN\n  if(noiseTransition < 0.5) {\n    discard;\n  }\n#endif\n"},function(e,t){e.exports="#define GLSLIFY 1\n#ifdef IS_CONE\n  opacity = 1.0 - uv.y;\n#endif\n"},function(e,t){e.exports="#define GLSLIFY 1\n#if defined(HOME) && defined(IS_ALL) && defined(USE_PALETTE_MAP)\n  float enabledLightVert = texture2D(tPaletteMap, vec2(objectUv.x, objectUv.y - (4. * 5. - 2.) / 64.)).r;\n  float lightMotion = cos(uTime * .001 + color.x * 86.) + cos(uTime * .0003 + color.y * 53.) + sin(uTime * .005 + color.z * 48.);\n  lightMotion /= 3.0;\n\n  transformed.y += lightMotion * color.x * 16. * enabledLightVert;\n  transformed.z += lightMotion * 5. * enabledLightVert;\n#endif\n"},function(e,t){e.exports="#define GLSLIFY 1\n#if defined(HOME) && defined(IS_ALL) && defined(USE_PALETTE_MAP)\n  float enabledLightFrag = texture2D(tPaletteMap, vec2(uv.x, uv.y - (4. * 5. - 2.) / 64.)).r;\n  float lightIntensity = cos(uTime * .001 + vColor.x * 86.) + cos(uTime * .0005 + vColor.y * 53.) + sin(uTime * .006 + vColor.z * 48.);\n  lightIntensity = lightIntensity / 3.0 * 0.5 + 0.5;\n  float fastlightIntensity = sin(uTime * .08 + vColor.x + vColor.y);\n\n  vec3 lightEmissive = mix(vec3(0.0), totalEmissiveRadiance, lightIntensity * .9 + fastlightIntensity * .022 + .15);\n  totalEmissiveRadiance = mix(totalEmissiveRadiance, lightEmissive, enabledLightFrag);\n#endif\n"},function(e,t){e.exports="#define GLSLIFY 1\n#if defined(HOME) && defined(IS_ALL) && defined(USE_PALETTE_MAP)\n  float enabledWindows = texture2D(tPaletteMap, vec2(uv.x, uv.y - (4. * 6. - 2.) / 64.)).r;\n  float windowsIntensity = sin(uTime * .001 + vColor.x * 36.) + cos(uTime * .0015 + vColor.y * 75.) + sin(uTime * .0009 + vColor.z * 68.) * 2.0;\n  windowsIntensity = windowsIntensity / 3.0 * 0.5 + 0.5;\n\n  vec3 windowsEmissive = mix(vec3(0.0), totalEmissiveRadiance, windowsIntensity * .85);\n  totalEmissiveRadiance = mix(totalEmissiveRadiance, windowsEmissive, enabledWindows);\n#endif\n"},function(e,t){e.exports="#define GLSLIFY 1\n#if defined(HOME) && (defined(IS_ALL) || defined(IS_LOGO_U_LETTER) || defined(IS_LOGO_LOCK)) && defined(USE_PALETTE_MAP)\n  float enabledLogoVert = texture2D(tPaletteMap, vec2(objectUv.x, objectUv.y - (4. * 7. - 2.) / 64.)).r;\n  float logoMotion = cos(uTime * .003 + color.x * 14.) + cos(uTime * .002 + color.y * 57.) + sin(uTime * .0009 + color.z * 35.);\n  logoMotion /= 3.0;\n\n  transformed.z += logoMotion * 8. * enabledLogoVert;\n#endif\n"},function(e,t){e.exports="#define GLSLIFY 1\n#if defined(HOME) && defined(IS_ALL) && defined(USE_PALETTE_MAP)\n  uniform sampler2D tGradientMap;\n  uniform float tLogoTransition;\n#endif\n"},function(e,t){e.exports="#define GLSLIFY 1\n#if defined(HOME) && defined(IS_ALL) && defined(USE_PALETTE_MAP)\n  float noiseEnabled = texture2D(tPaletteMap, vec2(uv.x, uv.y - (4. * 7. - 2.) / 64.)).r;\n\n  float gradient = texture2D(tGradientMap, vec2(uv2.x + tLogoTransition - 0.35, uv2.y)).r;\n  float noise = texture2D(tTransitionNoise, vec2(uv2.x + tLogoTransition * vColor.g * 0.001, uv2.y) * 1.3).g;\n  noise *= gradient;\n  noise += tLogoTransition * 0.4;\n\n  if(noise < 0.5 && noiseEnabled > 0.99) {\n    discard;\n  }\n#endif\n\n#if defined(HOME) && defined(IS_LOGO_LOCK) && defined(USE_PALETTE_MAP) && !defined(IS_NORMAL)\n  float logoLockEnabled = texture2D(tPaletteMap, vec2(uv.x, uv.y - (4. * 8. - 2.) / 64.)).r;\n  float logoIntensity = cos(uTime * .002 + vColor.x * 86.) + cos(uTime * .0009 + vColor.y * 53.) + sin(uTime * .0025 + vColor.z * 48.);\n  logoIntensity = logoIntensity / 3.0 * 0.5 + 0.5;\n\n  vec3 logoEmissive = mix(vec3(0.3), totalEmissiveRadiance, logoIntensity * 1.1);\n  totalEmissiveRadiance = mix(totalEmissiveRadiance, logoEmissive, logoLockEnabled);\n#endif\n"},function(e,t){e.exports="#define GLSLIFY 1\n#if defined(HOME) && defined(IS_ALL) && defined(USE_PALETTE_MAP)\n  float enabledBoardVert = texture2D(tPaletteMap, vec2(objectUv.x, objectUv.y - (4. * 9. - 2.) / 64.)).r;\n\n  vec3 boardOrigin = vec3(9.92, 10.62, 56.66);\n  float boardAngle = (cos(uTime * 0.005) + sin(uTime * 0.0055 + 5.)) / 2. * 0.3;\n\n  vec4 boardRotatedPos = worldPosition;\n  boardRotatedPos.xyz -= boardOrigin;\n  boardRotatedPos *= rotationMatrix(vec3(1., 0., 0.), boardAngle);\n  boardRotatedPos.xyz += boardOrigin;\n\n  gl_Position = mix(gl_Position, projectionMatrix * viewMatrix * boardRotatedPos, enabledBoardVert);\n#endif\n"},function(e,t){e.exports="#define GLSLIFY 1\n#if defined(IS_ALL_TRANSPARENT) && defined(USE_PALETTE_MAP)\n  vec2 noiseUv = uv2 * 0.5;\n\n  vec3 color1 = texture2D(tPaletteMap, vec2(uv.x, uv.y - (4. * 5. - 2.) / 64.)).rgb;\n  vec3 color2 = texture2D(tPaletteMap, vec2(uv.x, uv.y - (4. * 6. - 2.) / 64.)).rgb;\n  float isPortal = texture2D(tPaletteMap, vec2(uv.x, uv.y - (4. * 7. - 2.) / 64.)).r;\n  float isLocked = texture2D(tPaletteMap, vec2(uv.x, uv.y - (4. * 8. - 2.) / 64.)).r;\n\n  float noiseTime = mix(uTime, uTime * 0.2, isLocked);\n  vec2 uvNoise1 = vec2(noiseUv.x + noiseTime * 0.00001, noiseUv.y + noiseTime * 0.00003);\n  vec2 uvNoise2 = vec2(noiseUv.x + noiseTime * -0.00001, noiseUv.y + noiseTime * -0.00003);\n\n  float noise = texture2D(tTransitionNoise, uvNoise1).g + texture2D(tTransitionNoise, uvNoise2).g;\n  noise /= 2.0 - 0.22;\n\n  float threshold1 = when_lt(noise, 0.5);\n  float threshold2 = when_and(when_lt(noise, 0.525), when_ge(noise, 0.5));\n\n  vec3 mask1 = mix(vec3(1.0), color1, threshold1);\n  vec3 mask2 = mix(vec3(1.0), color2, threshold2);\n\n  vec3 pattern = mix(vec3(1.0), color1 * 1.2, when_and(threshold1, getHatchPattern(4.0)));\n  vec3 color = mask1 * mask2 * pattern;\n  \n  diffuseColor.rgb = mix(diffuseColor.rgb, mix(color, color * 0.5, isLocked), isPortal);\n  opacity = mix(opacity, threshold1 + threshold2, isPortal);\n  totalEmissiveRadiance = mix(totalEmissiveRadiance, mix(vec3(0.0), totalEmissiveRadiance, threshold1), isPortal);\n#endif\n"},function(e,t){e.exports="#define GLSLIFY 1\n#if defined(LOBBY) && defined(IS_ALL_NO_SHADOWS) && defined(USE_PALETTE_MAP)\n  gl_FragColor.rgb += diffuseColor.rgb * 0.2 * vColor.r;\n#endif\n"},function(e,t){e.exports="#define GLSLIFY 1\n#ifdef IS_LASER_HIT\n  uniform float uExplode;\n  uniform float uOffset;\n#endif\n"},function(e,t){e.exports="#define GLSLIFY 1\n#ifdef IS_LASER_HIT\n  vec3 dist = objectNormal * (uExplode + 1.0) * 0.3;\n  gl_Position.x += dist.x * sin(uTime * 0.3 + 0.3215 + uOffset);\n  gl_Position.y += dist.y * sin(uTime * 0.2 + 0.57603 + uOffset);\n  gl_Position.z += dist.z * sin(uTime * 0.1 + 23.234 + uOffset);\n#endif\n"},function(e,t){e.exports="#define GLSLIFY 1\n#ifdef IS_BURN\n  uniform sampler2D uBurnMap;\n#endif\n"},function(e,t){e.exports="#define GLSLIFY 1\n#ifdef IS_BURN\n  vec4 texel = texture2D(uBurnMap, vec2(fract(uv.x * 10.), uv.y));\n  diffuseColor *= texel;\n  opacity = texel.a;\n#endif\n"},function(e,t){e.exports="#define GLSLIFY 1\n#if defined(LEVEL_2) && defined(IS_ALL) && defined(USE_PALETTE_MAP)\n  float enabledScreenFrag = texture2D(tPaletteMap, vec2(uv.x, uv.y - (4. * 9. - 2.) / 64.)).r;\n  float screenIntensity = sin(uTime * .0015 + vColor.x * 32.) + sin(uTime * .002 + vColor.y * 63.) + sin(uTime * .0005 + vColor.z * 12.);\n  screenIntensity = screenIntensity / 3.0 * 0.5 + 0.5;\n  float fastScreenIntensity = sin(uTime * .08 + vColor.x * 23. + vColor.y * 75.);\n\n  vec3 screenEmissive = mix(vec3(0.0), totalEmissiveRadiance, screenIntensity * .9 + fastScreenIntensity * .022 + .15);\n  totalEmissiveRadiance = mix(totalEmissiveRadiance, screenEmissive, enabledScreenFrag);\n#endif\n"},function(e,t){e.exports="#define GLSLIFY 1\n#if defined(LEVEL_3) && defined(IS_ALL) && defined(USE_PALETTE_MAP) && defined(USE_COLOR)\n  vec2 noiseUv = uv2 * 0.3;\n\n  vec3 color1 = texture2D(tPaletteMap, vec2(uv.x, uv.y - (4. * 5. - 2.) / 64.)).rgb;\n  vec3 color2 = texture2D(tPaletteMap, vec2(uv.x, uv.y - (4. * 6. - 2.) / 64.)).rgb;\n  float isTube = texture2D(tPaletteMap, vec2(uv.x, uv.y - (4. * 9. - 2.) / 64.)).r;\n\n  vec2 uvNoise1 = vec2(noiseUv.x + uTime * 0.00001 + vColor.r * 25., noiseUv.y + uTime * 0.00008 + vColor.g * 86.);\n  vec2 uvNoise2 = vec2(noiseUv.x + uTime * -0.00001 + vColor.r * 25., noiseUv.y + uTime * -0.00004 + vColor.g * 86.);\n\n  float noiseTube = texture2D(tTransitionNoise, uvNoise1).g + texture2D(tTransitionNoise, uvNoise2).g;\n  noiseTube /= 2.0 - 0.22;\n\n  float threshold1 = when_lt(noiseTube, 0.5);\n  float threshold2 = when_and(when_lt(noiseTube, 0.525), when_ge(noiseTube, 0.5));\n\n  vec3 mask1 = mix(vec3(1.0), color1, threshold1);\n  vec3 mask2 = mix(vec3(1.0), color2, threshold2);\n\n  vec3 pattern = mix(vec3(1.0), color1 * 1.2, when_and(threshold1, getHatchPattern(4.0)));\n  vec3 color = mask1 * mask2 * pattern;\n\n  diffuseColor.rgb = mix(diffuseColor.rgb, color, isTube);\n#endif\n"},function(e,t){e.exports="#define GLSLIFY 1\n#if defined(LEVEL_4) && (defined(IS_ALL) || defined(IS_ALL_NO_SHADOWS)) && defined(USE_PALETTE_MAP)\n  float slowLightIntensity = cos(uTime * .003 + vColor.x * 53.) + cos(uTime * .005 + vColor.y * 32.) + sin(uTime * .006 + vColor.z * 84.);\n  slowLightIntensity = slowLightIntensity / 3.0 * 0.5 + 0.5;\n  float fastlightIntensity = sin(uTime * .07 + vColor.x * 24. + vColor.y * 37.) * 0.5 + 0.5;\n\n  float lightIntensity = slowLightIntensity + fastlightIntensity * .15 + .2;\n\n  float lightEnabled = dot(vColor, LUMINANCE);\n  vec3 lightColor = mix(vec3(0.0), diffuseColor.rgb, lightIntensity);\n  vec3 lightEmissive = mix(vec3(0.0), totalEmissiveRadiance, lightIntensity);\n\n  diffuseColor.rgb = mix(diffuseColor.rgb, lightColor, lightEnabled);\n  totalEmissiveRadiance = mix(totalEmissiveRadiance, lightEmissive, lightEnabled);\n#endif\n"},function(e,t){e.exports="#define GLSLIFY 1\n#if defined(LEVEL_4) && defined(USE_PALETTE_MAP)\n  float isLight = texture2D(tPaletteMap, vec2(uv.x, uv.y - (4. * 3. - 2.) / 64.)).r;\n  gl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(0.5, 0.5, 1.0), isLight);\n#endif\n"},function(e,t){e.exports="#define GLSLIFY 1\nvoid main() {\n  gl_FragColor = vec4(1.0);\n}\n"},function(e,t){e.exports="#define GLSLIFY 1\n#define SHADER_NAME Transition\n\nattribute vec2 position;\n\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\n\nvarying vec2 vUv;\n\nvoid main() {\n  vUv = position.xy * 0.5 + 0.5;\n  \n  gl_Position = vec4(position.xy, 1.0, 1.0);\n}\n"},function(e,t){e.exports="#define GLSLIFY 1\n#define SHADER_NAME Transition\n\nuniform sampler2D tDiffuse1;\nuniform sampler2D tDiffuse2;\nuniform float uTime;\nuniform float uProgress;\nuniform vec2 uResolution;\n\nvarying vec2 vUv;\n\nvec4 getFromColor(vec2 uv) {\n  return texture2D(tDiffuse1, uv);\n}\n\nvec4 getToColor(vec2 uv) {\n  return texture2D(tDiffuse2, uv);\n}\n\n@import {{ transition }}Transition\n\nvoid main() {\n  gl_FragColor = transition(vUv);\n}\n"},function(e,h,d){"use strict";(function(e){var t,i=d(13),a=d(1),s=d(279);function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function l(e,t,n){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var r=(o((t=function(e){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=c(this,f(n).call(this,e)))._create(),t._bind(),t.position.z=1,t._scaleFactor=1,t}var t,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(n,i["a"]),t=n,(o=[{key:"destroy",value:function(){l(f(n.prototype),"destroy",this).call(this)}},{key:"setSize",value:function(){var e=a.a.width,t=(a.a.height,.35*e);this.scale.set(t*this._scaleFactor,t*this._scaleFactor,1)}},{key:"update",value:function(e,t){this.visible&&this.material.update(e,t)}},{key:"_bind",value:function(){this._signals.levelIntro.show.add(this._show),this._signals.levelIntro.hide.add(this._hide),this._signals.scene.instanced.add(this._onSceneInstanced),this._signals.pause.shown.add(this._onPauseShow),this._signals.character.reseted.add(this._hide)}},{key:"_create",value:function(){this.geometry=new THREE.PlaneBufferGeometry(1,1),this.material=new s.a({}),this.mesh=new THREE.Mesh(this.geometry,this.material),this.add(this.mesh),this.setSize()}},{key:"_createTls",value:function(){}},{key:"_killTweens",value:function(){TweenMax.killTweensOf(this,{_scaleFactor:!0}),TweenMax.killTweensOf(this.material,{opacity:!0,progress:!0})}},{key:"_show",value:function(e){var t=this;this._killTweens(),this.visible=!0,this.material.uniforms.uMap.value=this._textures.get("main.texts.".concat(e)),TweenMax.fromTo(this,1.3,{_scaleFactor:1.3},{_scaleFactor:1,delay:1.2,onUpdate:this.setSize,ease:Expo.easeOut}),TweenMax.fromTo(this.material,.3,{opacity:0},{opacity:1,delay:1.1}),TweenMax.fromTo(this.material,2,{progress:0},{progress:1,ease:Expo.easeOut,delay:1.2,onStart:function(){t._sounds.get("long-woosh").play()},onComplete:function(){t._hide(1,1.2)}})}},{key:"_hide",value:function(e,t){var n=this;this._killTweens(),TweenMax.to(this,e,{_scaleFactor:1.3,ease:Expo.easeOut,delay:t,onUpdate:this.setSize}),TweenMax.to(this.material,.8*e-.2,{opacity:0,delay:t+.2,ease:Expo.easeOut}),TweenMax.to(this.material,.8*e,{progress:0,delay:t,ease:Expo.easeOut,onComplete:function(){n.visible=!1}})}},{key:"_onSceneInstanced",value:function(){this._hide()}},{key:"_onPauseShow",value:function(){this._hide()}}])&&u(t.prototype,o),r&&u(t,r),n}()).prototype,"setSize",[e],Object.getOwnPropertyDescriptor(t.prototype,"setSize"),t.prototype),o(t.prototype,"_show",[e],Object.getOwnPropertyDescriptor(t.prototype,"_show"),t.prototype),o(t.prototype,"_hide",[e],Object.getOwnPropertyDescriptor(t.prototype,"_hide"),t.prototype),o(t.prototype,"_onSceneInstanced",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onSceneInstanced"),t.prototype),o(t.prototype,"_onPauseShow",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onPauseShow"),t.prototype),t);h.a=r}).call(this,d(2).bind)},function(e,t){e.exports="#define GLSLIFY 1\n#define SHADER_NAME Basic-raw\n\nattribute vec3 position;\n\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\n\nvoid main() {  \n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n"},function(e,t){e.exports="#define GLSLIFY 1\n#define SHADER_NAME Debug\n\nuniform vec3 uColor;\nuniform float uOpacity;\n\nvoid main() {\n  gl_FragColor = vec4(uColor, uOpacity);\n}\n"},function(e,t){e.exports="#define GLSLIFY 1\nattribute vec3 position;\nattribute vec3 normal;\n\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\n\n#include <common>\n#include <uv_pars_vertex>\n\n@import skinningVertPars\n\nvoid main() {\n\tvec3 transformed = vec3(position);\n\tvec3 objectNormal = vec3(normal);\n\n  @import skinningVertBase\n  @import skinningVert\n  @import skinningVertNormal\n\n\tvec4 mvPosition = modelViewMatrix * vec4(transformed, 1.0);\n\n\tgl_Position = projectionMatrix * mvPosition;\n}\n"},function(e,t,n){"use strict";var o="./assets/audios",r="".concat(o,"/themes"),i="".concat(o,"/ui"),a="".concat(o,"/fx"),s="".concat(o,"/voices/plume"),u="".concat(o,"/voices/narrator"),c={common:{"main-theme":{url:"".concat(r,"/main-theme.mp3"),loop:!0},validate:{url:"".concat(i,"/validate.mp3"),volume:.2},woosh:{url:"".concat(a,"/woosh.mp3"),volume:1},"woosh-2":{url:"".concat(a,"/woosh-2.mp3"),volume:1},"woosh-3":{url:"".concat(a,"/woosh-3.mp3"),volume:1},"long-woosh":{url:"".concat(a,"/long-woosh.mp3"),volume:1},play:{url:"".concat(a,"/play.mp3"),volume:.6},"fall-stone-1":{url:"".concat(a,"/fall-stone-1.mp3"),volume:.3},"fall-stone-2":{url:"".concat(a,"/fall-stone-2.mp3"),volume:.3},walking:{url:"".concat(a,"/walking.mp3"),loop:!0,volume:0},portal:{url:"".concat(a,"/portal.mp3"),loop:!0,volume:1},laser:{url:"".concat(a,"/laser.mp3"),volume:.6,loop:!0},robot:{url:"".concat(a,"/robot.mp3"),volume:1,loop:!0},helper:{url:"".concat(i,"/helper.mp3"),volume:.2},jump_0:{url:"".concat(s,"/jump_0.mp3"),volume:.6},jump_1:{url:"".concat(s,"/jump_1.mp3"),volume:.8},jump_2:{url:"".concat(s,"/jump_2.mp3"),volume:.8},jump_3:{url:"".concat(s,"/jump_3.mp3"),volume:.8},jump_4:{url:"".concat(s,"/jump_4.mp3"),volume:.6},outch:{url:"".concat(s,"/outch.mp3"),volume:1},oh_no:{url:"".concat(s,"/oh_no.mp3"),volume:1},keys:{url:"".concat(s,"/keys.mp3"),volume:1},yipi:{url:"".concat(s,"/yipi.mp3"),volume:1},agh:{url:"".concat(s,"/agh.mp3"),volume:1},rrrr:{url:"".concat(s,"/rrrr.mp3"),volume:1},where_are_you_going:{url:"".concat(u,"/where_are_you_going.mp3"),volume:1}},home:{wind:{url:"".concat(a,"/wind.mp3"),loop:!0,volume:.7}},lobby:{"lobby-theme":{url:"".concat(r,"/main-theme.mp3"),loop:!0},where_is_santa_desk:{url:"".concat(s,"/where_is_santa_desk.mp3"),volume:1},portals:{url:"".concat(s,"/portals.mp3"),volume:1},locked_portals:{url:"".concat(s,"/locked_portals.mp3"),volume:1}},"level-1":{"level-1-theme":{url:"".concat(r,"/level-1.mp3"),loop:!0},"laser-hit":{url:"".concat(a,"/laser-hit.mp3"),volume:.8},"laser-death":{url:"".concat(a,"/laser-death.mp3"),volume:.7},bond:{url:"".concat(s,"/bond.mp3"),volume:1},you_sould_be_more_carefull:{url:"".concat(u,"/you_sould_be_more_carefull.mp3"),volume:1.2}},"level-2":{"level-2-theme":{url:"".concat(r,"/level-2.mp3"),loop:!0},"robot-hit":{url:"".concat(a,"/robot-hit.mp3"),volume:1.2},quiet_simon:{url:"".concat(s,"/quiet_simon.mp3"),volume:1},oops_trouble:{url:"".concat(u,"/oops_trouble.mp3"),volume:1}},"level-3":{"level-3-theme":{url:"".concat(r,"/level-3.mp3"),loop:!0},"camera-hit":{url:"".concat(a,"/camera-hit.mp3"),volume:.8},i_am_ready:{url:"".concat(s,"/i_am_ready.mp3"),volume:1},smile_camera:{url:"".concat(u,"/smile_camera.mp3"),volume:1}},"level-4":{where_is_santa:{url:"".concat(u,"/where_is_santa.mp3"),volume:.7},fragment:{url:"".concat(a,"/fragment.mp3"),volume:1},door:{url:"".concat(a,"/door.mp3"),volume:1},chest:{url:"".concat(a,"/chest.mp3"),volume:1}},outro:{merry_xmas:{url:"".concat(u,"/merry_xmas.mp3"),volume:1}}};t.a=c},function(e,t,n){"use strict";var i=n(22),o=n(280),a=n.n(o),r=n(281),s=n.n(r);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],0<=t.indexOf(n)||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],0<=t.indexOf(n)||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function f(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d=function(e){function o(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=(t.color,t.opacity,c(t,["color","opacity"]));return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=f(this,p(o).call(this,n))).vertexShader=a.a,e.fragmentShader=s.a,e.transparent=!0,e.uniforms=function(r){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},t=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),t.forEach(function(e){var t,n,o;t=r,o=i[n=e],n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o})}return r}({},e.uniforms,{uTime:{value:0},uOpacity:{value:1},uProgress:{value:0},uMap:{value:null}}),e}var t,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(o,i["a"]),t=o,(n=[{key:"update",value:function(e,t){this.uniforms.uTime.value=t}},{key:"progress",get:function(){return this.uniforms.uProgress.value},set:function(e){this.uniforms&&(this.uniforms.uProgress.value=e)}}])&&l(t.prototype,n),r&&l(t,r),o}();t.a=d},function(e,t){e.exports="#define GLSLIFY 1\n#define SHADER_NAME Level-intro\n\nattribute vec3 position;\nattribute vec2 uv;\n\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\n\nvarying vec2 vUv;\n\nvoid main() {\n  vUv = uv;\n  \n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n"},function(e,t){e.exports='#define GLSLIFY 1\n#define SHADER_NAME Level-intro\n\nvarying vec2 vUv;\nuniform sampler2D uMap;\nuniform float uProgress;\nuniform float uOpacity;\nuniform float uTime;\n\n//\n// GLSL textureless classic 2D noise "cnoise",\n// with an RSL-style periodic variant "pnoise".\n// Author:  Stefan Gustavson (stefan.gustavson@liu.se)\n// Version: 2011-08-22\n//\n// Many thanks to Ian McEwan of Ashima Arts for the\n// ideas for permutation and gradient selection.\n//\n// Copyright (c) 2011 Stefan Gustavson. All rights reserved.\n// Distributed under the MIT license. See LICENSE file.\n// https://github.com/ashima/webgl-noise\n//\n\nvec4 mod289_1_0(vec4 x)\n{\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute_1_1(vec4 x)\n{\n  return mod289_1_0(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt_1_2(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nvec2 fade_1_3(vec2 t) {\n  return t*t*t*(t*(t*6.0-15.0)+10.0);\n}\n\n// Classic Perlin noise\nfloat cnoise_1_4(vec2 P)\n{\n  vec4 Pi = floor(P.xyxy) + vec4(0.0, 0.0, 1.0, 1.0);\n  vec4 Pf = fract(P.xyxy) - vec4(0.0, 0.0, 1.0, 1.0);\n  Pi = mod289_1_0(Pi); // To avoid truncation effects in permutation\n  vec4 ix = Pi.xzxz;\n  vec4 iy = Pi.yyww;\n  vec4 fx = Pf.xzxz;\n  vec4 fy = Pf.yyww;\n\n  vec4 i = permute_1_1(permute_1_1(ix) + iy);\n\n  vec4 gx = fract(i * (1.0 / 41.0)) * 2.0 - 1.0 ;\n  vec4 gy_1_5 = abs(gx) - 0.5 ;\n  vec4 tx_1_6 = floor(gx + 0.5);\n  gx = gx - tx_1_6;\n\n  vec2 g00 = vec2(gx.x,gy_1_5.x);\n  vec2 g10 = vec2(gx.y,gy_1_5.y);\n  vec2 g01 = vec2(gx.z,gy_1_5.z);\n  vec2 g11 = vec2(gx.w,gy_1_5.w);\n\n  vec4 norm = taylorInvSqrt_1_2(vec4(dot(g00, g00), dot(g01, g01), dot(g10, g10), dot(g11, g11)));\n  g00 *= norm.x;\n  g01 *= norm.y;\n  g10 *= norm.z;\n  g11 *= norm.w;\n\n  float n00 = dot(g00, vec2(fx.x, fy.x));\n  float n10 = dot(g10, vec2(fx.y, fy.y));\n  float n01 = dot(g01, vec2(fx.z, fy.z));\n  float n11 = dot(g11, vec2(fx.w, fy.w));\n\n  vec2 fade_xy = fade_1_3(Pf.xy);\n  vec2 n_x = mix(vec2(n00, n01), vec2(n10, n11), fade_xy.x);\n  float n_xy = mix(n_x.x, n_x.y, fade_xy.y);\n  return 2.3 * n_xy;\n}\n\n\n\n\nvoid main() {\n  vec2 uv = vec2(vUv.x,vUv.y);\n  float n = cnoise_1_4(vUv * 3. + uTime * .001);\n  float m = cnoise_1_4(vUv * 10. + uTime * .004) * n;\n  m = clamp(m, 0., 1.) + uProgress;\n  vec4 texel = texture2D(uMap, vec2(uv.x + n * .01, uv.y + n * .01));\n  // texel.rgb *= vec3(.5);\n  gl_FragColor = texel;\n  gl_FragColor.a *= m;\n  gl_FragColor.a *= uOpacity;\n}\n'},function(e,h,d){"use strict";(function(e){var t,i=d(13),a=d(103),s=d(283);function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function l(e,t,n){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var r=(o((t=function(e){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=c(this,f(n).call(this,e)))._create(),t._bind(),t.renderOrder=1e3,t.position.z+=1,t}var t,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(n,i["a"]),t=n,(o=[{key:"destroy",value:function(){l(f(n.prototype),"destroy",this).call(this)}},{key:"update",value:function(e,t){this.visible&&this.material.update(e,t)}},{key:"_bind",value:function(){this._signals.overlay.show.add(this._show),this._signals.overlay.hide.add(this._hide),this._signals.pause.shown.add(this._onPauseShow),this._signals.pause.hidden.add(this._onPauseHide)}},{key:"_unbind",value:function(){this._signals.overlay.show.remove(this._show),this._signals.overlay.hide.remove(this._hide),this._signals.pause.shown.remove(this._onPauseShow),this._signals.pause.hidden.remove(this._onPauseHide)}},{key:"_create",value:function(){this.geometry=new a.a,this.material=new s.a({name:"OverlayMaterial",color:16777215,transparent:!0}),this.mesh=new THREE.Mesh(this.geometry,this.material),this.add(this.mesh)}},{key:"_createTls",value:function(){}},{key:"_show",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;this.visible=!0,TweenMax.killTweensOf(this.material,{opacity:!0,progress:!0}),TweenMax.to(this.material,e,{opacity:1}),TweenMax.to(this.material,e,{progress:1})}},{key:"_hide",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;"outro"!==this._router.currentRoute.name&&(TweenMax.killTweensOf(this.material,{opacity:!0,progress:!0}),TweenMax.to(this.material,t,{opacity:0,delay:.1,onComplete:function(){e.visible=!1}}),TweenMax.to(this.material,t,{progress:0,delay:.1}))}},{key:"_onPauseShow",value:function(){this._state.isDying||(this.visible=!0,TweenMax.killTweensOf(this.material,{opacity:!0,progress:!0}),TweenMax.to(this.material,1,{opacity:.95}),TweenMax.to(this.material,1,{progress:1}))}},{key:"_onPauseHide",value:function(){var e=this;this._state.isDying||(TweenMax.killTweensOf(this.material,{opacity:!0,progress:!0}),TweenMax.to(this.material,.6,{opacity:0,onComplete:function(){e.visible=!1}}),TweenMax.to(this.material,.6,{progress:0}))}}])&&u(t.prototype,o),r&&u(t,r),n}()).prototype,"_show",[e],Object.getOwnPropertyDescriptor(t.prototype,"_show"),t.prototype),o(t.prototype,"_hide",[e],Object.getOwnPropertyDescriptor(t.prototype,"_hide"),t.prototype),o(t.prototype,"_onPauseShow",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onPauseShow"),t.prototype),o(t.prototype,"_onPauseHide",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onPauseHide"),t.prototype),t);h.a=r}).call(this,d(2).bind)},function(e,t,n){"use strict";var i=n(22),a=n(29),s=n(1),o=n(284),u=n.n(o),r=n(285),c=n.n(r);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],0<=t.indexOf(n)||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],0<=t.indexOf(n)||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function p(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function h(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var v=function(e){function o(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=(t.color,t.opacity,f(t,["color","opacity"]));return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=h(this,d(o).call(this,n))).vertexShader=u.a,e.fragmentShader=c.a,e.transparent=!0,e.uniforms=function(r){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},t=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),t.forEach(function(e){var t,n,o;t=r,o=i[n=e],n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o})}return r}({},e.uniforms,{uTime:{value:0},uOpacity:{value:1},uProgress:{value:1},uColor:{value:new THREE.Color(3685189)},uColor2:{value:new THREE.Color(4672343)},uResolution:{value:s.a.resolution}}),e}var t,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(o,i["a"]),t=o,(n=[{key:"update",value:function(e,t){(a.a.pauseDisplayed||a.a.isOutro)&&(this.uniforms.uTime.value=t)}},{key:"color",get:function(){return this.uniforms.uColor.value},set:function(e){this.uniforms&&this.uniforms.uColor.set(e)}},{key:"progress",get:function(){return this.uniforms.uProgress.value},set:function(e){this.uniforms&&(this.uniforms.uProgress.value=e)}}])&&p(t.prototype,n),r&&p(t,r),o}();t.a=v},function(e,t){e.exports="#define GLSLIFY 1\n#define SHADER_NAME Overlay\nattribute vec2 position;\n\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\n\nvarying vec2 vUv;\n\nvoid main() {\n  vUv = position.xy * 0.5 + 0.5;\n  \n  gl_Position = vec4(position.xy, 1.0, 1.0);\n}\n"},function(e,t){e.exports="#define GLSLIFY 1\n#define SHADER_NAME Overlay\n\nvarying vec2 vUv;\nuniform vec3 uColor;\nuniform vec3 uColor2;\nuniform float uOpacity;\nuniform vec2 uResolution;\nuniform float uTime;\nuniform float uProgress;\n\nvec4 mod289_1_0(vec4 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute_1_1(vec4 x) {\n  return mod289_1_0(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt_1_2(vec4 r) {\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nvec2 fade_1_3(vec2 t) {\n  return t*t*t*(t*(t*6.0-15.0)+10.0);\n}\n\n// Classic Perlin noise\nfloat cnoise2d_1_4(vec2 P) {\n  vec4 Pi = floor(P.xyxy) + vec4(0.0, 0.0, 1.0, 1.0);\n  vec4 Pf = fract(P.xyxy) - vec4(0.0, 0.0, 1.0, 1.0);\n  Pi = mod289_1_0(Pi); // To avoid truncation effects in permutation\n  vec4 ix = Pi.xzxz;\n  vec4 iy = Pi.yyww;\n  vec4 fx = Pf.xzxz;\n  vec4 fy = Pf.yyww;\n\n  vec4 i = permute_1_1(permute_1_1(ix) + iy);\n\n  vec4 gx = fract(i * (1.0 / 41.0)) * 2.0 - 1.0 ;\n  vec4 gy_1_5 = abs(gx) - 0.5 ;\n  vec4 tx_1_6 = floor(gx + 0.5);\n  gx = gx - tx_1_6;\n\n  vec2 g00 = vec2(gx.x,gy_1_5.x);\n  vec2 g10 = vec2(gx.y,gy_1_5.y);\n  vec2 g01 = vec2(gx.z,gy_1_5.z);\n  vec2 g11 = vec2(gx.w,gy_1_5.w);\n\n  vec4 norm = taylorInvSqrt_1_2(vec4(dot(g00, g00), dot(g01, g01), dot(g10, g10), dot(g11, g11)));\n  g00 *= norm.x;\n  g01 *= norm.y;\n  g10 *= norm.z;\n  g11 *= norm.w;\n\n  float n00 = dot(g00, vec2(fx.x, fy.x));\n  float n10 = dot(g10, vec2(fx.y, fy.y));\n  float n01 = dot(g01, vec2(fx.z, fy.z));\n  float n11 = dot(g11, vec2(fx.w, fy.w));\n\n  vec2 fade_xy = fade_1_3(Pf.xy);\n  vec2 n_x = mix(vec2(n00, n01), vec2(n10, n11), fade_xy.x);\n  float n_xy = mix(n_x.x, n_x.y, fade_xy.y);\n  return 2.3 * n_xy;\n}\n\n\n\n\nfloat random (in vec2 _st) {\n    return fract(sin(dot(_st.xy,\n                         vec2(12.9898,78.233)))*\n        43758.5453123);\n}\n\nfloat noise (in vec2 _st) {\n    vec2 i = floor(_st);\n    vec2 f = fract(_st);\n\n    // Four corners in 2D of a tile\n    float a = random(i);\n    float b = random(i + vec2(1.0, 0.0));\n    float c = random(i + vec2(0.0, 1.0));\n    float d = random(i + vec2(1.0, 1.0));\n\n    vec2 u = f * f * (3.0 - 2.0 * f);\n\n    return mix(a, b, u.x) +\n            (c - a)* u.y * (1.0 - u.x) +\n            (d - b) * u.x * u.y;\n}\n\n#define NUM_OCTAVES 2\n\nfloat fbm ( in vec2 _st) {\n    float v = 0.0;\n    float a = 0.5;\n    vec2 shift = vec2(100.0);\n    // Rotate to reduce axial bias\n    mat2 rot = mat2(cos(0.5), sin(0.5),\n                    -sin(0.5), cos(0.50));\n    for (int i = 0; i < NUM_OCTAVES; ++i) {\n        v += a * cnoise2d_1_4(_st);\n        _st = rot * _st * 2.0 + shift;\n        a *= 0.5;\n    }\n    return v;\n}\n\nvoid main() {\n\n  vec2 st = vUv * 3.;\n  // st += st * abs(sin(u_time*0.1)*3.0);\n  vec3 color = vec3(0.0);\n\n  float time = uTime * .001;\n  vec2 q = vec2(0.);\n  q.x = fbm( st + 2.00 * time);\n  q.y = fbm( st + vec2(1.0));\n\n  vec2 r = vec2(0.);\n  r.x = fbm( st + 1.0 * q + vec2(1.7,9.2) + 0.15 * time );\n  r.y = fbm( st + 1.0 * q + vec2(8.3,2.8) + 0.126 * time );\n\n  float mask = clamp(fbm( st+r ) + uProgress * 2., 0., 1.);\n\n  float rColor = random(vUv + fract(uTime* .001) );\n\n  gl_FragColor = vec4(mix(uColor, uColor2, rColor), mask * uOpacity);\n}\n"},function(e,h,d){"use strict";(function(e){var t,i=d(13),a=(d(18),d(287)),s=d(1);function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function l(e,t,n){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var r=(o((t=function(e){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=c(this,f(n).call(this,e)))._create(),t._createTls(),t._bind(),t.renderOrder=1e3,t.position.z+=1,t.visible=!1,t.setSize(),t}var t,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(n,i["a"]),t=n,(o=[{key:"destroy",value:function(){l(f(n.prototype),"destroy",this).call(this)}},{key:"setSize",value:function(){var e=s.a.width,t=s.a.height,n=t<e?e:t;this.scale.set(n,n,1)}},{key:"update",value:function(e,t){this.visible&&this.material.update(e,t)}},{key:"_bind",value:function(){this._signals.scene.changed.add(this._onSceneChange),this._signals.shapeOverlay.show.add(this._show),this._signals.shapeOverlay.hide.add(this._hide),this._signals.shapeOverlay.tween.add(this._tween),this._signals.character.reseted.add(this._onCharReset)}},{key:"_create",value:function(){this.geometry=new THREE.PlaneBufferGeometry(1,1,1,1),this.material=new a.a({name:"ShapeOverlayMaterial",transparent:!0}),this.mesh=new THREE.Mesh(this.geometry,this.material),this.add(this.mesh)}},{key:"_createTls",value:function(){var e=this;this._resetTl=new TimelineMax({paused:!0,onComplete:function(){e.visible=!1}}),this._resetTl.set(this.material,{progress:0}).to(this.material,2,{progress:.19,ease:Elastic.easeOut.config(1,.12),onStart:function(){e._sounds.play("woosh-2")}}).to(this.material,.5,{progress:0,onStart:function(){e._sounds.play("woosh-4")},onComplete:function(){e._signals.shapeOverlay.screenCovered.dispatch()},ease:Expo.easeOut}).to(this.material,4,{progress:1,onStart:function(){e._sounds.play("woosh-3")},ease:Expo.easeOut},3.8)}},{key:"_onSceneChange",value:function(){this._hide(.3)}},{key:"_show",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;this.visible=!0,TweenMax.killTweensOf(this.material,{opacity:!0,progress:!0}),TweenMax.to(this.material,e,{progress:1})}},{key:"_hide",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;TweenMax.to(this.material,t,{progress:0,onComplete:function(){e.visible=!1}}),TweenMax.to(this.material,t,{progress:0})}},{key:"_tween",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;2<arguments.length&&void 0!==arguments[2]?arguments[2]:Expo.easeOut;this.visible=!0,TweenMax.to(this.material,n,{progress:t,onComplete:function(){e.visible=0<t}})}},{key:"_onCharReset",value:function(){this.visible=!0,this._resetTl.play(0)}}])&&u(t.prototype,o),r&&u(t,r),n}()).prototype,"setSize",[e],Object.getOwnPropertyDescriptor(t.prototype,"setSize"),t.prototype),o(t.prototype,"_onSceneChange",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onSceneChange"),t.prototype),o(t.prototype,"_show",[e],Object.getOwnPropertyDescriptor(t.prototype,"_show"),t.prototype),o(t.prototype,"_hide",[e],Object.getOwnPropertyDescriptor(t.prototype,"_hide"),t.prototype),o(t.prototype,"_tween",[e],Object.getOwnPropertyDescriptor(t.prototype,"_tween"),t.prototype),o(t.prototype,"_onCharReset",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onCharReset"),t.prototype),t);h.a=r}).call(this,d(2).bind)},function(e,t,n){"use strict";var i=n(22),a=n(1),o=n(74),s=n.n(o),r=n(288),u=n.n(r);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],0<=t.indexOf(n)||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],0<=t.indexOf(n)||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function f(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function p(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var y=function(e){function o(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=(t.color,t.opacity,l(t,["color","opacity"]));return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=p(this,h(o).call(this,n))).vertexShader=s.a,e.fragmentShader=u.a,e.transparent=!0,e.uniforms=function(r){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},t=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),t.forEach(function(e){var t,n,o;t=r,o=i[n=e],n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o})}return r}({},e.uniforms,{uTime:{value:0},uOpacity:{value:1},uProgress:{value:1},uColor:{value:new THREE.Color(14606046)},uColor2:{value:new THREE.Color(16777215)},uResolution:{value:a.a.resolution}}),e.extensions.derivatives=!0,e}var t,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(o,i["a"]),t=o,(n=[{key:"update",value:function(e,t){this.uniforms.uTime.value=t}},{key:"color",get:function(){return this.uniforms.uColor.value},set:function(e){this.uniforms&&this.uniforms.uColor.set(e)}},{key:"progress",get:function(){return this.uniforms.uProgress.value},set:function(e){this.uniforms&&(this.uniforms.uProgress.value=e)}}])&&f(t.prototype,n),r&&f(t,r),o}();t.a=y},function(e,t){e.exports='#define GLSLIFY 1\n#define SHADER_NAME Shape-Overlay\n\nvarying vec2 vUv;\nuniform vec3 uColor;\nuniform vec3 uColor2;\nuniform float uOpacity;\nuniform vec2 uResolution;\nuniform float uTime;\nuniform float uProgress;\n\n//\n// GLSL textureless classic 2D noise "cnoise",\n// with an RSL-style periodic variant "pnoise".\n// Author:  Stefan Gustavson (stefan.gustavson@liu.se)\n// Version: 2011-08-22\n//\n// Many thanks to Ian McEwan of Ashima Arts for the\n// ideas for permutation and gradient selection.\n//\n// Copyright (c) 2011 Stefan Gustavson. All rights reserved.\n// Distributed under the MIT license. See LICENSE file.\n// https://github.com/ashima/webgl-noise\n//\n\nvec4 mod289_1_0(vec4 x)\n{\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute_1_1(vec4 x)\n{\n  return mod289_1_0(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt_1_2(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nvec2 fade_1_3(vec2 t) {\n  return t*t*t*(t*(t*6.0-15.0)+10.0);\n}\n\n// Classic Perlin noise\nfloat cnoise_1_4(vec2 P)\n{\n  vec4 Pi = floor(P.xyxy) + vec4(0.0, 0.0, 1.0, 1.0);\n  vec4 Pf = fract(P.xyxy) - vec4(0.0, 0.0, 1.0, 1.0);\n  Pi = mod289_1_0(Pi); // To avoid truncation effects in permutation\n  vec4 ix = Pi.xzxz;\n  vec4 iy = Pi.yyww;\n  vec4 fx = Pf.xzxz;\n  vec4 fy = Pf.yyww;\n\n  vec4 i = permute_1_1(permute_1_1(ix) + iy);\n\n  vec4 gx = fract(i * (1.0 / 41.0)) * 2.0 - 1.0 ;\n  vec4 gy_1_5 = abs(gx) - 0.5 ;\n  vec4 tx_1_6 = floor(gx + 0.5);\n  gx = gx - tx_1_6;\n\n  vec2 g00 = vec2(gx.x,gy_1_5.x);\n  vec2 g10 = vec2(gx.y,gy_1_5.y);\n  vec2 g01 = vec2(gx.z,gy_1_5.z);\n  vec2 g11 = vec2(gx.w,gy_1_5.w);\n\n  vec4 norm = taylorInvSqrt_1_2(vec4(dot(g00, g00), dot(g01, g01), dot(g10, g10), dot(g11, g11)));\n  g00 *= norm.x;\n  g01 *= norm.y;\n  g10 *= norm.z;\n  g11 *= norm.w;\n\n  float n00 = dot(g00, vec2(fx.x, fy.x));\n  float n10 = dot(g10, vec2(fx.y, fy.y));\n  float n01 = dot(g01, vec2(fx.z, fy.z));\n  float n11 = dot(g11, vec2(fx.w, fy.w));\n\n  vec2 fade_xy = fade_1_3(Pf.xy);\n  vec2 n_x = mix(vec2(n00, n01), vec2(n10, n11), fade_xy.x);\n  float n_xy = mix(n_x.x, n_x.y, fade_xy.y);\n  return 2.3 * n_xy;\n}\n\n\n\n\nfloat random (in vec2 _st) {\n    return fract(sin(dot(_st.xy,\n                         vec2(12.9898,78.233)))*\n        43758.5453123);\n}\n\nfloat aastep(float threshold, float value) {\n  #ifdef GL_OES_standard_derivatives\n    float afwidth = length(vec2(dFdx(value), dFdy(value))) * 0.70710678118654757;\n    return smoothstep(threshold-afwidth, threshold+afwidth, value);\n  #else\n    return step(threshold, value);\n  #endif  \n}\n\nfloat circle(vec2 st, float radius) {\n  return aastep(radius, length(st - vec2(0.5)));\n}\n\nvoid main() {\n  float n = cnoise_1_4(vUv * 10. + fract(uTime* .003));\n  vec2 st = vec2(vUv.x + n * .009, vUv.y + n * .009);\n  float c = circle(st, uProgress);\n  float rColor = random(vUv + fract(uTime* .001));\n\n  gl_FragColor = vec4(mix(uColor, uColor2, rColor), c);\n}\n'},function(e,t){e.exports="precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 uv;\nattribute vec3 position;\n\nuniform vec4 uSize;\nuniform vec2 uSide;\nuniform vec2 uResolution;\n\nvarying vec2 vUv;\n\nvoid main() {\n  vUv = uv;\n\n  vec2 size = uSize.xy / uResolution.xy;\n  vec2 offset = uSize.wz / uResolution.yx;\n\n  vec2 transformed = position.xy * size.xy;\n  transformed += uSide - uSide * vec2(size.x, size.y);\n  transformed += uSide * vec2(-offset.y, -offset.x) * 2.0;\n\n  gl_Position = vec4(transformed, 1.0, 1.0);\n}\n"},function(e,t){e.exports="precision highp float;\n#define GLSLIFY 1\n\nvec3 unpackVec3_1_0(float value) {\n  float c_precisionp1 = 512.0 + 1.0;\n\tvec3 color;\n\tcolor.r = mod(value, c_precisionp1) / 512.0;\n\tcolor.b = mod(floor(value / c_precisionp1), c_precisionp1) / 512.0;\n\tcolor.g = floor(value / (c_precisionp1 * c_precisionp1)) / 512.0;\n\treturn color;\n}\n\n\n\n\nuniform sampler2D uTexture;\nuniform float uComponent;\nuniform float uPackedComponent;\nuniform float uUnpack;\nuniform float uAlpha;\n\nvarying vec2 vUv;\n\nfloat when_eq(float x, float y) {\n  return 1.0 - abs(sign(x - y));\n}\n\nfloat when_and(float a, float b) {\n  return a * b;\n}\n\nfloat when_or(float a, float b) {\n  return min(a + b, 1.0);\n}\n\nvoid main() {\n  vec4 tex = texture2D(uTexture, vUv);\n\n  // Component equalities\n  // 0.0 = RGB / 1.0 = R / 2.0 = G / 3.0 = B / 4.0 = A\n  float c0 = when_eq(uComponent, 0.0);\n  float c1 = when_eq(uComponent, 1.0);\n  float c2 = when_eq(uComponent, 2.0);\n  float c3 = when_eq(uComponent, 3.0);\n  float c4 = when_eq(uComponent, 4.0);\n\n  // Packed component equalities\n  // 0.0 = RGB / 1.0 = R / 2.0 = G / 3.0 = B\n  float pc0 = when_eq(uPackedComponent, 0.0);\n  float pc1 = when_eq(uPackedComponent, 1.0);\n  float pc2 = when_eq(uPackedComponent, 2.0);\n  float pc3 = when_eq(uPackedComponent, 3.0);\n\n  float upD = when_eq(uUnpack, 0.0); // Unpacking disabled\n  float upE = when_eq(uUnpack, 1.0); // Unpacking enabled\n\n  vec3 color = vec3(0.0);\n\n  // Output components (RGBA) when packing disabled\n  // 4 components + 1 default to RGB\n  color += when_and(c0, upD) * tex.rgb;\n  color += when_and(c1, upD) * tex.r;\n  color += when_and(c2, upD) * tex.g;\n  color += when_and(c3, upD) * tex.b;\n  color += when_and(c4, upD) * tex.a;\n\n  // Output packed components (RGBA * RGB packed) when packing enabled\n  // 12 packed components + 4 defaults to RGB\n  vec3 upR = unpackVec3_1_0(tex.r);\n  color += when_and(when_and(c1, upE), pc0) * upR.rgb;\n  color += when_and(when_and(c1, upE), pc1) * upR.r;\n  color += when_and(when_and(c1, upE), pc2) * upR.g;\n  color += when_and(when_and(c1, upE), pc3) * upR.b;\n\n  vec3 upG = unpackVec3_1_0(tex.g);\n  color += when_and(when_and(c2, upE), pc0) * upG.rgb;\n  color += when_and(when_and(c2, upE), pc1) * upG.r;\n  color += when_and(when_and(c2, upE), pc2) * upG.g;\n  color += when_and(when_and(c2, upE), pc3) * upG.b;\n\n  vec3 upB = unpackVec3_1_0(tex.b);\n  color += when_and(when_and(c3, upE), pc0) * upB.rgb;\n  color += when_and(when_and(c3, upE), pc1) * upB.r;\n  color += when_and(when_and(c3, upE), pc2) * upB.g;\n  color += when_and(when_and(c3, upE), pc3) * upB.b;\n\n  vec3 upA = unpackVec3_1_0(tex.a);\n  color += when_and(when_and(c4, upE), pc0) * upA.rgb;\n  color += when_and(when_and(c4, upE), pc1) * upA.r;\n  color += when_and(when_and(c4, upE), pc2) * upA.g;\n  color += when_and(when_and(c4, upE), pc3) * upA.b;\n\n  gl_FragColor = vec4(color, uAlpha);\n}\n"},function(e,f,p){"use strict";(function(e){var t,i=p(16),a=p(370),s=p(1),u=p(4),n=p(5);function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function r(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var c=Object(n.d)("PostProcessing","#2849cc",!1),l=(r((t=function(){function r(e,t,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this._renderer=i.a.renderer,this._scene=e,this._camera=t,this._enabled=n,this._noRenderToScreen=!0,this._signals=u.a,this._enabled)this._composer=new a.a(this._renderer,{noRenderToScreen:this._noRenderToScreen});else{var o=this._renderer.context.getContextAttributes().alpha;this._defaultRtt=new THREE.WebGLRenderTarget(s.a.width,s.a.height,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:o?THREE.RGBAFormat:THREE.RGBFormat,depthBuffer:!0,stencilBuffer:!1,generateMipmaps:!1})}this._bind()}var e,t,n;return e=r,(t=[{key:"addPass",value:function(e,t){this._composer.addPass(e,t)}},{key:"removePass",value:function(e){this._composer.removePass(e)}},{key:"getPass",value:function(e){return this._composer.getPass(e)}},{key:"destroyPasses",value:function(){this._composer&&this._composer.destroyPasses()}},{key:"setSize",value:function(e,t){this._enabled?this._composer.setSize(e,t):this._defaultRtt.setSize(e,t)}},{key:"update",value:function(e,t){this._enabled?this._composer.render(e,t):this._renderer.render(this._scene,this._camera,this._defaultRtt,!0)}},{key:"destroy",value:function(){this._unbind(),this._composer&&this._composer.destroy(),this._defaultRtt&&this._defaultRtt.dispose()}},{key:"_bind",value:function(){s.a.resized.add(this._onWindowResize),this._signals.camera.changed.add(this._onCameraChanged),this._signals.scene.changed.add(this._onSceneChanged)}},{key:"_unbind",value:function(){s.a.resized.remove(this._onWindowResize),this._signals.camera.changed.remove(this._onCameraChanged),this._signals.scene.changed.remove(this._onSceneChanged)}},{key:"_onWindowResize",value:function(e,t){this.setSize(e,t)}},{key:"_onCameraChanged",value:function(e){this._camera=e}},{key:"_onSceneChanged",value:function(e){this._scene=e}},{key:"enabled",get:function(){return this._enabled},set:function(e){e!==this._enabled&&c(e?"Enabled":"Disabled")}},{key:"rtt",get:function(){var e=this._defaultRtt;return this._enabled&&(e=this._composer.passes.length%2==0?this._composer.writeBuffer:this._composer.readBuffer),e}}])&&o(e.prototype,t),n&&o(e,n),r}()).prototype,"_onWindowResize",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onWindowResize"),t.prototype),r(t.prototype,"_onCameraChanged",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onCameraChanged"),t.prototype),r(t.prototype,"_onSceneChanged",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onSceneChanged"),t.prototype),t);f.a=l}).call(this,p(2).bind)},function(e,t){e.exports="#define GLSLIFY 1\nuniform sampler2D tInput;\n\nvarying vec2 vUv;\n\nvoid main() {\n  vec4 color = texture2D(tInput, vUv);\n  gl_FragColor = color;\n}\n"},function(e,_,g){"use strict";(function(e){var t,i=g(4),a=g(294),s=g(39);function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function l(e,t,n){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var o,r,h,d,y,v,m=(o=(t=function(e){function r(e,t){var n,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(n=c(this,f(r).call(this,e,t,null))).name="RenderPass",n.clearPass=new a.a(o),n.overrideMaterial=o.overrideMaterial||null,n.clearDepth=o.clearDepth||!1,n.clear=o.clear||!0,n._bind(),n}var t,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(r,s["a"]),t=r,(n=[{key:"destroy",value:function(){l(f(r.prototype),"destroy",this).call(this),this._unbind()}},{key:"render",value:function(e,t){var n=this.scene,o=this.renderToScreen?null:t;this.clear?this.clearPass.render(e,o):this.clearDepth&&(e.setRenderTarget(o),e.clearDepth()),n.overrideMaterial=this.overrideMaterial,e.render(n,this.camera,o),n.overrideMaterial=null}},{key:"_bind",value:function(){i.a.camera.changed.add(this._handleCameraChange)}},{key:"_unbind",value:function(){i.a.camera.changed.remove(this._handleCameraChange)}},{key:"_handleCameraChange",value:function(e){this.camera=e}}])&&u(t.prototype,n),o&&u(t,o),r}()).prototype,r="_handleCameraChange",h=[e],d=Object.getOwnPropertyDescriptor(t.prototype,"_handleCameraChange"),y=t.prototype,v={},Object.keys(d).forEach(function(e){v[e]=d[e]}),v.enumerable=!!v.enumerable,v.configurable=!!v.configurable,("value"in v||v.initializer)&&(v.writable=!0),v=h.slice().reverse().reduce(function(e,t){return t(o,r,e)||e},v),y&&void 0!==v.initializer&&(v.value=v.initializer?v.initializer.call(y):void 0,v.initializer=void 0),void 0===v.initializer&&(Object.defineProperty(o,r,v),v=null),t);_.a=m}).call(this,g(2).bind)},function(e,t,n){"use strict";var i=n(39);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function s(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=new THREE.Color,r=function(e){function n(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=s(this,u(n).call(this,null,null,null))).name="ClearPass",e.clearColor=t.clearColor||null,e.clearAlpha=t.clearAlpha||0,e}var t,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(n,i["a"]),t=n,(o=[{key:"render",value:function(e,t){var n,o=this.clearColor;null!==o&&(l.copy(e.getClearColor()),n=e.getClearAlpha(),e.setClearColor(o,this.clearAlpha)),e.setRenderTarget(this.renderToScreen?null:t),e.clear(),null!==o&&e.setClearColor(l,n)}}])&&a(t.prototype,o),r&&a(t,r),n}();t.a=r},function(e,w,O){"use strict";(function(e){var t,i=O(75),a=O(296),s=O(299),u=O(18),n=O(5),c=O(6);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function f(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var r,d,y,v,m,_,g=Object(n.d)("CameraCtrl","#bfd81e",!0),b=(r=(t=function(e){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=f(this,p(n).call(this,e)))._cameras=[],t._currentCameraId=null,t._helpers=new THREE.Object3D,t._isPaused=!0,t._guiIsCreated=!1,t._guiFolder=null,t._createGUI(),t._createDebugCameras(),t}var t,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(n,i["a"]),t=n,(o=[{key:"addCamera",value:function(e){this._cameras.push(e),this._checkDefaultCamera(e),this._createHelper(e)}},{key:"removeCamera",value:function(e){this._cameras.splice(this._cameras.indexOf(e),1),e.destroy()}},{key:"nextCamera",value:function(){var e=Object(u.modAbs)(this._currentCameraId+1,this._cameras.length);this.changeCamera(e)}},{key:"previousCamera",value:function(){var e=Object(u.modAbs)(this._currentCameraId-1,this._cameras.length);this.changeCamera(e)}},{key:"changeCamera",value:function(e){var t=this._getCamera(this._currentCameraId);t&&(t.helper&&(t.helper.visible=!0),t.controls&&(t.controls.enabled=!1),t.stop()),this._currentCameraId=e;var n=this._getCamera(e);n.controls&&(n.controls.enabled=!0),n.helper&&(n.helper.visible=!1),n.start(),this._isPaused||(g("Camera changed from '".concat(t.name,"' to '").concat(n.name,"'")),this._signals.camera.changed.dispatch(n))}},{key:"destroy",value:function(){this._unbind(),this._destroyGUI();for(var e=0,t=this._cameras.length;e<t;e++)this._cameras[e].destroy();this._cameras=null,this._currentCameraId=null}},{key:"start",value:function(){this._isPaused=!1,this._bind();for(var e=0,t=this._cameras.length;e<t;e++)this._cameras[e].createGUI(this._guiFolder)}},{key:"pause",value:function(){this._isPaused=!0,this._unbind()}},{key:"update",value:function(e,t){for(var n=0,o=this._cameras.length;n<o;n++)this._cameras[n].update(e,t)}},{key:"_bind",value:function(){this._keyboard.upped.add(this._onKeyUp)}},{key:"_unbind",value:function(){this._keyboard.upped.remove(this._onKeyUp)}},{key:"_createGUI",value:function(){this._guiIsCreated=!0,this._guiFolder=this._gui.addFolder("CameraCtrl - ".concat(this._scene.name))}},{key:"_destroyGUI",value:function(){this._guiFolder&&this._gui.removeFolder(this._guiFolder)}},{key:"_checkDefaultCamera",value:function(e){if(e.isDefault){var t=this._cameras.length-1;t!==this._currentCameraId&&(this.changeCamera(t),e.helper&&(e.helper.visible=!1))}}},{key:"_createHelper",value:function(e){e.helper&&this._helpers.add(e.helper)}},{key:"_getCamera",value:function(e){return this._cameras[e]}},{key:"_createDebugCameras",value:function(){this._debugOrbitCamera=new a.a({name:"Debug orbit camera",isDefault:!1,domEl:document.querySelector("#application")}),this.addCamera(this._debugOrbitCamera),this._debugFlyCamera=new s.a({name:"Debug fly camera",isDefault:!1,domEl:document.querySelector("#application")}),this.addCamera(this._debugFlyCamera)}},{key:"_onKeyUp",value:function(e,t){this._keyboard.isDown("shift")&&("c"!==t||this._keyboard.isDown("ctrl")||(this.nextCamera(),this._signals.toastMsg.log.dispatch("cameractrl","#CameraCtrl - Swtich to ".concat(this.camera.name.toLowerCase())),Object(c.a)("debug","debug-camera",this.camera.name)))}},{key:"helpers",get:function(){return this._helpers}},{key:"camera",get:function(){return this._cameras[this._currentCameraId]}},{key:"debugOrbitCamera",get:function(){return this._debugOrbitCamera}},{key:"debugFlyCamera",get:function(){return this._debugFlyCamera}},{key:"cameras",get:function(){return this._cameras}},{key:"currentCameraId",get:function(){return this._currentCameraId}}])&&l(t.prototype,o),r&&l(t,r),n}()).prototype,d="_onKeyUp",y=[e],v=Object.getOwnPropertyDescriptor(t.prototype,"_onKeyUp"),m=t.prototype,_={},Object.keys(v).forEach(function(e){_[e]=v[e]}),_.enumerable=!!_.enumerable,_.configurable=!!_.configurable,("value"in _||_.initializer)&&(_.writable=!0),_=y.slice().reverse().reduce(function(e,t){return t(r,d,e)||e},_),m&&void 0!==_.initializer&&(_.value=_.initializer?_.initializer.call(m):void 0,_.initializer=void 0),void 0===_.initializer&&(Object.defineProperty(r,d,_),_=null),t);w.a=b}).call(this,O(2).bind)},function(e,m,_){"use strict";(function(e){var t,r=_(76),a=_(298);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e,t,n){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var n,o,i,h,d,y,v=(n=(t=function(e){function i(){var e,t,n,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),t=this,n=l(i).call(this,o),(e=!n||"object"!==s(n)&&"function"!=typeof n?p(t):n).name=o.name||"Orbit Camera",e.controls=new a.a(p(p(e)),o.domEl||document.body),e.controls.enabled=!1,e.controls.enableKeys=!1,e.controls.target.set(0,0,0),e.position.set(50,50,50),window.orbitDebug=function(){console.log("orbit pos",e.position),console.log("orbit rot",e.rotation)},e}var t,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(i,r["a"]),t=i,(n=[{key:"createGUI",value:function(e){var t=this;if(!this._guiIsCreated){this._guiIsCreated=!0;var n=c(l(i.prototype),"createGUI",this).call(this,e);n.add(this.controls,"enabled").name("Controls enabled");var o=n.addFolder("Target");o.add({log:function(){return console.log(t.controls.target)}},"log").name("Log"),o.add(this.controls.target,"x").step(.1).name("X"),o.add(this.controls.target,"y").step(.1).name("Y"),o.add(this.controls.target,"z").step(.1).name("Z");var r=n.addFolder("Views");return r.add(this,"_setTopView").name("Top"),r.add(this,"_setBottomView").name("Bottom"),r.add(this,"_setLeftView").name("Left"),r.add(this,"_setRightView").name("Right"),n.add(this.controls,"autoRotate").name("Auto rotate"),n.add(this.controls,"autoRotateSpeed",0,60,1).name("Auto rotate speed"),n}}},{key:"destroy",value:function(){c(l(i.prototype),"destroy",this).call(this),this.controls.destroy()}},{key:"update",value:function(e,t){c(l(i.prototype),"update",this).call(this,e,t),this.controls.enabled&&this.controls.update()}},{key:"_onKeyDown",value:function(e,t,n){switch(n){case"left":this._setLeftView();break;case"up":this._setTopView();break;case"right":this._setRightView();break;case"down":this._setBottomView()}}},{key:"_setTopView",value:function(){this.controls.target.copy(new THREE.Vector3),this.position.set(0,200,0)}},{key:"_setBottomView",value:function(){this.controls.target.copy(new THREE.Vector3),this.position.set(0,-200,0)}},{key:"_setLeftView",value:function(){this.controls.target.copy(new THREE.Vector3),this.position.set(-200,0,0)}},{key:"_setRightView",value:function(){this.controls.target.copy(new THREE.Vector3),this.position.set(200,0,0)}},{key:"_createHelper",value:function(){}},{key:"_destroyHelper",value:function(){}}])&&u(t.prototype,n),o&&u(t,o),i}()).prototype,o="_onKeyDown",i=[e],h=Object.getOwnPropertyDescriptor(t.prototype,"_onKeyDown"),d=t.prototype,y={},Object.keys(h).forEach(function(e){y[e]=h[e]}),y.enumerable=!!y.enumerable,y.configurable=!!y.configurable,("value"in y||y.initializer)&&(y.writable=!0),y=i.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},y),d&&void 0!==y.initializer&&(y.value=y.initializer?y.initializer.call(d):void 0,y.initializer=void 0),void 0===y.initializer&&(Object.defineProperty(n,o,y),y=null),t);m.a=v}).call(this,_(2).bind)},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.objects=[],this.type=Object,this.instanceNb=0}var t,n,o;return t=e,(n=[{key:"release",value:function(){for(var e=arguments.length,t=0;t!==e;t++)this.objects.push(arguments[t]);return this}},{key:"get",value:function(){return 0===this.objects.length?(this.instanceNb++,50<=this.instanceNb&&console.warn("Pool limit of ".concat(50," reached.")),this.constructObject()):this.objects.pop()}},{key:"constructObject",value:function(){throw new Error("constructObject() not implemented in this Pool subclass yet!")}},{key:"resize",value:function(e){for(var t=this.objects;t.length>e;)t.pop();for(;t.length<e;)t.push(this.constructObject());return this}}])&&r(t.prototype,n),o&&r(t,o),e}();t.a=o},function(e,t,n){"use strict";function Z(e){return(Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Q(e){return(Q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ee(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var o=function(e){function J(e,t){var n,o,r,i,a,s,u,c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,J),o=this,(n=!(r=Q(J).call(this))||"object"!==Z(r)&&"function"!=typeof r?ee(o):r).object=e,n.domElement=void 0!==t?t:document,n.enabled=!0,n.target=new THREE.Vector3,n.minDistance=0,n.maxDistance=1/0,n.minZoom=0,n.maxZoom=1/0,n.minPolarAngle=0,n.maxPolarAngle=Math.PI,n.minAzimuthAngle=-1/0,n.maxAzimuthAngle=1/0,n.enableDamping=!1,n.dampingFactor=.25,n.enableZoom=!0,n.zoomSpeed=1,n.enableRotate=!0,n.rotateSpeed=1,n.enablePan=!0,n.keyPanSpeed=7,n.autoRotate=!1,n.autoRotateSpeed=2,n.enableKeys=!0,n.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},n.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT},n.target0=n.target.clone(),n.position0=n.object.position.clone(),n.zoom0=n.object.zoom,n.getPolarAngle=function(){return m.phi},n.getAzimuthalAngle=function(){return m.theta},n.reset=function(){l.target.copy(l.target0),l.object.position.copy(l.position0),l.object.zoom=l.zoom0,l.object.updateProjectionMatrix(),l.dispatchEvent(f),l.update(),y=d.NONE},n.update=(i=new THREE.Vector3,a=(new THREE.Quaternion).setFromUnitVectors(e.up,new THREE.Vector3(0,1,0)),s=a.clone().inverse(),u=new THREE.Vector3,c=new THREE.Quaternion,function(){var e=l.object.position;return i.copy(e).sub(l.target),i.applyQuaternion(a),m.setFromVector3(i),l.autoRotate&&y===d.NONE&&M(2*Math.PI/60/60*l.autoRotateSpeed),m.theta+=_.theta,m.phi+=_.phi,m.theta=Math.max(l.minAzimuthAngle,Math.min(l.maxAzimuthAngle,m.theta)),m.phi=Math.max(l.minPolarAngle,Math.min(l.maxPolarAngle,m.phi)),m.makeSafe(),m.radius*=g,m.radius=Math.max(l.minDistance,Math.min(l.maxDistance,m.radius)),l.target.add(b),i.setFromSpherical(m),i.applyQuaternion(s),e.copy(l.target).add(i),l.object.lookAt(l.target),!0===l.enableDamping?(_.theta*=1-l.dampingFactor,_.phi*=1-l.dampingFactor):_.set(0,0,0),g=1,b.set(0,0,0),!(!(w||u.distanceToSquared(l.object.position)>v||8*(1-c.dot(l.object.quaternion))>v)||(l.dispatchEvent(f),u.copy(l.object.position),c.copy(l.object.quaternion),w=!1))}),n.destroy=function(){l.domElement.removeEventListener("contextmenu",X,!1),l.domElement.removeEventListener("mousedown",B,!1),l.domElement.removeEventListener("wheel",$,!1),l.domElement.removeEventListener("touchstart",W,!1),l.domElement.removeEventListener("touchend",K,!1),l.domElement.removeEventListener("touchmove",Y,!1),l.domElement.removeEventListener("mousemove",V,!1),l.domElement.removeEventListener("mouseup",G,!1),window.removeEventListener("keydown",q,!1)};var l=ee(ee(n)),f={type:"change"},p={type:"start"},h={type:"end"},d={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},y=d.NONE,v=1e-6,m=new THREE.Spherical,_=new THREE.Spherical,g=1,b=new THREE.Vector3,w=!1,O=new THREE.Vector2,x=new THREE.Vector2,k=new THREE.Vector2,E=new THREE.Vector2,P=new THREE.Vector2,T=new THREE.Vector2,S=new THREE.Vector2,j=new THREE.Vector2,C=new THREE.Vector2;function R(){return Math.pow(.95,l.zoomSpeed)}function M(e){_.theta-=e}function A(e){_.phi-=e}var L,D,z,H=(L=new THREE.Vector3,function(e,t){L.setFromMatrixColumn(t,0),L.multiplyScalar(-e),b.add(L)}),I=(D=new THREE.Vector3,function(e,t){D.setFromMatrixColumn(t,1),D.multiplyScalar(e),b.add(D)}),F=(z=new THREE.Vector3,function(e,t){var n=l.domElement===document?l.domElement.body:l.domElement;if(Object.getPrototypeOf(l.object).isPerspectiveCamera){var o=l.object.position;z.copy(o).sub(l.target);var r=z.length();r*=Math.tan(l.object.fov/2*Math.PI/180),H(2*e*r/n.clientHeight,l.object.matrix),I(2*t*r/n.clientHeight,l.object.matrix)}else Object.getPrototypeOf(l.object).isOrthographicCamera?(H(e*(l.object.right-l.object.left)/l.object.zoom/n.clientWidth,l.object.matrix),I(t*(l.object.top-l.object.bottom)/l.object.zoom/n.clientHeight,l.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),l.enablePan=!1)});function N(e){Object.getPrototypeOf(l.object).isPerspectiveCamera?g/=e:Object.getPrototypeOf(l.object).isOrthographicCamera?(l.object.zoom=Math.max(l.minZoom,Math.min(l.maxZoom,l.object.zoom*e)),l.object.updateProjectionMatrix(),w=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),l.enableZoom=!1)}function U(e){Object.getPrototypeOf(l.object).isPerspectiveCamera?g*=e:Object.getPrototypeOf(l.object).isOrthographicCamera?(l.object.zoom=Math.max(l.minZoom,Math.min(l.maxZoom,l.object.zoom/e)),l.object.updateProjectionMatrix(),w=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),l.enableZoom=!1)}function B(e){if(!1!==l.enabled){if(e.preventDefault(),e.button===l.mouseButtons.ORBIT){if(!1===l.enableRotate)return;o=e,O.set(o.clientX,o.clientY),y=d.ROTATE}else if(e.button===l.mouseButtons.ZOOM){if(!1===l.enableZoom)return;n=e,S.set(n.clientX,n.clientY),y=d.DOLLY}else if(e.button===l.mouseButtons.PAN){if(!1===l.enablePan)return;t=e,E.set(t.clientX,t.clientY),y=d.PAN}var t,n,o;y!==d.NONE&&(l.domElement.addEventListener("mousemove",V,!1),l.domElement.addEventListener("mouseup",G,!1),l.dispatchEvent(p))}}function V(e){var t,n;if(!1!==l.enabled)if(e.preventDefault(),y===d.ROTATE){if(!1===l.enableRotate)return;!function(e){x.set(e.clientX,e.clientY),k.subVectors(x,O);var t=l.domElement===document?l.domElement.body:l.domElement;M(2*Math.PI*k.x/t.clientWidth*l.rotateSpeed),A(2*Math.PI*k.y/t.clientHeight*l.rotateSpeed),O.copy(x),l.update()}(e)}else if(y===d.DOLLY){if(!1===l.enableZoom)return;n=e,j.set(n.clientX,n.clientY),C.subVectors(j,S),0<C.y?N(R()):C.y<0&&U(R()),S.copy(j),l.update()}else if(y===d.PAN){if(!1===l.enablePan)return;t=e,P.set(t.clientX,t.clientY),T.subVectors(P,E),F(T.x,T.y),E.copy(P),l.update()}}function G(e){!1!==l.enabled&&(l.domElement.removeEventListener("mousemove",V,!1),l.domElement.removeEventListener("mouseup",G,!1),l.dispatchEvent(h),y=d.NONE)}function $(e){var t;!1===l.enabled||!1===l.enableZoom||y!==d.NONE&&y!==d.ROTATE||(e.preventDefault(),e.stopPropagation(),(t=e).deltaY<0?U(R()):0<t.deltaY&&N(R()),l.update(),l.dispatchEvent(p),l.dispatchEvent(h))}function q(e){!1!==l.enabled&&!1!==l.enableKeys&&!1!==l.enablePan&&function(e){switch(e.keyCode){case l.keys.UP:F(0,l.keyPanSpeed),l.update();break;case l.keys.BOTTOM:F(0,-l.keyPanSpeed),l.update();break;case l.keys.LEFT:F(l.keyPanSpeed,0),l.update();break;case l.keys.RIGHT:F(-l.keyPanSpeed,0),l.update()}}(e)}function W(e){if(!1!==l.enabled){switch(e.touches.length){case 1:if(!1===l.enableRotate)return;a=e,O.set(a.touches[0].pageX,a.touches[0].pageY),y=d.TOUCH_ROTATE;break;case 2:if(!1===l.enableZoom)return;o=(n=e).touches[0].pageX-n.touches[1].pageX,r=n.touches[0].pageY-n.touches[1].pageY,i=Math.sqrt(o*o+r*r),S.set(0,i),y=d.TOUCH_DOLLY;break;case 3:if(!1===l.enablePan)return;t=e,E.set(t.touches[0].pageX,t.touches[0].pageY),y=d.TOUCH_PAN;break;default:y=d.NONE}var t,n,o,r,i,a;y!==d.NONE&&l.dispatchEvent(p)}}function Y(e){var t,n,o,r,i;if(!1!==l.enabled)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:if(!1===l.enableRotate)return;if(y!==d.TOUCH_ROTATE)return;!function(e){x.set(e.touches[0].pageX,e.touches[0].pageY),k.subVectors(x,O);var t=l.domElement===document?l.domElement.body:l.domElement;M(2*Math.PI*k.x/t.clientWidth*l.rotateSpeed),A(2*Math.PI*k.y/t.clientHeight*l.rotateSpeed),O.copy(x),l.update()}(e);break;case 2:if(!1===l.enableZoom)return;if(y!==d.TOUCH_DOLLY)return;o=(n=e).touches[0].pageX-n.touches[1].pageX,r=n.touches[0].pageY-n.touches[1].pageY,i=Math.sqrt(o*o+r*r),j.set(0,i),C.subVectors(j,S),0<C.y?U(R()):C.y<0&&N(R()),S.copy(j),l.update();break;case 3:if(!1===l.enablePan)return;if(y!==d.TOUCH_PAN)return;t=e,P.set(t.touches[0].pageX,t.touches[0].pageY),T.subVectors(P,E),F(T.x,T.y),E.copy(P),l.update();break;default:y=d.NONE}}function K(e){!1!==l.enabled&&(l.dispatchEvent(h),y=d.NONE)}function X(e){e.preventDefault()}return l.domElement.addEventListener("contextmenu",X,!1),l.domElement.addEventListener("mousedown",B,!1),l.domElement.addEventListener("wheel",$,!1),l.domElement.addEventListener("touchstart",W,!1),l.domElement.addEventListener("touchend",K,!1),l.domElement.addEventListener("touchmove",Y,!1),window.addEventListener("keydown",q,!1),n.update(),n}var t,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(J,THREE.EventDispatcher),t=J,(n=[{key:"center",get:function(){return console.warn("OrbitControls: .center has been renamed to .target"),this.target}},{key:"noZoom",get:function(){return console.warn("OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(e){console.warn("OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!e}},{key:"noRotate",get:function(){return console.warn("OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(e){console.warn("OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!e}},{key:"noPan",get:function(){return console.warn("OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(e){console.warn("OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!e}},{key:"noKeys",get:function(){return console.warn("OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(e){console.warn("OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!e}},{key:"staticMoving",get:function(){return console.warn("OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(e){console.warn("OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!e}},{key:"dynamicDampingFactor",get:function(){return console.warn("OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(e){console.warn("OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=e}}])&&r(t.prototype,n),o&&r(t,o),J}();t.a=o},function(e,t,n){"use strict";var i=n(76),a=n(300);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e,t,n){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var o=function(e){function r(){var e,t,n,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),t=this,(e=!(n=l(r).call(this,o))||"object"!==s(n)&&"function"!=typeof n?p(t):n).name=o.name||"Fly Camera",e.controls=new a.a(p(p(e)),o.domEl||document),e.controls.enabled=!1,e.position.set(50,50,50),e}var t,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(r,i["a"]),t=r,(n=[{key:"createGUI",value:function(e){if(!this._guiIsCreated){this._guiIsCreated=!0;var t=c(l(r.prototype),"createGUI",this).call(this,e);return t.add(this.controls,"enabled").name("Controls enabled"),t}}},{key:"start",value:function(){this.controls.bind()}},{key:"stop",value:function(){this.controls.unbind()}},{key:"destroy",value:function(){c(l(r.prototype),"destroy",this).call(this),this.controls.destroy()}},{key:"update",value:function(e,t){c(l(r.prototype),"update",this).call(this,e,t),this.controls.enabled&&this.controls.update(e/1e3,t)}},{key:"_createHelper",value:function(){}},{key:"_destroyHelper",value:function(){}}])&&u(t.prototype,n),o&&u(t,o),r}();t.a=o},function(e,s,u){"use strict";(function(e){var t,r=u(15),i=u(7);function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function n(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var o=(n((t=function(){function n(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:document;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.enabled=!0,this.movementSpeed=15,this.accelerationSpeed=3,this.decelerationSpeed=.25,this.lookSpeed=.1,this.zoomSpeed=50,this.autoForward=!1,this.activeLook=!0,this._binded=!1,this._camera=e,this._target=new THREE.Vector3(0,0,0),this._domElement=t,this._bodyElement=this._domElement===document?this._domElement.body:t,this._defaultCameraFov=this._camera.fov,this._lat=0,this._lon=-90,this._phi=0,this._theta=0,this._moveForward=!1,this._moveBackward=!1,this._moveLeft=!1,this._moveRight=!1,this._accelerate=!1,this._decelerate=!1,this._slookSpeed=this.lookSpeed,this._szoomSpeed=this.zoomSpeed,this._zoomIn=!1,this._zoomOut=!1}var e,t,o;return e=n,(t=[{key:"bind",value:function(){this._binded||(this._binded=!0,this._bodyElement.requestPointerLock(),this._domElement.addEventListener("pointerlockchange",this._onPointerLockChange,!1),r.a.upped.add(this._handlePointerUp),r.a.downed.add(this._handlePointerDown),r.a.moved.add(this._handlePointerMove),i.a.upped.add(this._handleKeyUp),i.a.downed.add(this._handleKeyDown))}},{key:"unbind",value:function(){this._binded&&(this._binded=!1,document.exitPointerLock(),this._domElement.removeEventListener("pointerlockchange",this._onPointerLockChange,!1),r.a.upped.remove(this._handlePointerUp),r.a.downed.remove(this._handlePointerDown),r.a.moved.remove(this._handlePointerMove),i.a.upped.remove(this._handleKeyUp),i.a.downed.remove(this._handleKeyDown))}},{key:"update",value:function(e,t){if(!1!==this.enabled){var n=e*this.movementSpeed;this._accelerate?n*=this.accelerationSpeed:this._decelerate&&(n*=this.decelerationSpeed),(this._moveForward||this.autoForward&&!this._moveBackward)&&this._camera.translateZ(-n),this._moveBackward&&this._camera.translateZ(n),this._moveLeft&&this._camera.translateX(-n),this._moveRight&&this._camera.translateX(n),this._moveUp&&(this._camera.position.y+=n),this._moveDown&&(this._camera.position.y-=n),this._lat=Math.max(-85,Math.min(85,this._lat)),this._phi=THREE.Math.degToRad(90-this._lat),this._theta=THREE.Math.degToRad(this._lon);var o=this._target,r=this._camera.position;o.x=r.x+Math.sin(this._phi)*Math.cos(this._theta),o.y=r.y+Math.cos(this._phi),o.z=r.z+Math.sin(this._phi)*Math.sin(this._theta),this._camera.lookAt(o),(this._zoomIn||this._zoomOut)&&(this._camera.fov+=e*this._szoomSpeed*(this._zoomIn?-1:1),this._camera.fov=THREE.Math.clamp(this._camera.fov,1,179),this._camera.updateProjectionMatrix());var i=THREE.Math.mapLinear(this._camera.fov/this.lookSpeed,this._defaultCameraFov/this.lookSpeed,1/this.lookSpeed,1,0);i=THREE.Math.clamp(i,.01,1),this._slookSpeed=this.lookSpeed*i,this._szoomSpeed=this.zoomSpeed*i}}},{key:"destroy",value:function(){this.unbind()}},{key:"_onPointerLockChange",value:function(e){this.enabled=this._domElement.pointerLockElement===this._bodyElement}},{key:"_handlePointerDown",value:function(e){if(e.preventDefault(),e.stopPropagation(),this._bodyElement.requestPointerLock(),this.activeLook)switch(e.button){case 0:this._moveForward=!0;break;case 2:this._moveBackward=!0}}},{key:"_handlePointerUp",value:function(e){if(e.preventDefault(),e.stopPropagation(),this.activeLook)switch(e.button){case 0:this._moveForward=!1;break;case 2:this._moveBackward=!1}}},{key:"_handlePointerMove",value:function(e){if(this.enabled){var t=THREE.Math.clamp(e.movementX||0,-250,250),n=THREE.Math.clamp(e.movementY||0,-250,250);this._lat-=n*this._slookSpeed,this._lon+=t*this._slookSpeed}}},{key:"_handleKeyDown",value:function(e,t){switch(e.preventDefault(),t){case"up":this._moveForward=!0;break;case"left":this._moveLeft=!0;break;case"down":this._moveBackward=!0;break;case"right":this._moveRight=!0;break;case"e":this._moveUp=!0;break;case"q":this._moveDown=!0;break;case"shift":this._accelerate=!0;break;case"space":this._decelerate=!0;break;case"x":this._zoomIn=!0;break;case"z":this._zoomOut=!0}}},{key:"_handleKeyUp",value:function(e,t){switch(e.preventDefault(),t){case"up":this._moveForward=!1;break;case"left":this._moveLeft=!1;break;case"down":this._moveBackward=!1;break;case"right":this._moveRight=!1;break;case"e":this._moveUp=!1;break;case"q":this._moveDown=!1;break;case"shift":this._accelerate=!1;break;case"space":this._decelerate=!1;break;case"x":this._zoomIn=!1;break;case"z":this._zoomOut=!1}}}])&&a(e.prototype,t),o&&a(e,o),n}()).prototype,"_onPointerLockChange",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onPointerLockChange"),t.prototype),n(t.prototype,"_handlePointerDown",[e],Object.getOwnPropertyDescriptor(t.prototype,"_handlePointerDown"),t.prototype),n(t.prototype,"_handlePointerUp",[e],Object.getOwnPropertyDescriptor(t.prototype,"_handlePointerUp"),t.prototype),n(t.prototype,"_handlePointerMove",[e],Object.getOwnPropertyDescriptor(t.prototype,"_handlePointerMove"),t.prototype),n(t.prototype,"_handleKeyDown",[e],Object.getOwnPropertyDescriptor(t.prototype,"_handleKeyDown"),t.prototype),n(t.prototype,"_handleKeyUp",[e],Object.getOwnPropertyDescriptor(t.prototype,"_handleKeyUp"),t.prototype),t);s.a=o}).call(this,u(2).bind)},function(e,y,v){"use strict";(function(e){var t,i=v(75);function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function s(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var o,r,l,f,p,h,d=(o=(t=function(e){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=s(this,u(n).call(this,e)))._visible=!1,t._bind(),t}var t,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(n,i["a"]),t=n,(o=[{key:"destroy",value:function(){this._unbind()}},{key:"_bind",value:function(){this._keyboard.upped.add(this._onKeyUp)}},{key:"_unbind",value:function(){this._keyboard.upped.remove(this._onKeyUp)}},{key:"_toggleHelpers",value:function(r){var i=this;this._scene.traverse(function(e){var t=-1!==e.name.toLowerCase().search("helper"),n=i._scene.camera&&i._scene.camera.helper!==e,o=!e.disabled;t&&n&&o&&(e.visible=r)})}},{key:"_onKeyUp",value:function(e,t){this._keyboard.isDown("shift")&&"h"===t&&(this._visible=!this._visible,this._toggleHelpers(this._visible))}}])&&a(t.prototype,o),r&&a(t,r),n}()).prototype,r="_onKeyUp",l=[e],f=Object.getOwnPropertyDescriptor(t.prototype,"_onKeyUp"),p=t.prototype,h={},Object.keys(f).forEach(function(e){h[e]=f[e]}),h.enumerable=!!h.enumerable,h.configurable=!!h.configurable,("value"in h||h.initializer)&&(h.writable=!0),h=l.slice().reverse().reduce(function(e,t){return t(o,r,e)||e},h),p&&void 0!==h.initializer&&(h.value=h.initializer?h.initializer.call(p):void 0,h.initializer=void 0),void 0===h.initializer&&(Object.defineProperty(o,r,h),h=null),t);y.a=d}).call(this,v(2).bind)},function(e,f,p){"use strict";(function(e){var t,r=p(29),i=p(16),a=p(303),s=p(304),u=p(4),c=p(7);function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function n(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var o=(n((t=function(){function n(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this._scene=e,this._sceneName=t,this._state=r.a,this._context=i.a,this._signals=u.a,this._config=a.a[this._sceneName],this._materialsList=this._config.materials,this._contactMaterials=this._config.contactMaterials,this.group={terrain:1,character:2,rock1:4,rock2:8},this._fixedStep=1/60,this._maxSubSteps=10,this._speed=1,this._world=null,this._materials={},this._initWorld(),this._initMaterials(),this._initContactMaterials(),this._bind()}var e,t,o;return e=n,(t=[{key:"update",value:function(e,t){this._world.step(this._fixedStep*this._speed,e,this._maxSubSteps),this._state.cannonDebugMode&&this.cannonDebugger.update(),this._world.gravity.copy(this._config.world.gravity),this._scene.character._isJumpingForward&&(this._world.gravity.y*=2)}},{key:"destroy",value:function(){this._unbind(),this._world=null,this._materials=null}},{key:"_bind",value:function(){c.a.downed.add(this._onKeyDown),c.a.upped.add(this._onKeyUp)}},{key:"_unbind",value:function(){c.a.downed.remove(this._onKeyDown),c.a.upped.remove(this._onKeyUp)}},{key:"_initWorld",value:function(){this._world=new CANNON.World,this._world.broadphase=new CANNON.NaiveBroadphase,this._world.gravity.copy(this._config.world.gravity),this._world.solver=new CANNON.SplitSolver(new CANNON.GSSolver),this._world.solver.iterations=this._config.world.iterations,this.cannonDebugger=new s.a(this._context.scene,this._world)}},{key:"_initMaterials",value:function(){for(var e=0,t=this._materialsList.length;e<t;e++){var n=this._materialsList[e];this._materials[n]=new CANNON.Material(n)}}},{key:"_initContactMaterials",value:function(){for(var e=0,t=this._contactMaterials.length;e<t;e++){var n=this._contactMaterials[e],o=n.materials,r=n.friction,i=n.restitution;this._createContactMaterial(o[0],o[1],{friction:r,restitution:i})}}},{key:"_createContactMaterial",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{friction:.3,restitution:.3},o=new CANNON.ContactMaterial(this._materials[e],this._materials[t],n);return this._world.addContactMaterial(o),o}},{key:"_toggleCannonDebugger",value:function(e){this._state.cannonDebugMode=void 0===e?!this._state.cannonDebugMode:e,e=this._state.cannonDebugMode,this._signals.toastMsg.log.dispatch("physics","#Physics - Cannon debug mode: ".concat(e));for(var t=0,n=this.cannonDebugger._meshes.length;t<n;t++){var o=this.cannonDebugger._meshes[t];o&&(o.visible=e)}}},{key:"_onKeyDown",value:function(e,t){c.a.isDown("shift")&&"o"===t&&this._toggleCannonDebugger()}},{key:"_onKeyUp",value:function(e,t){}},{key:"world",get:function(){return this._world}},{key:"materials",get:function(){return this._materials}}])&&l(e.prototype,t),o&&l(e,o),n}()).prototype,"_onKeyDown",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onKeyDown"),t.prototype),n(t.prototype,"_onKeyUp",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onKeyUp"),t.prototype),t);f.a=o}).call(this,p(2).bind)},function(e,t,n){"use strict";var o={world:{iterations:10,gravity:new CANNON.Vec3(0,-.3,0)},materials:["character","ground","rock"],contactMaterials:[{materials:["character","ground"],friction:1,restitution:0},{materials:["rock","ground"],friction:1,restitution:0}]};t.a={home:o,lobby:o,"level-1":o,"level-2":o,"level-3":o,"level-4":o}},function(e,t,n){"use strict";var o=n(104),r=function(e,t,n){n=n||{},this.scene=e,this.world=t,this._meshes=[],this._material=new o.a({color:16715775,wireframe:!0,depthTest:!1,depthWrite:!1,transparent:!0,opacity:.3}),this._sphereGeometry=new THREE.SphereGeometry(1),this._boxGeometry=new THREE.BoxGeometry(1,1,1),this._planeGeometry=new THREE.PlaneGeometry(10,10,10,10),this._cylinderGeometry=new THREE.CylinderGeometry(1,1,10,10)};r.prototype={tmpVec0:new CANNON.Vec3,tmpVec1:new CANNON.Vec3,tmpVec2:new CANNON.Vec3,tmpQuat0:new CANNON.Vec3,update:function(){for(var e=this.world.bodies,t=this._meshes,n=this.tmpVec0,o=this.tmpQuat0,r=0,i=0;i!==e.length;i++)for(var a=e[i],s=0;s!==a.shapes.length;s++){var u=a.shapes[s];this._updateMesh(r,a,u),(c=t[r])&&(a.quaternion.vmult(a.shapeOffsets[s],n),a.position.vadd(n,n),a.quaternion.mult(a.shapeOrientations[s],o),c.position.copy(n),c.quaternion.copy(o)),r++}for(i=r;i<t.length;i++){var c;(c=t[i])&&this.scene.remove(c)}t.length=r},_updateMesh:function(e,t,n){var o=this._meshes[e];this._typeMatch(o,n)||(o&&this.scene.remove(o),o=this._meshes[e]=this._createMesh(n)),this._scaleMesh(o,n)},_typeMatch:function(e,t){if(!e)return!1;var n=e.geometry;return n instanceof THREE.SphereGeometry&&t instanceof CANNON.Sphere||n instanceof THREE.BoxGeometry&&t instanceof CANNON.Box||n instanceof THREE.PlaneGeometry&&t instanceof CANNON.Plane||n.id===t.geometryId&&t instanceof CANNON.ConvexPolyhedron||n.id===t.geometryId&&t instanceof CANNON.Trimesh||n.id===t.geometryId&&t instanceof CANNON.Heightfield},_createMesh:function(e){var t,n=this._material;switch(e.type){case CANNON.Shape.types.SPHERE:t=new THREE.Mesh(this._sphereGeometry,n);break;case CANNON.Shape.types.BOX:t=new THREE.Mesh(this._boxGeometry,n);break;case CANNON.Shape.types.CONVEXPOLYHEDRON:for(var o=new THREE.Geometry,r=0;r<e.vertices.length;r++){var i=e.vertices[r];o.vertices.push(new THREE.Vector3(i.x,i.y,i.z))}for(r=0;r<e.faces.length;r++)for(var a=e.faces[r],s=a[0],u=1;u<a.length-1;u++){var c=a[u],l=a[u+1];o.faces.push(new THREE.Face3(s,c,l))}o.computeBoundingSphere(),o.computeFaceNormals(),t=new THREE.Mesh(o,n),e.geometryId=o.id;break;case CANNON.Shape.types.TRIMESH:var f=new THREE.Geometry,p=this.tmpVec0,h=this.tmpVec1,d=this.tmpVec2;for(r=0;r<e.indices.length/3;r++){e.getTriangleVertices(r,p,h,d),f.vertices.push(new THREE.Vector3(p.x,p.y,p.z),new THREE.Vector3(h.x,h.y,h.z),new THREE.Vector3(d.x,d.y,d.z));u=f.vertices.length-3;f.faces.push(new THREE.Face3(u,u+1,u+2))}f.computeBoundingSphere(),f.computeFaceNormals(),t=new THREE.Mesh(f,n),e.geometryId=f.id;break;case CANNON.Shape.types.HEIGHTFIELD:f=new THREE.Geometry,p=this.tmpVec0,h=this.tmpVec1,d=this.tmpVec2;for(var y=0;y<e.data.length-1;y++)for(var v=0;v<e.data[y].length-1;v++)for(var m=0;m<2;m++){e.getConvexTrianglePillar(y,v,0===m),p.copy(e.pillarConvex.vertices[0]),h.copy(e.pillarConvex.vertices[1]),d.copy(e.pillarConvex.vertices[2]),p.vadd(e.pillarOffset,p),h.vadd(e.pillarOffset,h),d.vadd(e.pillarOffset,d),f.vertices.push(new THREE.Vector3(p.x,p.y,p.z),new THREE.Vector3(h.x,h.y,h.z),new THREE.Vector3(d.x,d.y,d.z));r=f.vertices.length-3;f.faces.push(new THREE.Face3(r,r+1,r+2))}f.computeBoundingSphere(),f.computeFaceNormals(),t=new THREE.Mesh(f,n),e.geometryId=f.id}return t&&this.scene.add(t),t},_scaleMesh:function(e,t){switch(t.type){case CANNON.Shape.types.SPHERE:var n=t.radius;e.scale.set(n,n,n);break;case CANNON.Shape.types.BOX:e.scale.copy(t.halfExtents),e.scale.multiplyScalar(2);break;case CANNON.Shape.types.CONVEXPOLYHEDRON:e.scale.set(1,1,1);break;case CANNON.Shape.types.TRIMESH:e.scale.copy(t.scale);break;case CANNON.Shape.types.HEIGHTFIELD:e.scale.set(1,1,1)}}},t.a=r},function(e,v,m){"use strict";(function(e){var t,n=m(306),i=m.n(n),D=m(49),a=m(307),z=m(148),s=m(308),u=m(105),c=m(373),l=m(36);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function H(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function p(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function r(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var y=(r((t=function(e){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=p(this,h(n).call(this,"Render")))._scene=e,t._materialCtrl=e.materialCtrl,t._cfg=l.a[e.name],t._userCfg="",t._cfg&&(t._paletteCfg=t._cfg.palette,t._init()),t}var t,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(n,a["a"]),t=n,(o=[{key:"_init",value:function(){var n=this,t=this._materialCtrl._defaultConfig;this._folder.add(this,"_copyCfg").name("Copy config"),this._userCfgCtrl=this._folder.add(this,"_userCfg").name("Set config").onFinishChange(this._setCfg);var o=this._cfg.common,e=this._folder.addFolder("Common");e.add({transition:0},"transition",0,1,.001).name("Transition").onChange(function(e){return n._materialCtrl.setAllProperties("transition",e)});var r=e.addColor(o,"background").name("Background").onChange(function(e){n._scene.background=new THREE.Color(e)}),i=o.postProcessing,a=this._scene.postProcessing,s=e.addFolder("Post-processing");s.add(a,"_enabled").name("Enabled");var u=a.getPass("PostPass"),c=i.postPass,l=s.addFolder("PostPass"),f=l.addFolder("Outline");f.add(c.outline,"thickness",-.3,.3,1e-4).name("Thickness").onChange(function(e){u.outline={thickness:e}}),f.add(c.outline,"amount",-30,30,.1).name("Amount").onChange(function(e){u.outline={amount:e}}),l.addColor(c,"bloomColor").name("Bloom color").onChange(function(e){u.bloomColor=new THREE.Color(e)}),l.add(c,"vignette",0,20,.01).name("Vignette").onChange(function(e){u.vignette=e}),l.add(c,"brightness",0,5,.001).name("Brightness").onChange(function(e){u.brightness=e}),l.add(c,"saturation",0,5,.001).name("Saturation").onChange(function(e){u.saturation=e}),l.add(c,"contrast",0,5,.001).name("Contrast").onChange(function(e){u.contrast=e});var p=l.addFolder("Colors");p.addColor(c.colors,"dark").name("Dark").onChange(function(e){u.colors={dark:e}}),p.addColor(c.colors,"light").name("Light").onChange(function(e){u.colors={light:e}});var h=l.addFolder("Noise"),d=h.addFolder("Dark");d.add(c.noise.dark,"scale",0,100,.1).name("Scale").onChange(function(e){u.noise={dark:{scale:e}}}),d.add(c.noise.dark,"intensity",0,1,.01).name("Intensity").onChange(function(e){u.noise={dark:{intensity:e}}}),d.add(c.noise.dark,"speed",0,100,.1).name("Speed").onChange(function(e){u.noise={dark:{speed:e}}});var y=h.addFolder("Light");if(y.add(c.noise.light,"scale",0,100,.1).name("Scale").onChange(function(e){u.noise={light:{scale:e}}}),y.add(c.noise.light,"intensity",0,1,.01).name("Intensity").onChange(function(e){u.noise={light:{intensity:e}}}),y.add(c.noise.light,"speed",0,100,.1).name("Speed").onChange(function(e){u.noise={light:{speed:e}}}),this._quality.isHigh){var v=a.getPass("BloomPass"),m=i.bloomPass,_=s.addFolder("BloomPass");_.add(m,"resolutionScale",0,1,.01).onChange(function(e){v.resolutionScale=e,a._composer.setSize()}),_.add(m,"kernelSize",0,5,1).onChange(function(e){v.kernelSize=e}),_.add(m,"intensity",0,5,.01).onChange(function(e){v.intensity=e}),_.add(m,"distinction",0,10,.01).onChange(function(e){v.distinction=e}),_.add(m,"blend").onChange(function(e){v.blend=e}),_.add(m,"screenMode").onChange(function(e){v.screenMode=e})}var g=e.addFolder("Ambient");g.addColor(o.ambient,"color").name("Color").onChange(function(e){return n._materialCtrl.setAllProperties("ambient",{color:e,intensity:o.ambient.intensity})}),g.add(o.ambient,"intensity",0,1,.01).name("Intensity").onChange(function(e){return n._materialCtrl.setAllProperties("ambient",{color:o.ambient.color,intensity:e})});var b=e.addFolder("Main light");b.addColor(o.mainLight,"color").name("Color").onChange(function(e){return n._lights.mainLight.color.set(e)}),b.add(o.mainLight,"intensity",.01,5,.01).name("Intensity").onChange(function(e){n._lights.mainLight.intensity=e});var w=b.addFolder("Position");w.add(o.mainLight.position,"x",-100,100,.1).name("X").onChange(function(e){n._lights.mainLight.offsetPos.x=e,n._lights.updateShadows()}),w.add(o.mainLight.position,"y",-100,100,.1).name("Y").onChange(function(e){n._lights.mainLight.offsetPos.y=e,n._lights.updateShadows()}),w.add(o.mainLight.position,"z",-100,100,.1).name("Z").onChange(function(e){n._lights.mainLight.offsetPos.z=e,n._lights.updateShadows()});var O=b.addFolder("Shadow");this._addShadowProperties(O,o.mainLight.shadow,"mainLight");var x=e.addFolder("Fog");x.add(o.fog,"enabled").name("Enabled").onChange(function(e){e?(n._materialCtrl.setAllUniforms("uFogDistanceDensity",t.common.fog.distance.density),n._materialCtrl.setAllUniforms("uFogHeightDensity",t.common.fog.height.density)):(n._materialCtrl.setAllUniforms("uFogDistanceDensity",0),n._materialCtrl.setAllUniforms("uFogHeightDensity",0))}),x.addColor(o.fog,"color").name("Color").onChange(function(e){r.setValue(e),n._scene.background=new THREE.Color(e),n._materialCtrl.setAllUniforms("uFogColor",new THREE.Color(e))}),x.add(o.fog.distance,"density",0,.3,1e-4).name("Distance density").onChange(function(e){return n._materialCtrl.setAllUniforms("uFogDistanceDensity",e)});var k=x.addFolder("Height");k.add(o.fog.height,"density",0,1,1e-4).name("Height density").onChange(function(e){return n._materialCtrl.setAllUniforms("uFogHeightDensity",e)}),k.add(o.fog.height,"propagation",0,10,1e-4).name("Height propagation").onChange(function(e){return n._materialCtrl.setAllUniforms("uFogHeightPropagation",e)}),k.add(o.fog.height,"offset",-100,100,.01).name("Height offset").onChange(function(e){return n._materialCtrl.setAllUniforms("uFogHeightOffset",e)});var E=k.addFolder("Noise");E.add(o.fog.height.noise,"speed",0,.05,1e-4).name("Speed").onChange(function(e){return n._materialCtrl.setAllUniformsComponent("uFogHeightNoise","x",e)}),E.add(o.fog.height.noise,"frequency",0,5,.001).name("Frequency").onChange(function(e){return n._materialCtrl.setAllUniformsComponent("uFogHeightNoise","y",e)}),E.add(o.fog.height.noise,"amplitude",0,5,.001).name("Amplitude").onChange(function(e){return n._materialCtrl.setAllUniformsComponent("uFogHeightNoise","z",e)}),E.add(o.fog.height.noise,"offset",0,10,.1).name("Offset").onChange(function(e){return n._materialCtrl.setAllUniformsComponent("uFogHeightNoise","w",e)});var P=e.addFolder("Shadows");P.add(o.shadows,"enabled").name("Enabled").onChange(function(e){return n._lights.toggleShadows(e)}),P.addColor(o.shadows,"color").name("Color").onChange(function(e){return n._materialCtrl.setAllUniforms("uShadowsColor",new THREE.Color(e))}),P.add(o.shadows,"intensity",0,1,.01).name("Intensity").onChange(function(e){return n._materialCtrl.setAllUniforms("uShadowsIntensity",e)}),this._addShadowProperties(P,o.shadows,"shadowLights");var T=this._cfg.objects,S=this._materialCtrl.materials,j={};S.forEach(function(e){for(var t={},n=e.whitelistGui,o=0,r=n.length;o<r;o++){var i=n[o];t[i]=e[i]}j[e.name]=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(e){H(t,e,n[e])})}return t}({},j[e.name],t)}),S.forEach(function(e){T[e.name]&&T[e.name].palette||(T[e.name]=j[e.name])});var C=this._folder.addFolder("Objects"),R=function(e){var t=T[e],o=n._materialCtrl.get(e);if(t.palette)return"continue";Object(z.a)({object:t,folder:C,folderName:e,changeCb:function(t,n){o.forEach(function(e){e[t]=n})}})};for(var M in T)R(M);var A=this._paletteCfg;if(A){var L=function(n){var e=A[n];Object(z.a)({object:e,folder:C,folderName:n,changeCb:function(e,t){D.a.updateChannel(n,e,t)}})};for(var M in A)L(M)}}},{key:"_addShadowProperties",value:function(e,t,o){var r=this;e.add(t,"bias",-1,1,1e-4).name("Bias").onChange(function(e){return r._lights.updateShadows(H({},o,{bias:e}))}),e.add(t,"radius",0,10,.01).name("Radius").onChange(function(e){return r._lights.updateShadows(H({},o,{radius:e}))}),e.add(t,"mapSize",128,8192,128).name("Map size").onChange(function(e){return r._lights.updateShadows(H({},o,{mapSize:e}))});var i=e.addFolder("Offsets"),a=t.offsets,n=function(n){i.add(a,n,-50,50,.1).name(Object(u.a)(n)).onChange(function(e){var t=H({},o,{offsets:H({},n,e)});r._lights.updateShadows(t)})};for(var s in a)n(s)}},{key:"_copyCfg",value:function(){var e=JSON.stringify(this._cfg,null,2);i()(e)&&this._signals.toastMsg.log.dispatch("debug","#RenderGUI - Config copied to clipboard")}},{key:"_setCfg",value:function(e){var t;this._userCfgCtrl.setValue("");try{t=JSON.parse(e).common}catch(e){return void this._signals.toastMsg.log.dispatch("debug","#RenderGUI - Fail to parse config : ".concat(e))}var n={common:t};Object(c.a)(this._cfg,n),Object(s.a)(this._folder),this._signals.toastMsg.log.dispatch("debug","#RenderGUI - Config set")}}])&&f(t.prototype,o),r&&f(t,r),n}()).prototype,"_copyCfg",[e],Object.getOwnPropertyDescriptor(t.prototype,"_copyCfg"),t.prototype),r(t.prototype,"_setCfg",[e],Object.getOwnPropertyDescriptor(t.prototype,"_setCfg"),t.prototype),t);v.a=y}).call(this,m(2).bind)},function(e,t){e.exports=function(e){if(navigator.clipboard)return navigator.clipboard.writeText(e);var t=document.createElement("span");t.textContent=e,t.style.whiteSpace="pre";var n=document.createElement("iframe");n.sandbox="allow-same-origin",document.body.appendChild(n);var o=n.contentWindow;o.document.body.appendChild(t);var r=o.getSelection();r||(o=window,r=o.getSelection(),document.body.appendChild(t));var i=o.document.createRange();r.removeAllRanges(),i.selectNode(t),r.addRange(i);var a=!1;try{a=o.document.execCommand("copy")}catch(e){}return r.removeAllRanges(),o.document.body.removeChild(t),document.body.removeChild(n),a?Promise.resolve():Promise.reject()}},function(e,t,n){"use strict";var r=n(26),i=n(4),a=n(30),s=n(21),u=n(105);function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var o=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._gui=r.a,this._folderName=Object(u.a)(e),this._folder=null,this._created=!1,this._signals=i.a,this._lights=a.a,this._quality=s.a,this.create()}var e,n,o;return e=t,(n=[{key:"create",value:function(){this._created||(this._created=!0,this._folder=r.a.addFolder(this._folderName),this._bind())}},{key:"destroy",value:function(){this._created&&this._folder&&(this._created=!1,r.a.removeFolder(this._folder),this._folder=null,this._unbind())}},{key:"_bind",value:function(){}},{key:"_unbind",value:function(){}},{key:"_init",value:function(){}},{key:"folder",get:function(){return this._folder}}])&&c(e.prototype,n),o&&c(e,o),t}();t.a=o},function(e,t,n){"use strict";function s(e){for(var t=e.__controllers,n=0,o=t.length;n<o;n++){var r=t[n];r.setValue(r.getValue())}var i=e.__folders;for(var a in i){s(i[a])}}n.d(t,"a",function(){return s})},function(e,E,P){"use strict";(function(e){var t,i=P(3),a=P(55),s=P(52),u=P(106),c=P(321),l=P(367),f=P(107),p=P(11),h=P(326),d=P(327),y=P(110),v=P(30),m=P(38),_=P(15),g=P(0);function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function w(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function O(e,t,n){return(O="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=x(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function k(e,t){return(k=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var r=(o((t=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),w(this,x(t).call(this,"home",{physics:!1,postProcessing:!0}))}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&k(e,t)}(t,a["a"]),n=t,(o=[{key:"destroy",value:function(){var e=this;return O(x(t.prototype),"destroy",this).call(this).then(function(){e._levelPostProcessing.destroy(),e._materialCtrl.destroy(),v.a.destroy()})}},{key:"_init",value:function(){var e=this;this._baseCamPos=new THREE.Vector3,this._offsetCamPos=new THREE.Vector3,this._baseCamRot=new THREE.Euler,this._pan=new THREE.Vector2(.5,.5),this._ctaClicked=!1,this._gltf.add("terrain","main.models.home"),this._gltf.add("character","main.models.character"),this._stack.before("GUI","GUI:before",function(){e._levelPostProcessing.init(),e._materialCtrl.init()})}},{key:"_bind",value:function(){this._signals.home.ctaEntered.add(this._onCTAIn),this._signals.home.ctaLeaved.add(this._onCTAOut),this._signals.home.ctaValidated.add(this._onCTAValidate),i.a.device.desktop||(_.a.client.norm.x=.5,_.a.client.norm.y=.5,window.addEventListener("touchend",function(){_.a.client.norm.x=.5,_.a.client.norm.y=.5}))}},{key:"_unbind",value:function(){this._signals.home.ctaEntered.remove(this._onCTAIn),this._signals.home.ctaLeaved.remove(this._onCTAOut),this._signals.home.ctaValidated.remove(this._onCTAValidate)}},{key:"_createCtrls",value:function(){O(x(t.prototype),"_createCtrls",this).call(this),this._materialCtrl=new y.a(this)}},{key:"_createCameras",value:function(){var e=this._gltf.getObject("terrain","camera");this._gameCamera=new s.a({isDefault:!0,fov:28}),this._gameCamera.position.copy(e.position),this._gameCamera.rotation.copy(e.rotation),i.a.device.desktop||(this._gameCamera.rotation.z-=.005),this._gameCamera.rotateOnAxis(new THREE.Vector3(1,0,0),-Math.PI/2),this._baseCamPos.copy(this._gameCamera.position),this._baseCamRot.copy(this._gameCamera.rotation),this.addCamera(this._gameCamera)}},{key:"_createPostProcessing",value:function(){O(x(t.prototype),"_createPostProcessing",this).call(this),this._levelPostProcessing=new u.a,i.a.device.desktop||(this._levelPostProcessing._postPass.vignette=1.4)}},{key:"_createEntities",value:function(){var n=this;this._terrain=new f.a(this),this.addEntity(this._terrain),this._terrain.traverse(function(e){if("all"===e.name){var t={name:(n._allMesh=e).name,useVertexColors:!0};e.material=new h.a(t),e.customNormalMaterial=new d.a(t)}});var e=this._gltf.getAsset("character"),t=e.scene.children[0];this.character=t;var o=this._gltf.getObject("terrain","character");t.position.copy(o.position),t.scale.multiplyScalar(.86),t.quaternion.multiply(o.quaternion),t.updateMatrixWorld();var r=t.children[0],i=r.geometry;i.computeBoundingBox(),i.boundingBox.applyMatrix4(r.matrixWorld),t.bbox=i.boundingBox,r.receiveShadow=!0,r.castShadow=!0,r.material=new p.a({name:r.name,skinning:!0}),r.customDepthMaterial=this._materials.depthSkinningMaterial,this.add(t),v.a.init(this);var a=e.animations,s=this._findAnimationByName("idle_look_around",a);this._animationMixer=new THREE.AnimationMixer(t),this._animationMixer.clipAction(s).play(),this._logo=new c.a(this),this.addEntity(this._logo),this._particles=new l.a(this,{map:m.a.get("main.particle")}),this.addEntity(this._particles),this.addEntity(v.a.lightsRoot)}},{key:"_createGUI",value:function(){O(x(t.prototype),"_createGUI",this).call(this)}},{key:"_createAudios",value:function(){O(x(t.prototype),"_createAudios",this).call(this,"main-theme",.4);var e=this._sounds.get("wind");e.fade(1,1),e.play()}},{key:"_destroyAudios",value:function(){O(x(t.prototype),"_destroyAudios",this).call(this);var e=this._sounds.get("wind");e.fade(0,1),setTimeout(function(){e.stop()},1e3)}},{key:"_findAnimationByName",value:function(e,t){for(var n=0,o=t.length;n<o;n++){var r=t[n];if(e===r.name)return r}return null}},{key:"_afterCreate",value:function(){O(x(t.prototype),"_afterCreate",this).call(this),TweenMax.from(this._baseCamPos,5,{z:"+=10",ease:Expo.easeOut}),TweenMax.from(this._baseCamRot,3,{x:"-=0.2",y:"-=0.5",z:"-=0"}),this._signals.overlay.hide.dispatch()}},{key:"_onCTAIn",value:function(){this._ctaClicked||TweenMax.to(this._offsetCamPos,1,{x:-1,z:-2,ease:Power1.easeOut})}},{key:"_onCTAOut",value:function(){this._ctaClicked||TweenMax.to(this._offsetCamPos,1.5,{x:0,z:0,ease:Power1.easeOut})}},{key:"_onCTAValidate",value:function(){this._ctaClicked=!0,TweenMax.to(this._offsetCamPos,2,{x:-10,z:-15,ease:Power2.easeOut})}},{key:"_onUpdate",value:function(e,t){this._materialCtrl.update(e,t),this._animationMixer.update(e/1e3),this._terrain.update(e,t),this._particles.update(e,t);var n=_.a.client.norm,o=Object(g.e)(n.x,0,1,-1,1),r=Object(g.e)(n.y,0,1,-1,1);this._pan.x+=o-.1*this._pan.x,this._pan.y+=r-.1*this._pan.y,this._gameCamera.position.copy(this._baseCamPos).add(this._offsetCamPos),this._gameCamera.rotation.copy(this._baseCamRot),this._gameCamera.rotation.y+=-.01*this._pan.x,this._gameCamera.rotation.x+=-.01*this._pan.y,v.a.update(e,t),this._levelPostProcessing.update(e,t)}},{key:"materialCtrl",get:function(){return this._materialCtrl}}])&&b(n.prototype,o),r&&b(n,r),t}()).prototype,"_onCTAIn",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onCTAIn"),t.prototype),o(t.prototype,"_onCTAOut",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onCTAOut"),t.prototype),o(t.prototype,"_onCTAValidate",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onCTAValidate"),t.prototype),t);E.a=r}).call(this,P(2).bind)},function(e,t){e.exports="#define GLSLIFY 1\n#define SHADER_NAME Normal\n\n@import commonVert\n\n@import skinningVertPars\n@import fogVertPars\n@import instancesVertPars\n\n@import level1LaserHitVertPars\n\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\nattribute vec2 uv2;\nattribute vec3 color;\n\nuniform mat4 modelMatrix;\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat3 normalMatrix;\n\nuniform float uTime;\n\n#ifdef USE_PALETTE_MAP\n  uniform sampler2D tPaletteMap;\n#endif\n\nvarying vec3 vNormal;\nvarying vec3 vWorldNormal;\nvarying vec3 vViewPosition;\nvarying vec2 vUv;\nvarying vec2 vUv2;\n\n#ifdef USE_COLOR\n  varying vec3 vColor;\n#endif\n\nvoid main() {\n  vec3 transformed = position;\n  vec3 objectNormal = normal;\n  vec2 objectUv = vec2(uv.x, 1.0 - uv.y);\n  vec2 objectUv2 = vec2(uv2.x, 1.0 - uv2.y);\n\n  @import skinningVertBase\n  @import skinningVert\n  @import skinningVertNormal\n\n  @import instancesVert\n\n  @import homeLightVert\n  @import homeLogoVert\n\n  vec4 worldPosition = modelMatrix * vec4(transformed, 1.0);\n  vec3 worldNormal = normalize(mat3(modelMatrix[0].xyz, modelMatrix[1].xyz, modelMatrix[2].xyz ) * objectNormal);\n  vec4 mvPosition = modelViewMatrix * vec4(transformed, 1.0);\n  \n  gl_Position = projectionMatrix * mvPosition;\n\n  @import level1LaserHitVert\n  @import homeBoardVert\n\n  vNormal = normalize(normalMatrix * objectNormal);\n  vWorldNormal = worldNormal;\n  vViewPosition = -mvPosition.xyz;\n  vUv = objectUv;\n  vUv2 = objectUv2;\n\n  #ifdef USE_COLOR\n    vColor = color;\n  #endif\n\n  @import fogVert\n}\n"},function(e,t){e.exports="#define GLSLIFY 1\n#define SHADER_NAME Normal\n\nvec3 packNormalToRGB_1_0(const in vec3 normal) {\n\treturn normalize(normal) * 0.5 + 0.5;\n}\n\n\n\n\n@import commonFrag\n\nuniform float uOpacity;\n\n#ifdef USE_PALETTE_MAP\n  uniform sampler2D tPaletteMap;\n#endif\n\nvarying vec3 vNormal;\nvarying vec3 vWorldNormal;\nvarying vec3 vViewPosition;\nvarying vec2 vUv;\nvarying vec2 vUv2;\n\n#ifdef USE_COLOR\n  varying vec3 vColor;\n#endif\n\n@import fogFragPars\n@import normalPars\n@import levelTransitionPars\n@import homeLogoFragPars\n\nvoid main() {\n  vUv;\n  vUv2;\n  vViewPosition;\n  #ifdef USE_COLOR\n  vColor;\n  #endif\n  \n  float opacity = uOpacity;\n\n  vec2 uv = vUv;\n  vec2 uv2 = vUv2;\n  vec3 normal = normalize(vNormal);\n\n  #ifdef USE_PALETTE_MAP\n    opacity = texture2D(tPaletteMap, vec2(uv.x, uv.y - (4. * 4. - 2.) / 64.)).r;\n  #endif\n\n  @import normal\n\n  @import homeLogoFrag\n\n  gl_FragColor = vec4(packNormalToRGB_1_0(normal), opacity);\n\n  @import level4LightNormalFrag\n  \n  @import fogFrag\n  @import levelTransition\n}\n"},function(e,t){e.exports="#define GLSLIFY 1\n#include <common>\n#include <dithering_pars_fragment>\n\nuniform sampler2D tInput;\n\nvarying vec2 vUv0;\nvarying vec2 vUv1;\nvarying vec2 vUv2;\nvarying vec2 vUv3;\n\nvoid main() {\n\n\t// Sample top left texel.\n\tvec4 sum = texture2D(tInput, vUv0);\n\n\t// Sample top right texel.\n\tsum += texture2D(tInput, vUv1);\n\n\t// Sample bottom right texel.\n\tsum += texture2D(tInput, vUv2);\n\n\t// Sample bottom left texel.\n\tsum += texture2D(tInput, vUv3);\n\n\t// Compute the average.\n\tgl_FragColor = sum * 0.25;\n\n\t#include <dithering_fragment>\n\n}\n"},function(e,t){e.exports="#define GLSLIFY 1\nuniform vec2 texelSize;\nuniform vec2 halfTexelSize;\nuniform float kernel;\n\nvarying vec2 vUv0;\nvarying vec2 vUv1;\nvarying vec2 vUv2;\nvarying vec2 vUv3;\n\nvoid main() {\n\n\tvec2 dUv = (texelSize * vec2(kernel)) + halfTexelSize;\n\n\tvUv0 = vec2(uv.x - dUv.x, uv.y + dUv.y);\n\tvUv1 = vec2(uv.x + dUv.x, uv.y + dUv.y);\n\tvUv2 = vec2(uv.x + dUv.x, uv.y - dUv.y);\n\tvUv3 = vec2(uv.x - dUv.x, uv.y - dUv.y);\n\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\n}"},function(e,t){e.exports="#define GLSLIFY 1\n#include <common>\n\nuniform sampler2D tInput;\nuniform float distinction;\nuniform vec2 range;\n\nvarying vec2 vUv;\n\nvoid main() {\n\n  vec4 texel = texture2D(tInput, vUv);\n  float l = linearToRelativeLuminance(texel.rgb);\n\n  #ifdef RANGE\n\n    float low = step(range.x, l);\n    float high = step(l, range.y);\n\n    // Apply the mask.\n    l *= low * high;\n\n  #endif\n\n  l = pow(abs(l), distinction);\n\n  #ifdef COLOR\n\n    gl_FragColor = vec4(texel.rgb * l, texel.a);\n\n  #else\n\n    gl_FragColor = vec4(l, l, l, texel.a);\n\n  #endif\n\n}\n"},function(e,t){e.exports="#define GLSLIFY 1\nvarying vec2 vUv;\n\nvoid main() {\n\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\n}"},function(e,t){e.exports="#define GLSLIFY 1\nuniform sampler2D texture1;\nuniform sampler2D texture2;\n\nuniform float opacity1;\nuniform float opacity2;\n\nvarying vec2 vUv;\n\nvoid main() {\n\n  vec4 texel1 = opacity1 * texture2D(texture1, vUv);\n  vec4 texel2 = opacity2 * texture2D(texture2, vUv);\n\n  #ifdef SCREEN_MODE\n\n    vec3 invTexel1 = vec3(1.0) - texel1.rgb;\n    vec3 invTexel2 = vec3(1.0) - texel2.rgb;\n\n    vec4 color = vec4(\n      vec3(1.0) - invTexel1 * invTexel2,\n      texel1.a + texel2.a\n    );\n\n  #else\n\n    vec4 color = texel1 + texel2;\n\n  #endif\n\n  gl_FragColor = color;\n\n}\n"},function(e,t){e.exports="#define GLSLIFY 1\nvarying vec2 vUv;\n\nvoid main() {\n\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\n}"},function(e,m,_){"use strict";(function(e){var t,i=_(51),a=_(4),s=_(21),n=_(319),u=_.n(n),o=_(320),c=_.n(o);function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function f(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function p(e,t,n){return(p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=h(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var v=(y((t=function(e){function n(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{outlines:!0};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=f(this,h(n).call(this)))._options=t,e.name="PostPass",e._signals=a.a,e._bind(),e}var t,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(n,i["a"]),t=n,(o=[{key:"destroy",value:function(){p(h(n.prototype),"destroy",this).call(this),this._unbind()}},{key:"init",value:function(e){p(h(n.prototype),"init",this).call(this,e),this.material.vertexShader=u.a,this.material.fragmentShader=c.a,this.material.uniforms=function(r){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},t=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),t.forEach(function(e){var t,n,o;t=r,o=i[n=e],n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o})}return r}({},this.material.uniforms,{tNormal:{value:this._options.normalTexture},uResolution:{value:new THREE.Vector2},uTime:{value:0},uColorDark:{value:new THREE.Color("#000000")},uColorLight:{value:new THREE.Color("#ffffff")},uVignette:{value:0},uFadeOut:{value:0},uBurn:{value:0},uOutline:{value:new THREE.Vector2},uBloomColor:{value:new THREE.Color("#000000")},uBloomMixColor:{value:new THREE.Color("#000000")},uBloomMix:{value:0},uBsc:{value:new THREE.Vector3(1,1,1)},uNoiseDark:{value:new THREE.Vector2(1,1,1)},uNoiseLight:{value:new THREE.Vector2(1,1,1)}});var t=0;s.a.isMedium?t=1:s.a.isHigh&&(t=2),this.material.defines={QUALITY:t,USE_OUTLINES:this._options.outlines,FXAA_REDUCE_MIN:1/128,FXAA_REDUCE_MUL:1/8,FXAA_SPAN_MAX:4,DEBUG_NORMAL:!1}}},{key:"_bind",value:function(){this._signals.postPass.vignetteAnimation.add(this._vignetteAnimation),this._signals.postPass.burnAnimation.add(this._burnAnimation)}},{key:"_unbind",value:function(){TweenMax.killTweensOf(this.material.uniforms.uVignette,{value:!0}),this._signals.postPass.vignetteAnimation.remove(this._vignetteAnimation),this._signals.postPass.burnAnimation.remove(this._burnAnimation)}},{key:"_burnAnimation",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){};TweenMax.to(this.material.uniforms.uBurn,e,{value:1,delay:t,onComplete:n,ease:Expo.easeOut})}},{key:"_vignetteAnimation",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,o=3<arguments.length?arguments[3]:void 0;if(TweenMax.to(this.material.uniforms.uVignette,e,{value:t,delay:n,ease:Expo.easeOut}),o){var r="out"===o;TweenMax.to(this.material.uniforms.uFadeOut,.5*e,{value:r?1:0,delay:r?n:.5*e+n,ease:Expo.easeOut})}}},{key:"outline",set:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.thickness,n=e.amount;t&&(this.material.uniforms.uOutline.value.x=t),n&&(this.material.uniforms.uOutline.value.y=n)}},{key:"bloomColor",set:function(e){this.material.uniforms.uBloomColor.value.set(e)},get:function(){return"#".concat(this.uniforms.uBloomColor.value.getHexString())}},{key:"burn",set:function(e){this.material.uniforms.uBurn.value=e},get:function(){return this.material.uniforms.uBurn.value}},{key:"colors",set:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.dark,n=e.light;t&&this.material.uniforms.uColorDark.value.set(t),n&&this.material.uniforms.uColorLight.value.set(n)}},{key:"vignette",get:function(){return this.material.uniforms.uVignette.value},set:function(e){this.material.uniforms.uVignette.value=e}},{key:"brightness",get:function(){return this.material.uniforms.uBsc.value.x},set:function(e){this.material.uniforms.uBsc.value.x=e}},{key:"saturation",get:function(){return this.material.uniforms.uBsc.value.y},set:function(e){this.material.uniforms.uBsc.value.y=e}},{key:"contrast",get:function(){return this.material.uniforms.uBsc.value.z},set:function(e){this.material.uniforms.uBsc.value.z=e}},{key:"noise",set:function(e){var t=e.dark,n=e.light;t&&(t.scale&&(this.material.uniforms.uNoiseDark.value.x=t.scale),t.intensity&&(this.material.uniforms.uNoiseDark.value.y=t.intensity),t.speed&&(this.material.uniforms.uNoiseDark.value.z=t.speed)),n&&(n.scale&&(this.material.uniforms.uNoiseLight.value.x=n.scale),n.intensity&&(this.material.uniforms.uNoiseLight.value.y=n.intensity),n.speed&&(this.material.uniforms.uNoiseLight.value.z=n.speed))}}])&&l(t.prototype,o),r&&l(t,r),n}()).prototype,"_burnAnimation",[e],Object.getOwnPropertyDescriptor(t.prototype,"_burnAnimation"),t.prototype),y(t.prototype,"_vignetteAnimation",[e],Object.getOwnPropertyDescriptor(t.prototype,"_vignetteAnimation"),t.prototype),t);m.a=v}).call(this,_(2).bind)},function(e,t){e.exports="#define GLSLIFY 1\n#define SHADER_NAME Post\n\nvoid texcoords_1_0(vec2 fragCoord, vec2 resolution,\n\t\t\tout vec2 v_rgbNW, out vec2 v_rgbNE,\n\t\t\tout vec2 v_rgbSW, out vec2 v_rgbSE,\n\t\t\tout vec2 v_rgbM) {\n\tvec2 inverseVP = 1.0 / resolution.xy;\n\tv_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n\tv_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n\tv_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n\tv_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n\tv_rgbM = vec2(fragCoord * inverseVP);\n}\n\n\n\n\nattribute vec3 position;\nattribute vec2 uv;\n\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\n\n\nuniform vec2 uResolution;\n\nvarying vec2 vUv;\n\n#if QUALITY != 0\n  varying vec2 vrgbNW;\n  varying vec2 vrgbNE;\n  varying vec2 vrgbSW;\n  varying vec2 vrgbSE;\n  varying vec2 vrgbM;\n#endif\n\nvoid main() {\n  vUv = uv;\n\n  #if QUALITY != 0\n    vec2 fragCoord = uv * uResolution;\n    texcoords_1_0(fragCoord, uResolution, vrgbNW, vrgbNE, vrgbSW, vrgbSE, vrgbM);\n  #endif\n\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n"},function(e,t){e.exports="#define GLSLIFY 1\n#define SHADER_NAME Post\n\nvec4 fxaa_5_0(sampler2D tex, vec2 fragCoord, vec2 resolution,\n            vec2 v_rgbNW, vec2 v_rgbNE, \n            vec2 v_rgbSW, vec2 v_rgbSE, \n            vec2 v_rgbM) {\n    vec4 color;\n    mediump vec2 inverseVP = vec2(1.0 / resolution.x, 1.0 / resolution.y);\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n    \n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n    \n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n    \n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n              dir * rcpDirMin)) * inverseVP;\n    \n    vec3 rgbA = 0.5 * (\n        texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n        texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n        texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n        texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\n\n\n#define LUMINANCE vec3(0.2125, 0.7154, 0.0721)\n\nfloat outline_1_1(sampler2D tInput, vec2 uv, vec2 resolution, float thickness) {\n  vec2 texel = vec2(1.0 / resolution.x, 1.0 / resolution.y);\n\n  const mat3 Gx = mat3(-1, -2, -1, 0, 0, 0, 1, 2, 1);\n  const mat3 Gy = mat3(-1, 0, 1, -2, 0, 2, -1, 0, 1);\n\n  float tx0y0 = dot(texture2D(tInput, uv + texel * vec2(-thickness, -thickness)).rgb, LUMINANCE);\n  float tx0y1 = dot(texture2D(tInput, uv + texel * vec2(-thickness, 0)).rgb, LUMINANCE);\n  float tx0y2 = dot(texture2D(tInput, uv + texel * vec2(-thickness, thickness)).rgb, LUMINANCE);\n\n  float tx1y0 = dot(texture2D(tInput, uv + texel * vec2(0, -thickness)).rgb, LUMINANCE);\n  float tx1y1 = dot(texture2D(tInput, uv + texel * vec2(0, 0)).rgb, LUMINANCE);\n  float tx1y2 = dot(texture2D(tInput, uv + texel * vec2(0, thickness)).rgb, LUMINANCE);\n\n  float tx2y0 = dot(texture2D(tInput, uv + texel * vec2(thickness, -thickness)).rgb, LUMINANCE);\n  float tx2y1 = dot(texture2D(tInput, uv + texel * vec2(thickness, 0)).rgb, LUMINANCE);\n  float tx2y2 = dot(texture2D(tInput, uv + texel * vec2(thickness, thickness)).rgb, LUMINANCE);\n\n  float valueGx = Gx[0][0] * tx0y0 + Gx[1][0] * tx1y0 + Gx[2][0] * tx2y0 + \n    Gx[0][1] * tx0y1 + Gx[1][1] * tx1y1 + Gx[2][1] * tx2y1 + \n    Gx[0][2] * tx0y2 + Gx[1][2] * tx1y2 + Gx[2][2] * tx2y2; \n\n  float valueGy = Gy[0][0] * tx0y0 + Gy[1][0] * tx1y0 + Gy[2][0] * tx2y0 + \n    Gy[0][1] * tx0y1 + Gy[1][1] * tx1y1 + Gy[2][1] * tx2y1 + \n    Gy[0][2] * tx0y2 + Gy[1][2] * tx1y2 + Gy[2][2] * tx2y2; \n\n  return sqrt((valueGx * valueGx) + (valueGy * valueGy));\n}\n\n\n\nvec3 bsc_2_2(vec3 color, float brightness, float saturation, float contrast) {\n   vec3 bColor = color.rgb * brightness;\n   float intensity = dot(bColor, vec3(0.2125, 0.7154, 0.0721));\n   return mix(vec3(0.5), mix(vec3(intensity), bColor, saturation), contrast);\n}\n\n\n\nfloat vignette_3_3(float boost, float reduction, vec2 resolution) {\n  vec2 center = resolution * 0.5;\n  float vignette = distance(center, gl_FragCoord.xy)  / resolution.x;\n  vignette = boost - vignette * reduction;\n  return vignette;\n}\n\n\n\nfloat rand_4_4(vec2 n, float offset) {\n  return 0.5 - fract(sin(dot(n.xy + vec2( offset, 0. ), vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nfloat random_4_5(vec2 pos, float time, float amount, float speed) {\n  return amount * rand_4_4(pos, 0.0000000001 * time * speed);\n}\n\n\n\n\n@import commonFrag\n\nuniform sampler2D tInput;\n\nuniform vec2 uResolution;\nuniform float uTime;\n\nuniform vec3 uNoiseDark;\nuniform vec3 uNoiseLight;\n\nuniform vec3 uColorDark;\nuniform vec3 uColorLight;\n\nuniform float uVignette;\nuniform vec2 uOutline;\n\nuniform float uFadeOut;\nuniform float uBurn;\n\nuniform float uBloomMix;\nuniform vec3 uBloomColor;\nuniform vec3 uBloomMixColor;\n\nuniform vec3 uBsc;\nuniform vec2 uNoise;\n\nvarying vec2 vUv;\n\n#if QUALITY != 0\n  uniform sampler2D tNormal;\n\n  varying vec2 vrgbNW;\n  varying vec2 vrgbNE;\n  varying vec2 vrgbSW;\n  varying vec2 vrgbSE;\n  varying vec2 vrgbM;\n#endif\n\nvoid main() {\n  #if QUALITY != 0\n    vec2 fragCoord = vUv * uResolution;\n    vec4 tex = fxaa_5_0(tInput, fragCoord, uResolution, vrgbNW, vrgbNE, vrgbSW, vrgbSE, vrgbM);\n  #else\n    vec4 tex = texture2D(tInput, vUv);\n  #endif\n\n  vec3 color = tex.rgb;\n\n  #if defined(USE_OUTLINES) && QUALITY != 0\n    float outlines = 1.0 - outline_1_1(tNormal, vUv, uResolution, uOutline.x) * uOutline.y; // thickness - amount\n    color *= outlines;\n  #endif\n\n  color += mix(uBloomColor, uBloomMixColor, uBloomMix);\n  color = bsc_2_2(color, uBsc.r, uBsc.g, uBsc.b);\n  color *= saturate(vignette_3_3(1.0, uVignette, uResolution));\n\n  float noiseMask = dot(color, LUMINANCE);\n  noiseMask = mix(0.0, 1.0, step(0.3, noiseMask));\n\n  float darkNoise = random_4_5(vUv * uNoiseDark.x, uTime, uNoiseDark.y, uNoiseDark.z);\n  color += vec3(darkNoise * (1.0 - noiseMask));\n\n  float lightNoise = random_4_5(vUv * uNoiseLight.x, uTime, uNoiseLight.y, uNoiseLight.z);\n  color += vec3(lightNoise * noiseMask);\n\n  color = mix(color, vec3(0.0, 0.0, 0.0), uFadeOut);\n  color = mix(color, vec3(1.0, 1.0, 1.0), uBurn);\n  color = mix(uColorDark, uColorLight, color);\n\n  #if defined(DEBUG_NORMAL)\n    color = texture2D(tNormal, vUv).rgb;\n  #endif\n\n  gl_FragColor = vec4(color, 1.0);\n}\n"},function(e,m,_){"use strict";(function(e){var t,i=_(13),a=_(11);function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function u(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function c(e,t,n){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var o,r,p,h,d,y,v=(o=(t=function(e){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=u(this,l(n).call(this,e)))._create(),t}var t,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(n,i["a"]),t=n,(o=[{key:"destroy",value:function(){c(l(n.prototype),"destroy",this).call(this),this._gui.removeFolder(this._guiFolder)}},{key:"setSize",value:function(){}},{key:"_create",value:function(){var e=this._gltf.getObject("terrain","logo_lock"),t=this._gltf.getObject("terrain","logo_u_letter");this._logoLock=e,this._logoULetter=t,e.frustumCulled=!1,t.frustumCulled=!1,e.material=new a.a({name:e.name,useVertexColors:!0}),t.material=new a.a({name:t.name,useVertexColors:!0}),this.add(e,t),this._createGUI(),this._animationIn()}},{key:"_animationIn",value:function(){var e=this;this._logoTransition=0,this._tl=new TimelineMax,this._tls.push(this._tl),this._tl.from(this._logoULetter.position,3,{y:"+=20",ease:Expo.easeOut},2.4).from(this._logoLock.position,3.5,{y:"+=20",ease:Expo.easeOut},2.4+.3).to(this._logoLock.rotation,4,{z:2*Math.PI,ease:Elastic.easeOut},2.4).to(this._logoULetter.rotation,3,{z:2*-Math.PI,ease:Expo.easeOut},2.4).to(this,4,{_logoTransition:1,ease:Power1.easeOut,onUpdate:function(){return e._scene._materialCtrl.setAllProperties("logoTransition",e._logoTransition)}},2.5)}},{key:"_createGUI",value:function(){var t=this;this._guiFolder=this._gui.addFolder("HomeLogo"),this._guiFolder.add({val:0},"val",0,1,.01).name("Logo transition").onChange(function(e){return t._scene._materialCtrl.setAllProperties("logoTransition",e)})}}])&&s(t.prototype,o),r&&s(t,r),n}()).prototype,r="setSize",p=[e],h=Object.getOwnPropertyDescriptor(t.prototype,"setSize"),d=t.prototype,y={},Object.keys(h).forEach(function(e){y[e]=h[e]}),y.enumerable=!!y.enumerable,y.configurable=!!y.configurable,("value"in y||y.initializer)&&(y.writable=!0),y=p.slice().reverse().reduce(function(e,t){return t(o,r,e)||e},y),d&&void 0!==y.initializer&&(y.value=y.initializer?y.initializer.call(d):void 0,y.initializer=void 0),void 0===y.initializer&&(Object.defineProperty(o,r,y),y=null),t);m.a=v}).call(this,_(2).bind)},function(e,t){e.exports="#define GLSLIFY 1\n#define SHADER_NAME Default\n\n@import commonVert\n\n@import shadowmapVertPars\n@import skinningVertPars\n@import fogVertPars\n@import instancesVertPars\n\n@import level1LaserHitVertPars\n\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\nattribute vec2 uv2;\nattribute vec3 color;\n\nuniform mat4 modelMatrix;\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat3 normalMatrix;\n\nuniform float uTime;\n\n#ifdef USE_PALETTE_MAP\n  uniform sampler2D tPaletteMap;\n#endif\n\nvarying vec3 vNormal;\nvarying vec3 vWorldNormal;\nvarying vec3 vViewPosition;\nvarying vec2 vUv;\nvarying vec2 vUv2;\n\n#ifdef USE_COLOR\n  varying vec3 vColor;\n#endif\n\nvoid main() {\n  vec3 transformed = position;\n  vec3 objectNormal = normal;\n  vec2 objectUv = vec2(uv.x, 1.0 - uv.y);\n  vec2 objectUv2 = vec2(uv2.x, 1.0 - uv2.y);\n\n  @import skinningVertBase\n  @import skinningVert\n  @import skinningVertNormal\n\n  @import instancesVert\n\n  @import homeLightVert\n  @import homeLogoVert\n\n  vec4 worldPosition = modelMatrix * vec4(transformed, 1.0);\n  vec3 worldNormal = normalize(mat3(modelMatrix[0].xyz, modelMatrix[1].xyz, modelMatrix[2].xyz) * objectNormal);\n  vec4 mvPosition = modelViewMatrix * vec4(transformed, 1.0);\n  \n  @import shadowmapVert\n\n  gl_Position = projectionMatrix * mvPosition;\n\n  @import level1LaserHitVert\n  @import homeBoardVert\n\n  vNormal = normalize(normalMatrix * objectNormal);\n  vWorldNormal = worldNormal;\n  vViewPosition = -mvPosition.xyz;\n  vUv = objectUv;\n  vUv2 = objectUv2;\n\n  #ifdef USE_COLOR\n    vColor = color;\n  #endif\n\n  @import fogVert\n}\n"},function(e,t){e.exports="#define GLSLIFY 1\n#define SHADER_NAME Default\n\n@import commonFrag\n\n@import lightsPars\n@import shadowmapFragPars\n@import fogFragPars\n@import normalPars\n\n@import homeLogoFragPars\n@import levelTransitionPars\n@import level1BurnFragPars\n\n// Object\nuniform vec3 uDiffuseColor;\nuniform float uOpacity;\n\nuniform vec3 uSpecularColor;\nuniform float uSpecularShininess;\nuniform float uSpecularStrength;\n\nuniform vec3 uEmissive;\n\n#ifdef USE_DIFFUSE_MAP\n  uniform sampler2D uDiffuseMap;\n#endif\n\n// Common\nuniform vec3 uShadowsColor;\nuniform float uShadowsIntensity;\n\nuniform vec3 uAmbientColor;\n\n#ifdef USE_PALETTE_MAP\n  uniform sampler2D tPaletteMap;\n#endif\n\nvarying vec3 vNormal;\nvarying vec3 vWorldNormal;\nvarying vec3 vViewPosition;\nvarying vec2 vUv;\nvarying vec2 vUv2;\n\n#ifdef USE_COLOR\n  varying vec3 vColor;\n#endif\n\nvoid main() {\n  vUv;\n  vUv2;\n  vViewPosition;\n  #ifdef USE_COLOR\n  vColor;\n  #endif\n\n  ReflectedLight reflectedLight = ReflectedLight(vec3(0.0), vec3(0.0), vec3(0.0));\n  vec3 totalEmissiveRadiance = uEmissive;\n\n  float opacity = uOpacity;\n  vec2 uv = vUv;\n  vec2 uv2 = vUv2;\n\n  @import levelConeFrag\n\n  #ifdef USE_PALETTE_MAP\n    opacity = texture2D(tPaletteMap, vec2(uv.x, uv.y - (4. * 4. - 2.) / 64.)).r;\n  #endif\n\n  vec4 diffuseColor = vec4(uDiffuseColor, opacity);\n  vec3 specularColor = uSpecularColor;\n  vec3 normal = normalize(vNormal);\n\n  @import normal\n\n  #ifdef USE_PALETTE_MAP\n    diffuseColor.rgb = texture2D(tPaletteMap, vec2(uv.x, uv.y - 2. / 64.)).rgb;\n    specularColor = texture2D(tPaletteMap, vec2(uv.x, uv.y - (4. * 2. - 2.) / 64.)).rgb;\n    totalEmissiveRadiance.rgb = texture2D(tPaletteMap, vec2(uv.x, uv.y - (4. * 3. - 2.) / 64.)).rgb;\n  #endif\n\n  #ifdef USE_DIFFUSE_MAP\n    vec4 mTexel = texture2D(uDiffuseMap, uv2);\n    diffuseColor *= mTexel;\n    opacity *= mTexel.a;\n  #endif\n\n  @import homeWindowsFrag\n  @import homeLightFrag\n  @import homeLogoFrag\n  @import lobbyPortalFrag\n  @import level1BurnFrag\n  @import level2ScreenFrag\n  @import level3TubeFrag\n  @import level4LightFrag\n\n  // --- Geometry\n  GeometricContext geometry;\n\n  geometry.position = -vViewPosition;\n  geometry.normal = normal;\n  geometry.viewDir = normalize(vViewPosition);\n\n  // --- Material\n  DefaultMaterial material;\n  material.diffuseColor = diffuseColor.rgb;\n\n  material.specularColor = specularColor;\n  material.specularShininess = uSpecularShininess;\n  material.specularStrength = uSpecularStrength;\n\n  // --- Ambient\n  AmbientIrradiance ambient;\n  ambient.color = uAmbientColor;\n\n  // --- Lights accumulation\n  IncidentLight directLight;\n\n  indirect(ambient, material, reflectedLight);\n\n  #if NUM_DIR_LIGHTS > 0\n    DirectionalLight directionalLight;\n\n    #pragma unroll_loop\n    for (int i = 0; i < NUM_DIR_LIGHTS; i++) {\n      directionalLight = directionalLights[i];\n\n      directLight.color = directionalLight.color;\n      directLight.direction = directionalLight.direction;\n      directLight.visible = true;\n\n      if(directLight.color != vec3(0.0))\n        direct(directLight, geometry, material, reflectedLight);\n    }\n  #endif\n\n  // --- Shadows\n  float shadowsMask = min(1.0 - getShadowMask(), uShadowsIntensity);\n  vec3 shadows = mix(vec3(1.0), uShadowsColor, shadowsMask);\n  reflectedLight.directDiffuse *= shadows;\n\n  vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + totalEmissiveRadiance;\n\n  gl_FragColor = vec4(outgoingLight, opacity);\n\n  @import fogFrag\n  @import levelTransition\n  \n  @import lobbyPostersFrag \n}\n"},function(e,t){e.exports="#define GLSLIFY 1\n#define SHADER_NAME Instanced-depth\n\nattribute vec3 position;\nattribute vec3 normal;\n\nuniform mat4 modelMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\n\nuniform float uTime;\n\n@import instancesVertPars\n\nvoid main() {\n  vec3 transformed = vec3(position);\n  vec3 objectNormal = normal;\n\n  @import instancesVert\n\n  vec4 worldPosition = modelMatrix * vec4(transformed, 1.0);\n  vec4 mvPosition = modelViewMatrix * vec4(transformed, 1.0);\n\n  gl_Position = projectionMatrix * mvPosition;\n}\n"},function(e,t,n){"use strict";n.d(t,"a",function(){return o});var l=new THREE.Vector3,f=new THREE.Vector3,p=new THREE.Vector3,h=new THREE.Vector3,d=new THREE.Line3,y=new THREE.Line3,v=new THREE.Line3;function o(e,t,n,o){t=f.copy(t),n=p.copy(n),o=h.copy(o);var r=e.center,i=e.radius;d.set(t,n),y.set(t,o),v.set(n,o);for(var a=[d,y,v],s=!1,u=0,c=a.length;u<c;u++)if(a[u].closestPointToPoint(r,!0,l),l.distanceTo(r)<=i){s=!0;break}return s}},function(e,t,n){"use strict";var i=n(11);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function s(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var r=function(e){function n(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=s(this,u(n).call(this,t))).uniforms=function(r){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},t=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),t.forEach(function(e){var t,n,o;t=r,o=i[n=e],n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o})}return r}({},e.uniforms,{tGradientMap:{value:e._textures.get("main.gradient")},tLogoTransition:{value:0}}),e}var t,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(n,i["a"]),t=n,(o=[{key:"logoTransition",set:function(e){this.uniforms.tLogoTransition.value=e}}])&&a(t.prototype,o),r&&a(t,r),n}();t.a=r},function(e,t,n){"use strict";var i=n(53);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function s(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var r=function(e){function n(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=s(this,u(n).call(this,t))).uniforms=function(r){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},t=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),t.forEach(function(e){var t,n,o;t=r,o=i[n=e],n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o})}return r}({},e.uniforms,{tGradientMap:{value:e._textures.get("main.gradient")},tLogoTransition:{value:0}}),e}var t,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(n,i["a"]),t=n,(o=[{key:"logoTransition",set:function(e){this.uniforms.tLogoTransition.value=e}}])&&a(t.prototype,o),r&&a(t,r),n}();t.a=r},function(e,t,n){e.exports=n(552).default},function(e,E,P){"use strict";(function(e){var t,n,o,i=P(40),a=P(57),s=P(10),u=P(35),c=P(31),l=P(0);function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function p(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function h(e,t,n){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var m,_,g,b=!0,w=new THREE.Vector3(0,5.96,-31.6),O={spawn:{charPos:new THREE.Vector3(11.09,1.44,10.1),charDir:13.32,camDir:-5.6,camPanY:.99},"level-1":{charPos:new THREE.Vector3(-16.69,1.49,-27.24),charDir:-21.44,camDir:-5.2601,camPanY:2.8712},"level-2":{charPos:new THREE.Vector3(-12.5525,1.49,-31.32),charDir:100,camDir:-10.42,camPanY:3.2178},"level-3":{charPos:new THREE.Vector3(13.57,1.44,-30.3),charDir:-15.7079,camDir:-18.84,camPanY:3.069},"level-4":{charPos:new THREE.Vector3(.2393,5.97,-31.695),charDir:15.761667,camDir:-11.62,camPanY:4.0594}},x={portal_01:{anchor:new THREE.Vector3(-19.96,1.45,-27.8),route:"/level/1"},portal_02:{anchor:new THREE.Vector3(-12.17,1.45,-36.25),route:"/level/2"},portal_03:{anchor:new THREE.Vector3(12.29,1.45,-36.65),route:"/level/3"},portal_04:{anchor:new THREE.Vector3(.15,5.97,-36.16),route:"/level/4",locked:!1}},k=(o=n=function(e){function n(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=p(this,d(n).call(this,"lobby",{physics:!0,postProcessing:!0})))._resetData=O,x.portal_04.locked=e._state.keysNb<3,e}var t,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(n,i["a"]),t=n,(o=[{key:"_init",value:function(){h(d(n.prototype),"_init",this).call(this),this._needsDoorInstruction=this._state.keysNb<3,document.title="Santa's Hall - Plume and the forgotten letter | WebGL game"}},{key:"_unbind",value:function(){clearTimeout(this._santaDeskTimeout),h(d(n.prototype),"_unbind",this).call(this)}},{key:"_createPostProcessing",value:function(){h(d(n.prototype),"_createPostProcessing",this).call(this)}},{key:"_createEntities",value:function(){var e=this;h(d(n.prototype),"_createEntities",this).call(this),this.portals=new a.a(this,x),this.addEntity(this.portals),this._state.keysNb<3?(this.lockBody=new CANNON.Body({mass:0,shape:new CANNON.Box(new CANNON.Vec3(2.7,4,.01)),position:new CANNON.Vec3(0,9.5,-34.5)}),this.lockBody.added=!1):this._noKeyTimeout=setTimeout(function(){e._signals.instructions.show.dispatch("Great! You have all the keys, go to the portal in the center.")},3e3)}},{key:"_createAudios",value:function(){h(d(n.prototype),"_createAudios",this).call(this,"lobby-theme")}},{key:"_afterCreate",value:function(){var e=this;if(h(d(n.prototype),"_afterCreate",this).call(this),this._palette.updateChannel("portal_04","isLocked",this._state.keysNb<3),1<this._state.levelHistory.length){var t=this._state.levelHistory[this._state.levelHistory.length-2];t&&this._resetData[t]&&this.setView(t)}b?(b=!1,this._createControlsInstructions()):this._santaDeskTimeout=setTimeout(function(){e._sounds.play("where_is_santa_desk")},Object(l.j)(2e4,7e4))}},{key:"_createControlsInstructions",value:function(){var t=this;this._instructionsTl=new TimelineMax,this._tls.push(this._instructionsTl),this._instructionsTl.addCallback(function(){t._sounds.play("where_is_santa_desk")},1).addCallback(function(){var e=u.a.get("global.qwerty")?"_qwerty":"_azerty";t._showInstruction("move"+e)},3).addCallback(function(){t._hideInstruction()},"+=4").addCallback(function(){t._showInstruction("jump"),t._sounds.play("portals")},"+=1").addCallback(function(){t._hideInstruction()},"+=4").addCallback(function(){t._showInstruction("camera")},"+=1").addCallback(function(){t._hideInstruction()},"+=4").addCallback(function(){t._showInstruction("jump_forward")},"+=1").addCallback(function(){t._hideInstruction()},"+=4")}},{key:"_showInstruction",value:function(e){var t=s.a.isConnected?c.a.tutorial.gamepad:c.a.tutorial.keyboard;this._signals.instructions.show.dispatch(t[e])}},{key:"_hideInstruction",value:function(){this._signals.instructions.hide.dispatch()}},{key:"_onPauseShow",value:function(){this._instructionsTl&&this._instructionsTl.pause()}},{key:"_onPauseHide",value:function(){this._instructionsTl&&0<this._instructionsTl.progress()&&this._instructionsTl.progress()<1&&this._instructionsTl.play()}},{key:"_onUpdate",value:function(e,t){this._needsDoorInstruction&&(w.distanceTo(this.character.position)<3.5&&(this._needsDoorInstruction=!1,this._sounds.play("locked_portals"),this._signals.lobby.showLockMsg.dispatch()));(this.portals.update(e,t),this.lockBody)&&(Object(l.b)(this.character.position.x,this.character.position.z,this.lockBody.position.x,this.lockBody.position.z)<4?this.lockBody.added||(this.lockBody.added=!0,this.physics.world.add(this.lockBody)):this.lockBody.added&&(this.lockBody.added=!1,this.physics.world.remove(this.lockBody)))}}])&&f(t.prototype,o),r&&f(t,r),n}(),g=!0,(_="needsTextures")in(m=n)?Object.defineProperty(m,_,{value:g,enumerable:!0,configurable:!0,writable:!0}):m[_]=g,v((t=o).prototype,"_onPauseShow",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onPauseShow"),t.prototype),v(t.prototype,"_onPauseHide",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onPauseHide"),t.prototype),t);E.a=k}).call(this,P(2).bind)},function(e,y,v){"use strict";(function(e){var t,i=v(52),a=v(15),s=v(10),u=v(3),c=v(0);function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function f(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function p(e,t,n){return(p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=h(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var r=(o((t=function(e){function o(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=f(this,h(o).call(this,function(r){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},t=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),t.forEach(function(e){var t,n,o;t=r,o=i[n=e],n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o})}return r}({fov:"desktop"===u.a.device.type?60:50},t)))).name=t.name||"Game camera",e.shakeFactor=0,e._offsetX=new THREE.Vector3,e._defaultPanY=330,e._panY=e._panYTarget=e._defaultPanY,e._angleX=e._angleTargetX=0,e._isDown=!1,e._rotateDampingFactor=.2,e._cameraDampingFactor=.01,e._rotateSpeed=.01,e._panSpeed=5,e._minPanY=100,e._maxPanY=800,e._radius=8,e.shakeSpeed=.01,e}var t,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(o,i["a"]),t=o,(n=[{key:"createGUI",value:function(e){}},{key:"setPanY",value:function(e){this._panY=this._panYTarget=e}},{key:"update",value:function(e,t){if(p(h(o.prototype),"update",this).call(this,e,t),!this._state.pauseDisplayed){this._processGamepadInputs(),this._angleX=Object(c.d)(this._angleX,this._angleTargetX,this._rotateDampingFactor),this._offsetX.x=this._radius*Math.cos(this._angleX),this._offsetX.z=this._radius*Math.sin(this._angleX),this.position.copy(this._charPos).add(this._offsetX),this._panY=(this._panYTarget-this._panY)*this._cameraDampingFactor,this.position.y+=this._panY;var n=t*this.shakeSpeed;this.position.x+=this.shakeFactor*(Math.cos(n+2300)+Math.sin(1.2*n)+Math.cos(2*n))/3*.1,this.position.y+=this.shakeFactor*(Math.sin(n+800)+Math.sin(.7*n)+Math.cos(1.8*n))/3*.1,this.lookAt(this._charPos)}}},{key:"destroy",value:function(){p(h(o.prototype),"destroy",this).call(this),this._unbind()}},{key:"_bind",value:function(){p(h(o.prototype),"_bind",this).call(this),"desktop"===u.a.device.type&&(a.a.downed.add(this._onPointerDown),a.a.upped.add(this._onPointerUp),a.a.moved.add(this._onPointerMove),a.a.leaved.add(this._onPointerLeave))}},{key:"_unbind",value:function(){p(h(o.prototype),"_unbind",this).call(this),a.a.downed.remove(this._onPointerDown),a.a.upped.remove(this._onPointerUp),a.a.moved.remove(this._onPointerMove),a.a.leaved.remove(this._onPointerLeave)}},{key:"_processGamepadInputs",value:function(){var e=s.a.joystickRight.x,t=s.a.joystickRight.y;this._angleTargetX+=e*this._rotateSpeed*5,this._panYTarget+=t*this._panSpeed*4,this._panYTarget=Object(c.a)(this._panYTarget,this._minPanY,this._maxPanY)}},{key:"_onPointerDown",value:function(e){e.preventDefault(),this._state.pauseDisplayed||0===e.button&&(this._isDown=!0,a.a.addCursor("grabbing"))}},{key:"_onPointerUp",value:function(e){e.preventDefault(),0===e.button&&(this._isDown=!1,a.a.addCursor("grab"))}},{key:"_onPointerMove",value:function(e){e.preventDefault(),this._isDown&&(this._angleTargetX+=a.a.delta.x*this._rotateSpeed,this._panYTarget+=a.a.delta.y*this._panSpeed,this._panYTarget=Object(c.a)(this._panYTarget,this._minPanY,this._maxPanY))}},{key:"_onPointerLeave",value:function(){this._isDown=!1,a.a.addCursor("grab")}},{key:"direction",set:function(e){this._angleX=this._angleTargetX=e},get:function(){return this._angleX}},{key:"maxPanY",get:function(){return this._maxPanY},set:function(e){this._maxPanY=e}},{key:"panYTarget",get:function(){return this._panYTarget},set:function(e){this._panYTarget=e}},{key:"defaultPanY",get:function(){return this._defaultPanY}},{key:"rotateDampingFactor",get:function(){return this._rotateDampingFactor},set:function(e){this._rotateDampingFactor=e}},{key:"isDown",get:function(){return this._isDown}},{key:"radius",set:function(e){this._radius=e},get:function(){return this._radius}}])&&l(t.prototype,n),r&&l(t,r),o}()).prototype,"_onPointerDown",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onPointerDown"),t.prototype),o(t.prototype,"_onPointerUp",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onPointerUp"),t.prototype),o(t.prototype,"_onPointerMove",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onPointerMove"),t.prototype),o(t.prototype,"_onPointerLeave",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onPointerLeave"),t.prototype),t);y.a=r}).call(this,v(2).bind)},function(e,k,E){"use strict";(function(e){var t,i=E(332),a=E(13),u=E(7),s=E(15),c=E(10),l=E(11),f=E(53),p=E(14),h=E(64),d=E(6),y=E(0);function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function m(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function _(e,t,n){return(_="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=g(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var w=new CANNON.Quaternion,O={baseMoveAnimationRatio:1.25,moveAnimationRatio:1.25,inAirPosMaxSpeed:3.8,groundedPosMaxSpeed:3.5,jumpImpulse:1,heightLimit:-30},x=null,r=(o((t=function(e){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=m(this,g(n).call(this,e)))._lastCharReset=Date.now(),t._posSpeed=.03,t._baseSpeedMax=.24,t._posSmoothness=.1,t._posSpeedMax=t._baseSpeedMax,t._coords=null,t.canDie=!1,t._lastSoundIds={jump:-1,laser:-1,robot:-1,camera:-1},t._narratorCounts={laser:0,robot:0,camera:0},t._wasWalking=!1,t._isWalking=!1,t._wasRunning=!1,t._isRunning=!1,t._wasGrounded=!1,t._isGrounded=!0,t._isJumping=!1,t._isFalling=!1,t._state.isDying=!1,t._isJumpingForward=!1,t._canJumpForward=!0,t._speedFactor=1,t._jumpNow=Date.now(),t._canPlayFallenSprite=!1,t._goundedDistance=2,t._jumpType=null,t._canPlayMoveAnimation=!0,t._lastHeightDistance=0,t._bodyGrounded=!1,t._contactCollision=null,t._posAcceleration=0,t._rotAcceleration=0,t._posAccelerationTgt=0,t._rotAccelerationTgt=0,t._jumpBtnDowned=!1,t._runningEnabled=!1,t._cEuler=new CANNON.Vec3,t._hipsBonePos=new THREE.Vector3,t._hipsBoneRot=new THREE.Quaternion,t._velocityCoef=1,t._velocityCoefTarget=1,t._keysDowned=!1,t._raycaster=t._context.raycaster,x||(x=t._sounds.get("walking")).play(),t._walkingSound=x,t._walkingSound.playbackRate=1.8,t._init(),t.createGUI(),t._canDieTimeout=new h.a(function(){t.canDie=!0},1e3),t}var t,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(n,a["a"]),t=n,(o=[{key:"createGUI",value:function(){this._guiFolder=this._gui.addFolder("Character - "+this._scene.name),this._guiFolder.add(O,"moveAnimationRatio",0,2,.001),this._guiFolder.add(this._walkingSound,"playbackRate",0,2,.001)}},{key:"destroyGUI",value:function(){this._guiFolder&&this._gui.removeFolder(this._guiFolder)}},{key:"setPosition",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this.body.position.copy(e),this.body.position.y+=t,this.syncMesh()}},{key:"setDirection",value:function(e){this._rotAcceleration=this._rotAccelerationTgt=Math.PI/2-e}},{key:"destroy",value:function(){this._jumpForwardOutTimeout&&this._jumpForwardOutTimeout.clear(),this._canJumpForwardTimeout&&this._canJumpForwardTimeout.clear(),this.destroyGUI(),_(g(n.prototype),"destroy",this).call(this),this._unbind(),this._walkingSound.volume=0}},{key:"_bind",value:function(){s.a.downed.add(this._onPointerDown),u.a.downed.add(this._onKeyDown),u.a.upped.add(this._onKeyUp),c.a.buttonDowned.add(this._onButtonDown),c.a.buttonUpped.add(this._onButtonUp),this._world.addEventListener("preStep",this._onPreStep),this._world.addEventListener("postStep",this._onPostStep),this.body.addEventListener("collide",this._onBodyCollide),this._signals.pause.shown.add(this._onPauseShow),this._signals.pause.hidden.add(this._onPauseHide),this._signals.enemies.laserHit.add(this._onLaserHit),this._signals.enemies.cameraHit.add(this._onCameraHit),this._signals.enemies.lookHit.add(this._onLookHit)}},{key:"_unbind",value:function(){s.a.downed.remove(this._onPointerDown),u.a.downed.remove(this._onKeyDown),u.a.upped.remove(this._onKeyUp),c.a.buttonDowned.remove(this._onButtonDown),c.a.buttonUpped.remove(this._onButtonUp),this._world.removeEventListener("preStep",this._onPreStep),this._world.removeEventListener("postStep",this._onPostStep),this.body.removeEventListener("collide",this._onBodyCollide),this._signals.pause.shown.remove(this._onPauseShow),this._signals.pause.hidden.remove(this._onPauseHide),this._signals.enemies.laserHit.remove(this._onLaserHit),this._signals.enemies.cameraHit.remove(this._onCameraHit),this._signals.enemies.lookHit.remove(this._onLookHit)}},{key:"_init",value:function(){var e=this._gltf.getAsset("character"),t=e.scene.children[0];(this.obj=t).scale.multiplyScalar(.55),t.position.y=-1.43;var n=t.children[0];n.receiveShadow=!0,n.castShadow=!0;var o={name:n.name,skinning:!0};n.material=new l.a(o),n.customNormalMaterial=new f.a(o),n.customDepthMaterial=this._materials.depthSkinningMaterial,this.skinnedMesh=n,this.material=n.material,this.add(this.obj),this.skeletonHelper=new THREE.SkeletonHelper(this.obj),this.skeletonHelper.name="SkeletonHelper",this.skeletonHelper.visible=!1,this._scene.add(this.skeletonHelper),this.animations=new i.a(this,this.obj,e.animations),this.animations.play("idle",.3),this.body=new CANNON.Body({mass:70,shape:new CANNON.Sphere(1.45),material:this._pMaterials.character,angularDamping:0,linearDamping:0,collisionFilterGroup:this._physics.group.character,collisionFilterMask:this._physics.group.terrain|this._physics.group.rock2}),this.obj.baseRot=this.obj.rotation.clone(),this.addBody(),"level-1"===this._scene.name&&(this.hitBox=new THREE.Mesh(new THREE.BoxBufferGeometry(.6,2.7,.7),this._materials.debugMaterial),this.hitBox.name="HitBoxHelper",this.hitBox.visible=!1,this._scene.add(this.hitBox)),this._bind()}},{key:"_charReset",value:function(e){var t=this;this._lastCharReset=Date.now(),this.canDie=!1,this._canDieTimeout&&this._canDieTimeout.clear(),this._canDieTimeout=new h.a(function(){t.canDie=!0},1e3),this.body.velocity.set(0,-.001,0),this.body.angularVelocity.set(0,0,0),this._signals.character.reseted.dispatch(e),TweenMax.delayedCall(3,function(){t._state.isDying=!1,t._scene.setView("spawn","fall"===e?10:null),t.animations.play("idle",.4),TweenMax.to(t.obj.rotation,.1,{x:t.obj.baseRot.x,z:t.obj.baseRot.z}),t._canPlayMoveAnimation=!0,t._resetInputs(),t._triggerMoveAnimationInAir()})}},{key:"_resetInputs",value:function(){var e=this;this._jumpForwardOutTimeout&&this._jumpForwardOutTimeout.clear(),this._canJumpForwardTimeout&&this._canJumpForwardTimeout.clear(),this._canDieTimeout&&this._canDieTimeout.clear(),this._isRunning=!1,this._wasRunning=!1,this._isWalking=!1,this._wasWalking=!1,this._isJumping=!1,this._isJumpingForward=!1,this._canJumpForward=!0,this.canDie=!1,this._canDieTimeout=new h.a(function(){e.canDie=!0},1e3)}},{key:"_accelerate",value:function(){if(this._state.actionIsActive)this.body.velocity.x=0,this.body.velocity.z=0;else{this.body.quaternion.toEuler(this._cEuler);var e=this._posAcceleration;this._isJumpingForward&&(e=-1),this._coords=Object(y.g)(e,this._cEuler.y),this._velocityCoefTarget=1,this._isJumping&&(this._velocityCoefTarget="in-place"===this._jumpType?.01:1.3),this._isJumpingForward&&(this._velocityCoefTarget*=1.8),this._velocityCoef+=.25*(this._velocityCoefTarget-this._velocityCoef),this.body.velocity.x=this._coords.y*this._velocityCoef,this.body.velocity.z=this._coords.x*this._velocityCoef}}},{key:"_rotate",value:function(){w.setFromAxisAngle(p.a.Y_UP.c,this._rotAcceleration),this.body.quaternion.copy(w)}},{key:"_groundedTest",value:function(){this._raycaster.set(this.position,p.a.Y_DOWN);var e=this._scene.navMeshes;this._intersects=this._raycaster.intersectObjects(e);var t,n=this._intersects.length;if(n&&(this._intersect=this._intersects[0],t=this._intersect.distance,this._intersect.object.bbox&&(t-=this._intersect.object.bbox.y/2)),!this._state.isDying&&this._intersect&&(!n||3<t)&&((!this._isJumping&&!this._isJumpingForward||5<t&&!this._isJumpingForward)&&(this._isFalling=!0,this._canPlayMoveAnimation=!1,this.animations.play("falling",.4)),10<this.position.y-this._intersect.point.y&&(this._canPlayFallenSprite=!0)),!this._isFalling&&this._isJumping&&"running"===this._jumpType&&1e3<Date.now()-this._jumpNow&&this._onJumpingDone(),n&&t<2.1&&!this._state.isDying){this._isGrounded=!0,this._isFalling&&this._onFallingDone();var o=Date.now()-this._jumpNow,r="running"===this._jumpType?800:1300;this._isJumping&&r<o&&this._onJumpingDone()}else this._isGrounded&&(this._isGrounded=!1);this._wasGrounded=this._isGrounded}},{key:"_jump",value:function(){if(!(this._state.actionIsActive||this._state.isDying||this._isJumping||this._isJumpingForward)&&this._canJumpForward&&this._isGrounded){this._jumpNow=Date.now(),this._canPlayMoveAnimation=!1,this._isJumping=!0,this._jumpAnimation();for(var e=Object(y.j)(0,4);e===this._lastSoundIds.jump;)e=Object(y.j)(0,4);this._lastSoundIds.jump=e,this._sounds.play("jump_".concat(e))}}},{key:"_onJumpingDone",value:function(){this._canPlayMoveAnimation=!0,this._triggerMoveAnimationInAir(),TweenMax.to(this.obj.rotation,.1,{x:this.obj.baseRot.x,z:this.obj.baseRot.z}),this._isJumping=!1}},{key:"_defineSpeed",value:function(){this._runningEnabled=!0,this._speedFactor=1,this._isRunning=!0,this._isGrounded?this._runningEnabled?this._posSpeedMax=this._baseSpeedMax*O.groundedPosMaxSpeed:this._posSpeedMax=this._baseSpeedMax:this._posSpeedMax=this._baseSpeedMax*O.inAirPosMaxSpeed,this._speedFactor*=O.moveAnimationRatio}},{key:"_updatePosition",value:function(e){this._state.actionIsActive||this._isJumpingForward||(this._posAccelerationTgt+=-e,this._posAccelerationTgt=Object(y.a)(this._posAccelerationTgt,-this._posSpeedMax,this._posSpeedMax))}},{key:"_processMoveInputs",value:function(){if(!this._state.actionIsActive&&!this._state.isDying){var e=0,t=0,n=!1;if(c.a.joystickLeftIsMoving)e=c.a.joystickLeft.x,t=c.a.joystickLeft.y,n=!0;else{var o=u.a.isDown("up")||c.a.isDown("d_pad_up"),r=u.a.isDown("down")||c.a.isDown("d_pad_down"),i=u.a.isDown("left")||c.a.isDown("d_pad_left"),a=u.a.isDown("right")||c.a.isDown("d_pad_right");this._keysDowned=o||i||a||r,n=this._keysDowned,i?e=-1:a&&(e=1),o?t=-1:r&&(t=1)}if(n){this._isWalking=!0,this._updatePosition(this._posSpeed*this._speedFactor);var s=-Math.atan2(t,e);this._rotAccelerationTgt=s-this._scene.camera.cameraAngle}}}},{key:"_triggerMoveAnimations",value:function(){!this._state.actionIsActive&&this._canPlayMoveAnimation&&this._canJumpForward&&!this._state.isDying&&(!this._isWalking&&this._wasWalking?this.animations.play("idle",.5):!this._wasWalking&&this._isWalking&&this.animations.play("running",.5))}},{key:"_triggerMoveAnimationInAir",value:function(){if(!this._state.isDying)if(300<Date.now()-this._jumpNow&&(this._signals.character.fallen.dispatch(this._intersect),this._sounds.play("fall-stone-".concat(Object(y.j)(1,2)))),this._isWalking){var e=0;this._isJumpingForward&&(e=.4),this._isJumping&&(e="running"===this._jumpType?.2:.5),this.animations.play("running",.3,e)}else this.animations.play("idle",.5,this._isJumpingForward?.5:0)}},{key:"_jumpAnimation",value:function(){var e=this;clearTimeout(this._jumpTimeout),this._isWalking?(this._jumpType="running",this.animations.play("jump_running_3",.3,0,.7),this._jumpTimeout=setTimeout(function(){TweenMax.to(e.body.velocity,.34,{y:.8,ease:CustomEase.create("custom","M0,0 C0,0 0.148,1 0.5,1 1,1 1,0 1,0")})},50)):(this._jumpType="in-place",this.animations.play("jump_in_place",.1,0,.8),this._jumpTimeout=setTimeout(function(){TweenMax.to(e.body.velocity,.35,{y:.4,ease:CustomEase.create("custom","M0,0 C0,0 -0.008,0.984 0.31,1 0.809,1.025 1,0 1,0")})},600))}},{key:"_jumpForward",value:function(){var e=this;if(!this._isJumping&&!this._isJumpingForward&&this._canJumpForward&&this._isGrounded&&!this._state.isDying){this._canJumpForward=!1,this.animations.play("jump_ninja",.3,0,1.2),this._jumpForwardInTimeout&&this._jumpForwardInTimeout.clear(),this._jumpForwardInTimeout=new h.a(function(){e._isJumpingForward=!0},350),this._jumpForwardOutTimeout&&this._jumpForwardOutTimeout.clear(),this._jumpForwardOutTimeout=new h.a(function(){e._isJumpingForward=!1},1120),this._canJumpForwardOutTimeout&&this._canJumpForwardOutTimeout.clear(),this._canJumpForwardOutTimeout=new h.a(function(){e._canJumpForward=!0,e._triggerMoveAnimationInAir()},1280),this._sounds.play("fall-stone-".concat(Object(y.j)(1,2)));for(var t=Object(y.j)(0,4);t===this._lastSoundIds.jump;)t=Object(y.j)(0,4);this._lastSoundIds.jump=t,this._sounds.play("jump_".concat(t))}}},{key:"_onKeyDown",value:function(e,t){this._state.actionIsActive||this._state.pauseDisplayed||this._jumpBtnDowned||("space"!==t&&"e"!==t||(this._jumpBtnDowned=!0),"space"===t?this._jump():"e"===t&&this._jumpForward())}},{key:"_onKeyUp",value:function(e,t){if(this._state.pauseDisplayed||"space"!==t&&"e"!==t||(this._jumpBtnDowned=!1),u.a.isDown("shift"))if("alt"===t)this._save.set("".concat(this._scene.name,".char_position"),JSON.stringify(this.body.position)),this._signals.toastMsg.log.dispatch("character","#Character - Position saved");else if("t"===t){var n=this._save.get("".concat(this._scene.name,".char_position"));this._signals.konami.cheated.dispatch(),n&&(n=JSON.parse(n),this.setPosition(n,10),this._signals.toastMsg.log.dispatch("character","#Character - Tp to position"))}}},{key:"_onButtonDown",value:function(e){this._state.actionIsActive||this._state.pauseDisplayed||this._jumpBtnDowned||("button_1"!==e&&"button_3"!==e||(this._jumpBtnDowned=!0),"button_1"===e?this._jump():"button_3"===e&&this._jumpForward())}},{key:"_onButtonUp",value:function(e){this._state.actionIsActive||this._state.pauseDisplayed||"button_1"!==e&&"button_3"!==e||(this._jumpBtnDowned=!1)}},{key:"_onPointerDown",value:function(){if(u.a.isDown("shift")){this._signals.konami.cheated.dispatch();var e={x:2*s.a.client.norm.x-1,y:2*-s.a.client.norm.y+1};this._raycaster.setFromCamera(e,this._scene.camera);var t=this._raycaster.intersectObjects(this._scene.navMeshes);if(t.length){var n=t[0];this.setPosition(n.point,10)}}}},{key:"_onPreStep",value:function(){c.a.joystickLeftIsMoving||this._keysDowned||!this._isGrounded||this._isJumpingForward||(this.body.velocity.x*=.001,this.body.velocity.z*=.001),this._state.isDying&&(this.body.velocity.x=0,this.body.velocity.z=0)}},{key:"_onPostStep",value:function(){}},{key:"_onBodyCollide",value:function(e){this._isJumping||this._signals.character.collided.dispatch(e)}},{key:"_onPauseShow",value:function(){this._walkingSound.volume=0,this._jumpForwardOutTimeout&&this._jumpForwardOutTimeout.pause(),this._canJumpForwardTimeout&&this._canJumpForwardTimeout.pause(),this._canDieTimeout&&this._canDieTimeout.pause()}},{key:"_onPauseHide",value:function(){this._jumpForwardOutTimeout&&this._jumpForwardOutTimeout.resume(),this._canJumpForwardTimeout&&this._canJumpForwardTimeout.resume(),this._canDieTimeout&&this._canDieTimeout.resume()}},{key:"_onLaserHit",value:function(){var e=this;if(this.canDie&&!this._state.isDying){this._state.isDying=!0,this.animations.play("enemy_laser",.4,1),this._charReset("laser"),this._scene.camera.shakeFactor=10,this._scene.camera.shakeSpeed=.2,TweenMax.to(this._scene.camera,2,{shakeFactor:0,shakeSpeed:0,ease:Expo.easeIn,delay:.2}),this._sounds.play("laser-hit"),setTimeout(function(){e._sounds.play("laser-death")},120);for(var t=["outch","oh_no","agh"],n=Object(y.j)(0,t.length-1);n===this._lastSoundIds.laser;)n=Object(y.j)(0,t.length-1);this._lastSoundIds.laser=n,this._sounds.play(t[n]),this._narratorCounts.laser%3==0&&setTimeout(function(){e._sounds.play("you_sould_be_more_carefull")},1400),this._narratorCounts.laser++,Object(d.a)("character","character-laser-hit")}}},{key:"_onCameraHit",value:function(){var e=this;if(this.canDie&&!this._state.isDying){this._state.isDying=!0,this.animations.play("enemy_camera",1),this._charReset("camera"),this._scene.camera.shakeFactor=3,this._scene.camera.shakeSpeed=.2,TweenMax.to(this._scene.camera,2,{shakeFactor:0,shakeSpeed:0,ease:Expo.easeIn,delay:.2}),this._sounds.play("camera-hit");for(var t=["agh","oh_no","pfff","rrrr"],n=Object(y.j)(0,t.length-1);n===this._lastSoundIds.laser;)n=Object(y.j)(0,t.length-1);this._lastSoundIds.camera=n,this._sounds.play(t[n]),this._narratorCounts.camera%3==0&&setTimeout(function(){e._sounds.play("smile_camera")},1400),this._narratorCounts.camera++,Object(d.a)("character","character-camera-hit")}}},{key:"_onFall",value:function(){var e=this;this.canDie&&!this._state.isDying&&(this._state.isDying=!0,this._charReset("fall"),this._scene.camera.shakeFactor=3,this._scene.camera.shakeSpeed=.2,TweenMax.to(this._scene.camera,2,{shakeFactor:0,shakeSpeed:0,ease:Expo.easeIn,delay:.2}),this._sounds.play("agh"),setTimeout(function(){e._sounds.play("where_are_you_going")},1e3),Object(d.a)("character","character-fall"))}},{key:"_onLookHit",value:function(){var e=this;if(this.canDie&&!this._state.isDying){this._state.isDying=!0,this.animations.play("enemy_robot",.4),this._charReset("look"),this._scene.camera.shakeFactor=3,this._scene.camera.shakeSpeed=.2,TweenMax.to(this._scene.camera,2,{shakeFactor:0,shakeSpeed:0,ease:Expo.easeIn,delay:.2});for(var t=["agh","oh_no","pfff","rrrr"],n=Object(y.j)(0,t.length-1);n===this._lastSoundIds.laser;)n=Object(y.j)(0,t.length-1);this._lastSoundIds.robot=n,this._sounds.play(t[n]),this._narratorCounts.robot%3==0&&setTimeout(function(){e._sounds.play("oops_trouble")},1400),this._narratorCounts.robot++,Object(d.a)("character","character-lookat-hit")}}},{key:"_onFallingDone",value:function(){TweenMax.to(this.obj.rotation,.1,{x:this.obj.baseRot.x,z:this.obj.baseRot.z}),this._isFalling=!1,this._canPlayMoveAnimation=!0,this._triggerMoveAnimationInAir()}},{key:"update",value:function(e,t){if(this.body){var n=this.obj.children[0].skeleton.bones[0];n.getWorldPosition(this._hipsBonePos),n.getWorldQuaternion(this._hipsBoneRot),this.hitBox&&(this.hitBox.position.copy(this._hipsBonePos),this.hitBox.quaternion.copy(this._hipsBoneRot)),this._posAcceleration+=(this._posAccelerationTgt-this._posAcceleration)*this._posSmoothness,this._rotAcceleration=Object(y.d)(this._rotAcceleration,this._rotAccelerationTgt,.1),this._groundedTest(),this._defineSpeed(),this._isWalking=!1,this._processMoveInputs(),this._triggerMoveAnimations(),this._wasWalking=this._isWalking,this._wasRunning=this._isRunning,c.a.joystickLeftIsMoving||this._keysDowned||(this._posAccelerationTgt=0),this._state.isDying&&this._isFalling||(this._rotate(),this._accelerate()),100<this.body.position.y&&(this.body.position.y=100),this.syncMesh(),this.animations.update(e/1e3*this._speedFactor,t),this.body.position.y<O.heightLimit&&!this._state.isDying&&this._onFall(),this._walkingSound.volume=0,this._isGrounded&&this._isWalking&&!this._isJumpingForward&&(this._walkingSound.volume=.65)}}},{key:"bbox",get:function(){this.updateMatrixWorld();var e=this.skinnedMesh.geometry;return e.computeBoundingBox(),e.boundingBox.applyMatrix4(this.skinnedMesh.matrixWorld),e.boundingBox}}])&&v(t.prototype,o),r&&v(t,r),n}()).prototype,"_onKeyDown",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onKeyDown"),t.prototype),o(t.prototype,"_onKeyUp",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onKeyUp"),t.prototype),o(t.prototype,"_onButtonDown",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onButtonDown"),t.prototype),o(t.prototype,"_onButtonUp",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onButtonUp"),t.prototype),o(t.prototype,"_onPointerDown",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onPointerDown"),t.prototype),o(t.prototype,"_onPreStep",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onPreStep"),t.prototype),o(t.prototype,"_onPostStep",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onPostStep"),t.prototype),o(t.prototype,"_onBodyCollide",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onBodyCollide"),t.prototype),o(t.prototype,"_onPauseShow",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onPauseShow"),t.prototype),o(t.prototype,"_onPauseHide",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onPauseHide"),t.prototype),o(t.prototype,"_onLaserHit",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onLaserHit"),t.prototype),o(t.prototype,"_onCameraHit",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onCameraHit"),t.prototype),o(t.prototype,"_onFall",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onFall"),t.prototype),o(t.prototype,"_onLookHit",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onLookHit"),t.prototype),t);k.a=r}).call(this,E(2).bind)},function(e,s,u){"use strict";(function(e){var t,n=u(8),c=u.n(n),l=u(0),o=u(5);function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function i(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var f=Object(o.d)("CharacterAnimations",o.b,!1),p=Object(o.d)("CharacterAnimations",o.a,!0),a=(i((t=function(){function u(e,t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),this._character=e,this.mixer=new THREE.AnimationMixer(t),this.clipsArray=n,this.clips={},this.actionsArray=[],this.actions={},this.previousAnimation=null,this.currentAnimation=null,this.idleIdx=0,this.idles=["idle_look_happy","idle_look_around","idle_look_bottom"],this.loopAnimations=["idle_look_happy","idle_look_around","idle_look_bottom","running"],this.lockAnimations=["falling","jump_in_place","jump_running_3","jump_ninja_1","jump_ninja_2","enemy_camera","enemy_laser","enemy_robot"],this.excludeAnimations=[],this.mixer.addEventListener("loop",this._handleLoop),this.mixer.addEventListener("finished",this._handleFinish);for(var o=0,r=n.length;o<r;o++){var i=n[o],a=i.name.toLowerCase().replace("character_","");if("tpose"!==(i.name=a)){this.clips[a]=i;var s=this.mixer.clipAction(i);s.enabled=!0,s.setEffectiveWeight(0),-1===this.loopAnimations.indexOf(a)&&(s.loop=THREE.LoopOnce),-1<this.lockAnimations.indexOf(a)&&(s.clampWhenFinished=!0),s.play(),s.name=a,this.actionsArray.push(s),this.actions[a]=s}}this.looped=new c.a,this.finished=new c.a}var e,t,n;return e=u,(t=[{key:"getRandomIdleAnimation",value:function(){var e=this.idleIdx,t=Object(l.j)(0,this.idles.length-1);return e===t?this.getRandomIdleAnimation():(.7<Object(l.h)(0,1)&&(t=e),this.idleIdx=t,this.idles[this.idleIdx])}},{key:"play",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:.5,n=2<arguments.length?arguments[2]:void 0,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1;if("idle"===e&&(e=this.getRandomIdleAnimation()),"jump_ninja"===e){var r=Object(l.j)(1,2);e+="_".concat(r)}if(this.clips[e]||p("Animation '".concat(e,"' does not exist")),this.previousAnimation!==this.currentAnimation&&-1===this.excludeAnimations.indexOf(e)&&(this.previousAnimation=this.currentAnimation),this.currentAnimation=e,this.previousAnimation!==this.currentAnimation)if(this.previousAnimation){var i=this.actions[this.previousAnimation],a=this.actions[this.currentAnimation];f("From '".concat(this.previousAnimation,"' to '").concat(this.currentAnimation,"'")),a.setEffectiveWeight(1),a.enabled=!0,a.paused=!0,a.time=0,a.reset(),a.setEffectiveTimeScale(o),i.fadeOut(n||t),a.fadeIn(t)}else{var s=this.actions[this.currentAnimation];s.setEffectiveWeight(1),s.play()}}},{key:"playPrevious",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:.5;this.play(this.previousAnimation,e)}},{key:"update",value:function(e,t){this.mixer.update(e)}},{key:"_handleLoop",value:function(e){this.looped.dispatch(e),e.action.name===this.currentAnimation&&-1<this.idles.indexOf(this.currentAnimation)&&this.play(this.getRandomIdleAnimation(),1)}},{key:"_handleFinish",value:function(e){this.finished.dispatch(e)}}])&&r(e.prototype,t),n&&r(e,n),u}()).prototype,"update",[e],Object.getOwnPropertyDescriptor(t.prototype,"update"),t.prototype),i(t.prototype,"_handleLoop",[e],Object.getOwnPropertyDescriptor(t.prototype,"_handleLoop"),t.prototype),i(t.prototype,"_handleFinish",[e],Object.getOwnPropertyDescriptor(t.prototype,"_handleFinish"),t.prototype),t);s.a=a}).call(this,u(2).bind)},function(e,O,x){"use strict";(function(e){var t,n,o,i=x(40),a=x(57),s=x(334),u=x(77),c=x(31);function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function f(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function p(e,t,n){return(p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=h(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var v,m,_,g=!0,b={portal_01:{color:9178642,anchor:new THREE.Vector3(13.54,1.45,54.8),route:"/lobby"}},w=(o=n=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=f(this,h(t).call(this,"level-1",{physics:!0,postProcessing:!0})))._resetData={spawn:{charPos:new THREE.Vector3(-6.6,1.43,42.45),charDir:5.94,camDir:-4.31,camPanY:.99},lobby:{charPos:new THREE.Vector3(.8,1.44998,45.81),charDir:-4.68,camDir:7.8508939,camPanY:10}},e}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(t,i["a"]),n=t,(o=[{key:"_init",value:function(){var e=this;p(h(t.prototype),"_init",this).call(this),this._boundInterval=setInterval(function(){e._sounds.play("bond")},1e5),document.title="Laser Game - Plume and the forgotten letter | WebGL game"}},{key:"_unbind",value:function(){clearInterval(this._boundInterval),p(h(t.prototype),"_unbind",this).call(this)}},{key:"_createPostProcessing",value:function(){p(h(t.prototype),"_createPostProcessing",this).call(this)}},{key:"_createEntities",value:function(){p(h(t.prototype),"_createEntities",this).call(this),this.portals=new a.a(this,b),this.addEntity(this.portals),this.laserEnemies=new s.a(this,[{position:new THREE.Vector3(11.6,4,17.88),direction:new THREE.Vector3(-1,0,0),rotation:-Math.PI/2,burn:{position:-.26,scale:23.4},setTl:function(e,t){e.to(t.basePosition,2,{y:.4,ease:Power2.easeOut}).to(t.basePosition,3,{y:4,ease:Power2.easeOut}),e.progress(.4)}},{position:new THREE.Vector3(-11.09,.5,11.79),direction:new THREE.Vector3(1,0,0),rotation:Math.PI/2,burn:{position:.79,scale:23.4},setTl:function(e,t){e.to(t.basePosition,2,{y:4,ease:Power2.easeOut}).to(t.basePosition,2.5,{y:.5,ease:Power2.easeOut}),e.progress(.2)}},{position:new THREE.Vector3(11.6,4,4.2),direction:new THREE.Vector3(-1,0,0),rotation:-Math.PI/2,burn:{position:-.26,scale:23.4},setTl:function(e,t){e.to(t.basePosition,2,{y:.2,ease:Power2.easeOut}).to(t.basePosition,3,{y:4,ease:Power2.easeOut}),e.progress(.5)}},{position:new THREE.Vector3(-11.09,5,-2.15),direction:new THREE.Vector3(1,0,0),rotation:Math.PI/2,burn:{position:.79,scale:23.4},setTl:function(e,t){e.to(t.basePosition,2,{y:.4,ease:Power2.easeOut}).to(t.basePosition,1.8,{y:5,ease:Power2.easeOut}),e.progress(.35)}},{position:new THREE.Vector3(11.6,.4,-8.1),direction:new THREE.Vector3(-1,0,0),rotation:-Math.PI/2,burn:{position:-.26,scale:23.4},setTl:function(e,t){e.to(t.basePosition,1.5,{y:4}).to(t.basePosition,1.9,{y:.4}),e.progress(.7)}},{position:new THREE.Vector3(6,5.7,-13.55),direction:new THREE.Vector3(0,-1,0),burn:{position:-2.46,scale:17.33},setTl:function(e,t){e.to(t.basePosition,8,{x:-11,ease:Power0.easeNone}).to(t.basePosition,8,{x:6,ease:Power0.easeNone}),e.progress(.2)}},{position:new THREE.Vector3(-11,5,-15.8),direction:new THREE.Vector3(0,-1,0),burn:{position:-2.46,scale:17.33},setTl:function(e,t){e.to(t.basePosition,10,{x:6,ease:Power0.easeNone}).to(t.basePosition,10,{x:-11,ease:Power0.easeNone}),e.progress(.3)}},{position:new THREE.Vector3(-11,6,-19.15),direction:new THREE.Vector3(0,-1,0),burn:{position:-2.46,scale:17.33},setTl:function(e,t){e.to(t.basePosition,9,{x:6,ease:Power0.easeNone}).to(t.basePosition,9,{x:-11,ease:Power0.easeNone}),e.progress(.8)}},{position:new THREE.Vector3(-9.9,7,-22.2423),direction:new THREE.Vector3(0,-1,0),burn:{position:0,scale:19.33},setTl:function(e,t){e.to(t.basePosition,9,{x:9.9,ease:Power0.easeNone}).to(t.basePosition,9,{x:-9.9,ease:Power0.easeNone}),e.progress(.35)}},{position:new THREE.Vector3(-6,5.5,-25),direction:new THREE.Vector3(0,-1,0),burn:{position:2.03,scale:16.06},setTl:function(e,t){e.to(t.basePosition,8,{x:9.9,ease:Power0.easeNone}).to(t.basePosition,8,{x:-6,ease:Power0.easeNone}),e.progress(.9)}},{position:new THREE.Vector3(11.85,7.5,-28),direction:new THREE.Vector3(0,-1,0),burn:{position:2.13,scale:20.56},setTl:function(e,t){e.to(t.basePosition,7,{x:-8,ease:Power0.easeNone}).to(t.basePosition,7,{x:11.85,ease:Power0.easeNone}),e.progress(.5)}},{position:new THREE.Vector3(11.85,8,-35),direction:new THREE.Vector3(0,-1,0),burn:{position:8.35,scale:9.08},setTl:function(e,t){e.to(t.basePosition,4,{x:4.02,ease:Power0.easeNone}).to(t.basePosition,4,{x:11.85,ease:Power0.easeNone}),e.progress(.5)}},{position:new THREE.Vector3(11.85,8,-38),direction:new THREE.Vector3(0,-1,0),burn:{position:8.53,scale:7.55},setTl:function(e,t){e.to(t.basePosition,4,{x:4.09,ease:Power0.easeNone}).to(t.basePosition,4,{x:11.85,ease:Power0.easeNone}),e.progress(.2)}},{position:new THREE.Vector3(11.85,8,-43.25),direction:new THREE.Vector3(0,-1,0),burn:{position:6.15,scale:11.68},setTl:function(e,t){e.to(t.basePosition,4,{x:.29,ease:Power0.easeNone}).to(t.basePosition,4,{x:11.85,ease:Power0.easeNone}),e.progress(.8)}}]),this.addEntity(this.laserEnemies),this._state.keys[this.name]||(this.key=new u.a(this,{basePosition:new THREE.Vector3(.71,2.5,-70),diffuse:new THREE.Color(16711680)}),this.addEntity(this.key))}},{key:"_createAudios",value:function(){p(h(t.prototype),"_createAudios",this).call(this,"level-1-theme",1)}},{key:"_afterCreate",value:function(){var e=this;(p(h(t.prototype),"_afterCreate",this).call(this),1<this._state.levelHistory.length)&&("lobby"===this._state.levelHistory[this._state.levelHistory.length-2]&&this.setView("lobby"));g?(g=!1,this._createControlsInstructions()):this._state.keys[this.name]&&(this._noKeyTimeout=setTimeout(function(){e._signals.instructions.show.dispatch("You have already taken the key that is in this room.")},4e3))}},{key:"_createControlsInstructions",value:function(){var e=this;this._instructionsTl=new TimelineMax,this._tls.push(this._instructionsTl),this._instructionsTl.addCallback(function(){e._showInstruction("intro")},3.6).addCallback(function(){e._hideInstruction()},"+=2").addCallback(function(){e._showInstruction("avoid")},"+=1").addCallback(function(){e._sounds.play("bond")},"+=1").addCallback(function(){e._hideInstruction()},"+=6")}},{key:"_showInstruction",value:function(e){var t=c.a.tutorial["level-1"];this._signals.instructions.show.dispatch(t[e])}},{key:"_hideInstruction",value:function(){this._signals.instructions.hide.dispatch()}},{key:"_onPauseShow",value:function(){this._instructionsTl&&this._instructionsTl.pause()}},{key:"_onPauseHide",value:function(){this._instructionsTl&&0<this._instructionsTl.progress()&&this._instructionsTl.progress()<1&&this._instructionsTl.play()}},{key:"_onUpdate",value:function(e,t){this.portals.update(e,t),this.laserEnemies.update(e,t),this.key&&this.key.update(e,t)}}])&&l(n.prototype,o),r&&l(n,r),t}(),_=!0,(m="needsTextures")in(v=n)?Object.defineProperty(v,m,{value:_,enumerable:!0,configurable:!0,writable:!0}):v[m]=_,y((t=o).prototype,"_onPauseShow",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onPauseShow"),t.prototype),y(t.prototype,"_onPauseHide",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onPauseHide"),t.prototype),t);O.a=w}).call(this,x(2).bind)},function(e,t,n){"use strict";var i=n(13),s=n(147),a=n(11);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=new THREE.PlaneBufferGeometry(1,1,1,1);p.addAttribute("uv2",new THREE.BufferAttribute(p.attributes.uv.array,2));var h=null,r=function(e){function r(e,t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(n=c(this,l(r).call(this,e))).config={debug:!1},n._createGUI(),n._closestLasers=[],n._laserCircles=[],n._laserCirclesNb=6,n._angle=0,n._circleCenter=new THREE.Vector3(.71,2.5,-70),h||(h=new a.a({name:"laser_circle_burn",transparent:!0,diffuse:16777215,diffuseMap:n._textures.get("level-1.circle_burn")})),n._circleBurn=new THREE.Mesh(p,h),n._circleBurn.position.copy(n._circleCenter),n._circleBurn.position.y=-.02,n._circleBurn.rotation.x=-Math.PI/2,n._circleBurn.scale.multiplyScalar(20),n.add(n._circleBurn),n._data=t,n._currentLoopIndex=0,n._scene=e,n._entities=[],n._createEntites();var o=function(){for(var e=0,t=n._entities.length;e<t;e++)n._entities[e].raycast()};return o(),setTimeout(function(){o()},100),n._interval=setInterval(function(){o()},500),n}var t,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(r,i["a"]),t=r,(n=[{key:"setSize",value:function(){}},{key:"destroy",value:function(){clearInterval(this._interval);for(var e=0,t=this._entities.length;e<t;e++)this._entities[e].destroy();this._gui.removeFolder(this.guiFolder)}},{key:"_createGUI",value:function(){this.guiFolder=this._gui.addFolder("LaserEnemyEntities")}},{key:"update",value:function(e,t){this._closestLasers=[];for(var n=0,o=this._entities.length;n<o;n++){var r=this._entities[n];Math.abs(this._character.position.z-r.position.z)<2&&this._closestLasers.push(r)}this._closestLasers.length&&(this._currentLoopIndex>=this._closestLasers.length&&(this._currentLoopIndex=0),this._closestLasers[this._currentLoopIndex].raycast(),this._currentLoopIndex++);var i=6+Math.sin(.002*t);this._angle+=3e-4*e,this._angle=this._angle%(2*Math.PI);for(var a=0,s=this._laserCircles.length;a<s;a++){var u=this._laserCircles[a],c=this._circleCenter.x+i*Math.cos(2*Math.PI*a/s+this._angle),l=this._circleCenter.z+i*Math.sin(2*Math.PI*a/s+this._angle);u.basePosition.x=c,u.basePosition.y=7+.4*Math.sin(2*Math.PI*a/s+.002*t),u.basePosition.z=l}for(var f=0,p=this._entities.length;f<p;f++)this._entities[f].update(e,t)}},{key:"_createEntites",value:function(){for(var e=0,t=this._data.length;e<t;e++){var n=this._data[e],o=new s.a(this._scene,this,e,n);o.basePosition.copy(n.position),this.add(o),this._entities.push(o)}for(var r=0,i=this._laserCirclesNb;r<i;r++){var a=new s.a(this._scene,this,r,{position:this._circleCenter,direction:new THREE.Vector3(0,-1,0)});this._laserCircles.push(a),this.add(a),this._entities.push(a)}}}])&&u(t.prototype,n),o&&u(t,o),r}();t.a=r},function(e,t,n){"use strict";var r=n(11);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(e){a(t,e,n[e])})}return t}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],0<=t.indexOf(n)||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],0<=t.indexOf(n)||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function u(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=function(e){function o(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=(t.locked,s(t,["locked"]));return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=u(this,c(o).call(this,i({transparent:!0,useShadowMap:!1},n)))).defines=i({},e.defines,{IS_BURN:!0}),e.uniforms.uBurnMap={value:e._textures.get("level-1.laser_burn")},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(o,r["a"]),o}();t.a=f},function(e,t,n){"use strict";var o=n(11),r=n(0);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(e){s(t,e,n[e])})}return t}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=function(e){function n(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=u(this,c(n).call(this,t))).uniforms=a({},e.uniforms,{uExplode:{value:0},uOffset:{value:Object(r.h)(-100,100)}}),e.defines=a({},e.defines,{IS_LASER_HIT:!0}),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(n,o["a"]),n}();t.a=f},function(e,S,j){"use strict";(function(e){var t,n,o,i=j(40),a=j(57),s=j(338),u=j(77),c=j(31),l=j(14),r=j(23),f=j.n(r),p=j(41),h=j.n(p);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function v(e,t){return!t||"object"!==d(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function m(e,t,n){return(m="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var w,O,x,k=!0,E={portal_01:{anchor:new THREE.Vector3(3.41,1.5,12.9),route:"/lobby"}},P=new THREE.Vector3(0,3,-53),T=(o=n=function(e){function n(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=v(this,_(n).call(this,"level-2",{physics:!0,postProcessing:!0})))._gltf.add("robot_big","level-2.models.robot_big"),e._gltf.add("robot_small","level-2.models.robot_small"),e}var t,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(n,i["a"]),t=n,(o=[{key:"destroy",value:function(){return clearTimeout(this._playTimeout),this._destroyTls(),this._unbind(),this._machineSound&&f.a.destroy("machine"),m(_(n.prototype),"destroy",this).call(this)}},{key:"_init",value:function(){var e=this;m(_(n.prototype),"_init",this).call(this),this._resetData={spawn:{charPos:new THREE.Vector3(-1.06,1.5,3.4),charDir:0,camDir:1.59,camPanY:1.83}},this._quietInterval=setInterval(function(){e._sounds.play("quiet_simon")},12e4),document.title="Engine Room - Plume and the forgotten letter | WebGL game"}},{key:"_unbind",value:function(){clearInterval(this._quietInterval),m(_(n.prototype),"_unbind",this).call(this)}},{key:"_createPostProcessing",value:function(){m(_(n.prototype),"_createPostProcessing",this).call(this)}},{key:"_createEntities",value:function(){m(_(n.prototype),"_createEntities",this).call(this),this.portals=new a.a(this,E),this.addEntity(this.portals);var e=this._loader.get("level-2.json.paths");this.robotEnemies=new s.a(this,e),this.addEntity(this.robotEnemies),this._state.keys[this.name]||(this.key=new u.a(this,{basePosition:new THREE.Vector3(0,2.5,-120),diffuse:new THREE.Color(15787660)}),this.addEntity(this.key))}},{key:"_createAudios",value:function(){m(_(n.prototype),"_createAudios",this).call(this,"level-2-theme",1)}},{key:"_afterCreate",value:function(){var e=this;m(_(n.prototype),"_afterCreate",this).call(this),k?(k=!1,this._createControlsInstructions()):this._state.keys[this.name]&&(this._noKeyTimeout=setTimeout(function(){e._signals.instructions.show.dispatch("You have already taken the key that is in this room.")},4e3)),this._machineSound=this._sounds.createSound({id:"machine",url:"./assets/audios/fx/machine.m4a",loop:!0,volume:.8}),this._playTimeout=setTimeout(function(){e._machineSound.play()},3e3),this._machinePan=this._machineSound.effects.add(h()({maxDistance:55}));var t=l.a.pool.get();t.set(0,0,-1),this._machinePan.setPosition(P),this._machinePan.setOrientation(t.normalize()),t.release()}},{key:"_createControlsInstructions",value:function(){var e=this;this._instructionsTl=new TimelineMax,this._tls.push(this._instructionsTl),this._instructionsTl.addCallback(function(){e._showInstruction("intro")},3.6).addCallback(function(){e._hideInstruction()},"+=2").addCallback(function(){e._showInstruction("avoid")},"+=1").addCallback(function(){e._hideInstruction(),e._sounds.play("quiet_simon")},"+=3")}},{key:"_showInstruction",value:function(e){var t=c.a.tutorial["level-2"];this._signals.instructions.show.dispatch(t[e])}},{key:"_hideInstruction",value:function(){this._signals.instructions.hide.dispatch()}},{key:"_updateSound",value:function(){var e=l.a.pool.get();e.set(0,0,-1),e.applyQuaternion(this.camera.quaternion),this._machinePan.setListenerPosition(this.camera.position),this._machinePan.setListenerOrientation(e.normalize()),e.release()}},{key:"_onPauseShow",value:function(){this._instructionsTl&&this._instructionsTl.pause(),this._machineSound.volume=0}},{key:"_onPauseHide",value:function(){this._instructionsTl&&0<this._instructionsTl.progress()&&this._instructionsTl.progress()<1&&this._instructionsTl.play(),this._machineSound.volume=.8}},{key:"_onUpdate",value:function(e,t){this.portals.update(e,t),this.robotEnemies.update(e,t),this.key&&this.key.update(e,t),this._machineSound&&this._updateSound()}}])&&y(t.prototype,o),r&&y(t,r),n}(),x=!0,(O="needsTextures")in(w=n)?Object.defineProperty(w,O,{value:x,enumerable:!0,configurable:!0,writable:!0}):w[O]=x,b((t=o).prototype,"_onPauseShow",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onPauseShow"),t.prototype),b(t.prototype,"_onPauseHide",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onPauseHide"),t.prototype),t);S.a=T}).call(this,j(2).bind)},function(e,g,b){"use strict";(function(e){var t,i=b(13),a=b(339),s=b(341);function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function l(e,t,n){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var o,r,h,d,y,v,m={path_1_small:{speed:3.3,baseProgress:.05},path_2_small:{speed:2.9,baseProgress:0},path_3_small:{speed:3.3,baseProgress:0},path_4_small:{speed:2.8,baseProgress:0},path_5_small:{speed:3.3,baseProgress:0},path_6_big:{speed:2.8,baseProgress:.5}},_=(o=(t=function(e){function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=c(this,f(o).call(this,e)))._paths=t,n._entities=[],n._bigEntities=[],n._smallEntities=[],n._charHit=!1,n._create(),n._createTls(),n._bind(),n}var t,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(o,i["a"]),t=o,(n=[{key:"destroy",value:function(){clearTimeout(this._resetTimeout),this._unbind();for(var e=0,t=this._entities.length;e<t;e++)this._entities[e].destroy();l(f(o.prototype),"destroy",this).call(this)}},{key:"robotHit",value:function(e){this._charHit||(this._charHit=!0,this._createTls(),this._hitHit.play(0))}},{key:"reset",value:function(){var n=this;clearTimeout(this._resetTimeout),this._charHit=!1,this._resetTimeout=setTimeout(function(){for(var e=0,t=n._entities.length;e<t;e++)n._entities[e].reset()},1e3)}},{key:"update",value:function(e,t){for(var n=0,o=this._entities.length;n<o;n++)this._entities[n].update(e,t)}},{key:"_bind",value:function(){this._signals.shapeOverlay.screenCovered.add(this._onScreenCover)}},{key:"_unbind",value:function(){this._signals.shapeOverlay.screenCovered.remove(this._onScreenCover)}},{key:"_create",value:function(){for(var e=0,t=this._paths.length;e<t;e++){var n=this._paths[e],o=void 0;o=-1<n.name.indexOf("big")?new a.a(this._scene,this,this._paths[e],m[n.name]):new s.a(this._scene,this,this._paths[e],m[n.name]),this.add(o),this._entities.push(o)}}},{key:"_createTls",value:function(){var e=this;this._hitHit=new TimelineMax({paused:!0}),this._tls.push(this._hitHit),this._hitHit.addCallback(function(){e._sounds.play("robot-hit"),e._scene.camera.shakeFactor=1,e._scene.camera.shakeSpeed=3}).addCallback(function(){e._signals.enemies.lookHit.dispatch()},.7)}},{key:"_onScreenCover",value:function(){var e=this;setTimeout(function(){e.reset()},100)}}])&&u(t.prototype,n),r&&u(t,r),o}()).prototype,r="_onScreenCover",h=[e],d=Object.getOwnPropertyDescriptor(t.prototype,"_onScreenCover"),y=t.prototype,v={},Object.keys(d).forEach(function(e){v[e]=d[e]}),v.enumerable=!!v.enumerable,v.configurable=!!v.configurable,("value"in v||v.initializer)&&(v.writable=!0),v=h.slice().reverse().reduce(function(e,t){return t(o,r,e)||e},v),y&&void 0!==v.initializer&&(v.value=v.initializer?v.initializer.call(y):void 0,v.initializer=void 0),void 0===v.initializer&&(Object.defineProperty(o,r,v),v=null),t);g.a=_}).call(this,b(2).bind)},function(e,t,n){"use strict";var r=n(111),i=n(11),a=n(78),s=n(56);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function p(e,t,n){return(p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=h(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d=null,f=function(e){function f(e,t,n,o){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f);return(r=c(this,h(f).call(this,e,t,n,o,20,5)))._type="BigRobot",r._hitLookAtY=-1,r._lookAtFarOffset=.049,r._cone.basePosition.y=4.879,r._createDebugGUI(),r}var t,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(f,r["a"]),t=f,(n=[{key:"destroy",value:function(){p(h(f.prototype),"destroy",this).call(this),this._gui.removeFolder(this._guiFolder)}},{key:"reset",value:function(){p(h(f.prototype),"reset",this).call(this),TweenMax.set(this._cone.basePosition,{y:4.879}),TweenMax.killTweensOf(this._bones.right_should.rotation,{x:!0}),TweenMax.killTweensOf(this._bones.right_elbow.rotation,{x:!0}),TweenMax.killTweensOf(this._bones.right_wrist.rotation,{z:!0})}},{key:"update",value:function(e,t){p(h(f.prototype),"update",this).call(this,e,t),this.isHiting||(this._cone.rotation.x=.6);var n=this._bones,o=(n.belly,n.torso),r=n.neck,i=n.left_should,a=n.right_should,s=n.left_elbow,u=n.right_elbow,c=n.left_wrist,l=n.right_wrist;o.rotation.y=o.baseRot.y+.15*Math.sin(.003*t+o.offset.y),r.rotation.z=r.baseRot.z+.15*Math.sin(.003*t+r.offset.z),this.isHiting||(i.rotation.x=i.baseRot.x+.1*Math.cos(.003*t+i.offset.x),a.rotation.x=a.baseRot.x+.1*Math.sin(.003*t+i.offset.x),s.rotation.x=s.baseRot.x+.05*Math.cos(.003*t+i.offset.x),u.rotation.x=u.baseRot.x+.05*Math.sin(.003*t+i.offset.x),c.rotation.z=c.baseRot.z+.1*Math.sin(.003*t+i.offset.x),l.rotation.z=l.baseRot.z+.1*Math.sin(.003*t+i.offset.x)),this._updateSound()}},{key:"_create",value:function(){var n=this;p(h(f.prototype),"_create",this).call(this);var e=Object(s.a)("level-2.models.robot_big").scene;e.traverse(function(e){if(e instanceof THREE.Bone){var t=e.name.toLowerCase().replace("armature_","");n._bones[t]=e}e.material&&(e.material=new i.a({name:"robot_big",skinning:!0}))});for(var t=e.children.length;t--;){var o=e.children[t];this._group.add(o)}d||(d=new THREE.ConeBufferGeometry(this._radius,this._height,32,1,!0)).rotateX(-Math.PI/2),this._initBones(),this._bones.bassin.rotation.y=-Math.PI,this._initCone(d,new a.a({name:"robot_big_cone"})),this._cone.basePosition=new THREE.Vector3(0,2.6,0),this.body=new CANNON.Body({mass:0,shape:new CANNON.Box(new CANNON.Vec3(1.3,3,1))}),this.body.offsetY=3.2,this.body.added=!1,this._shadow.scale.multiplyScalar(8)}},{key:"_hit",value:function(){this._scene.character.canDie&&(p(h(f.prototype),"_hit",this).call(this),TweenMax.to(this._cone.rotation,1,{x:.3}),TweenMax.to(this._bones.right_should.rotation,1.6,{x:.97,ease:Expo.easeOut}),TweenMax.to(this._bones.right_elbow.rotation,1.6,{x:.175,ease:Expo.easeOut}),TweenMax.to(this._bones.right_wrist.rotation,.5,{z:.8,yoyo:!0,repeat:-1}))}}])&&u(t.prototype,n),o&&u(t,o),f}();t.a=f},function(e,t,n){"use strict";function o(e){for(var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,n=[],o=0,r=e.length;o<r;o+=t)n.push(e.slice(o,o+t));return n}n.d(t,"a",function(){return o})},function(e,t,n){"use strict";var r=n(111),i=n(11),a=n(78),s=n(56);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function f(e,t,n){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d=null,l=function(e){function l(e,t,n,o){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l);return(r=c(this,p(l).call(this,e,t,n,o,20,5)))._xOffset="path_5_small"===n.name?.4:.25,r._type="SmallRobot",r._lookAtFarOffset=.049,r._shadow.position.z=-.15,r._createDebugGUI(),r}var t,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(l,r["a"]),t=l,(n=[{key:"destroy",value:function(){f(p(l.prototype),"destroy",this).call(this),this._gui.removeFolder(this._guiFolder)}},{key:"reset",value:function(){f(p(l.prototype),"reset",this).call(this),TweenMax.set(this._cone.basePosition,{y:2.6})}},{key:"update",value:function(e,t){f(p(l.prototype),"update",this).call(this,e,t),this.isHiting||(this._cone.rotation.x=Math.PI/2+this._bones.hips.rotation.x+this._xOffset);var n=this._bones,o=n.hips,r=n.torso,i=n.neck,a=n.should_left,s=n.should_right,u=n.arm_left,c=n.arm_right;o.rotation.x=o.baseRot.x+.09*Math.sin(.002*t+o.offset.x),r.rotation.y=r.baseRot.y+.15*Math.sin(.003*t+r.offset.y),i.rotation.z=i.baseRot.z+.15*Math.sin(.003*t+i.offset.z),a.rotation.x=a.baseRot.x+.3*Math.cos(.003*t+a.offset.x),u.rotation.x=u.baseRot.x+.15*Math.sin(.003*t+a.offset.x),this.isHiting||(s.rotation.x=s.baseRot.x+.3*Math.sin(.003*t+a.offset.x),c.rotation.x=c.baseRot.x+.15*Math.sin(.003*t+a.offset.x)),this._updateSound()}},{key:"_create",value:function(){var t=this;f(p(l.prototype),"_create",this).call(this);var e=Object(s.a)("level-2.models.robot_small").scene;e.traverse(function(e){e instanceof THREE.Bone&&(t._bones[e.name.toLowerCase()]=e),e.material&&(e.material=new i.a({name:"robot_small",skinning:!0}))});for(var n=e.children.length;n--;){var o=e.children[n];this._group.add(o)}d||(d=new THREE.ConeBufferGeometry(this._radius,this._height,32,1,!0)).rotateX(-Math.PI/2),this._initBones(),this._bones.neck.baseRot.x=.314,this._bones.hips.baseRot.x=-1.33,this._initCone(d,new a.a({name:"robot_small_cone"})),this._cone.basePosition=new THREE.Vector3(0,2.6,0),this.body=new CANNON.Body({mass:0,shape:new CANNON.Box(new CANNON.Vec3(1.3,2,1))}),this.body.offsetY=2.5,this.body.added=!1,this._shadow.scale.multiplyScalar(5)}},{key:"_hit",value:function(){this._scene.character.canDie&&(f(p(l.prototype),"_hit",this).call(this),TweenMax.to(this._cone.basePosition,.3,{y:2.37}),TweenMax.to(this._bones.should_right.rotation,1.6,{x:1,ease:Expo.easeOut}))}}])&&u(t.prototype,n),o&&u(t,o),l}();t.a=l},function(e,S,j){"use strict";(function(e){var t,n,o,r=j(40),i=j(57),a=j(77),s=j(343),c=j(31),l=j(14),u=j(23),f=j.n(u),p=j(41),h=j.n(p);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function v(e,t){return!t||"object"!==d(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function m(e,t,n){return(m="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var w,O,x,k=!0,E={portal_01:{anchor:new THREE.Vector3(6.36,1.4,1.9),route:"/lobby"}},P=[new THREE.Vector3(-10.46,3,-27.8),new THREE.Vector3(60.2,3,-60)],T=(o=n=function(e){function u(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(e=v(this,_(u).call(this,"level-3",{physics:!0,postProcessing:!0})))._fxSounds=[],e._pans=[],e._fxSoundsNames=[],e}var t,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(u,r["a"]),t=u,(n=[{key:"destroy",value:function(){this._unbind(),this._destroyTls(),clearTimeout(this._playTimeout);for(var e=0,t=this._fxSoundsNames.length;e<t;e++)f.a.destroy(this._fxSoundsNames[e]);return m(_(u.prototype),"destroy",this).call(this)}},{key:"_init",value:function(){var e=this;m(_(u.prototype),"_init",this).call(this),this._resetData={spawn:{charPos:new THREE.Vector3(0,1.4,-7),charDir:0,camDir:1.66,camPanY:.99}},this._readyInterval=setInterval(function(){e._sounds.play("i_am_ready")},1e5),document.title="Candy Shop - Plume and the forgotten letter | WebGL game"}},{key:"_unbind",value:function(){clearInterval(this._readyInterval),m(_(u.prototype),"_unbind",this).call(this)}},{key:"_createPostProcessing",value:function(){m(_(u.prototype),"_createPostProcessing",this).call(this)}},{key:"_createEntities",value:function(){m(_(u.prototype),"_createEntities",this).call(this),this.portals=new i.a(this,E),this.addEntity(this.portals),this.cameraEnemies=new s.a(this),this.addEntity(this.cameraEnemies),this._state.keys[this.name]||(this.key=new a.a(this,{basePosition:new THREE.Vector3(53,2.5,-88),diffuse:new THREE.Color(15787660)}),this.addEntity(this.key))}},{key:"_createAudios",value:function(){m(_(u.prototype),"_createAudios",this).call(this,"level-3-theme",1)}},{key:"_afterCreate",value:function(){var n=this;m(_(u.prototype),"_afterCreate",this).call(this),k?(k=!1,this._createControlsInstructions()):this._state.keys[this.name]&&(this._noKeyTimeout=setTimeout(function(){n._signals.instructions.show.dispatch("You have already taken the key that is in this room.")},4e3));for(var e=0,t=P.length;e<t;e++){var o=P[e],r="bubble-".concat(e);this._fxSoundsNames.push(r);var i=this._sounds.createSound({id:r,url:"./assets/audios/fx/bubble.mp3",loop:!0,volume:.4});this._fxSounds.push(i);var a=i.effects.add(h()({maxDistance:25}));this._pans.push(a);var s=l.a.pool.get();s.set(0,0,-1),a.setPosition(o),a.setOrientation(s.normalize()),s.release()}this._playTimeout=setTimeout(function(){for(var e=0,t=n._fxSounds.length;e<t;e++)n._fxSounds[e].play()},3e3)}},{key:"_createControlsInstructions",value:function(){var e=this;this._instructionsTl=new TimelineMax,this._tls.push(this._instructionsTl),this._instructionsTl.addCallback(function(){e._showInstruction("intro")},3.6).addCallback(function(){e._hideInstruction(),e._sounds.play("i_am_ready")},"+=2").addCallback(function(){e._showInstruction("avoid")},"+=1").addCallback(function(){e._hideInstruction()},"+=3")}},{key:"_showInstruction",value:function(e){var t=c.a.tutorial["level-3"];this._signals.instructions.show.dispatch(t[e])}},{key:"_hideInstruction",value:function(){this._signals.instructions.hide.dispatch()}},{key:"_updateSounds",value:function(){var e=l.a.pool.get();e.set(0,0,-1),e.applyQuaternion(this.camera.quaternion);for(var t=0,n=this._pans.length;t<n;t++)this._pans[t].setListenerPosition(this.camera.position),this._pans[t].setListenerOrientation(e.normalize());e.release()}},{key:"_onPauseShow",value:function(){this._instructionsTl&&this._instructionsTl.pause();for(var e=0,t=this._fxSounds.length;e<t;e++)this._fxSounds[e].volume=0}},{key:"_onPauseHide",value:function(){this._instructionsTl&&0<this._instructionsTl.progress()&&this._instructionsTl.progress()<1&&this._instructionsTl.play();for(var e=0,t=this._fxSounds.length;e<t;e++)this._fxSounds[e].volume=.4}},{key:"_onUpdate",value:function(e,t){this.portals.update(e,t),this.cameraEnemies.update(e,t),this.key&&this.key.update(e,t),this._updateSounds()}}])&&y(t.prototype,n),o&&y(t,o),u}(),x=!0,(O="needsTextures")in(w=n)?Object.defineProperty(w,O,{value:x,enumerable:!0,configurable:!0,writable:!0}):w[O]=x,b((t=o).prototype,"_onPauseShow",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onPauseShow"),t.prototype),b(t.prototype,"_onPauseHide",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onPauseHide"),t.prototype),t);S.a=T}).call(this,j(2).bind)},function(e,_,g){"use strict";(function(e){var t,r=g(13),a=g(344);function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function u(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function c(e,t,n){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var o,i,p,h,d,y,v={camera_1:{target:new THREE.Vector3(-3.84,-9.67,-6.53),rotationY:-Math.PI,aTanOffset:{x:Math.PI/2,y:1.72},setTl:function(e,t){e.to(t,2.5,{x:-10,ease:Power2.easeInOut},0).to(t,2.5,{x:-5.78,z:2.24,ease:Power2.easeOut}).to(t,2.5,{x:-3.84,y:-9.67,z:-6.53,ease:Power2.easeInOut})}},camera_2:{target:new THREE.Vector3(-.2,-10.11,6.04),rotationY:-1.55,aTanOffset:{x:-.18,y:1.35},setTl:function(e,t){e.to(t,2.5,{x:5.84,z:9,ease:Power2.easeInOut},.4).to(t,2.5,{x:-.2,y:-10.11,z:6.04,ease:Power2.easeInOut})}},camera_3:{target:new THREE.Vector3(6.32,-10.12,4.62),rotationY:-.52,aTanOffset:{x:-1.1,y:1.3},setTl:function(e,t){e.to(t,2.5,{x:3.35,z:.2,ease:Power2.easeInOut},.4).to(t,3,{x:6.32,y:-10.12,z:4.62,ease:Power2.easeOut})}},camera_4:{target:new THREE.Vector3(.35,-10.12,4.62),rotationY:-.52,aTanOffset:{x:-.81,y:1.3},setTl:function(e,t){e.to(t,1.6,{x:9.63,z:1.55,ease:Power2.easeInOut},.4).to(t,1.6,{x:.35,y:-10.12,z:4.62,ease:Power2.easeOut})}},camera_5:{target:new THREE.Vector3(-17.31,-13.71,5.59),rotationY:-Math.PI,aTanOffset:{x:1.65,y:1.8},setTl:function(e,t){e.to(t,2,{x:-15.51,y:-13.71,z:-2.49,ease:Power3.easeOut}).to(t,2,{x:-17.31,y:-13.71,z:5.59,ease:Power3.easeOut})}},camera_6:{target:new THREE.Vector3(-7.88,-10.12,-6.82),rotationY:-Math.PI,aTanOffset:{x:1.51,y:1.58},setTl:function(e,t){e.to(t,2,{x:-4.29,z:2.9,ease:Power2.easeOut},0).to(t,2,{x:-7.88,y:-10.12,z:-6.82,ease:Power3.easeOut})}}},m=(o=(t=function(e){function i(e,t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=u(this,l(i).call(this,e)))._paths=t,n._entities=[],n._points=[],n._guiFolder=null;var o=n._scene.terrain.points;for(var r in o)0===r.indexOf("camera_")&&n._points.push(o[r]);return n._charHit=!1,n._createGUI(),n._create(),n._createTls(),n._bind(),n}var t,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(i,r["a"]),t=i,(n=[{key:"destroy",value:function(){clearTimeout(this._resetTimeout),this._unbind(),this._destroyGUI();for(var e=0,t=this._entities.length;e<t;e++)this._entities[e].destroy();c(l(i.prototype),"destroy",this).call(this)}},{key:"cameraHit",value:function(e){this._charHit||(this._charHit=!0,this._createTls(),this._hitHit.play(0))}},{key:"reset",value:function(){var n=this;clearTimeout(this._resetTimeout),this._charHit=!1,this._resetTimeout=setTimeout(function(){for(var e=0,t=n._entities.length;e<t;e++)n._entities[e].reset()},1e3)}},{key:"update",value:function(e,t){for(var n=0,o=this._entities.length;n<o;n++)this._entities[n].update(e,t)}},{key:"_bind",value:function(){this._signals.shapeOverlay.screenCovered.add(this._onScreenCover)}},{key:"_unbind",value:function(){this._signals.shapeOverlay.screenCovered.remove(this._onScreenCover)}},{key:"_createGUI",value:function(){this._guiFolder=this._gui.addFolder("Camera enemies")}},{key:"_destroyGUI",value:function(){this._gui.removeFolder(this._guiFolder)}},{key:"_create",value:function(){for(var e=0,t=this._points.length;e<t;e++){var n=this._points[e],o=v[n.name];o.point=n;var r=new a.a(this._scene,this,o);this.add(r),this._entities.push(r)}}},{key:"_createTls",value:function(){var e=this;this._hitHit=new TimelineMax({paused:!0}),this._tls.push(this._hitHit),this._hitHit.addCallback(function(){e._scene.camera.shakeFactor=1,e._scene.camera.shakeSpeed=3}).addCallback(function(){e._signals.enemies.cameraHit.dispatch()},.7)}},{key:"_onScreenCover",value:function(){var e=this;setTimeout(function(){e.reset()},100)}}])&&s(t.prototype,n),o&&s(t,o),i}()).prototype,i="_onScreenCover",p=[e],h=Object.getOwnPropertyDescriptor(t.prototype,"_onScreenCover"),d=t.prototype,y={},Object.keys(h).forEach(function(e){y[e]=h[e]}),y.enumerable=!!y.enumerable,y.configurable=!!y.configurable,("value"in y||y.initializer)&&(y.writable=!0),y=p.slice().reverse().reduce(function(e,t){return t(o,i,e)||e},y),d&&void 0!==y.initializer&&(y.value=y.initializer?y.initializer.call(d):void 0,y.initializer=void 0),void 0===y.initializer&&(Object.defineProperty(o,i,y),y=null),t);_.a=m}).call(this,g(2).bind)},function(e,t,n){"use strict";var i=n(13),a=n(11),s=n(78),u=n(14),c=n(0);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function f(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function p(e,t,n){return(p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=h(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var y=null,v=null,m=null,r=function(e){function r(e,t,n){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(o=f(this,h(r).call(this,e)))._radius=8,o._height=30,o._ctrl=t,o._config=n,o._aTanOffset=n.aTanOffset||{x:-Math.PI/2,y:Math.PI/2},o.basePosition=n.point.position.clone(),o.position.copy(o.basePosition),o._headWPos=new THREE.Vector3,o._target=n.target.clone(),o._lookAtTarget=new THREE.Vector3,o._speed=new THREE.Vector3(Object(c.h)(-1,1),Object(c.h)(-1,1),Object(c.h)(-1,1)),o._offset=new THREE.Vector3(Object(c.h)(-1,1),Object(c.h)(-1,1),Object(c.h)(-1,1)),o._cameraHit=!1,o._guiFolder=null,n.rotationY&&(o.rotation.y=n.rotationY),o._create(),o._createTls(),o._createGUI(),o._bind(),o}var t,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(r,i["a"]),t=r,(n=[{key:"reset",value:function(){this._cameraHit=!1}},{key:"destroy",value:function(){p(h(r.prototype),"destroy",this).call(this)}},{key:"update",value:function(e,t){this._lookAtTarget.copy(this.position).add(this._target);var n=this._lookAtTarget;this._cameraHit&&this._state.isDying?n=this._scene.character.position:this._cameraHit=!1,this._cone.lookAt(n),this._head.getWorldPosition(this._headWPos);var o=Math.atan2(n.x-this._headWPos.x,n.z-this._headWPos.z),r=Math.atan2(n.y-this._headWPos.y,n.y-this._headWPos.y);this._head.rotation.y=(o+this._aTanOffset.x)%(2*Math.PI),this._head.rotation.z=(r+this._aTanOffset.y)%(2*Math.PI);var i=u.a.pool.get(),a=u.a.pool.get();a.copy(this._scene.character.position),a.y-=1.5;var s=i.copy(this._lookAtTarget).sub(this.position).normalize();Object(c.c)(a,this.position,s,this._height,this._radius)&&(this._cameraHit=!0,this._signals.enemies.cameraHit.dispatch()),i.release(),a.release()}},{key:"_bind",value:function(){}},{key:"_unbind",value:function(){}},{key:"_create",value:function(){var e=this._gltf.getObject("terrain","props");y&&v||e.traverse(function(e){"camera_head"===e.name&&(y=e.clone()),"camera_support"===e.name&&(v=e.clone())}),this._head=y.clone(),this._head.offsetRot=new THREE.Euler,this._head.offsetRot.y=-Math.PI/2,this._support=v.clone();var t=new a.a({name:"camera",color:16711680});this._head.material=t,this._support.material=t,this._cam=new THREE.Object3D,this._cam.add(this._head),this._cam.add(this._support),this.add(this._cam),m||(m=new THREE.ConeBufferGeometry(this._radius,this._height,32));var n=new s.a({name:"camera_cone"}),o=new THREE.Mesh(m,n);o.position.z=.5*this._height,o.rotation.x=Math.PI/2*3,this._cone=new THREE.Object3D,this._cone.position.x=.3,this._cone.position.y=.3,this._cone.add(o),this._head.add(this._cone)}},{key:"_createTls",value:function(){this._config.setTl&&(this._tl=new TimelineMax({repeat:-1}),this._tls.push(this._tl),this._config.setTl(this._tl,this._target))}},{key:"_createGUI",value:function(){this._guiFolder=this._ctrl._guiFolder.addFolder(this._config.point.name),this._guiFolder.add(this._target,"x",-20,20,.01),this._guiFolder.add(this._target,"y",-20,20,.01),this._guiFolder.add(this._target,"z",-20,20,.01),this._guiFolder.add(this.rotation,"y",-Math.PI,Math.PI,.01).name("rotation y"),this._guiFolder.add(this._aTanOffset,"x",-Math.PI,Math.PI,.01).name("aTanOffset x"),this._guiFolder.add(this._aTanOffset,"y",-Math.PI,Math.PI,.01).name("aTanOffset y")}}])&&l(t.prototype,n),o&&l(t,o),r}();t.a=r},function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n(7),s=n(10),u=n(346),c=[38,38,40,40,37,39,37,39,66,65],l=["up","up","down","down","left","right","left","right","button_2","button_1"];function o(n){var o=0,r=function(){o=0},i=function(e,t){t===e[o]?o++:r(),o===e.length&&(n(),r())};a.a.downed.add(function(e){var t=e.keyCode;return i(c,t)}),s.a.buttonDowned.add(function(e){return-1!==e.indexOf("button_")?i(l,e):null}),u.a.direction.add(function(e,t){return e.keyCode?null:i(l,t)})}},function(e,f,p){"use strict";(function(e){var t,n=p(8),r=p.n(n),i=p(7),a=p(10);function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function o(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var u={arrow:100,stick:300},c=.5,l=(o((t=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._binded=!1,this._directionEnabled=!0,this._stickEnabled=!0,this._createSignals(),this.bind()}var t,n,o;return t=e,(n=[{key:"bind",value:function(){this._binded||(i.a.downed.add(this._onKeyDown),a.a.buttonDowned.add(this._onButtonDown),a.a.stickLeftMoved.add(this._onStickLeftMove),this._binded=!0)}},{key:"unbind",value:function(){this._binded&&(i.a.downed.remove(this._onKeyDown),a.a.buttonDowned.remove(this._onButtonDown),a.a.stickLeftMoved.remove(this._onStickLeftMove),this._binded=!1)}},{key:"_createSignals",value:function(){this.direction=new r.a,this.validate=new r.a,this.back=new r.a,this.pause=new r.a}},{key:"_throttleDirection",value:function(){var e=this;this._directionEnabled=!1,setTimeout(function(){e._directionEnabled=!0},u.arrow)}},{key:"_throttleStick",value:function(){var e=this;this._stickEnabled=!1,setTimeout(function(){e._stickEnabled=!0},u.stick)}},{key:"_onKeyDown",value:function(e,t,n){if("left"===t||"right"===t||"down"===t||"up"===t){if(!this._directionEnabled)return;this._throttleDirection(),this.direction.dispatch(e,t)}else"enter"===t?this.validate.dispatch(e,t):"esc"===t&&(this.pause.dispatch(e,t),this.back.dispatch(e,t))}},{key:"_onButtonDown",value:function(e,t){if("d_pad_up"===e||"d_pad_down"===e||"d_pad_left"===e||"d_pad_right"===e||"shoulder_top_left"===e||"shoulder_top_right"===e){if(!this._directionEnabled)return;var n=e.replace(/(d_pad_|shoulder_top_)/gi,"");this._throttleDirection(),this.direction.dispatch(t,n)}else"button_1"===e?this.validate.dispatch(t,e):"button_2"===e?this.back.dispatch(t,e):"start"===e&&this.pause.dispatch(t,e)}},{key:"_onStickLeftMove",value:function(e,t){this._stickEnabled&&(t.x<-c?(this._throttleStick(),this.direction.dispatch(e,"left")):t.x>c?(this._throttleStick(),this.direction.dispatch(e,"right")):t.y<-c?(this._throttleStick(),this.direction.dispatch(e,"up")):t.y>c&&(this._throttleStick(),this.direction.dispatch(e,"down")))}}])&&s(t.prototype,n),o&&s(t,o),e}()).prototype,"_onKeyDown",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onKeyDown"),t.prototype),o(t.prototype,"_onButtonDown",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onButtonDown"),t.prototype),o(t.prototype,"_onStickLeftMove",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onStickLeftMove"),t.prototype),t);f.a=new l}).call(this,p(2).bind)},function(e,p,h){"use strict";(function(e){var t,i=h(12),a=h(3);function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function u(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function c(e,t,n){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var r=(o((t=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),u(this,l(t).apply(this,arguments))}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,i["a"]),n=t,(o=[{key:"init",value:function(){this.$name="preloader"}},{key:"mounted",value:function(){"desktop"===a.a.device.type&&(c(l(t.prototype),"mounted",this).call(this),this._bind(),TweenMax.to(this.$els.text,.1,{display:"block",opacity:1,delay:.2}),this._isShown=!0,this._appEl=document.body.querySelector("#application"))}},{key:"_bind",value:function(){this._loader.started.add(this._onStart),this._loader.progressed.add(this._onProgress),this._loader.loaded.once(this._onLoadComplete),this._signals.loader.hide.add(this._hide),this._signals.scene.changed.add(this._onLoadComplete),this._signals.context.initialized.add(this._onContextInit)}},{key:"_show",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this._isShown&&!e||(this._isShown=!0,this.$el.classList.remove("preloader--is-hidden"),this._appEl.classList.remove("cursor-grab"),this._appEl.classList.remove("cursor-grabbing"),this._appEl.classList.add("cursor-loading"))}},{key:"_hide",value:function(){this._isShown&&(this._isShown=!1,this.$el.classList.add("preloader--is-hidden"),this._signals.quality.enter.dispatch(),this._appEl.classList.remove("cursor-loading"))}},{key:"_onContextInit",value:function(){}},{key:"_onStart",value:function(){this._show()}},{key:"_onProgress",value:function(e){TweenMax.to(this.$els.bar,.4,{scaleX:e/100})}},{key:"_onLoadComplete",value:function(){this._hide()}},{key:"template",get:function(){return h(555)}},{key:"components",get:function(){return{}}}])&&s(n.prototype,o),r&&s(n,r),t}()).prototype,"_onContextInit",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onContextInit"),t.prototype),o(t.prototype,"_onStart",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onStart"),t.prototype),o(t.prototype,"_onProgress",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onProgress"),t.prototype),o(t.prototype,"_onLoadComplete",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onLoadComplete"),t.prototype),t);p.a=r}).call(this,h(2).bind)},function(e,t,i){"use strict";var a=i(12);function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function u(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function c(e,t,n){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var o=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),u(this,l(t).apply(this,arguments))}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,a["a"]),n=t,(o=[{key:"init",value:function(){this.$name="gl",this._isInit=!1}},{key:"mounted",value:function(){var e=this;c(l(t.prototype),"mounted",this).call(this),this.$nextTick(function(){e._context.init(e.$el)})}},{key:"beforeDestroy",value:function(){}},{key:"template",get:function(){return i(556)}}])&&s(n.prototype,o),r&&s(n,r),t}();t.a=o},function(e,m,_){"use strict";(function(e){var t,i=_(12),a=_(21),n=_(23),s=_.n(n),u=_(3),c=_(0),l=_(6);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function p(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function h(e,t,n){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function r(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var v=(r((t=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),p(this,d(t).apply(this,arguments))}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(t,i["a"]),n=t,(o=[{key:"init",value:function(){this.$name="quality",this._levels=a.a._availableLevels,this._defaultLevelIdx=this._levels.indexOf(a.a._currentLevel),this._currentLevelIdx=-1}},{key:"mounted",value:function(){var o=this;this._router.beforeEachChanged.once(function(e,t,n){"home"===t.name&&u.a.device.desktop&&(o._registerDOM(),o._bind(),o._createTls(),o._show())})}},{key:"beforeDestroy",value:function(){this._unbind()}},{key:"data",value:function(){return function(r){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},t=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),t.forEach(function(e){var t,n,o;t=r,o=i[n=e],n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o})}return r}({},h(d(t.prototype),"data",this).call(this),{levels:this._levels})}},{key:"enter",value:function(){var e=this;return this._enterTl=new TimelineMax,this._tls.push(this._enterTl),this._enterTl.to(this.$els.title,1,{opacity:1},.9).staggerTo(this.$els.levels,1,{autoAlpha:1},.06,1),this.$els.levels[this._defaultLevelIdx].classList.add("quality__level--is-recommended"),setTimeout(function(){e.$el.classList.remove("quality--is-hidden")},500),this._bindHandlers(),h(d(t.prototype),"enter",this).call(this)}},{key:"leave",value:function(){var e=this;return this._showHome(),setTimeout(function(){e.$el&&e.$el.classList.add("quality--is-hidden")},1e3),h(d(t.prototype),"leave",this).call(this)}},{key:"_show",value:function(){}},{key:"_bind",value:function(){this._signals.quality.enter.add(this.enter)}},{key:"_bindHandlers",value:function(){for(var e=0,t=this.$els.levels.length;e<t;e++){var n=this.$els.levels[e];n.addEventListener("click",this._handleLevelClick,!1),n.addEventListener("mouseenter",this._handleLevelMouseEnter,!1)}}},{key:"_unbind",value:function(){this._signals.quality.enter.remove(this.enter);for(var e=0,t=this.$els.levels.length;e<t;e++){var n=this.$els.levels[e];n.removeEventListener("click",this._handleLevelClick,!1),n.removeEventListener("mouseenter",this._handleLevelMouseEnter,!1)}}},{key:"_registerDOM",value:function(){}},{key:"_createTls",value:function(){this._enterTl=new TimelineMax({paused:!0}),this._leaveTl=new TimelineMax({paused:!0}),this._tls.push(this._enterTl,this._leaveTl),this._levelInTls=[]}},{key:"_createLeaveTl",value:function(e){this._leaveTl=new TimelineMax,this._tls.push(this._leaveTl),this._leaveTl.set(this.$els.levels[e],{color:"#dedede"}).to(this.$els.title,1,{autoAlpha:0});for(var t=0,n=this.$els.levels.length;t<n;t++)t===e?this._leaveTl.to(this.$els.levels[t],1,{scale:1.05,autoAlpha:0},.7):this._leaveTl.to(this.$els.levels[t],.7,{autoAlpha:0},.2)}},{key:"_showHome",value:function(){this._signals.home.show.dispatch()}},{key:"_changeLevel",value:function(e){if(e!==this._currentLevelIdx){this._currentLevelIdx;this._currentLevelIdx=Object(c.f)(e,this._levels.length)}}},{key:"_previousLevel",value:function(){this._changeLevel(this._currentLevelIdx-1)}},{key:"_nextLevel",value:function(){this._changeLevel(this._currentLevelIdx+1)}},{key:"_selectLevel",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this._currentLevelIdx,t=this._levels[e];a.a.level=t,this._signals.quality.selected.dispatch(t),this.$els.levels[e].classList.add("quality__level-is-selected"),this.$el.classList.add("quality--is-leaving"),this._createLeaveTl(e),this._unbind(),this.leave(),this._sounds.get("validate").play(),Object(l.a)("quality","quality-selected",t)}},{key:"_preloadQualityPacks",value:function(){var e=this._save.lastSeenLevelName,t=this._quality.level,n=this._textures.format,o=[];o.push("level-textures-".concat(t,"-").concat(n)),o.push("".concat(e,"-textures-").concat(t,"-").concat(n)),this._loader.load(o)}},{key:"_handleLevelClick",value:function(e){var t=this,n=parseInt(e.currentTarget.getAttribute("data-index"),10);n!==this._currentLevelIdx&&this._changeLevel(n),this._selectLevel(n),s.a.context.resume().then(function(){t._signals.context.audioResume.dispatch()})}},{key:"_handleLevelMouseEnter",value:function(e){var t=parseInt(e.currentTarget.getAttribute("data-index"),10);this._changeLevel(t)}},{key:"_onSceneStart",value:function(){}},{key:"_onDirection",value:function(e,t){"left"===t?this._previousLevel():"right"===t&&this._nextLevel()}},{key:"_onValidate",value:function(e,t){this._selectLevel()}},{key:"template",get:function(){return _(557)}},{key:"components",get:function(){return{}}}])&&f(n.prototype,o),r&&f(n,r),t}()).prototype,"enter",[e],Object.getOwnPropertyDescriptor(t.prototype,"enter"),t.prototype),r(t.prototype,"leave",[e],Object.getOwnPropertyDescriptor(t.prototype,"leave"),t.prototype),r(t.prototype,"_handleLevelClick",[e],Object.getOwnPropertyDescriptor(t.prototype,"_handleLevelClick"),t.prototype),r(t.prototype,"_handleLevelMouseEnter",[e],Object.getOwnPropertyDescriptor(t.prototype,"_handleLevelMouseEnter"),t.prototype),r(t.prototype,"_onSceneStart",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onSceneStart"),t.prototype),r(t.prototype,"_onDirection",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onDirection"),t.prototype),r(t.prototype,"_onValidate",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onValidate"),t.prototype),t);m.a=v}).call(this,_(2).bind)},function(e,v,m){"use strict";(function(e){var t,i=m(12);function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function s(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function u(e,t,n){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var o,r,f,p,h,d,y=(o=(t=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),s(this,c(t).apply(this,arguments))}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(t,i["a"]),n=t,(o=[{key:"init",value:function(){this.$name="toast-msg"}},{key:"mounted",value:function(){u(c(t.prototype),"mounted",this).call(this),this._bind()}},{key:"_bind",value:function(){this._signals.toastMsg.log.add(this._log)}},{key:"_log",value:function(e,t){var n=this,o=document.createElement("li");o.classList.add("toast-msg__el"),o.classList.add("toast-msg__el--".concat(e)),this.$el.appendChild(o),t=(t=(t=(t=(t=(t=t.replace(/(#[a-zA-Z0-9\-_]+)/g,'<span class="title">$1</span>')).replace("true",'<span class="true">true<span>')).replace("false",'<span class="false">false<span>')).replace("undefined",'<span class="undefined">undefined<span>')).replace("connected",'<span class="connected">connected<span>')).replace("disconnected",'<span class="disconnected">disconnected<span>'),o.innerHTML='\n      <div class="toast-msg__el-container">\n        <p class="toast-msg__text">'.concat(t,"</p>\n      </div>\n    "),setTimeout(function(){o.classList.add("toast-msg__el--is-entering")},150),setTimeout(function(){o.classList.add("toast-msg__el--is-leaving")},4500),setTimeout(function(){n.$el.removeChild(o)},5e3)}},{key:"template",get:function(){return m(558)}},{key:"components",get:function(){return{}}}])&&a(n.prototype,o),r&&a(n,r),t}()).prototype,r="_log",f=[e],p=Object.getOwnPropertyDescriptor(t.prototype,"_log"),h=t.prototype,d={},Object.keys(p).forEach(function(e){d[e]=p[e]}),d.enumerable=!!d.enumerable,d.configurable=!!d.configurable,("value"in d||d.initializer)&&(d.writable=!0),d=f.slice().reverse().reduce(function(e,t){return t(o,r,e)||e},d),h&&void 0!==d.initializer&&(d.value=d.initializer?d.initializer.call(h):void 0,d.initializer=void 0),void 0===d.initializer&&(Object.defineProperty(o,r,d),d=null),t);v.a=y}).call(this,m(2).bind)},function(e,h,d){"use strict";(function(e){var t,i=d(12),n=d(5);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function s(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function u(e,t,n){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function r(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var f=Object(n.d)("Instructions","#fd79a8",!1),p=(r((t=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),s(this,c(t).apply(this,arguments))}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(t,i["a"]),n=t,(o=[{key:"init",value:function(){this.$name="instructions"}},{key:"mounted",value:function(){u(c(t.prototype),"mounted",this).call(this),this._bind()}},{key:"beforeDestroy",value:function(){u(c(t.prototype),"beforeDestroy",this).call(this),this._unbind()}},{key:"_createTl",value:function(e){}},{key:"_bind",value:function(){this._signals.instructions.show.add(this._show),this._signals.instructions.hide.add(this._hide),this._signals.character.reseted.add(this._onCharReset)}},{key:"_unbind",value:function(){this._signals.instructions.show.remove(this._show),this._signals.instructions.hide.remove(this._hide),this._signals.character.reseted.remove(this._onCharReset)}},{key:"_show",value:function(e){var t=e.match(/\[\[[a-zA-Z0-9-]*\]\]/g);if(t)for(var n=0,o=t.length;n<o;n++){var r=t[n],i=r.replace("[[","").replace("]]","").toLowerCase();e=e.replace(r,'<span class="introduction__input introduction__input--'.concat(i,'"></span>'))}this.$els.text.innerHTML=e,this.$el.classList.add("instructions--is-visible"),this._sounds.play("helper"),f("Show",e)}},{key:"_hide",value:function(){this.$el.classList.remove("instructions--is-visible"),f("Hide")}},{key:"_onCharReset",value:function(){this._hide()}},{key:"template",get:function(){return d(559)}},{key:"components",get:function(){return{}}}])&&a(n.prototype,o),r&&a(n,r),t}()).prototype,"_show",[e],Object.getOwnPropertyDescriptor(t.prototype,"_show"),t.prototype),r(t.prototype,"_hide",[e],Object.getOwnPropertyDescriptor(t.prototype,"_hide"),t.prototype),r(t.prototype,"_onCharReset",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onCharReset"),t.prototype),t);h.a=p}).call(this,d(2).bind)},function(e,p,h){"use strict";(function(e){var t,i=h(12),a=h(6);function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function u(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function c(e,t,n){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var r=(o((t=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),u(this,l(t).apply(this,arguments))}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,i["a"]),n=t,(o=[{key:"init",value:function(){this.$name="sound-bars",this.isActive=!0}},{key:"mounted",value:function(){c(l(t.prototype),"mounted",this).call(this),this._bind()}},{key:"_createTls",value:function(){}},{key:"_bind",value:function(){this._signals.loader.hide.add(this._onLoaderHide),this.$el.addEventListener("click",this._handleClick,!1)}},{key:"_handleClick",value:function(){this.isActive=!this.isActive,this.$el.classList.toggle("sound-bars--is-active",this.isActive),this.isActive?this._sounds.unmute():this._sounds.mute();var e=this.isActive?"unmute":"mute";Object(a.a)("sound","sound-".concat(e))}},{key:"_onLoaderStart",value:function(){}},{key:"_onLoaderHide",value:function(){this.$el.classList.add("sound-bars--is-visible")}},{key:"template",get:function(){return h(560)}},{key:"components",get:function(){return{}}}])&&s(n.prototype,o),r&&s(n,r),t}()).prototype,"_handleClick",[e],Object.getOwnPropertyDescriptor(t.prototype,"_handleClick"),t.prototype),o(t.prototype,"_onLoaderStart",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onLoaderStart"),t.prototype),o(t.prototype,"_onLoaderHide",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onLoaderHide"),t.prototype),t);p.a=r}).call(this,h(2).bind)},function(e,d,y){"use strict";(function(e){var t,i=y(12),a=y(1),s=y(10),u=y(6);function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function l(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function f(e,t,n){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var r=(o((t=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),l(this,p(t).apply(this,arguments))}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(t,i["a"]),n=t,(o=[{key:"init",value:function(){this.$name="fullscreen"}},{key:"mounted",value:function(){f(p(t.prototype),"mounted",this).call(this),this._bind()}},{key:"_createTls",value:function(){}},{key:"_bind",value:function(){this._signals.loader.hide.add(this._onLoaderHide),this.$el.addEventListener("click",this._handleClick,!1),a.a.fullScreenChanged.add(this._onWindowFullscreenChange),s.a.buttonDowned.add(this._onButtonDown)}},{key:"_handleClick",value:function(){a.a.fullScreen.toggle()}},{key:"_onWindowFullscreenChange",value:function(){this.$el.classList.toggle("fullscreen--is-active",a.a.fullScreen.isFullscreen);var e=a.a.fullScreen.isFullscreen?"on":"off";Object(u.a)("fullscreen","fullscreen-".concat(e))}},{key:"_onLoaderStart",value:function(){this.$el.classList.remove("fullscreen--is-visible")}},{key:"_onLoaderHide",value:function(){this.$el.classList.add("fullscreen--is-visible")}},{key:"_onButtonDown",value:function(e){}},{key:"template",get:function(){return y(561)}},{key:"components",get:function(){return{}}}])&&c(n.prototype,o),r&&c(n,r),t}()).prototype,"_handleClick",[e],Object.getOwnPropertyDescriptor(t.prototype,"_handleClick"),t.prototype),o(t.prototype,"_onWindowFullscreenChange",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onWindowFullscreenChange"),t.prototype),o(t.prototype,"_onLoaderStart",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onLoaderStart"),t.prototype),o(t.prototype,"_onLoaderHide",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onLoaderHide"),t.prototype),o(t.prototype,"_onButtonDown",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onButtonDown"),t.prototype),t);d.a=r}).call(this,y(2).bind)},function(e,p,h){"use strict";(function(e){var t,i=h(12),a=(h(1),h(10));h(6);function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function u(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function c(e,t,n){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var r=(o((t=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),u(this,l(t).apply(this,arguments))}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,i["a"]),n=t,(o=[{key:"init",value:function(){this.$name="gamepad-infos"}},{key:"mounted",value:function(){var e=this;this._initNow=Date.now(),c(l(t.prototype),"mounted",this).call(this),this._showPlayed=!1,this._bind(),this._createTls(),window.connected=this._onGamepadConnect,window.disconnected=this._onGamepadDisconnect,setTimeout(function(){!e._showPlayed&&a.a.isConnected&&e._showTl.play()},3e3)}},{key:"_createTls",value:function(){}},{key:"_bind",value:function(){a.a.connected.add(this._onGamepadConnect),a.a.disconnected.add(this._onGamepadDisconnect)}},{key:"_createTls",value:function(){var e=this;this._showTl=new TimelineMax({paused:!0}),this._showTl.addCallback(function(){e._showPlayed=!0,e._sounds.play("helper")}).set(this.$el,{autoAlpha:0,y:100},0).set(this.$els.msg,{opacity:0},0).to(this.$el,1,{autoAlpha:1,y:0,ease:Elastic.easeOut.config(.2)},.1).to(this.$els.msg,.3,{opacity:1,repeat:3},.5).to(this.$el,1,{autoAlpha:0,y:100,ease:Elastic.easeIn.config(.2)},2)}},{key:"_onGamepadConnect",value:function(){var e=this;clearTimeout(this._showTimeout),this.$el.classList.remove("gamepad-infos--is-disconnected"),this.$els.msg.innerHTML="Gamepad connected",Date.now()-this._initNow<2e3?this._showTimeout=setTimeout(function(){e._showTl.play(0)},2e3):this._showTl.play(0)}},{key:"_onGamepadDisconnect",value:function(){clearTimeout(this._showTimeout),this.$el.classList.add("gamepad-infos--is-disconnected"),this.$els.msg.innerHTML="Gamepad disconnected",this._showTl.play(0)}},{key:"template",get:function(){return h(562)}},{key:"components",get:function(){return{}}}])&&s(n.prototype,o),r&&s(n,r),t}()).prototype,"_onGamepadConnect",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onGamepadConnect"),t.prototype),o(t.prototype,"_onGamepadDisconnect",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onGamepadDisconnect"),t.prototype),t);p.a=r}).call(this,h(2).bind)},function(e,h,d){"use strict";(function(e){var t,i=d(12),n=d(20),a=d.n(n),s=d(6);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function r(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var p=(r((t=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),c(this,l(t).apply(this,arguments))}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,i["a"]),n=t,(o=[{key:"init",value:function(){this.$name="gamepad-infos"}},{key:"mounted",value:function(){var e=this;this._initNow=null,this._isActivated=!1,this._cheat=!1,this._completed=!1,this._signals.konami.toggle.add(this._onKonami),this._signals.konami.cheated.add(this._onCheat),this._signals.konami.completed.add(this._onComplete),this._signals.home.ctaValidated.add(this._onCTAValidate),window.speedrun=window.konami=function(){e._onKonami()}}},{key:"_bind",value:function(){this._binded||(this._binded=!0,this._cheat||a.a.add(this._onUpdate))}},{key:"_unbind",value:function(){this._binded&&(this._binded=!1,a.a.remove(this._onUpdate))}},{key:"_show",value:function(){this._isActivated=!0,this._bind(),TweenMax.fromTo(this.$els.text,1,{opacity:0,z:500},{opacity:1,z:0,ease:Elastic.easeOut.config(.4)}),Object(s.a)("speedrun","speedrun-show")}},{key:"_hide",value:function(){var e=this;this._isActivated=!1,TweenMax.to(this.$els.text,1,{opacity:0,z:500,ease:Elastic.easeIn.config(.4),onComplete:function(){e._unbind()}}),Object(s.a)("speedrun","speedrun-hide")}},{key:"_format",value:function(e){var t=parseInt(e%1e3/100),n=parseInt(e/1e3%60),o=parseInt(e/6e4%60),r=parseInt(e/36e5%24);return(r=r<10?"0"+r:r)+":"+(o=o<10?"0"+o:o)+":"+(n=n<10?"0"+n:n)+":"+t+"0"}},{key:"_onCheat",value:function(){this._cheat=!0,this._unbind(),this.$els.text.innerHTML="UC:HE:AT:ED",Object(s.a)("speedrun","speedrun-cheat")}},{key:"_onCTAValidate",value:function(){this.$el.classList.remove("speedrun--is-done"),this._completed=!1,this._initNow=Date.now(),this._cheat=!1,this._isActivated&&this._bind()}},{key:"_onKonami",value:function(){this._isActivated?this._hide():this._show()}},{key:"_onComplete",value:function(){this._completed=!0,this._cheat||(this.$el.classList.add("speedrun--is-done"),console.log("SPEERUN COMPLETED: "+this.$els.text.innerHTML)),Object(s.a)("speedrun","speedrun-complete",this.$els.text.innerHTML)}},{key:"_onUpdate",value:function(e,t){if(this._initNow&&!this._completed){var n=this._format(Date.now()-this._initNow);this.$els.text.innerHTML=n}}},{key:"template",get:function(){return d(563)}},{key:"components",get:function(){return{}}}])&&u(n.prototype,o),r&&u(n,r),t}()).prototype,"_onCheat",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onCheat"),t.prototype),r(t.prototype,"_onCTAValidate",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onCTAValidate"),t.prototype),r(t.prototype,"_onKonami",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onKonami"),t.prototype),r(t.prototype,"_onComplete",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onComplete"),t.prototype),r(t.prototype,"_onUpdate",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onUpdate"),t.prototype),t);h.a=p}).call(this,d(2).bind)},function(e,g,b){"use strict";(function(e){var t,i=b(54),a=b(10),n=b(20),s=b.n(n),u=b(112),c=b(113),l=b(6),o=b(357),f=b.n(o);function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function h(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function d(e,t,n){return(d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=y(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var _=(m((t=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=h(this,y(t).apply(this,arguments))).$name="home",e._isShown=!1,e._introIsShown=!1,e._isSkipped=!1,e._contextResumed=!1,e}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(t,i["a"]),n=t,(o=[{key:"data",value:function(){return function(r){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},t=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),t.forEach(function(e){var t,n,o;t=r,o=i[n=e],n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o})}return r}({},d(y(t.prototype),"data",this))}},{key:"getDependencies",value:function(e){return d(y(t.prototype),"getDependencies",this).call(this)}},{key:"ready",value:function(){d(y(t.prototype),"ready",this).call(this),this._quality.haveBeenSet&&this._show()}},{key:"mounted",value:function(){this._currentSubIndex=0,this._subs=Object(c.parse)(f.a),this._currentSub=this._subs[0],this._sounds.create("home"),this._bind(),Object(l.b)("/")}},{key:"beforeDestroy",value:function(){clearTimeout(this._showTimeout),clearTimeout(this._pauseTimeout),this._gamepadTl&&this._gamepadTl.kill(),this._unbind(),d(y(t.prototype),"beforeDestroy",this).call(this)}},{key:"beforeRouteLeave",value:function(e,t,n){n()}},{key:"_bind",value:function(){var e=this;setTimeout(function(){a.a.connected.add(e._onGamepadConnected)},0),this._signals.home.show.add(this._show),this.$els.cta.addEventListener("click",this._handleCTAClick),this.$els.cta.addEventListener("mouseenter",this._handleCTAMouseEnter),this.$els.cta.addEventListener("mouseleave",this._handleCTAMouseLeave),this.$els.skip.addEventListener("click",this._handleSkipClick),this.$els.video.addEventListener("ended",this._handleVideoEnd)}},{key:"_unbind",value:function(){clearTimeout(this._startTimeout),a.a.connected.remove(this._onGamepadConnected),a.a.buttonDowned.remove(this._onButtonDown),this._signals.home.show.remove(this._show),this.$els.cta.removeEventListener("click",this._handleCTAClick),this.$els.cta.removeEventListener("mouseenter",this._handleCTAMouseEnter),this.$els.cta.removeEventListener("mouseleave",this._handleCTAMouseLeave),this.$els.skip.removeEventListener("click",this._handleSkipClick),this.$els.video.removeEventListener("ended",this._handleVideoEnd),s.a.remove(this._onSubUpdate)}},{key:"_show",value:function(){var e=this;this._isShown||(this._isShown=!0,this._showTimeout=setTimeout(function(){e._startTimeout=setTimeout(function(){a.a.buttonDowned.add(e._onButtonDown)},4e3),TweenMax.to(e.$els.cta,.6,{autoAlpha:1,delay:3}),TweenMax.to(e.$els.cta,1,{scaleX:1,delay:3,ease:Elastic.easeOut.config(.3)}),TweenMax.to(e.$els.cta,1.1,{scaleY:1,delay:3.1,ease:Elastic.easeOut.config(.3)}),TweenMax.to(e.$els.xmas,2,{autoAlpha:1,delay:2}),TweenMax.fromTo(e.$els.decoLeft,1,{autoAlpha:0,x:"400%"},{autoAlpha:1,x:"-50%",ease:Elastic.easeOut.config(.25),delay:3.3}),TweenMax.fromTo(e.$els.decoRight,1,{autoAlpha:0,x:"-400%"},{autoAlpha:1,x:"-50%",ease:Elastic.easeOut.config(.25),delay:3.3}),e._gamepadTl=new TimelineMax,e._gamepadTl.fromTo(e.$els.gamepad,.3,{opacity:0},{opacity:1},3.5).fromTo(e.$els.gamepad,.3,{opacity:0},{opacity:1}).fromTo(e.$els.gamepad,1,{opacity:0},{opacity:1}),e._switchScene(e.$name)},1e3))}},{key:"_showIntro",value:function(){var e=this;this._introIsShown||(this._introIsShown=!0,this.$el.classList.add("home--is-intro"),this._gamepadTl&&this._gamepadTl.pause(),TweenMax.to(this.$els.skip,1.5,{x:"-50%",y:0,autoAlpha:1,ease:Expo.easeOut,delay:3}),TweenMax.to(this.$els.cta,1,{scale:0,ease:Expo.easeOut,delay:.2}),TweenMax.to(this.$els.decoLeft,.3,{opacity:0,x:"300%",ease:Expo.easeOut}),TweenMax.to(this.$els.decoRight,.3,{opacity:0,x:"-300%",ease:Expo.easeOut}),TweenMax.to(this.$els.xmas,.7,{autoAlpha:0}),TweenMax.to(this.$els.gamepad,.7,{autoAlpha:0}),this.$els.cta.style.clipPath="polygon(50% 50%, 50% 50%, 50% 50%, 50% 50%)",this.$els.cta.style.webkitClipPath=this.$els.cta.style.clipPath,this._pauseTimeout=setTimeout(function(){e.$els.video.play(),e._context.sceneManager.pause("home"),e._signals.overlay.show.dispatch()},2e3),this._sounds.get("main-theme").fade(0,1),this._sounds.get("wind").fade(0,1),this._sounds.get("play").play(),this._sounds.get("woosh").play(),s.a.add(this._onSubUpdate),Object(l.a)("intro","intro-start"))}},{key:"_handleCTAClick",value:function(){this._introIsShown||(this._signals.home.ctaValidated.dispatch(),this._showIntro())}},{key:"_handleCTAMouseEnter",value:function(){this._signals.home.ctaEntered.dispatch()}},{key:"_handleCTAMouseLeave",value:function(){this._signals.home.ctaLeaved.dispatch()}},{key:"_handleSkipClick",value:function(){var e=this;this._isSkipped||(this._isSkipped=!0,this.$els.skip.style.transition=null,this._signals.overlay.show.dispatch(),this._sounds.get("validate").play(),TweenMax.to(this.$els.skip,.5,{scale:1.3,autoAlpha:0,onComplete:function(){e._router.navigate("/lobby")}}),Object(l.a)("intro","intro-skip"))}},{key:"_handleVideoEnd",value:function(){this._router.navigate("/lobby")}},{key:"_handleClick",value:function(){this._contextResumed}},{key:"_onGamepadConnected",value:function(){this._gamepadTl&&this._gamepadTl.pause(),TweenMax.to(this.$els.gamepad,.7,{autoAlpha:0})}},{key:"_onButtonDown",value:function(e){this._introIsShown||"start"!==e||(this._signals.home.ctaValidated.dispatch(),this._showIntro())}},{key:"_onSubUpdate",value:function(e,t){var n=1e3*this.$els.video.currentTime;if(this._currentSub){var o=this._currentSub,r=o.start,i=o.end,a=o.text;i<=n&&this._subIsActive?(this._subIsActive=!1,this._currentSubIndex++,this._signals.subtitles.remove.dispatch(),this._currentSub=this._subs[this._currentSubIndex]):r<=n&&!this._subIsActive&&(this._subIsActive=!0,this._signals.subtitles.add.dispatch(a))}}},{key:"template",get:function(){return b(565)}},{key:"components",get:function(){return{Subtitles:u.a}}}])&&p(n.prototype,o),r&&p(n,r),t}()).prototype,"_show",[e],Object.getOwnPropertyDescriptor(t.prototype,"_show"),t.prototype),m(t.prototype,"_handleCTAClick",[e],Object.getOwnPropertyDescriptor(t.prototype,"_handleCTAClick"),t.prototype),m(t.prototype,"_handleCTAMouseEnter",[e],Object.getOwnPropertyDescriptor(t.prototype,"_handleCTAMouseEnter"),t.prototype),m(t.prototype,"_handleCTAMouseLeave",[e],Object.getOwnPropertyDescriptor(t.prototype,"_handleCTAMouseLeave"),t.prototype),m(t.prototype,"_handleSkipClick",[e],Object.getOwnPropertyDescriptor(t.prototype,"_handleSkipClick"),t.prototype),m(t.prototype,"_handleVideoEnd",[e],Object.getOwnPropertyDescriptor(t.prototype,"_handleVideoEnd"),t.prototype),m(t.prototype,"_handleClick",[e],Object.getOwnPropertyDescriptor(t.prototype,"_handleClick"),t.prototype),m(t.prototype,"_onGamepadConnected",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onGamepadConnected"),t.prototype),m(t.prototype,"_onButtonDown",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onButtonDown"),t.prototype),m(t.prototype,"_onSubUpdate",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onSubUpdate"),t.prototype),t);g.a=_}).call(this,b(2).bind)},function(e,t){e.exports="1\n00:00:00,340 --\x3e 00:00:02,560\nPlume, is a seven years old girl.\n\n2\n00:00:02,900 --\x3e 00:00:04,480\nShe loves Christmas,\n\n3\n00:00:04,640 --\x3e 00:00:06,640\nand especially her gifts.\n\n4\n00:00:07,980 --\x3e 00:00:10,100\nShe is never far from her plush,\n\n5\n00:00:10,120 --\x3e 00:00:11,460\nDinosaur Simon.\n\n6\n00:00:12,720 --\x3e 00:00:13,560\nBut this year,\n\n7\n00:00:13,900 --\x3e 00:00:16,720\nPlume forgot to post her letter to Santa Claus.\n\n8\n00:00:17,360 --\x3e 00:00:19,820\nShe then decides, to go to Santa's workshop,\n\n9\n00:00:19,820 --\x3e 00:00:22,820\nto put her letter on his desk herself.\n\n"},function(e,y,v){"use strict";(function(e){var t,i=v(114),a=v(6);function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function u(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(e){r(t,e,n[e])})}return t}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function l(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function f(e,t,n){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var d=(o((t=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=l(this,p(t).apply(this,arguments))).$name="lobby",e.sceneName=e.$name,e}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(t,i["a"]),n=t,(o=[{key:"data",value:function(){return u({},f(p(t.prototype),"data",this))}},{key:"ready",value:function(){f(p(t.prototype),"ready",this).call(this),this._bind()}},{key:"mounted",value:function(){f(p(t.prototype),"mounted",this).call(this),Object(a.b)("/lobby")}},{key:"beforeDestroy",value:function(){f(p(t.prototype),"beforeDestroy",this).call(this),this._unbind(),this._signals.instructions.hide.dispatch()}},{key:"getDependencies",value:function(e){return s(f(p(t.prototype),"getDependencies",this).call(this,e))}},{key:"_bind",value:function(){this._signals.lobby.showLockMsg.add(this._showLockMsg),this._signals.pause.shown.add(this._onPauseShow),this._signals.pause.hidden.add(this._onPauseHide)}},{key:"_unbind",value:function(){this._signals.lobby.showLockMsg.remove(this._showLockMsg),this._signals.pause.shown.remove(this._onPauseShow),this._signals.pause.hidden.remove(this._onPauseHide)}},{key:"_showLockMsg",value:function(){var e=this;this._lockMsgTl=new TimelineMax,this._tls.push(this._lockMsgTl),this._lockMsgTl.addCallback(function(){e._sounds.play("helper")}).fromTo(this.$els.msg,.2,{autoAlpha:0},{autoAlpha:1}).fromTo(this.$els.msg,.2,{autoAlpha:0},{autoAlpha:1}).fromTo(this.$els.msg,.5,{autoAlpha:0,scale:1.2},{autoAlpha:1,scale:1}).to(this.$els.msg,.5,{autoAlpha:0,scale:1.2},7)}},{key:"_onPauseShow",value:function(){this._lockMsgTl&&this._lockMsgTl.pause()}},{key:"_onPauseHide",value:function(){this._lockMsgTl&&this._lockMsgTl.progress()<1&&this._lockMsgTl.play()}},{key:"template",get:function(){return v(573)}},{key:"components",get:function(){return u({},f(p(t.prototype),"components",this))}}])&&c(n.prototype,o),r&&c(n,r),t}()).prototype,"_showLockMsg",[e],Object.getOwnPropertyDescriptor(t.prototype,"_showLockMsg"),t.prototype),o(t.prototype,"_onPauseShow",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onPauseShow"),t.prototype),o(t.prototype,"_onPauseHide",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onPauseHide"),t.prototype),t);y.a=d}).call(this,v(2).bind)},function(e,g,b){"use strict";(function(e){var t,i=b(12),a=(b(1),b(10)),s=b(7),n=b(20),u=b.n(n),c=b(0),l=b(6),f=b(115),p=b(116);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function d(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function y(e,t,n){return(y="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=v(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function r(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var _=(r((t=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),d(this,v(t).apply(this,arguments))}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(t,i["a"]),n=t,(o=[{key:"init",value:function(){this.$name="pause"}},{key:"mounted",value:function(){var e=this;y(v(t.prototype),"mounted",this).call(this),this._registerDOM(),this._state.pauseDisplayed=!1,this._isTweening=!0,this._save.get("global.qwerty")&&this.$els.keyboard.classList.add("pause__keyboard--is-qwerty"),this._bindTimeout=setTimeout(function(){e._bind()},3e3),this._createTl(),this._root=document.querySelector("#application"),this._root.classList.remove("is-paused"),this._gPtsTg=[{x:5,y:9},{x:98,y:3},{x:97,y:97},{x:2,y:98}],this._kPtsTg=[{x:4,y:3},{x:98,y:3},{x:93,y:92},{x:6,y:94}],this._gOffsetsVal=[{x:Object(c.h)(-1,1),y:Object(c.h)(-1,1)},{x:Object(c.h)(-1,1),y:Object(c.h)(-1,1)},{x:Object(c.h)(-1,1),y:Object(c.h)(-1,1)},{x:Object(c.h)(-1,1),y:Object(c.h)(-1,1)}],this._gOffsetsSpeed=[{x:Object(c.h)(-1,1),y:Object(c.h)(-1,1)},{x:Object(c.h)(-1,1),y:Object(c.h)(-1,1)},{x:Object(c.h)(-1,1),y:Object(c.h)(-1,1)},{x:Object(c.h)(-1,1),y:Object(c.h)(-1,1)}],this._gOffsetsPos=[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],this._kOffsetsVal=[{x:Object(c.h)(-1,1),y:Object(c.h)(-1,1)},{x:Object(c.h)(-1,1),y:Object(c.h)(-1,1)},{x:Object(c.h)(-1,1),y:Object(c.h)(-1,1)},{x:Object(c.h)(-1,1),y:Object(c.h)(-1,1)}],this._kOffsetsSpeed=[{x:Object(c.h)(-1,1),y:Object(c.h)(-1,1)},{x:Object(c.h)(-1,1),y:Object(c.h)(-1,1)},{x:Object(c.h)(-1,1),y:Object(c.h)(-1,1)},{x:Object(c.h)(-1,1),y:Object(c.h)(-1,1)}],this._kOffsetsPos=[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}]}},{key:"beforeDestroy",value:function(){clearTimeout(this._bindTimeout),this._instructionsTl&&this._instructionsTl.kill(),y(v(t.prototype),"beforeDestroy",this).call(this),this._unbind()}},{key:"_bind",value:function(){this._signals.pause.show.add(this._show),this._signals.pause.hide.add(this._hide),s.a.downed.add(this._onKeyDown),a.a.buttonDowned.add(this._onButtonDown),this.$els.keyboard.addEventListener("click",this._handleKeyboardClick,!1)}},{key:"_unbind",value:function(){this._signals.pause.show.remove(this._show),this._signals.pause.hide.remove(this._hide),s.a.downed.remove(this._onKeyDown),a.a.buttonDowned.remove(this._onButtonDown),this.$els.keyboard.removeEventListener("click",this._handleKeyboardClick,!1)}},{key:"_registerDOM",value:function(){this.$els.xmas=this.$el.querySelector(".xmas-love"),this.$els.creditEls=this.$el.querySelectorAll(".credits-el"),this.$els.smallStrokes=this.$el.querySelectorAll(".credits-sep")}},{key:"_createTl",value:function(){var o=this;this._sStrokes=[{clipPath:100},{clipPath:100},{clipPath:100}],this._showTl=new TimelineMax({paused:!0}),this._tls.push(this._showTl);this._showTl.set(this.$els.keyboard,{opacity:0,y:"-120%"}).set(this.$els.xmas,{opacity:0}).set(this._sStrokes,{clipPath:100},0).set([this.$els.gamepadTitle,this.$els.keyboardTitle],{x:"-50%",y:"130%",opacity:0},0).addCallback(function(){for(var e=0,t=o.$els.creditEls.length;e<t;e++)o.$els.smallStrokes[e].style.clipPath="inset(0   100 0 0)"},0).set(this.$els.deco,{opacity:0,scale:0}).set(this.$els.title,{opacity:0,y:100,z:800,force3D:!0},0).set(this.$els.creditEls,{opacity:0,y:50,rotation:0,force3D:!0},0).to(this.$els.deco,.3,{opacity:1,scale:1,ease:Back.easeOut},.4).to(this.$els.title,1,{opacity:1,y:0,z:0,force3D:!0,ease:Expo.easeOut},.2).to(this.$els.keyboard,1.3,{opacity:1,y:"0%",force3D:!0,ease:Elastic.easeOut.config(.1)},.6).to(this.$els.gamepadTitle,1.4,{opacity:1,x:"-50%",y:"0%",force3D:!0,ease:Elastic.easeOut.config(.3)},.5).to(this.$els.keyboardTitle,1.4,{opacity:1,x:"-50%",y:"0%",force3D:!0,ease:Elastic.easeOut.config(.3)},.6).to(this.$els.xmas,1.4,{opacity:1,y:"0%",force3D:!0,ease:Expo.easeOut},1.1).staggerTo(this.$els.creditEls,1.3,{opacity:1,rotation:0,y:0,z:0,force3D:!0,ease:Expo.easeOut},.06,.7);for(var e=function(e,t){var n=o.$els.creditEls[e].querySelectorAll(".credits-name");o._showTl.staggerFromTo(n,.6,{opacity:0,y:5,force3D:!0},{y:0,opacity:1},.22,.5+.2*e),o._showTl.to(o._sStrokes[e],.3,{clipPath:0,ease:Expo.easeOut,onUpdate:function(){o.$els.smallStrokes[e].style.clipPath="inset(0 ".concat(o._sStrokes[e].clipPath,"% 0 0)")}},.4+.2*e)},t=0,n=this.$els.creditEls.length;t<n;t++)e(t)}},{key:"_createInstructionsTl",value:function(){this._instructionsTl&&this._instructionsTl.kill();this._instructionsTl=new TimelineMax({paused:!0}),this._gPts=[{x:50,y:50},{x:50,y:50},{x:50,y:50},{x:50,y:50}],this._kPts=[{x:50,y:50},{x:50,y:50},{x:50,y:50},{x:50,y:50}],this._instructionsTl.fromTo(this.$els.svgs,1,{scale:1.5,x:"-50%",y:"-50%",opacity:0},{scale:1,x:"-50%",y:"-50%",opacity:1,ease:Elastic.easeOut.config(.2)},.1+.2);for(var e=0,t=this._gPts.length;e<t;e++){var n=this._gPts[e],o=this._kPts[e],r=this._gPtsTg[e],i=this._kPtsTg[e];this._instructionsTl.to(n,Object(c.h)(.8,1.2),{x:r.x,ease:Elastic.easeOut.config(.4)},Object(c.h)(0,.2)+.2).to(n,Object(c.h)(.8,1.2),{y:r.y,ease:Elastic.easeOut.config(.4)},Object(c.h)(0,.2)+.2).to(o,Object(c.h)(.8,1.2),{x:i.x,ease:Elastic.easeOut.config(.4)},Object(c.h)(0,.2)+.2).to(o,Object(c.h)(.8,1.2),{y:i.y,ease:Elastic.easeOut.config(.4)},Object(c.h)(0,.2)+.2)}this._instructionsTl.play()}},{key:"_show",value:function(){this._state.isDying||(this.$el.classList.add("pause--is-opened"),this._state.pauseDisplayed=!0,this._signals.pause.shown.dispatch(),this._context.pause(),this._showTl.play(0),this._createInstructionsTl(),u.a.add(this._onUpdate),this._sounds.play("woosh-2"),this._root||(this._root=document.querySelector("#application")),this._root.classList.add("is-paused"),Object(l.a)("pause","pause-show"))}},{key:"_hide",value:function(){this._instructionsTl&&this._instructionsTl.kill(),u.a.remove(this._onUpdate),this._state.isDying||(this._showTl.pause(),this.$el.classList.remove("pause--is-opened"),this._state.pauseDisplayed=!1,this._signals.pause.hidden.dispatch(),this._context.resume(),this._sounds.play("woosh-3"),this._root.classList.remove("is-paused"),Object(l.a)("pause","pause-hide"))}},{key:"_toggle",value:function(){this._state.pauseDisplayed?this._hide():this._show()}},{key:"_handleKeyboardClick",value:function(){var e=!this._save.get("global.qwerty");this._save.set("global.qwerty",!this._save.get("global.qwerty")),e?this.$els.keyboard.classList.add("pause__keyboard--is-qwerty"):this.$els.keyboard.classList.remove("pause__keyboard--is-qwerty"),this._sounds.play("validate"),Object(l.a)("pause","pause-toggle-azerty",e)}},{key:"_onKeyDown",value:function(e,t){"esc"===t&&this._toggle()}},{key:"_onButtonDown",value:function(e){"start"===e&&this._toggle()}},{key:"_onUpdate",value:function(e,t){for(var n=this._gPts,o=this._kPts,r=this._gOffsetsPos,i=this._kOffsetsPos,a=0,s=this._gOffsetsPos.length;a<s;a++){var u=this._gOffsetsVal[a],c=this._gOffsetsPos[a],l=this._gOffsetsSpeed[a];c.x=2*Math.sin(.0015*t*l.x+u.x),c.y=2*Math.sin(.0015*t*l.y+u.y);var f=this._kOffsetsVal[a],p=this._kOffsetsPos[a],h=this._kOffsetsSpeed[a];p.x=2*Math.sin(.0015*t*h.x+f.x),p.y=2*Math.sin(.0015*t*h.y+f.y)}this.$els.instructionL.style.webkitClipPath=this.$els.instructionL.style.clipPath="polygon(".concat(n[0].x+r[0].x,"% ").concat(n[0].y+r[0].y,"%, ").concat(n[1].x+r[1].x,"% ").concat(n[1].y+r[1].y,"%, ").concat(n[2].x+r[2].x,"% ").concat(n[2].x+r[2].y,"%, ").concat(n[3].x+r[3].y,"% ").concat(n[3].y+r[3].y,"%)"),this.$els.instructionR.style.webkitClipPath=this.$els.instructionR.style.clipPath="polygon(".concat(o[0].x+i[0].x,"% ").concat(o[0].y+i[0].y,"%, ").concat(o[1].x+i[1].x,"% ").concat(o[1].y+i[1].y,"%, ").concat(o[2].x+i[2].x,"% ").concat(o[2].x+i[2].y,"%, ").concat(o[3].x+i[3].y,"% ").concat(o[3].y+i[3].y,"%)")}},{key:"template",get:function(){return b(569)}},{key:"components",get:function(){return{Credits:f.a,XmasLove:p.a}}}])&&h(n.prototype,o),r&&h(n,r),t}()).prototype,"_show",[e],Object.getOwnPropertyDescriptor(t.prototype,"_show"),t.prototype),r(t.prototype,"_hide",[e],Object.getOwnPropertyDescriptor(t.prototype,"_hide"),t.prototype),r(t.prototype,"_toggle",[e],Object.getOwnPropertyDescriptor(t.prototype,"_toggle"),t.prototype),r(t.prototype,"_handleKeyboardClick",[e],Object.getOwnPropertyDescriptor(t.prototype,"_handleKeyboardClick"),t.prototype),r(t.prototype,"_onKeyDown",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onKeyDown"),t.prototype),r(t.prototype,"_onButtonDown",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onButtonDown"),t.prototype),r(t.prototype,"_onUpdate",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onUpdate"),t.prototype),t);g.a=_}).call(this,b(2).bind)},function(e,f,p){"use strict";(function(e){var t,i=p(12);p(1);function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function s(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function u(e,t,n){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var r=(o((t=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),s(this,c(t).apply(this,arguments))}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(t,i["a"]),n=t,(o=[{key:"init",value:function(){this.$name="pause"}},{key:"mounted",value:function(){u(c(t.prototype),"mounted",this).call(this),this._bind(),this._animateIn()}},{key:"beforeDestroy",value:function(){u(c(t.prototype),"beforeDestroy",this).call(this),this._unbind()}},{key:"_animateIn",value:function(){var e=new TimelineMax;this._tls.push(e);e.set(this.$els.part,{opacity:0}).set(this.$els.bg,{scaleX:0,scaleY:0,rotation:30}).to(this.$els.bg,1,{scaleX:1,ease:Elastic.easeOut.config(.7)},3.4-.8).to(this.$els.bg,2,{scaleY:1,ease:Elastic.easeOut},3.4-.8).to(this.$els.bg,2,{rotation:0,ease:Elastic.easeOut},3.4-.8).to(this.$els.part,1,{opacity:1,ease:Expo.easeOut},3)}},{key:"_bind",value:function(){this._signals.pause.shown.add(this._onShow),this._signals.pause.hidden.add(this._onHide),this.$el.addEventListener("click",this._handleClick,!1)}},{key:"_unbind",value:function(){this._signals.pause.shown.remove(this._onShow),this._signals.pause.hidden.remove(this._onHide),this.$el.removeEventListener("click",this._handleClick,!1)}},{key:"_onShow",value:function(){this.$el.classList.add("pause-btn--is-opened"),TweenMax.to(this.$els.bg,.7,{skewY:"20deg",ease:Elastic.easeOut})}},{key:"_onHide",value:function(){this.$el.classList.remove("pause-btn--is-opened"),TweenMax.to(this.$els.bg,.7,{skewY:"0deg",ease:Elastic.easeOut})}},{key:"_handleClick",value:function(){this._state.isDying||(this._state.pauseDisplayed?this._signals.pause.hide.dispatch():this._signals.pause.show.dispatch())}},{key:"template",get:function(){return p(570)}},{key:"components",get:function(){return{}}}])&&a(n.prototype,o),r&&a(n,r),t}()).prototype,"_onShow",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onShow"),t.prototype),o(t.prototype,"_onHide",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onHide"),t.prototype),o(t.prototype,"_handleClick",[e],Object.getOwnPropertyDescriptor(t.prototype,"_handleClick"),t.prototype),t);f.a=r}).call(this,p(2).bind)},function(e,_,g){"use strict";(function(e){var t,i=g(12),a=(g(1),g(0)),s=g(31);function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function l(e,t,n){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var o,r,h,d,y,v,m=(o=(t=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),c(this,f(t).apply(this,arguments))}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(t,i["a"]),n=t,(o=[{key:"init",value:function(){this.$name="death-overlay",this._lastLaserIndex=-1,this._lastCameraIndex=-1,this._lastLookIndex=-1,this._lastFallIndex=-1,this._lastIndexes={camera:-1,laser:-1,look:-1,fall:-1}}},{key:"mounted",value:function(){l(f(t.prototype),"mounted",this).call(this),this._bind()}},{key:"beforeDestroy",value:function(){l(f(t.prototype),"beforeDestroy",this).call(this),this._unbind(),this._resetTl&&this._resetTl.kill()}},{key:"_bind",value:function(){this._signals.character.reseted.add(this._onCharReset)}},{key:"_unbind",value:function(){this._signals.character.reseted.remove(this._onCharReset)}},{key:"_onCharReset",value:function(e){for(var t=s.a.death[e].sentences,n=Object(a.j)(0,t.length-1);this._lastIndexes[e]===n;)n=Object(a.j)(0,t.length-1);this._lastIndexes[e]=n,this.$els.desc.innerHTML=t[n],this._resetTl=new TimelineMax;this._resetTl.to(this.$el,1,{autoAlpha:1}).set(this.$els.title,{opacity:0,y:100,z:800,force3D:!0},0).set(this.$els.desc,{opacity:0,y:100,z:800,force3D:!0},0).to(this.$els.title,.7,{opacity:1,y:0,z:0,force3D:!0,ease:Expo.easeOut},.2).to(this.$els.desc,.7,{opacity:1,y:0,z:0,force3D:!0,ease:Expo.easeOut},.5).to(this.$el,.4,{autoAlpha:0},2.9)}},{key:"template",get:function(){return g(571)}},{key:"components",get:function(){return{}}}])&&u(n.prototype,o),r&&u(n,r),t}()).prototype,r="_onCharReset",h=[e],d=Object.getOwnPropertyDescriptor(t.prototype,"_onCharReset"),y=t.prototype,v={},Object.keys(d).forEach(function(e){v[e]=d[e]}),v.enumerable=!!v.enumerable,v.configurable=!!v.configurable,("value"in v||v.initializer)&&(v.writable=!0),v=h.slice().reverse().reduce(function(e,t){return t(o,r,e)||e},v),y&&void 0!==v.initializer&&(v.value=v.initializer?v.initializer.call(y):void 0,v.initializer=void 0),void 0===v.initializer&&(Object.defineProperty(o,r,v),v=null),t);_.a=m}).call(this,g(2).bind)},function(e,p,h){"use strict";(function(e){var t,i=h(12),a=(h(1),h(6));function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function u(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function c(e,t,n){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var r=(o((t=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),u(this,l(t).apply(this,arguments))}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,i["a"]),n=t,(o=[{key:"init",value:function(){this.$name="pause",this._current=this._state.keysNb}},{key:"mounted",value:function(){c(l(t.prototype),"mounted",this).call(this),this._bind(),this.$els.current.innerHTML=this._current,this._animateIn()}},{key:"beforeDestroy",value:function(){c(l(t.prototype),"beforeDestroy",this).call(this),this._unbind()}},{key:"_bind",value:function(){this._signals.character.keyFound.add(this._onKeyFound),this.$el.addEventListener("click",this._handleClick,!1)}},{key:"_unbind",value:function(){this._signals.character.keyFound.remove(this._onKeyFound),this.$el.removeEventListener("click",this._handleClick,!1)}},{key:"_animateIn",value:function(){var e=new TimelineMax;this._tls.push(e);e.set(this.$els.current,{opacity:0,scale:.5}).set(this.$els.slash,{opacity:0,scale:.5}).set(this.$els.total,{opacity:0,scale:.5}).set(this.$els.key,{scale:0}).set(this.$els.bg,{scaleX:0,scaleY:0,rotation:-30}).to(this.$els.bg,1,{scaleX:1,ease:Elastic.easeOut.config(.7)},2.2).to(this.$els.bg,2,{scaleY:1,ease:Elastic.easeOut},2.2).to(this.$els.bg,2,{rotation:0,ease:Elastic.easeOut},2.2).to(this.$els.current,1,{opacity:1,scale:1,ease:Expo.easeOut},2.6).to(this.$els.slash,1,{opacity:1,scale:1,ease:Expo.easeOut},2.7).to(this.$els.total,1,{opacity:1,scale:1,ease:Expo.easeOut},2.8).to(this.$els.key,1,{scale:1,ease:Expo.easeOut},3)}},{key:"_handleClick",value:function(){}},{key:"_onKeyFound",value:function(e,t){var n=this;this._state.keys[e]=!0;var o=0;for(var r in this._state.keys)this._state.keys[r]&&o++;this._state.keysNb=o;var i=new TimelineMax({onComplete:function(){}});this._tls.push(i),i.set(this.$el,{transformOrigin:"left"}).to(this.$el,.5,{scale:1.3,ease:Elastic.easeOut},0).to(this.$els.bg,1.7,{skewX:"30deg",ease:Elastic.easeOut.config(.8)},0).to(this.$els.bg,1.7,{skewY:"-20deg",ease:Expo.easeOut},0).to(this.$els.current,.3,{opacity:0,onComplete:function(){n.$els.current.innerHTML=n._state.keysNb,TweenMax.from(n.$els.current,.5,{z:300}),TweenMax.to(n.$els.current,.5,{opacity:1})}},.5).to(this.$els.key,.2,{z:300,ease:Expo.easeOut},.1).to(this.$els.key,.7,{z:0,ease:Expo.easeOut},.3).to(this.$els.key,1,{z:0,ease:Expo.easeOut},1).addCallback(function(){t&&t()},1.9),this._sounds.play("key"),Object(a.a)("key","key-found",e),3===o&&Object(a.a)("key","key-complete")}},{key:"template",get:function(){return h(572)}},{key:"components",get:function(){return{}}}])&&s(n.prototype,o),r&&s(n,r),t}()).prototype,"_handleClick",[e],Object.getOwnPropertyDescriptor(t.prototype,"_handleClick"),t.prototype),o(t.prototype,"_onKeyFound",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onKeyFound"),t.prototype),t);p.a=r}).call(this,h(2).bind)},function(e,b,w){"use strict";(function(e){var t,i=w(54),a=w(112),s=w(113),n=w(364),u=w.n(n),o=w(20),c=w.n(o),l=w(6),f=w(115),p=w(116);function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function d(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function y(e,t,n){return(y="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=v(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _(n,o,e,t,r){var i={};return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=e.slice().reverse().reduce(function(e,t){return t(n,o,e)||e},i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(n,o,i),i=null),i}var g=(_((t=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=d(this,v(t).apply(this,arguments))).$name="outro",e}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(t,i["a"]),n=t,(o=[{key:"data",value:function(){return function(r){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},t=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),t.forEach(function(e){var t,n,o;t=r,o=i[n=e],n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o})}return r}({},y(v(t.prototype),"data",this))}},{key:"ready",value:function(){y(v(t.prototype),"ready",this).call(this)}},{key:"mounted",value:function(){var e=this;y(v(t.prototype),"mounted",this).call(this),document.title="The End - Plume and the forgotten letter | WebGL game",window.outroDebug=function(){e._showEnding()},this._registerDOM(),this._state.isOutro=!0,this._currentSubIndex=0,this._subs=Object(s.parse)(u.a),this._currentSub=this._subs[0],this._context.sceneManager.destroy("level-4"),this._signals.overlay.show.dispatch(),this._appEl=document.body.querySelector("#application"),this._mountedTimeout=setTimeout(function(){document.querySelector(".preloader").classList.add("preloader--is-hidden"),e._appEl.classList.remove("cursor-grab"),e._appEl.classList.remove("cursor-grabbing"),e._appEl.classList.remove("cursor-loading")},100),this._bind(),this.$els.video.play(),this._createTl(),this._sounds.create("outro"),Object(l.b)("/outro")}},{key:"beforeDestroy",value:function(){var e=this;document.title="Plume and the forgotten letter | WebGL game",this._state.isOutro=!1,this._state.keys={"level-1":!1,"level-2":!1,"level-3":!1},this._state.keysNb=0,clearTimeout(this._mountedTimeout),y(v(t.prototype),"beforeDestroy",this).call(this),this._unbind(),this._themeAudio&&TweenMax.to(this._themeAudio,1,{volume:0,omComplete:function(){e._themeAudio.stop()}})}},{key:"getDependencies",value:function(e){return y(v(t.prototype),"getDependencies",this).call(this)}},{key:"_bind",value:function(){this.$els.video.addEventListener("ended",this._handleVideoEnded,!1),c.a.add(this._onUpdate)}},{key:"_unbind",value:function(){this.$els.video.removeEventListener("ended",this._handleVideoEnded,!1),c.a.remove(this._onUpdate)}},{key:"_registerDOM",value:function(){this.$els.xmas=this.$el.querySelector(".xmas-love"),this.$els.creditEls=this.$el.querySelectorAll(".credits-el"),this.$els.smallStrokes=this.$el.querySelectorAll(".credits-sep")}},{key:"_createTl",value:function(){var o=this;this._sStrokes=[{clipPath:100},{clipPath:100},{clipPath:100}],this._showTl=new TimelineMax({paused:!0}),this._tls.push(this._showTl);this._showTl.set(this.$els.xmas,{opacity:0},0).set(this._sStrokes,{clipPath:100},0).to(this.$els.bg,3,{scale:1,ease:Expo.easeOut},0).to(this.$els.title,1.5,{rotation:-1,z:0,opacity:1,force3D:!0,ease:Elastic.easeOut.config(.2)},.6).addCallback(function(){o._sounds.play("merry_xmas"),o._themeAudio=o._sounds.get("main-theme"),o._themeAudio.play(),o._themeAudio.volume=0,TweenMax.to(o._themeAudio,1,{volume:.5})},.7).to(this.$els.desc,1.5,{y:0,opacity:1,force3D:!0,ease:Expo.easeOut},.8).to(this.$els.ctas[0],1.5,{scaleX:1,force3D:!0,ease:Elastic.easeOut.config(.2)},.7).to(this.$els.ctas[0],1.2,{scaleY:1,force3D:!0,ease:Elastic.easeOut.config(.3)},.85).to(this.$els.ctas[1],1.3,{scaleX:1,force3D:!0,ease:Elastic.easeOut.config(.25)},.83).to(this.$els.ctas[1],1.5,{scaleY:1,force3D:!0,ease:Elastic.easeOut.config(.1)},.9).addCallback(function(){for(var e=0,t=o.$els.creditEls.length;e<t;e++)o.$els.smallStrokes[e].style.clipPath="inset(0   100 0 0)"},0).set(this.$els.creditEls,{opacity:0,y:50,rotation:0,force3D:!0},0).to(this.$els.xmas,1.4,{opacity:1,y:"0%",force3D:!0},1.7).staggerTo(this.$els.creditEls,1.3,{opacity:1,rotation:0,y:0,z:0,force3D:!0,ease:Expo.easeOut},.06,.8);for(var e=function(e,t){var n=o.$els.creditEls[e].querySelectorAll(".credits-name");o._showTl.staggerFromTo(n,.6,{opacity:0,y:5,force3D:!0},{y:0,opacity:1},.22,.6+.2*e),o._showTl.to(o._sStrokes[e],.3,{clipPath:0,ease:Expo.easeOut,onUpdate:function(){o.$els.smallStrokes[e].style.clipPath="inset(0 ".concat(o._sStrokes[e].clipPath,"% 0 0)")}},.5+.2*e)},t=0,n=this.$els.creditEls.length;t<n;t++)e(t)}},{key:"_showEnding",value:function(){this._showTl.play(0),this.$el.classList.add("outro--is-ending")}},{key:"_handleVideoEnded",value:function(){this._showEnding()}},{key:"_onUpdate",value:function(e,t){var n=1e3*this.$els.video.currentTime;if(this._currentSub){var o=this._currentSub,r=o.start,i=o.end,a=o.text;i<=n&&this._subIsActive?(this._subIsActive=!1,this._currentSubIndex++,this._signals.subtitles.remove.dispatch(),this._currentSub=this._subs[this._currentSubIndex]):r<=n&&!this._subIsActive&&(this._subIsActive=!0,this._signals.subtitles.add.dispatch(a))}}},{key:"template",get:function(){return w(575)}},{key:"components",get:function(){return{Subtitles:a.a,Credits:f.a,XmasLove:p.a}}}])&&h(n.prototype,o),r&&h(n,r),t}()).prototype,"_handleVideoEnded",[e],Object.getOwnPropertyDescriptor(t.prototype,"_handleVideoEnded"),t.prototype),_(t.prototype,"_onUpdate",[e],Object.getOwnPropertyDescriptor(t.prototype,"_onUpdate"),t.prototype),t);b.a=g}).call(this,w(2).bind)},function(e,t){e.exports="1\n00:00:02,307 --\x3e 00:00:04,500\nHello Plume, wake up!\n\n2\n00:00:04,800 --\x3e 00:00:06,180\nSanta was here!\n"},function(e,t,n){"use strict";n(87);function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,o=[{key:"addFunctions",value:function(){}}],(n=null)&&r(t.prototype,n),o&&r(t,o),e}();t.a=o},function(e,t,n){"use strict";var i=n(51),o=n(312),a=n.n(o),r=n(313),s=n.n(r),u=3;function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function f(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d=function(e){function n(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new THREE.Vector2;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=f(this,p(n).call(this,{type:"ConvolutionMaterial",uniforms:{tInput:new THREE.Uniform(null),texelSize:new THREE.Uniform(new THREE.Vector2),halfTexelSize:new THREE.Uniform(new THREE.Vector2),kernel:new THREE.Uniform(0)},fragmentShader:a.a,vertexShader:s.a,depthWrite:!1,depthTest:!1}))).setTexelSize(t.x,t.y),e.kernelSize=u,e}var t,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(n,THREE.ShaderMaterial),t=n,(o=[{key:"getKernel",value:function(){return y[this.kernelSize]}},{key:"setTexelSize",value:function(e,t){this.uniforms.texelSize.value.set(e,t),this.uniforms.halfTexelSize.value.set(e,t).multiplyScalar(.5)}}])&&l(t.prototype,o),r&&l(t,r),n}(),y=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],v=d,m=n(314),_=n.n(m),g=n(315),b=n.n(g);function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function x(e,t){return!t||"object"!==w(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function E(e,t){return(E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var P=function(e){function r(){var e,t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r);var o=null!==n;return(e=x(this,k(r).call(this,{type:"LuminosityMaterial",uniforms:{tInput:new THREE.Uniform(null),distinction:new THREE.Uniform(1),range:new THREE.Uniform(o?n:new THREE.Vector2)},fragmentShader:_.a,vertexShader:b.a}))).setColorOutputEnabled(t),e.setLuminanceRangeEnabled(o),e}var t,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}(r,THREE.ShaderMaterial),t=r,(n=[{key:"setColorOutputEnabled",value:function(e){e?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}},{key:"setLuminanceRangeEnabled",value:function(e){e?this.defines.RANGE="1":delete this.defines.RANGE,this.needsUpdate=!0}}])&&O(t.prototype,n),o&&O(t,o),r}(),T=n(316),S=n.n(T),j=n(317),C=n.n(j);function R(e){return(R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function M(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function A(e,t){return!t||"object"!==R(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function L(e){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function D(e,t){return(D=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var z=function(e){function n(){var e,t=0<arguments.length&&void 0!==arguments[0]&&arguments[0];return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=A(this,L(n).call(this,{type:"CombineMaterial",uniforms:{texture1:new THREE.Uniform(null),texture2:new THREE.Uniform(null),opacity1:new THREE.Uniform(1),opacity2:new THREE.Uniform(1)},fragmentShader:S.a,vertexShader:C.a,depthWrite:!1,depthTest:!1}))).screenMode=t,e}var t,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&D(e,t)}(n,THREE.ShaderMaterial),t=n,(o=[{key:"screenMode",get:function(){return!!this.defines.SCREEN_MODE},set:function(e){e?this.defines.SCREEN_MODE="1":delete this.defines.SCREEN_MODE,this.needsUpdate=!0}}])&&M(t.prototype,o),r&&M(t,r),n}();function H(e){return(H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function I(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function F(e,t){return!t||"object"!==H(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function N(e){return(N=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function U(e,t){return(U=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var B=function(e){function n(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=F(this,N(n).call(this,"BlurPass"))).renderTargetX=new THREE.WebGLRenderTarget(1,1,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,stencilBuffer:!1,depthBuffer:!1}),e.renderTargetX.texture.name="Blur.TargetX",e.renderTargetX.texture.generateMipmaps=!1,e.renderTargetY=e.renderTargetX.clone(),e.renderTargetY.texture.name="Blur.TargetY",e.resolutionScale=void 0!==t.resolutionScale?t.resolutionScale:.5,e.convolutionMaterial=new v,e.ditheredConvolutionMaterial=new v,e.ditheredConvolutionMaterial.dithering=!0,e.dithering=!1,e.kernelSize=t.kernelSize,e}var t,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&U(e,t)}(n,i["a"]),t=n,(o=[{key:"render",value:function(e,t,n,o,r){var i,a,s,u=this.scene,c=this.camera,l=this.renderTargetX,f=this.renderTargetY,p=this.convolutionMaterial,h=p.uniforms,d=p.getKernel(),y=t;for(this.material=p,a=0,s=d.length-1;a<s;++a)i=a%2==0?l:f,h.kernel.value=d[a],h.tInput.value=y.texture,e.render(u,c,i),y=i;this.dithering&&(h=(p=this.ditheredConvolutionMaterial).uniforms,this.material=p),h.kernel.value=d[a],h.tInput.value=y.texture,e.render(u,c,this.renderToScreen?null:n)}},{key:"setSize",value:function(e,t){e=Math.max(1,Math.floor(e*this.resolutionScale)),t=Math.max(1,Math.floor(t*this.resolutionScale)),this.renderTargetX.setSize(e,t),this.renderTargetY.setSize(e,t),this.convolutionMaterial.setTexelSize(1/e,1/t),this.ditheredConvolutionMaterial.setTexelSize(1/e,1/t)}},{key:"init",value:function(e,t){t||(this.renderTargetX.texture.format=THREE.RGBFormat,this.renderTargetY.texture.format=THREE.RGBFormat)}},{key:"width",get:function(){return this.renderTargetX.width}},{key:"height",get:function(){return this.renderTargetX.height}},{key:"kernelSize",get:function(){return this.convolutionMaterial.kernelSize},set:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:u;this.convolutionMaterial.kernelSize=e,this.ditheredConvolutionMaterial.kernelSize=e}}])&&I(t.prototype,o),r&&I(t,r),n}();function V(e){return(V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function G(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function $(e,t){return!t||"object"!==V(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function q(e){return(q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function W(e,t){return(W=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Y=function(e){function n(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=$(this,q(n).call(this,{name:"BloomPass"}))).renderTarget=new THREE.WebGLRenderTarget(1,1,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,stencilBuffer:!1,depthBuffer:!1}),e.needsSwap=!0,e.renderTarget.texture.name="Bloom.Target",e.renderTarget.texture.generateMipmaps=!1,e.blurPass=new B(t),e.combineMaterial=new z(void 0===t.screenMode||t.screenMode),e.intensity=t.intensity,e.luminosityMaterial=new P(!0),e.distinction=t.distinction,e.blend=t.blend,e}var t,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&W(e,t)}(n,i["a"]),t=n,(o=[{key:"render",value:function(e,t,n,o,r){var i=this.scene,a=this.camera,s=this.blurPass,u=this.luminosityMaterial,c=this.combineMaterial,l=this.renderTarget;(this.material=u).uniforms.tInput.value=t.texture,e.render(i,a,l),s.render(e,l,l),this.blend&&((this.material=c).uniforms.texture1.value=t.texture,c.uniforms.texture2.value=l.texture,e.render(i,a,this.renderToScreen?null:n))}},{key:"setSize",value:function(e,t){this.blurPass.setSize(e,t),e=this.blurPass.width,t=this.blurPass.height,this.renderTarget.setSize(e,t)}},{key:"init",value:function(e,t){this.blurPass.init(e,t),t||(this.renderTarget.texture.format=THREE.RGBFormat)}},{key:"resolutionScale",get:function(){return this.blurPass.resolutionScale},set:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:.5;this.blurPass.resolutionScale=e}},{key:"kernelSize",get:function(){return this.blurPass.kernelSize},set:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:u;this.blurPass.kernelSize=e}},{key:"intensity",get:function(){return this.combineMaterial.uniforms.opacity2.value},set:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;this.combineMaterial.uniforms.opacity2.value=e}},{key:"distinction",get:function(){return this.luminosityMaterial.uniforms.distinction.value},set:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;this.luminosityMaterial.uniforms.distinction.value=e}},{key:"dithering",get:function(){return this.blurPass.dithering},set:function(e){this.blurPass.dithering=e}},{key:"blend",get:function(){return this.needsSwap},set:function(e){this.needsSwap=e}},{key:"screenMode",get:function(){return this.combineMaterial.screenMode},set:function(e){this.combineMaterial.screenMode=e}},{key:"overlay",get:function(){return this.renderTarget.texture}}])&&G(t.prototype,o),r&&G(t,r),n}();t.a=Y},function(e,t,n){"use strict";var o=n(43),l=n.n(o);function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u={texture:"",transparent:!0,maxParticleCount:1e5,fog:!1},c=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i(this,a(t).call(this,function(r){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},t=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),t.forEach(function(e){var t,n,o;t=r,o=i[n=e],n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o})}return r}({},u,e)))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(t,l.a.Group),t}();function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){return!t||"object"!==f(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var y={particleCount:1},v=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),p(this,h(t).call(this,function(r){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},t=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),t.forEach(function(e){var t,n,o;t=r,o=i[n=e],n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o})}return r}({},y,e)))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(t,l.a.Emitter),t}(),m=n(13),_=n(37);function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function w(e,t){return!t||"object"!==g(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function O(e,t,n){return(O="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=x(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function k(e,t){return(k=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var E=function(e){function a(e,t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=w(this,x(a).call(this))).group=new c(e),n.group.mesh.frustumCulled=!1,n.add(n.group.mesh),n.emitters=[];for(var o=0,r=t.length;o<r;o++){var i=new v(t[o]);n.emitters.push(i),n.group.addEmitter(i)}return n.addHelpers(),n}var t,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&k(e,t)}(a,m["a"]),t=a,(n=[{key:"addHelpers",value:function(){for(var e=0,t=this.emitters.length;e<t;e++){var n=this.emitters[e],o=n.position.value,r=void 0;switch(n.type){case l.a.distributions.BOX:var i=n.position.spread,a=new THREE.BoxBufferGeometry(i.x,i.y,i.z);r=new THREE.LineSegments(new THREE.EdgesGeometry(a),_.a.lineDebugMaterial);break;case l.a.distributions.SPHERE:var s=n.position.radius,u=n.position.radiusScale,c=new THREE.SphereBufferGeometry(s,32,32);(r=new THREE.LineSegments(new THREE.EdgesGeometry(c),_.a.lineDebugMaterial)).scale.multiply(u)}r.visible=!1,r.name="EmitterHelper",r.position.copy(o),this.add(r)}}},{key:"update",value:function(e){this.group.tick(e)}},{key:"remove",value:function(){O(x(a.prototype),"remove",this).call(this),this.group.dispose(),this.group.texture instanceof THREE.Texture&&this.group.texture.dispose()}},{key:"defaultEmitter",get:function(){return this.emitters[0]}}])&&b(t.prototype,n),o&&b(t,o),a}();function P(e){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function T(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function S(e,t){return!t||"object"!==P(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function j(e,t,n){return(j="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=C(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function R(e,t){return(R=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var M=[{type:l.a.distributions.BOX,particleCount:1e4,maxAge:{value:5,spread:2},position:{value:new THREE.Vector3(15,10,67),spread:new THREE.Vector3(36,19,40),randomise:!0},velocity:{value:new THREE.Vector3(-.7,-.8,0),spread:new THREE.Vector3(0,.2,0)},acceleration:{value:new THREE.Vector3(-.1,.1,0),spread:new THREE.Vector3(.1,0,0)},drag:{value:.2,spread:.1},wiggle:{value:.2,spread:.05,randomise:!0},color:{value:[new THREE.Color("#ffffff")]},opacity:{value:[1,0],spread:.2,randomise:!0},size:{value:1.3,spread:.1,randomise:!0}}],A=function(e){function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=S(this,C(o).call(this,{texture:{value:t.map}},M)))._speedFactor=.01,n}var t,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&R(e,t)}(o,E),t=o,(n=[{key:"destroy",value:function(){j(C(o.prototype),"destroy",this).call(this)}},{key:"update",value:function(e,t){j(C(o.prototype),"update",this).call(this,e*this._speedFactor)}},{key:"_bind",value:function(){}},{key:"_unbind",value:function(){}}])&&T(t.prototype,n),r&&T(t,r),o}();t.a=A},function(e,t,n){"use strict";var o=n(108),i=n(11);function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(e){s(t,e,n[e])})}return t}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],0<=t.indexOf(n)||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],0<=t.indexOf(n)||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(e){function r(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=t.speed,o=u(t,["speed"]);return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(e=c(this,l(r).call(this,a({},o,{instanced:!0,defines:{IS_COG:!0}})))).uniforms=a({},e.uniforms,{uCogSpeed:{value:n}}),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(r,i["a"]),r}(),h=n(109),d=n(53);function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(e){m(t,e,n[e])})}return t}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],0<=t.indexOf(n)||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],0<=t.indexOf(n)||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function g(e,t){return!t||"object"!==y(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var O=function(e){function r(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=t.speed,o=_(t,["speed"]);return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(e=g(this,b(r).call(this,v({instanced:!0,defines:{IS_COG:!0}},o)))).uniforms=v({},e.uniforms,{uCogSpeed:{value:n}}),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(r,d["a"]),r}();function x(e){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k(e,t){return!t||"object"!==x(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function P(e,t){return(P=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var T=.08,S=function(e){function n(e,t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),k(this,E(n).call(this,e,function(r){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},t=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),t.forEach(function(e){var t,n,o;t=r,o=i[n=e],n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o})}return r}({},t,{material:new p({name:t.name,speed:T}),customDepthMaterial:new h.a({name:t.name}),customNormalMaterial:new O({name:t.name,speed:T})})))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&P(e,t)}(n,o["a"]),n}();t.a=S},function(e,t,i){"use strict";var n=i(356),a=i(54),s=i(6);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function l(e,t,n){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var r=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=c(this,f(t).apply(this,arguments))).$name="fallback",e}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(t,a["a"]),n=t,(o=[{key:"data",value:function(){return function(r){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},t=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),t.forEach(function(e){var t,n,o;t=r,o=i[n=e],n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o})}return r}({},l(f(t.prototype),"data",this))}},{key:"getDependencies",value:function(e){return[]}},{key:"ready",value:function(){l(f(t.prototype),"ready",this).call(this)}},{key:"mounted",value:function(){this._bind(),TweenMax.fromTo(this.$els.msg,1.6,{opacity:0,y:30},{opacity:1,y:0,delay:1,ease:Expo.easeOut}),Object(s.b)("/fallback")}},{key:"beforeDestroy",value:function(){clearTimeout(this._showTimeout),clearTimeout(this._pauseTimeout),this._unbind(),l(f(t.prototype),"beforeDestroy",this).call(this)}},{key:"beforeRouteLeave",value:function(e,t,n){n()}},{key:"_bind",value:function(){}},{key:"_unbind",value:function(){}},{key:"template",get:function(){return i(566)}},{key:"components",get:function(){return{}}}])&&u(n.prototype,o),r&&u(n,r),t}(),h=i(358),d=i(114);function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(e){_(t,e,n[e])})}return t}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function b(e,t){return!t||"object"!==y(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function w(e,t,n){return(w="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=O(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function x(e,t){return(x=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var k=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=b(this,O(t).apply(this,arguments))).$name="level",e.sceneName="".concat(e.$name,"-").concat(e._router.currentRoute.params.name),e}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&x(e,t)}(t,d["a"]),n=t,(o=[{key:"data",value:function(){return m({},w(O(t.prototype),"data",this),{sceneName:this.sceneName})}},{key:"ready",value:function(){w(O(t.prototype),"ready",this).call(this)}},{key:"mounted",value:function(){w(O(t.prototype),"mounted",this).call(this),Object(s.b)("/".concat(this.$name,"-").concat(this._router.currentRoute.params.name))}},{key:"beforeDestroy",value:function(){w(O(t.prototype),"beforeDestroy",this).call(this),this._signals.instructions.hide.dispatch()}},{key:"getDependencies",value:function(e){return v(w(O(t.prototype),"getDependencies",this).call(this,e))}},{key:"template",get:function(){return i(574)}},{key:"components",get:function(){return m({},w(O(t.prototype),"components",this))}}])&&g(n.prototype,o),r&&g(n,r),t}(),E=i(363);t.a={Home:n.a,Fallback:r,Lobby:h.a,Level:k,Outro:E.a}},function(e,t,n){"use strict";var r=n(51),i=n(39);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function s(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var h=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=s(this,u(t).call(this,null,null,null))).name="ClearMaskPass",e}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(t,i["a"]),n=t,(o=[{key:"render",value:function(e){e.state.buffers.stencil.setTest(!1)}}])&&a(n.prototype,o),r&&a(n,r),t}();function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function p(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var v=function(e){function o(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(n=p(this,d(o).call(this,e,t,null))).name="MaskPass",n.inverse=!1,n.clearStencil=!0,n}var t,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(o,i["a"]),t=o,(n=[{key:"render",value:function(e,t,n){var o=e.context,r=e.state,i=this.scene,a=this.camera,s=this.inverse?0:1,u=1-s;r.buffers.color.setMask(!1),r.buffers.depth.setMask(!1),r.buffers.color.setLocked(!0),r.buffers.depth.setLocked(!0),r.buffers.stencil.setTest(!0),r.buffers.stencil.setOp(o.REPLACE,o.REPLACE,o.REPLACE),r.buffers.stencil.setFunc(o.ALWAYS,s,4294967295),r.buffers.stencil.setClear(u),this.clearStencil&&(e.setRenderTarget(t),e.clearStencil(),e.setRenderTarget(n),e.clearStencil()),e.render(i,a,t),e.render(i,a,n),r.buffers.color.setLocked(!1),r.buffers.depth.setLocked(!1),r.buffers.stencil.setFunc(o.EQUAL,1,4294967295),r.buffers.stencil.setOp(o.KEEP,o.KEEP,o.KEEP)}}])&&f(t.prototype,n),r&&f(t,r),o}();function m(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var _=function(){function n(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{noRenderToScreen:!1};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this._renderer=e,this._readBuffer=null,this._writeBuffer=null,this._noRenderToScreen=t.noRenderToScreen,null!==this._renderer&&(this._renderer.autoClear=!1,this._readBuffer=this._createBuffer(t.depthBuffer,t.stencilBuffer,t.depthTexture),this._writeBuffer=this._readBuffer.clone()),this._passes=[],this._copyPass=new r.a,this._checkPassToRender()}var e,t,o;return e=n,(t=[{key:"addPass",value:function(e,t){var n=this._renderer,o=n.getDrawingBufferSize();e.init(n,n.context.getContextAttributes().alpha),e.setSize(o.width,o.height),void 0!==t?this._passes.splice(t,0,e):this._passes.push(e),this._checkPassToRender()}},{key:"destroyPass",value:function(e){e.destroy(),this._passes.splice(this._passes.indexOf(e),1)}},{key:"getPass",value:function(e){for(var t=0,n=this._passes.length;t<n;t++){var o=this._passes[t];if(o.name===e)return o}return null}},{key:"destroyPasses",value:function(){for(var e=this._passes;0<e.length;)e.pop().destroy()}},{key:"render",value:function(e,t){var n,o,r,i,a,s=this._passes,u=this._renderer,c=this._copyPass,l=this._readBuffer,f=this._writeBuffer,p=!1;for(i=0,a=s.length;i<a;++i)(n=s[i]).enabled&&(n.render(u,l,f,e,t,p),n.needsSwap&&(p&&((o=u.context).stencilFunc(o.NOTEQUAL,1,4294967295),c.render(u,l,f),o.stencilFunc(o.EQUAL,1,4294967295)),r=l,l=f,f=r),n instanceof v?p=!0:n instanceof h&&(p=!1))}},{key:"reset",value:function(e){var t=this._readBuffer.depthBuffer,n=this._readBuffer.stencilBuffer,o=null!==this._readBuffer.depthTexture;this.destroy(e?this.createBuffer(t,n,o):e)}},{key:"destroy",value:function(e){null!==this._readBuffer&&null!==this._writeBuffer&&(this._readBuffer.dispose(),this._writeBuffer.dispose(),this._readBuffer=null,this._writeBuffer=null),this.destroyPasses(),void 0!==e?(this._readBuffer=e,this._writeBuffer=this._readBuffer.clone()):this._copyPass.destroy()}},{key:"setSize",value:function(e,t){var n,o,r=this._passes,i=this._renderer;void 0!==e&&void 0!==t||(e=(n=i.getSize()).width,t=n.height),i.setSize(e,t),o=i.getDrawingBufferSize(),this._readBuffer.setSize(o.width,o.height),this._writeBuffer.setSize(o.width,o.height);for(var a=0,s=r.length;a<s;++a)r[a].setSize(o.width,o.height)}},{key:"_createBuffer",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],o=this._renderer.getDrawingBufferSize(),r=this._renderer.context.getContextAttributes().alpha,i=new THREE.WebGLRenderTarget(o.width,o.height,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:r?THREE.RGBAFormat:THREE.RGBFormat,depthBuffer:e,stencilBuffer:t,depthTexture:n?new THREE.DepthTexture:null,generateMipmaps:!1});return n&&t&&(i.depthTexture.format=THREE.DepthStencilFormat,i.depthTexture.type=THREE.UnsignedInt248Type),i}},{key:"_checkPassToRender",value:function(){for(var e=0,t=this._passes.length;e<t;e++){var n=this._passes[e];n.renderToScreen=!1,e!==t-1||this._noRenderToScreen||(n.renderToScreen=!0)}}},{key:"passes",get:function(){return this._passes}},{key:"readBuffer",get:function(){return this._readBuffer}},{key:"writeBuffer",get:function(){return this._writeBuffer}}])&&m(e.prototype,t),o&&m(e,o),n}();t.a=_},function(e,t,n){"use strict";var o=n(211);function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(e){a(t,e,n[e])})}return t}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=function(e){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=s(this,u(n).call(this,i({data:{transition:"basic"}},e)))).uniforms=i({},t.uniforms),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(n,o["a"]),n}(),f=n(103);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function d(e,t){return!t||"object"!==p(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function y(e,t,n){return(y="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=v(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var _=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=d(this,v(t).call(this)))._init(),e}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(t,THREE.Object3D),n=t,(o=[{key:"destroy",value:function(){y(v(t.prototype),"destroy",this).call(this)}},{key:"update",value:function(e,t){this.material.update(e,t)}},{key:"_init",value:function(){this.geometry=new f.a,this.material=new l,this.mesh=new THREE.Mesh(this.geometry,this.material),this.mesh.frustumCulled=!1,this.add(this.mesh),this.matrixAutoUpdate=!1}},{key:"rtt1",get:function(){return this.material.uniforms.tDiffuse1.value},set:function(e){this.material.uniforms.tDiffuse1.value=e}},{key:"rtt2",get:function(){return this.material.uniforms.tDiffuse2.value},set:function(e){this.material.uniforms.tDiffuse2.value=e}}])&&h(n.prototype,o),r&&h(n,r),t}();t.a=_},function(e,t,n){"use strict";var o=n(289),x=n.n(o),r=n(290),k=n.n(r);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function E(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function P(e){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var T=new THREE.PlaneBufferGeometry(2,2,1,1),S=new THREE.Vector2(128,128),j=new THREE.Vector2,C=new THREE.Vector2(1,1),R=function(e){return e instanceof THREE.Vector2?e:new THREE.Vector2(e,e)},g=function(e){function O(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=t.texture,o=void 0===n?null:n,r=t.size,i=void 0===r?S:r,a=t.offset,s=void 0===a?j:a,u=t.resolution,c=void 0===u?C:u,l=t.bottom,f=void 0!==l&&l,p=t.right,h=void 0!==p&&p,d=t.component,y=void 0===d?0:d,v=t.packedComponent,m=void 0===v?0:v,_=t.unpack,g=void 0!==_&&_,b=t.alpha,w=void 0===b?1:b;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,O),(e=E(this,P(O).call(this)))._size=R(i),e._offset=R(s),e._resolution=R(c),e._material=new THREE.RawShaderMaterial({uniforms:{uTexture:{value:o},uSize:{value:new THREE.Vector4(e._size.x,e._size.y,e._offset.x,e._offset.y)},uSide:{value:new THREE.Vector2(h?1:-1,f?-1:1)},uResolution:{value:e._resolution},uComponent:{value:y},uPackedComponent:{value:m},uUnpack:{value:g},uAlpha:{value:w}},vertexShader:x.a,fragmentShader:k.a,transparent:1!==w,depthWrite:!1}),e._mesh=new THREE.Mesh(T,e._material),e._mesh.frustumCulled=!1,e._mesh.renderOrder=-1,e.add(e._mesh),e}var t,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(O,THREE.Object3D),t=O,(n=[{key:"size",get:function(){return this._size},set:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:S;e=R(e),this._size=e,this._material.uniforms.uSize.value.x=e.x,this._material.uniforms.uSize.value.y=e.y}},{key:"offset",get:function(){return this._offset},set:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:j;e=R(e),this._offset=e,this._material.uniforms.uSize.value.z=e.x,this._material.uniforms.uSize.value.w=e.y}},{key:"resolution",get:function(){return this._resolution},set:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:C;e=R(e),this._resolution=e,this._material.uniforms.uResolution.value.x=e.x,this._material.uniforms.uResolution.value.y=e.y}}])&&a(t.prototype,n),o&&a(t,o),O}();function u(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var c=new THREE.OrthographicCamera(-1,1,1,-1,0,1),b=new THREE.Vector2,w=new THREE.Vector2,l=new THREE.Vector2,f=function(){function i(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.renderer,n=void 0===t?null:t,o=e.margin,r=void 0===o?0:o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),this._renderer=n,this._margin=r,this._enabled=!0,this._rendererSize=null,this._rendererAspect=null,this._camera=c,this._scene=new THREE.Scene,this.resize()}var e,t,n;return e=i,(t=[{key:"add",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.texture,n=void 0===t?null:t,o=e.component,r=void 0===o?0:o,i=e.packedComponent,a=void 0===i?0:i,s=e.unpack,u=void 0!==s&&s,c=e.alpha,l=void 0===c?.8:c,f=e.size,p=void 0===f?128:f,h=e.aspect,d=void 0===h||h,y=e.bottom,v=void 0===y||y;if(2===arguments.length){n=arguments[0];var m=arguments[1].split("|").map(Number);r=m[0],a=m[1],u=m[2]}d&&(w.set(p*this._rendererAspect,p),p=w);var _=new g({texture:n,component:r,packedComponent:a,unpack:u,alpha:l,size:p,bottom:v,offset:this._computeOffset(),resolution:b});this._scene.add(_)}},{key:"resize",value:function(){this._rendererSize=this._renderer.getSize(),this._rendererAspect=this._rendererSize.width/this._rendererSize.height,b.set(this._rendererSize.width,this._rendererSize.height),this._updateOffsets()}},{key:"render",value:function(){if(this._enabled){var e=this._renderer,t=e.autoClear;e.autoClear=!1,e.clearDepth(),e.render(this._scene,this._camera),e.autoClear=t}}},{key:"_updateOffsets",value:function(){for(var e=this._scene.children,t=0,n=e.length;t<n;t++){var o=e[t];o.offset=this._computeOffset(t),o.resolution=b}}},{key:"_computeOffset",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this._scene.children.length;l.set(0,0);for(var t=l,n=0,o=e;n<o;n++){var r=this._scene.children[n];t.y+=r.size.y+this._margin,t.y+r.size.y>this._rendererSize.height&&(t.y=0,t.x+=r.size.x+this._margin)}return t}},{key:"enabled",get:function(){return this._enabled},set:function(e){this._enabled=e}},{key:"margin",get:function(){return this._margin},set:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;this._margin=e,this._updateOffsets()}}])&&u(e.prototype,t),n&&u(e,n),i}();t.a=f},function(e,t,n){"use strict";var r=n(48).isObject;function i(e,t){for(var n in t){var o=t[n];r(o)?i(e[n],o):void 0!==e&&(e[n]=o)}}n.d(t,"a",function(){return i})},,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.r(t);var o=new(n(198).a);document.addEventListener("DOMContentLoaded",o.onDOMContentLoaded)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(t,n,e){if(void 0===e||"function"!=typeof e.value)throw new SyntaxError("@bind decorator can only be applied to a method");var o=e.value,r=e.configurable,i=e.enumerable;return{configurable:r,enumerable:i,get:function(){if(this===t)return o;var e=o.bind(this);return Object.defineProperty(this,n,{configurable:!0,writable:!0,enumerable:!1,value:e}),e}}},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){for(var e=arguments.length,l=Array(e),t=0;t<e;t++)l[t]=arguments[t];if("function"!=typeof l[0])return function(e){for(var t=e.prototype,n={},o=0,r=l.length;o<r;o++){var i=l[o];for(var a in i){var s=i[a];"function"==typeof s?(n[a]=n[a]||[],n[a].push(s)):t[a]=s}}var u=function(e){var a=n[e],s=t[e];t[e]=function(){for(var e=void 0,t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];for(var r=0,i=a.length;r<i;r++)e=a[r].apply(this,n);return"function"==typeof s&&(e=s.apply(this,n)),e}};for(var c in n)u(c)};throw new SyntaxError("@mixin decorator '"+l[0].name+"' requires at least one mixin")},e.exports=t.default},function(r,e,i){(function(e){var t,n=void 0!==e?e:"undefined"!=typeof window?window:{},o=i(401);"undefined"!=typeof document?t=document:(t=n["__GLOBAL_DOCUMENT_CACHE@4"])||(t=n["__GLOBAL_DOCUMENT_CACHE@4"]=o),r.exports=t}).call(this,i(34))},function(e,t){},function(e,t,n){var o=n(403);e.exports=function(e){var t=o();return e(t.broadcast),t.listen}},function(e,t){e.exports=function(){var n=[];return{broadcast:function(e){for(var t=0;t<n.length;t++)n[t](e)},listen:function(t){return n.push(t),function(){var e=n.indexOf(t);-1!==e&&n.splice(e,1)}}}}},function(e,t,n){"use strict";e.exports=function(e){var t=function(e){if(null!=e.hidden)return"";if(null!=e.mozHidden)return"moz";if(null!=e.msHidden)return"ms";if(null!=e.webkitHidden)return"webkit"}(e);if(null==t)return;return{hidden:(n=t+"Hidden",n.substring(0,1).toLowerCase()+n.substring(1)),event:t+"visibilitychange"};var n}},function(t,e,n){(function(e,c){t.exports=function(n){var o={};function r(e){if(o[e])return o[e].exports;var t=o[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,r),t.l=!0,t.exports}return r.m=n,r.c=o,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=27)}([function(e,t){e.exports=n(406)},function(e,t,n){"use strict";e.exports=function(){var _=arguments,g=0,b=function(e,t,n,o){n||(n=" ");var r=e.length>=t?"":new Array(1+t-e.length>>>0).join(n);return o?e+r:r+e},w=function(e,t,n,o,r,i){var a=o-e.length;return 0<a&&(e=n||!r?b(e,o,i,n):[e.slice(0,t.length),b("",a,"0",!0),e.slice(t.length)].join("")),e},O=function(e,t,n,o,r,i,a){var s=e>>>0;return e=(n=n&&s&&{2:"0b",8:"0",16:"0x"}[t]||"")+b(s.toString(t),i||0,"0",!1),w(e,n,o,r,a)},x=function(e,t,n,o,r,i){return null!=o&&(e=e.slice(0,o)),w(e,"",t,n,r,i)};return _[g++].replace(/%%|%(\d+\$)?([-+'#0 ]*)(\*\d+\$|\*|\d+)?(?:\.(\*\d+\$|\*|\d+))?([scboxXuideEfFgG])/g,function(e,t,n,o,r,i){var a,s,u,c,l;if("%%"===e)return"%";var f,p=!1,h="",d=!1,y=!1,v=" ",m=n.length;for(f=0;f<m;f++)switch(n.charAt(f)){case" ":h=" ";break;case"+":h="+";break;case"-":p=!0;break;case"'":v=n.charAt(f+1);break;case"0":d=!0,v="0";break;case"#":y=!0}if((o=o?"*"===o?+_[g++]:"*"===o.charAt(0)?+_[o.slice(1,-1)]:+o:0)<0&&(o=-o,p=!0),!isFinite(o))throw new Error("sprintf: (minimum-)width must be finite");switch(r=r?"*"===r?+_[g++]:"*"===r.charAt(0)?+_[r.slice(1,-1)]:+r:-1<"fFeE".indexOf(i)?6:"d"===i?0:void 0,l=t?_[t.slice(0,-1)]:_[g++],i){case"s":return x(l+"",p,o,r,d,v);case"c":return x(String.fromCharCode(+l),p,o,r,d);case"b":return O(l,2,y,p,o,r,d);case"o":return O(l,8,y,p,o,r,d);case"x":return O(l,16,y,p,o,r,d);case"X":return O(l,16,y,p,o,r,d).toUpperCase();case"u":return O(l,10,y,p,o,r,d);case"i":case"d":return a=+l||0,l=(s=(a=Math.round(a-a%1))<0?"-":h)+b(String(Math.abs(a)),r,"0",!1),w(l,s,p,o,d);case"e":case"E":case"f":case"F":case"g":case"G":return s=(a=+l)<0?"-":h,u=["toExponential","toFixed","toPrecision"]["efg".indexOf(i.toLowerCase())],c=["toString","toUpperCase"]["eEfFgG".indexOf(i)%2],l=s+Math.abs(a)[u](r),w(l,s,p,o,d)[c]();default:return e}})}},function(e,t){e.exports=function(s){"use strict";return s.exports={VERSION:s.VERSION},s.exports.twig=function(e){var t=e.id,n={strict_variables:e.strict_variables||!1,autoescape:null!=e.autoescape&&e.autoescape||!1,allowInlineIncludes:e.allowInlineIncludes||!1,rethrow:e.rethrow||!1,namespaces:e.namespaces};if(s.cache&&t&&s.validateId(t),void 0!==e.debug&&(s.debug=e.debug),void 0!==e.trace&&(s.trace=e.trace),void 0!==e.data)return s.Templates.parsers.twig({data:e.data,path:e.hasOwnProperty("path")?e.path:void 0,module:e.module,id:t,options:n});if(void 0!==e.ref){if(void 0!==e.id)throw new s.Error("Both ref and id cannot be set on a twig.js template.");return s.Templates.load(e.ref)}if(void 0===e.method)return void 0!==e.href?s.Templates.loadRemote(e.href,{id:t,method:"ajax",parser:e.parser||"twig",base:e.base,module:e.module,precompiled:e.precompiled,async:e.async,options:n},e.load,e.error):void 0!==e.path?s.Templates.loadRemote(e.path,{id:t,method:"fs",parser:e.parser||"twig",base:e.base,module:e.module,precompiled:e.precompiled,async:e.async,options:n},e.load,e.error):void 0;if(!s.Templates.isRegisteredLoader(e.method))throw new s.Error('Loader for "'+e.method+'" is not defined.');return s.Templates.loadRemote(e.name||e.href||e.path||t||void 0,{id:t,method:e.method,parser:e.parser||"twig",base:e.base,module:e.module,precompiled:e.precompiled,async:e.async,options:n},e.load,e.error)},s.exports.extendFilter=function(e,t){s.filter.extend(e,t)},s.exports.extendFunction=function(e,t){s._function.extend(e,t)},s.exports.extendTest=function(e,t){s.test.extend(e,t)},s.exports.extendTag=function(e){s.logic.extend(e)},s.exports.extend=function(e){e(s)},s.exports.compile=function(e,t){var n,o=t.filename,r=t.filename;return n=new s.Template({data:e,path:r,id:o,options:t.settings["twig options"]}),function(e){return n.render(e)}},s.exports.renderFile=function(e,t,n){"function"==typeof t&&(n=t,t={});var o=(t=t||{}).settings||{},r=o["twig options"],i={path:e,base:o.views,load:function(e){r&&r.allow_async?e.renderAsync(t).then(function(e){n(null,e)},n):n(null,""+e.render(t))}};if(r)for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a]);s.exports.twig(i)},s.exports.__express=s.exports.renderFile,s.exports.cache=function(e){s.cache=e},s.exports.path=s.path,s.exports.filters=s.filters,s.exports.Promise=s.Promise,s}},function(e,t){e.exports=function(u){"use strict";return u.parseAsync=function(e,t){return u.parse.call(this,e,t,!0)},u.expression.parseAsync=function(e,t,n){return u.expression.parse.call(this,e,t,n,!0)},u.logic.parseAsync=function(e,t,n){return u.logic.parse.call(this,e,t,n,!0)},u.Template.prototype.renderAsync=function(e,t){return this.render(e,t,!0)},u.async={},u.isPromise=function(e){return e&&e.then&&"function"==typeof e.then},u.async.potentiallyAsync=function(e,t,n){return t?u.Promise.resolve(n.call(e)):function(e,t,n){var o=n.call(e),r=null,i=!0;if(!u.isPromise(o))return o;if(o.then(function(e){o=e,i=!1}).catch(function(e){r=e}),null!==r)throw r;if(i)throw new u.Error("You are using Twig.js in sync mode in combination with async extensions.");return o}(e,0,n)},u.Thenable=function(e,t,n){this.then=e,this._value=n?t:null,this._state=n||0},u.Thenable.prototype.catch=function(e){return 1==this._state?this:this.then(null,e)},u.Thenable.resolvedThen=function(e){try{return u.Promise.resolve(e(this._value))}catch(e){return u.Promise.reject(e)}},u.Thenable.rejectedThen=function(e,t){if(!t||"function"!=typeof t)return this;var n=this._value,o=u.attempt(function(){return t(n)},u.Promise.reject);return u.Promise.resolve(o)},u.Promise=function(e){var n=0,o=null,r=function(e,t){n=e,o=t};return function(e,t,n){try{e(function(e){r(1,e)},n)}catch(e){n(e)}}(e,0,function(e){r(2,e)}),1===n?u.Promise.resolve(o):2===n?u.Promise.reject(o):(r=u.FullPromise()).promise},u.FullPromise=function(){var r=null;function n(e){e(s._value)}function o(e,t){t(s._value)}var a=function(e,t){var n,o;o=[e,t,-2],(n=r)?-2==n[2]?n=[n,o]:n.push(o):n=o,r=n};function e(e,t){s._state||(s._value=t,s._state=e,a=1==e?n:o,r&&(-2===r[2]&&(a(r[0],r[1]),r=null),u.forEach(r,function(e){a(e[0],e[1])}),r=null))}var s=new u.Thenable(function(o,r){var e="function"==typeof o;if(1==s._state&&!e)return u.Promise.resolve(s._value);if(1===s._state)return u.attempt(function(){return u.Promise.resolve(o(s._value))},u.Promise.reject);var i="function"==typeof r;return u.Promise(function(t,n){a(e?function(e){u.attempt(function(){t(o(e))},n)}:t,i?function(e){u.attempt(function(){t(r(e))},n)}:n)})});return e.promise=s,e},u.Promise.defaultResolved=new u.Thenable(u.Thenable.resolvedThen,void 0,1),u.Promise.emptyStringResolved=new u.Thenable(u.Thenable.resolvedThen,"",1),u.Promise.resolve=function(e){return arguments.length<1||void 0===e?u.Promise.defaultResolved:u.isPromise(e)?e:""===e?u.Promise.emptyStringResolved:new u.Thenable(u.Thenable.resolvedThen,e,1)},u.Promise.reject=function(e){return new u.Thenable(u.Thenable.rejectedThen,e,2)},u.Promise.all=function(e){var n=new Array(e.length);return u.async.forEach(e,function(e,t){if(u.isPromise(e)){if(1!=e._state)return e.then(function(e){n[t]=e});n[t]=e._value}else n[t]=e}).then(function(){return n})},u.async.forEach=function(n,o){var r=n.length,i=0;return function e(){var t=null;do{if(i==r)return u.Promise.resolve();t=o(n[i],i),i++}while(!t||!u.isPromise(t)||1==t._state);return t.then(e)}()},u}},function(e,t){e.exports=function(o){"use strict";return o.tests={empty:function(e){if(null==e)return!0;if("number"==typeof e)return!1;if(e.length&&0<e.length)return!1;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},odd:function(e){return e%2==1},even:function(e){return e%2==0},divisibleby:function(e,t){return e%t[0]==0},defined:function(e){return void 0!==e},none:function(e){return null===e},null:function(e){return this.none(e)},"same as":function(e,t){return e===t[0]},sameas:function(e,t){return console.warn("`sameas` is deprecated use `same as`"),o.tests["same as"](e,t)},iterable:function(e){return e&&(o.lib.is("Array",e)||o.lib.is("Object",e))}},o.test=function(e,t,n){if(!o.tests[e])throw"Test "+e+" is not defined.";return o.tests[e](t,n)},o.test.extend=function(e,t){o.tests[e]=t},o}},function(e,t,f){e.exports=function(l){"use strict";l.path={};var i=/.::/,a=/@/;return l.path.parsePath=function(e,t){var n=null,o=e.options.namespaces,r=t||"";if(o&&"object"==typeof o)for(n in o){if(i.test(r))return r=r.replace(n+"::",o[n]);if(a.test(r))return r=r.replace("@"+n,o[n])}return l.path.relativePath(e,r)},l.path.relativePath=function(e,t){var n,o,r,i="/",a=[];if(t=t||"",e.url)n=void 0!==e.base?e.base+("/"===e.base.charAt(e.base.length-1)?"":"/"):e.url;else if(e.path){var s=f(0),u=s.sep||i,c=new RegExp("^\\.{1,2}"+u.replace("\\","\\\\"));t=t.replace(/\//g,u),n=(n=void 0!==e.base&&null==t.match(c)?(t=t.replace(e.base,""),e.base+u):s.normalize(e.path)).replace(u+u,u),i=u}else{if(!e.name&&!e.id||!e.method||"fs"===e.method||"ajax"===e.method)throw new l.Error("Cannot extend an inline template.");n=e.base||e.name||e.id}for((o=n.split(i)).pop(),o=o.concat(t.split(i));0<o.length;)"."==(r=o.shift())||(".."==r&&0<a.length&&".."!=a[a.length-1]?a.pop():a.push(r));return a.join(i)},l}},function(e,t){e.exports=function(t){"use strict";t.Templates.registerParser("twig",function(e){return new t.Template(e)})}},function(e,t){e.exports=function(e){"use strict";e.Templates.registerParser("source",function(e){return e.data||""})}},function(e,t){e.exports=function(h){"use strict";for(h.logic={},h.logic.type={if_:"Twig.logic.type.if",endif:"Twig.logic.type.endif",for_:"Twig.logic.type.for",endfor:"Twig.logic.type.endfor",else_:"Twig.logic.type.else",elseif:"Twig.logic.type.elseif",set:"Twig.logic.type.set",setcapture:"Twig.logic.type.setcapture",endset:"Twig.logic.type.endset",filter:"Twig.logic.type.filter",endfilter:"Twig.logic.type.endfilter",shortblock:"Twig.logic.type.shortblock",block:"Twig.logic.type.block",endblock:"Twig.logic.type.endblock",extends_:"Twig.logic.type.extends",use:"Twig.logic.type.use",include:"Twig.logic.type.include",spaceless:"Twig.logic.type.spaceless",endspaceless:"Twig.logic.type.endspaceless",macro:"Twig.logic.type.macro",endmacro:"Twig.logic.type.endmacro",import_:"Twig.logic.type.import",from:"Twig.logic.type.from",embed:"Twig.logic.type.embed",endembed:"Twig.logic.type.endembed",with:"Twig.logic.type.with",endwith:"Twig.logic.type.endwith"},h.logic.definitions=[{type:h.logic.type.if_,regex:/^if\s+([\s\S]+)$/,next:[h.logic.type.else_,h.logic.type.elseif,h.logic.type.endif],open:!0,compile:function(e){var t=e.match[1];return e.stack=h.expression.compile.call(this,{type:h.expression.type.expression,value:t}).stack,delete e.match,e},parse:function(t,n,o){var r=this;return h.expression.parseAsync.call(this,t.stack,n).then(function(e){return o=!0,h.lib.boolval(e)?(o=!1,h.parseAsync.call(r,t.output,n)):""}).then(function(e){return{chain:o,output:e}})}},{type:h.logic.type.elseif,regex:/^elseif\s+([^\s].*)$/,next:[h.logic.type.else_,h.logic.type.elseif,h.logic.type.endif],open:!1,compile:function(e){var t=e.match[1];return e.stack=h.expression.compile.call(this,{type:h.expression.type.expression,value:t}).stack,delete e.match,e},parse:function(t,n,o){var r=this;return h.expression.parseAsync.call(this,t.stack,n).then(function(e){return o&&h.lib.boolval(e)?(o=!1,h.parseAsync.call(r,t.output,n)):""}).then(function(e){return{chain:o,output:e}})}},{type:h.logic.type.else_,regex:/^else$/,next:[h.logic.type.endif,h.logic.type.endfor],open:!1,parse:function(e,t,n){var o=h.Promise.resolve("");return n&&(o=h.parseAsync.call(this,e.output,t)),o.then(function(e){return{chain:n,output:e}})}},{type:h.logic.type.endif,regex:/^endif$/,next:[],open:!1},{type:h.logic.type.for_,regex:/^for\s+([a-zA-Z0-9_,\s]+)\s+in\s+([\S\s]+?)(?:\s+if\s+([^\s].*))?$/,next:[h.logic.type.else_,h.logic.type.endfor],open:!0,compile:function(e){var t=e.match[1],n=e.match[2],o=e.match[3],r=null;if(e.key_var=null,e.value_var=null,0<=t.indexOf(",")){if(2!==(r=t.split(",")).length)throw new h.Error("Invalid expression in for loop: "+t);e.key_var=r[0].trim(),e.value_var=r[1].trim()}else e.value_var=t;return e.expression=h.expression.compile.call(this,{type:h.expression.type.expression,value:n}).stack,o&&(e.conditional=h.expression.compile.call(this,{type:h.expression.type.expression,value:o}).stack),delete e.match,e},parse:function(a,s,e){var u,n,c=[],l=0,f=this,p=a.conditional,o=function(e,t){var n,o,r,i=h.ChildContext(s);return i[a.value_var]=t,a.key_var&&(i[a.key_var]=e),i.loop=(o=u,{index:(n=l)+1,index0:n,revindex:(r=void 0!==p)?void 0:NaN,revindex0:r?void 0:NaN,first:!1,last:!!r&&void 0,length:r?void 0:o,parent:s}),(void 0===p?h.Promise.resolve(!0):h.expression.parseAsync.call(f,p,i)).then(function(e){if(e)return h.parseAsync.call(f,a.output,i).then(function(e){c.push(e),l+=1})}).then(function(){delete i.loop,delete i[a.value_var],delete i[a.key_var],h.merge(s,i,!0)})};return h.expression.parseAsync.call(this,a.expression,s).then(function(t){return h.lib.isArray(t)?(u=t.length,h.async.forEach(t,function(e){return o(l,e)})):h.lib.is("Object",t)?(n=void 0!==t._keys?t._keys:Object.keys(t),u=n.length,h.async.forEach(n,function(e){if("_keys"!==e)return o(e,t[e])})):void 0}).then(function(){return{chain:0===c.length,output:h.output.call(f,c)}})}},{type:h.logic.type.endfor,regex:/^endfor$/,next:[],open:!1},{type:h.logic.type.set,regex:/^set\s+([a-zA-Z0-9_,\s]+)\s*=\s*([\s\S]+)$/,next:[],open:!0,compile:function(e){var t=e.match[1].trim(),n=e.match[2],o=h.expression.compile.call(this,{type:h.expression.type.expression,value:n}).stack;return e.key=t,e.expression=o,delete e.match,e},parse:function(e,t,n){var o=e.key;return h.expression.parseAsync.call(this,e.expression,t).then(function(e){return e===t&&(e=h.lib.copy(e)),t[o]=e,{chain:n,context:t}})}},{type:h.logic.type.setcapture,regex:/^set\s+([a-zA-Z0-9_,\s]+)$/,next:[h.logic.type.endset],open:!0,compile:function(e){var t=e.match[1].trim();return e.key=t,delete e.match,e},parse:function(e,t,n){var o=this,r=e.key;return h.parseAsync.call(this,e.output,t).then(function(e){return o.context[r]=e,t[r]=e,{chain:n,context:t}})}},{type:h.logic.type.endset,regex:/^endset$/,next:[],open:!1},{type:h.logic.type.filter,regex:/^filter\s+(.+)$/,next:[h.logic.type.endfilter],open:!0,compile:function(e){var t="|"+e.match[1].trim();return e.stack=h.expression.compile.call(this,{type:h.expression.type.expression,value:t}).stack,delete e.match,e},parse:function(n,o,t){var r=this;return h.parseAsync.call(this,n.output,o).then(function(e){var t=[{type:h.expression.type.string,value:e}].concat(n.stack);return h.expression.parseAsync.call(r,t,o)}).then(function(e){return{chain:t,output:e}})}},{type:h.logic.type.endfilter,regex:/^endfilter$/,next:[],open:!1},{type:h.logic.type.block,regex:/^block\s+([a-zA-Z0-9_]+)$/,next:[h.logic.type.endblock],open:!0,compile:function(e){return e.block=e.match[1].trim(),delete e.match,e},parse:function(t,n,e){var o,r=this,i=h.Promise.resolve(),a=-1<h.indexOf(this.importedBlocks,t.block),s=this.blocks[t.block]&&-1<h.indexOf(this.blocks[t.block],h.placeholders.parent);return h.forEach(this.parseStack,function(e){e.type==h.logic.type.for_&&(t.overwrite=!0)}),(void 0===this.blocks[t.block]||a||s||t.overwrite)&&(i=(i=t.expression?h.expression.parseAsync.call(this,t.output,n).then(function(e){return h.expression.parseAsync.call(r,{type:h.expression.type.string,value:e},n)}):h.parseAsync.call(this,t.output,n).then(function(e){return h.expression.parseAsync.call(r,{type:h.expression.type.string,value:e},n)})).then(function(e){a&&r.importedBlocks.splice(r.importedBlocks.indexOf(t.block),1),r.blocks[t.block]=s?h.Markup(r.blocks[t.block].replace(h.placeholders.parent,e)):e,r.originalBlockTokens[t.block]={type:t.type,block:t.block,output:t.output,overwrite:!0}})),i.then(function(){return o=r.child.blocks[t.block]?r.child.blocks[t.block]:r.blocks[t.block],{chain:e,output:o}})}},{type:h.logic.type.shortblock,regex:/^block\s+([a-zA-Z0-9_]+)\s+(.+)$/,next:[],open:!0,compile:function(e){return e.expression=e.match[2].trim(),e.output=h.expression.compile({type:h.expression.type.expression,value:e.expression}).stack,e.block=e.match[1].trim(),delete e.match,e},parse:function(e,t,n){for(var o=new Array(arguments.length),r=arguments.length;0<r--;)o[r]=arguments[r];return h.logic.handler[h.logic.type.block].parse.apply(this,o)}},{type:h.logic.type.endblock,regex:/^endblock(?:\s+([a-zA-Z0-9_]+))?$/,next:[],open:!1},{type:h.logic.type.extends_,regex:/^extends\s+(.+)$/,next:[],open:!0,compile:function(e){var t=e.match[1].trim();return delete e.match,e.stack=h.expression.compile.call(this,{type:h.expression.type.expression,value:t}).stack,e},parse:function(e,t,n){var o=this,r=h.ChildContext(t);return h.expression.parseAsync.call(this,e.stack,t).then(function(e){return((o.extend=e)instanceof h.Template?e:o.importFile(e)).renderAsync(r)}).then(function(){return h.lib.extend(t,r),{chain:n,output:""}})}},{type:h.logic.type.use,regex:/^use\s+(.+)$/,next:[],open:!0,compile:function(e){var t=e.match[1].trim();return delete e.match,e.stack=h.expression.compile.call(this,{type:h.expression.type.expression,value:t}).stack,e},parse:function(e,t,n){var o=this;return h.expression.parseAsync.call(this,e.stack,t).then(function(e){return o.importBlocks(e),{chain:n,output:""}})}},{type:h.logic.type.include,regex:/^include\s+(.+?)(?:\s|$)(ignore missing(?:\s|$))?(?:with\s+([\S\s]+?))?(?:\s|$)(only)?$/,next:[],open:!0,compile:function(e){var t=e.match,n=t[1].trim(),o=void 0!==t[2],r=t[3],i=void 0!==t[4]&&t[4].length;return delete e.match,e.only=i,e.ignoreMissing=o,e.stack=h.expression.compile.call(this,{type:h.expression.type.expression,value:n}).stack,void 0!==r&&(e.withStack=h.expression.compile.call(this,{type:h.expression.type.expression,value:r.trim()}).stack),e},parse:function(e,t,n){var o=e.only?{}:h.ChildContext(t),r=e.ignoreMissing,i=this,a={chain:n,output:""};return(void 0!==e.withStack?h.expression.parseAsync.call(this,e.withStack,t).then(function(e){h.lib.extend(o,e)}):h.Promise.resolve()).then(function(){return h.expression.parseAsync.call(i,e.stack,t)}).then(function(e){if(e instanceof h.Template)return e.renderAsync(o);try{return i.importFile(e).renderAsync(o)}catch(e){if(r)return"";throw e}}).then(function(e){return""!==e&&(a.output=e),a})}},{type:h.logic.type.spaceless,regex:/^spaceless$/,next:[h.logic.type.endspaceless],open:!0,parse:function(e,t,n){return h.parseAsync.call(this,e.output,t).then(function(e){var t=e.replace(/>\s+</g,"><").trim();return t=h.Markup(t),{chain:n,output:t}})}},{type:h.logic.type.endspaceless,regex:/^endspaceless$/,next:[],open:!1},{type:h.logic.type.macro,regex:/^macro\s+([a-zA-Z0-9_]+)\s*\(\s*((?:[a-zA-Z0-9_]+(?:\s*=\s*([\s\S]+))?(?:,\s*)?)*)\s*\)$/,next:[h.logic.type.endmacro],open:!0,compile:function(e){var t=e.match[1],n=e.match[2].split(/\s*,\s*/),o=n.map(function(e){return e.split(/\s*=\s*/)[0]}),r=o.length;if(1<r)for(var i={},a=0;a<r;a++){var s=o[a];if(i[s])throw new h.Error("Duplicate arguments for parameter: "+s);i[s]=1}return e.macroName=t,e.parameters=o,e.defaults=n.reduce(function(e,t){var n=t.split(/\s*=\s*/),o=n[0],r=n[1];return e[o]=r?h.expression.compile.call(this,{type:h.expression.type.expression,value:r}).stack:void 0,e},{}),delete e.match,e},parse:function(r,i,e){var t=this;return this.macros[r.macroName]=function(){var n={_self:t.macros},o=Array.prototype.slice.call(arguments);return h.async.forEach(r.parameters,function(t,e){return void 0!==o[e]?(n[t]=o[e],!0):void 0!==r.defaults[t]?h.expression.parseAsync.call(this,r.defaults[t],i).then(function(e){return n[t]=e,h.Promise.resolve()}):!(n[t]=void 0)}).then(function(){return h.parseAsync.call(t,r.output,n)})},{chain:e,output:""}}},{type:h.logic.type.endmacro,regex:/^endmacro$/,next:[],open:!1},{type:h.logic.type.import_,regex:/^import\s+(.+)\s+as\s+([a-zA-Z0-9_]+)$/,next:[],open:!0,compile:function(e){var t=e.match[1].trim(),n=e.match[2].trim();return delete e.match,e.expression=t,e.contextName=n,e.stack=h.expression.compile.call(this,{type:h.expression.type.expression,value:t}).stack,e},parse:function(t,n,e){var o=this,r={chain:e,output:""};return"_self"===t.expression?(n[t.contextName]=this.macros,h.Promise.resolve(r)):h.expression.parseAsync.call(this,t.stack,n).then(function(e){return o.importFile(e||t.expression)}).then(function(e){return n[t.contextName]=e.renderAsync({},{output:"macros"}),r})}},{type:h.logic.type.from,regex:/^from\s+(.+)\s+import\s+([a-zA-Z0-9_, ]+)$/,next:[],open:!0,compile:function(e){for(var t=e.match[1].trim(),n=e.match[2].trim().split(/\s*,\s*/),o={},r=0;r<n.length;r++){var i=n[r],a=i.match(/^([a-zA-Z0-9_]+)\s+as\s+([a-zA-Z0-9_]+)$/);a?o[a[1].trim()]=a[2].trim():i.match(/^([a-zA-Z0-9_]+)$/)&&(o[i]=i)}return delete e.match,e.expression=t,e.macroNames=o,e.stack=h.expression.compile.call(this,{type:h.expression.type.expression,value:t}).stack,e},parse:function(n,o,r){var t=this,e=h.Promise.resolve(this.macros);return"_self"!==n.expression&&(e=h.expression.parseAsync.call(this,n.stack,o).then(function(e){return t.importFile(e||n.expression)}).then(function(e){return e.renderAsync({},{output:"macros"})})),e.then(function(e){for(var t in n.macroNames)e.hasOwnProperty(t)&&(o[n.macroNames[t]]=e[t]);return{chain:r,output:""}})}},{type:h.logic.type.embed,regex:/^embed\s+(.+?)(?:\s+(ignore missing))?(?:\s+with\s+([\S\s]+?))?(?:\s+(only))?$/,next:[h.logic.type.endembed],open:!0,compile:function(e){var t=e.match,n=t[1].trim(),o=void 0!==t[2],r=t[3],i=void 0!==t[4]&&t[4].length;return delete e.match,e.only=i,e.ignoreMissing=o,e.stack=h.expression.compile.call(this,{type:h.expression.type.expression,value:n}).stack,void 0!==r&&(e.withStack=h.expression.compile.call(this,{type:h.expression.type.expression,value:r.trim()}).stack),e},parse:function(t,e,n){var o,r,i={},a=this,s=h.Promise.resolve();if(!t.only)for(o in e)e.hasOwnProperty(o)&&(i[o]=e[o]);return void 0!==t.withStack&&(s=h.expression.parseAsync.call(this,t.withStack,e).then(function(e){for(o in e)e.hasOwnProperty(o)&&(i[o]=e[o])})),s.then(function(){return s=null,h.expression.parseAsync.call(a,t.stack,i)}).then(function(e){if(e instanceof h.Template)r=e;else try{r=a.importFile(e)}catch(e){if(t.ignoreMissing)return"";throw a=null,e}return a._blocks=h.lib.copy(a.blocks),a.blocks={},h.parseAsync.call(a,t.output,i).then(function(){return r.renderAsync(i,{blocks:a.blocks})})}).then(function(e){return a.blocks=h.lib.copy(a._blocks),{chain:n,output:e}})}},{type:h.logic.type.endembed,regex:/^endembed$/,next:[],open:!1},{type:h.logic.type.with,regex:/^(?:with\s+([\S\s]+?))(?:\s|$)(only)?$/,next:[h.logic.type.endwith],open:!0,compile:function(e){var t=e.match,n=t[1],o=void 0!==t[2]&&t[2].length;return delete e.match,e.only=o,void 0!==n&&(e.withStack=h.expression.compile.call(this,{type:h.expression.type.expression,value:n.trim()}).stack),e},parse:function(e,t,n){var o,r={},i=this,a=h.Promise.resolve();return e.only||(r=h.ChildContext(t)),void 0!==e.withStack&&(a=h.expression.parseAsync.call(this,e.withStack,t).then(function(e){for(o in e)e.hasOwnProperty(o)&&(r[o]=e[o])})),a.then(function(){return h.parseAsync.call(i,e.output,r)}).then(function(e){return{chain:n,output:e}})}},{type:h.logic.type.endwith,regex:/^endwith$/,next:[],open:!1}],h.logic.handler={},h.logic.extendType=function(e,t){t=t||"Twig.logic.type"+e,h.logic.type[e]=t},h.logic.extend=function(e){if(!e.type)throw new h.Error("Unable to extend logic definition. No type provided for "+e);h.logic.extendType(e.type),h.logic.handler[e.type]=e};0<h.logic.definitions.length;)h.logic.extend(h.logic.definitions.shift());return h.logic.compile=function(e){var t=e.value.trim(),n=h.logic.tokenize.call(this,t),o=h.logic.handler[n.type];return o.compile&&(n=o.compile.call(this,n),h.log.trace("Twig.logic.compile: ","Compiled logic token to ",n)),n},h.logic.tokenize=function(e){var t=null,n=null,o=null,r=null,i=null,a=null,s=null;for(t in e=e.trim(),h.logic.handler)for(n=h.logic.handler[t].type,r=o=h.logic.handler[t].regex,h.lib.isArray(o)||(r=[o]),i=r.length,a=0;a<i;a++)if(null!==(s=r[a].exec(e)))return h.log.trace("Twig.logic.tokenize: ","Matched a ",n," regular expression of ",s),{type:n,match:s};throw new h.Error("Unable to parse '"+e.trim()+"'")},h.logic.parse=function(o,r,i,e){return h.async.potentiallyAsync(this,e,function(){h.log.debug("Twig.logic.parse: ","Parsing logic token ",o);var e,t=h.logic.handler[o.type],n=this;return t.parse?(n.parseStack.unshift(o),e=t.parse.call(n,o,r||{},i),h.isPromise(e)?e=e.then(function(e){return n.parseStack.shift(),e}):n.parseStack.shift(),e):""})},h}},function(e,t){e.exports=n(407)},function(e,t,n){e.exports=function(l){"use strict";var f,t;try{f=n(9),t=n(0)}catch(l){}l.Templates.registerLoader("fs",function(n,o,r,i){var a,e=null,s=o.precompiled,u=this.parsers[o.parser]||this.parser.twig;if(!f||!t)throw new l.Error('Unsupported platform: Unable to load from file because there is no "fs" or "path" implementation');var c=function(e,t){e?"function"==typeof i&&i(e):(!0===s&&(t=JSON.parse(t)),o.data=t,o.path=o.path||n,a=u.call(this,o),"function"==typeof r&&r(a))};if(o.path=o.path||n,o.async)return f.stat(o.path,function(e,t){!e&&t.isFile()?f.readFile(o.path,"utf8",c):"function"==typeof i&&i(new l.Error("Unable to find template file "+o.path))}),!0;try{if(!f.statSync(o.path).isFile())throw new l.Error("Unable to find template file "+o.path)}catch(e){throw new l.Error("Unable to find template file "+o.path)}return e=f.readFileSync(o.path,"utf8"),c(void 0,e),a})}},function(e,t){e.exports=function(c){"use strict";c.Templates.registerLoader("ajax",function(t,n,o,r){var i,a,s=n.precompiled,u=this.parsers[n.parser]||this.parser.twig;if("undefined"==typeof XMLHttpRequest)throw new c.Error('Unsupported platform: Unable to do ajax requests because there is no "XMLHTTPRequest" implementation');return(a=new XMLHttpRequest).onreadystatechange=function(){var e=null;4===a.readyState&&(200===a.status||window.cordova&&0==a.status?(c.log.debug("Got template ",a.responseText),e=!0===s?JSON.parse(a.responseText):a.responseText,n.url=t,n.data=e,i=u.call(this,n),"function"==typeof o&&o(i)):"function"==typeof r&&r(a))},a.open("GET",t,!!n.async),a.send(),!!n.async||i})}},function(e,t,n){"use strict";e.exports=function(e){return!1!==e&&0!==e&&0!==e&&""!==e&&"0"!==e&&(!Array.isArray(e)||0!==e.length)&&null!=e}},function(e,t,n){"use strict";e.exports=function(e,t){var o,n,r,i,a=["Sun","Mon","Tues","Wednes","Thurs","Fri","Satur","January","February","March","April","May","June","July","August","September","October","November","December"],s=/\\?(.?)/gi,u=function(e,t){return n[e]?n[e]():t},c=function(e,t){for(e=String(e);e.length<t;)e="0"+e;return e};return n={d:function(){return c(n.j(),2)},D:function(){return n.l().slice(0,3)},j:function(){return o.getDate()},l:function(){return a[n.w()]+"day"},N:function(){return n.w()||7},S:function(){var e=n.j(),t=e%10;return t<=3&&1===parseInt(e%100/10,10)&&(t=0),["st","nd","rd"][t-1]||"th"},w:function(){return o.getDay()},z:function(){var e=new Date(n.Y(),n.n()-1,n.j()),t=new Date(n.Y(),0,1);return Math.round((e-t)/864e5)},W:function(){var e=new Date(n.Y(),n.n()-1,n.j()-n.N()+3),t=new Date(e.getFullYear(),0,4);return c(1+Math.round((e-t)/864e5/7),2)},F:function(){return a[6+n.n()]},m:function(){return c(n.n(),2)},M:function(){return n.F().slice(0,3)},n:function(){return o.getMonth()+1},t:function(){return new Date(n.Y(),n.n(),0).getDate()},L:function(){var e=n.Y();return e%4==0&e%100!=0|e%400==0},o:function(){var e=n.n(),t=n.W();return n.Y()+(12===e&&t<9?1:1===e&&9<t?-1:0)},Y:function(){return o.getFullYear()},y:function(){return n.Y().toString().slice(-2)},a:function(){return 11<o.getHours()?"pm":"am"},A:function(){return n.a().toUpperCase()},B:function(){var e=3600*o.getUTCHours(),t=60*o.getUTCMinutes(),n=o.getUTCSeconds();return c(Math.floor((e+t+n+3600)/86.4)%1e3,3)},g:function(){return n.G()%12||12},G:function(){return o.getHours()},h:function(){return c(n.g(),2)},H:function(){return c(n.G(),2)},i:function(){return c(o.getMinutes(),2)},s:function(){return c(o.getSeconds(),2)},u:function(){return c(1e3*o.getMilliseconds(),6)},e:function(){throw new Error("Not supported (see source code of date() for timezone on how to add support)")},I:function(){return new Date(n.Y(),0)-Date.UTC(n.Y(),0)!=new Date(n.Y(),6)-Date.UTC(n.Y(),6)?1:0},O:function(){var e=o.getTimezoneOffset(),t=Math.abs(e);return(0<e?"-":"+")+c(100*Math.floor(t/60)+t%60,4)},P:function(){var e=n.O();return e.substr(0,3)+":"+e.substr(3,2)},T:function(){return"UTC"},Z:function(){return 60*-o.getTimezoneOffset()},c:function(){return"Y-m-d\\TH:i:sP".replace(s,u)},r:function(){return"D, d M Y H:i:s O".replace(s,u)},U:function(){return o/1e3|0}},r=e,o=void 0===(i=t)?new Date:i instanceof Date?new Date(i):new Date(1e3*i),r.replace(s,u)}},function(e,t,n){"use strict";e.exports=function(e,t){var n,o,r,i,f,p,h,a,s,u;if(!e)return!1;e=e.replace(/^\s+|\s+$/g,"").replace(/\s{2,}/g," ").replace(/[\t\r\n]/g,"").toLowerCase();var c=new RegExp(["^(\\d{1,4})","([\\-\\.\\/:])","(\\d{1,2})","([\\-\\.\\/:])","(\\d{1,4})","(?:\\s(\\d{1,2}):(\\d{2})?:?(\\d{2})?)?","(?:\\s([A-Z]+)?)?$"].join(""));if((o=e.match(c))&&o[2]===o[4])if(1901<o[1])switch(o[2]){case"-":return!(12<o[3]||31<o[5])&&new Date(o[1],parseInt(o[3],10)-1,o[5],o[6]||0,o[7]||0,o[8]||0,o[9]||0)/1e3;case".":return!1;case"/":return!(12<o[3]||31<o[5])&&new Date(o[1],parseInt(o[3],10)-1,o[5],o[6]||0,o[7]||0,o[8]||0,o[9]||0)/1e3}else if(1901<o[5])switch(o[2]){case"-":case".":return!(12<o[3]||31<o[1])&&new Date(o[5],parseInt(o[3],10)-1,o[1],o[6]||0,o[7]||0,o[8]||0,o[9]||0)/1e3;case"/":return!(12<o[1]||31<o[3])&&new Date(o[5],parseInt(o[1],10)-1,o[3],o[6]||0,o[7]||0,o[8]||0,o[9]||0)/1e3}else switch(o[2]){case"-":return!(12<o[3]||31<o[5]||o[1]<70&&38<o[1])&&(i=0<=o[1]&&o[1]<=38?+o[1]+2e3:o[1],new Date(i,parseInt(o[3],10)-1,o[5],o[6]||0,o[7]||0,o[8]||0,o[9]||0)/1e3);case".":return 70<=o[5]?!(12<o[3]||31<o[1])&&new Date(o[5],parseInt(o[3],10)-1,o[1],o[6]||0,o[7]||0,o[8]||0,o[9]||0)/1e3:o[5]<60&&!o[6]&&!(23<o[1]||59<o[3])&&(r=new Date,new Date(r.getFullYear(),r.getMonth(),r.getDate(),o[1]||0,o[3]||0,o[5]||0,o[9]||0)/1e3);case"/":return!(12<o[1]||31<o[3]||o[5]<70&&38<o[5])&&(i=0<=o[5]&&o[5]<=38?+o[5]+2e3:o[5],new Date(i,parseInt(o[1],10)-1,o[3],o[6]||0,o[7]||0,o[8]||0,o[9]||0)/1e3);case":":return!(23<o[1]||59<o[3]||59<o[5])&&(r=new Date,new Date(r.getFullYear(),r.getMonth(),r.getDate(),o[1]||0,o[3]||0,o[5]||0)/1e3)}if("now"===e)return null===t||isNaN(t)?(new Date).getTime()/1e3|0:0|t;if(!isNaN(n=Date.parse(e)))return n/1e3|0;if(c=new RegExp(["^([0-9]{4}-[0-9]{2}-[0-9]{2})","[ t]","([0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]+)?)","([\\+-][0-9]{2}(:[0-9]{2})?|z)"].join("")),(o=e.match(c))&&("z"===o[4]?o[4]="Z":o[4].match(/^([+-][0-9]{2})$/)&&(o[4]=o[4]+":00"),!isNaN(n=Date.parse(o[1]+"T"+o[2]+o[4]))))return n/1e3|0;function l(e){var t,n,o,r,i=e.split(" "),a=i[0],s=i[1].substring(0,3),u=/\d+/.test(a),c="ago"===i[2],l=("last"===a?-1:1)*(c?-1:1);if(u&&(l*=parseInt(a,10)),h.hasOwnProperty(s)&&!i[1].match(/^mon(day|\.)?$/i))return f["set"+h[s]](f["get"+h[s]]()+l);if("wee"===s)return f.setDate(f.getDate()+7*l);if("next"===a||"last"===a)t=a,n=l,void 0!==(r=p[s])&&(0==(o=r-f.getDay())?o=7*n:0<o&&"last"===t?o-=7:o<0&&"next"===t&&(o+=7),f.setDate(f.getDate()+o));else if(!u)return!1;return!0}if(f=t?new Date(1e3*t):new Date,p={sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6},h={yea:"FullYear",mon:"Month",day:"Date",hou:"Hours",min:"Minutes",sec:"Seconds"},s="([+-]?\\d+\\s(years?|months?|weeks?|days?|hours?|minutes?|min|seconds?|sec|sunday|sun\\.?|monday|mon\\.?|tuesday|tue\\.?|wednesday|wed\\.?|thursday|thu\\.?|friday|fri\\.?|saturday|sat\\.?)|(last|next)\\s(years?|months?|weeks?|days?|hours?|minutes?|min|seconds?|sec|sunday|sun\\.?|monday|mon\\.?|tuesday|tue\\.?|wednesday|wed\\.?|thursday|thu\\.?|friday|fri\\.?|saturday|sat\\.?))(\\sago)?",!(o=e.match(new RegExp(s,"gi"))))return!1;for(u=0,a=o.length;u<a;u++)if(!l(o[u]))return!1;return f.getTime()/1e3}},function(e,t,n){"use strict";e.exports=function(e,n){return n=(((n||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join(""),e.replace(/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi,"").replace(/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,function(e,t){return-1<n.indexOf("<"+t.toLowerCase()+">")?e:""})}},function(e,t,n){"use strict";var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(){var e,t,n,o=0,r=arguments,i=r.length,u=function(e){if("[object Array]"===Object.prototype.toString.call(e))return e;var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(e[n]);return t},a=function e(t,n){var o=0,r=0,i=0,a=0,s=0;if(t===n)return 0;if("object"!==(void 0===t?"undefined":c(t)))return"object"===(void 0===n?"undefined":c(n))?1:isNaN(n)&&!isNaN(t)?0===t?0:t<0?1:-1:isNaN(t)&&!isNaN(n)?0===n?0:0<n?1:-1:n===t?0:t<n?1:-1;if("object"!==(void 0===n?"undefined":c(n)))return-1;if(t=u(t),n=u(n),s=t.length,(a=n.length)>s)return 1;if(a<s)return-1;for(o=0,r=s;o<r;++o){if(1===(i=e(t[o],n[o])))return 1;if(-1===i)return-1}return 0};if(0===i)throw new Error("At least one value should be passed to min()");if(1===i){if("object"!==c(r[0]))throw new Error("Wrong parameter count for min()");if(0===(e=u(r[0])).length)throw new Error("Array must contain at least one element for min()")}else e=r;for(t=e[0],o=1,n=e.length;o<n;++o)-1===a(t,e[o])&&(t=e[o]);return t}},function(e,t,n){"use strict";var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(){var e,t,n,o=0,r=arguments,i=r.length,u=function(e){if("[object Array]"===Object.prototype.toString.call(e))return e;var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(e[n]);return t},a=function e(t,n){var o=0,r=0,i=0,a=0,s=0;if(t===n)return 0;if("object"!==(void 0===t?"undefined":c(t)))return"object"===(void 0===n?"undefined":c(n))?1:isNaN(n)&&!isNaN(t)?0===t?0:t<0?1:-1:isNaN(t)&&!isNaN(n)?0===n?0:0<n?1:-1:n===t?0:t<n?1:-1;if("object"!==(void 0===n?"undefined":c(n)))return-1;if(t=u(t),n=u(n),s=t.length,(a=n.length)>s)return 1;if(a<s)return-1;for(o=0,r=s;o<r;++o){if(1===(i=e(t[o],n[o])))return 1;if(-1===i)return-1}return 0};if(0===i)throw new Error("At least one value should be passed to max()");if(1===i){if("object"!==c(r[0]))throw new Error("Wrong parameter count for max()");if(0===(e=u(r[0])).length)throw new Error("Array must contain at least one element for max()")}else e=r;for(t=e[0],o=1,n=e.length;o<n;++o)1===a(t,e[o])&&(t=e[o]);return t}},function(e,t,n){"use strict";e.exports=function(e,t,n){var o,r,i,a;if(t|=0,i=(e*=o=Math.pow(10,t))%1==.5*(a=0<e|-(e<0)),r=Math.floor(e),i)switch(n){case"PHP_ROUND_HALF_DOWN":e=r+(a<0);break;case"PHP_ROUND_HALF_EVEN":e=r+r%2*a;break;case"PHP_ROUND_HALF_ODD":e=r+!(r%2);break;default:e=r+(0<a)}return(i?e:Math.round(e))/o}},function(e,t,n){"use strict";e.exports=function(e,t){return n(1).apply(this,[e].concat(t))}},function(e,t,o){e.exports=function(i){i.lib={},i.lib.sprintf=o(1),i.lib.vsprintf=o(19),i.lib.round=o(18),i.lib.max=o(17),i.lib.min=o(16),i.lib.strip_tags=o(15),i.lib.strtotime=o(14),i.lib.date=o(13),i.lib.boolval=o(12);var n=Object.prototype.toString;return i.lib.is=function(e,t){return null!=t&&("Array"===e&&Array.isArray?Array.isArray(t):n.call(t).slice(8,-1)===e)},i.lib.isArray=Array.isArray||function(e){return"Array"===n.call(e).slice(8,-1)},i.lib.copy=function(e){var t,n={};for(t in e)n[t]=e[t];return n},i.lib.extend=function(e,t){var n,o=Object.keys(t||{});for(n=o.length;n--;)e[o[n]]=t[o[n]];return e},i.lib.replaceAll=function(e,t,n){return e.split(t).join(n)},i.lib.chunkArray=function(e,t){var n=[],o=0,r=e.length;if(t<1||!i.lib.is("Array",e))return[];for(;o<r;)n.push(e.slice(o,o+=t));return n},i}},function(u,e){u.exports=function(s){return s.functions={range:function(e,t,n){var o,r,i=[],a=n||1,s=!1;if((r=isNaN(e)||isNaN(t)?isNaN(e)&&isNaN(t)?(s=!0,o=e.charCodeAt(0),t.charCodeAt(0)):(o=isNaN(e)?0:e,isNaN(t)?0:t):(o=parseInt(e,10),parseInt(t,10)))<o)for(;r<=o;)i.push(s?String.fromCharCode(o):o),o-=a;else for(;o<=r;)i.push(s?String.fromCharCode(o):o),o+=a;return i},cycle:function(e,t){return e[t%e.length]},dump:function(){var e=arguments.length;for(args=new Array(e);0<e--;)args[e]=arguments[e];var n=0,o="",r=function(e){for(var t="";0<e;)e--,t+="  ";return t},i=function(e){o+=r(n),"object"==typeof e?t(e):"function"==typeof e?o+="function()\n":"string"==typeof e?o+="string("+e.length+') "'+e+'"\n':"number"==typeof e?o+="number("+e+")\n":"boolean"==typeof e&&(o+="bool("+e+")\n")},t=function(e){var t;if(null===e)o+="NULL\n";else if(void 0===e)o+="undefined\n";else if("object"==typeof e){for(t in o+=r(n)+typeof e,n++,o+="("+function(e){var t,n=0;for(t in e)e.hasOwnProperty(t)&&n++;return n}(e)+") {\n",e)o+=r(n)+"["+t+"]=> \n",i(e[t]);o+=r(--n)+"}\n"}else i(e)};return 0==args.length&&args.push(this.context),s.forEach(args,function(e){t(e)}),o},date:function(e,t){var n;if(null==e||""===e)n=new Date;else if(s.lib.is("Date",e))n=e;else if(s.lib.is("String",e))n=e.match(/^[0-9]+$/)?new Date(1e3*e):new Date(1e3*s.lib.strtotime(e));else{if(!s.lib.is("Number",e))throw new s.Error("Unable to parse date "+e);n=new Date(1e3*e)}return n},block:function(e){return this.originalBlockTokens[e]?s.logic.parse.call(this,this.originalBlockTokens[e],this.context).output:this.blocks[e]},parent:function(){return s.placeholders.parent},attribute:function(e,t,n){return s.lib.is("Object",e)&&e.hasOwnProperty(t)?"function"==typeof e[t]?e[t].apply(void 0,n):e[t]:e[t]||void 0},max:function(e){return s.lib.is("Object",e)?(delete e._keys,s.lib.max(e)):s.lib.max.apply(null,arguments)},min:function(e){return s.lib.is("Object",e)?(delete e._keys,s.lib.min(e)):s.lib.min.apply(null,arguments)},template_from_string:function(e){return void 0===e&&(e=""),s.Templates.parsers.twig({options:this.options,data:e})},random:function(e){var r=2147483648;function t(e){var t=Math.floor(Math.random()*r),n=Math.min.call(null,0,e),o=Math.max.call(null,0,e);return n+Math.floor((o-n+1)*t/r)}if(s.lib.is("Number",e))return t(e);if(s.lib.is("String",e))return e.charAt(t(e.length-1));if(s.lib.is("Array",e))return e[t(e.length-1)];if(s.lib.is("Object",e)){var n=Object.keys(e);return e[n[t(n.length-1)]]}return t(r-1)},source:function(e,t){var n,o,r,i=!1;r=void 0!==u&&void 0!==u.exports&&"undefined"==typeof window?(o="fs",c+"/"+e):(o="ajax",e);var a={id:e,path:r,method:o,parser:"source",async:!1,fetchTemplateSource:!0};void 0===t&&(t=!1);try{void 0===(n=s.Templates.loadRemote(e,a))||null===n?n="":i=!0}catch(e){s.log.debug("Twig.functions.source: ","Problem loading template  ",e)}return i||t?n:'Template "{name}" is not defined.'.replace("{name}",e)}},s._function=function(e,t,n){if(!s.functions[e])throw"Unable to find function "+e;return s.functions[e](t,n)},s._function.extend=function(e,t){s.functions[e]=t},s}},function(e,t){e.exports=function(u){function i(e,t){var n=Object.prototype.toString.call(t).slice(8,-1);return null!=t&&n===e}return u.filters={upper:function(e){return"string"!=typeof e?e:e.toUpperCase()},lower:function(e){return"string"!=typeof e?e:e.toLowerCase()},capitalize:function(e){return"string"!=typeof e?e:e.substr(0,1).toUpperCase()+e.toLowerCase().substr(1)},title:function(e){return"string"!=typeof e?e:e.toLowerCase().replace(/(^|\s)([a-z])/g,function(e,t,n){return t+n.toUpperCase()})},length:function(e){return u.lib.is("Array",e)||"string"==typeof e?e.length:u.lib.is("Object",e)?void 0===e._keys?Object.keys(e).length:e._keys.length:0},reverse:function(e){if(i("Array",e))return e.reverse();if(i("String",e))return e.split("").reverse().join("");if(i("Object",e)){var t=e._keys||Object.keys(e).reverse();return e._keys=t,e}},sort:function(o){if(i("Array",o))return o.sort();if(i("Object",o)){delete o._keys;var e=Object.keys(o).sort(function(e,t){var n;return o[e]>o[t]==!(o[e]<=o[t])?o[e]>o[t]?1:o[e]<o[t]?-1:0:isNaN(n=parseFloat(o[e]))||isNaN(b1=parseFloat(o[t]))?"string"==typeof o[e]?o[e]>o[t].toString()?1:o[e]<o[t].toString()?-1:0:"string"==typeof o[t]?o[e].toString()>o[t]?1:o[e].toString()<o[t]?-1:0:null:n>b1?1:n<b1?-1:0});return o._keys=e,o}},keys:function(t){if(null!=t){var e=t._keys||Object.keys(t),n=[];return u.forEach(e,function(e){"_keys"!==e&&t.hasOwnProperty(e)&&n.push(e)}),n}},url_encode:function(e){if(null!=e){var t=encodeURIComponent(e);return t=t.replace("'","%27")}},join:function(t,e){if(null!=t){var n="",o=[],r=null;return e&&e[0]&&(n=e[0]),i("Array",t)?o=t:(r=t._keys||Object.keys(t),u.forEach(r,function(e){"_keys"!==e&&t.hasOwnProperty(e)&&o.push(t[e])})),o.join(n)}},default:function(e,t){if(void 0!==t&&1<t.length)throw new u.Error("default filter expects one argument");return null==e||""===e?void 0===t?"":t[0]:e},json_encode:function(t){if(null==t)return"null";if("object"==typeof t&&i("Array",t))return n=[],u.forEach(t,function(e){n.push(u.filters.json_encode(e))}),"["+n.join(",")+"]";if("object"==typeof t&&i("Date",t))return'"'+t.toISOString()+'"';if("object"!=typeof t)return JSON.stringify(t);var e=t._keys||Object.keys(t),n=[];return u.forEach(e,function(e){n.push(JSON.stringify(e)+":"+u.filters.json_encode(t[e]))}),"{"+n.join(",")+"}"},merge:function(n,e){var o=[],r=0,t=[];if(i("Array",n)?u.forEach(e,function(e){i("Array",e)||(o={})}):o={},i("Array",o)||(o._keys=[]),i("Array",n)?u.forEach(n,function(e){o._keys&&o._keys.push(r),o[r]=e,r++}):(t=n._keys||Object.keys(n),u.forEach(t,function(e){o[e]=n[e],o._keys.push(e);var t=parseInt(e,10);!isNaN(t)&&r<=t&&(r=t+1)})),u.forEach(e,function(n){i("Array",n)?u.forEach(n,function(e){o._keys&&o._keys.push(r),o[r]=e,r++}):(t=n._keys||Object.keys(n),u.forEach(t,function(e){o[e]||o._keys.push(e),o[e]=n[e];var t=parseInt(e,10);!isNaN(t)&&r<=t&&(r=t+1)}))}),0===e.length)throw new u.Error("Filter merge expects at least one parameter");return o},date:function(e,t){var n=u.functions.date(e),o=t&&t.length?t[0]:"F j, Y H:i";return u.lib.date(o,n)},date_modify:function(e,t){if(null!=e){if(void 0===t||1!==t.length)throw new u.Error("date_modify filter expects 1 argument");var n,o=t[0];return u.lib.is("Date",e)&&(n=u.lib.strtotime(o,e.getTime()/1e3)),u.lib.is("String",e)&&(n=u.lib.strtotime(o,u.lib.strtotime(e))),u.lib.is("Number",e)&&(n=u.lib.strtotime(o,e)),new Date(1e3*n)}},replace:function(e,t){if(null!=e){var n,o=t[0];for(n in o)o.hasOwnProperty(n)&&"_keys"!==n&&(e=u.lib.replaceAll(e,n,o[n]));return e}},format:function(e,t){if(null!=e)return u.lib.vsprintf(e,t)},striptags:function(e,t){if(null!=e)return u.lib.strip_tags(e,t)},escape:function(e,t){if(null!=e){var n="html";if(t&&t.length&&!0!==t[0]&&(n=t[0]),"html"==n){var o=e.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");return u.Markup(o,"html")}if("js"==n){o=e.toString();for(var r="",i=0;i<o.length;i++)o[i].match(/^[a-zA-Z0-9,\._]$/)?r+=o[i]:r+=(a=o.charCodeAt(i))<128?"\\x"+a.toString(16).toUpperCase():u.lib.sprintf("\\u%04s",a.toString(16).toUpperCase());return u.Markup(r,"js")}if("css"==n){for(o=e.toString(),r="",i=0;i<o.length;i++)o[i].match(/^[a-zA-Z0-9]$/)?r+=o[i]:r+="\\"+(a=o.charCodeAt(i)).toString(16).toUpperCase()+" ";return u.Markup(r,"css")}if("url"==n)return r=u.filters.url_encode(e),u.Markup(r,"url");if("html_attr"!=n)throw new u.Error("escape strategy unsupported");for(o=e.toString(),r="",i=0;i<o.length;i++)if(o[i].match(/^[a-zA-Z0-9,\.\-_]$/))r+=o[i];else if(o[i].match(/^[&<>"]$/))r+=o[i].replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");else{var a;r+=(a=o.charCodeAt(i))<=31&&9!=a&&10!=a&&13!=a?"&#xFFFD;":a<128?u.lib.sprintf("&#x%02s;",a.toString(16).toUpperCase()):u.lib.sprintf("&#x%04s;",a.toString(16).toUpperCase())}return u.Markup(r,"html_attr")}},e:function(e,t){return u.filters.escape(e,t)},nl2br:function(e){if(null!=e){var t="<br />BACKSLASH_n_replace";return e=u.filters.escape(e).replace(/\r\n/g,t).replace(/\r/g,t).replace(/\n/g,t),e=u.lib.replaceAll(e,"BACKSLASH_n_replace","\n"),u.Markup(e)}},number_format:function(e,t){var n=e,o=t&&t[0]?t[0]:void 0,r=t&&void 0!==t[1]?t[1]:".",i=t&&void 0!==t[2]?t[2]:",";n=(n+"").replace(/[^0-9+\-Ee.]/g,"");var a,s,u,c=isFinite(+n)?+n:0,l=isFinite(+o)?Math.abs(o):0,f="";return 3<(f=(l?(a=c,s=l,u=Math.pow(10,s),""+Math.round(a*u)/u):""+Math.round(c)).split("."))[0].length&&(f[0]=f[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,i)),(f[1]||"").length<l&&(f[1]=f[1]||"",f[1]+=new Array(l-f[1].length+1).join("0")),f.join(r)},trim:function(e,t){if(null!=e){var n,o=""+e;n=t&&t[0]?""+t[0]:" \n\r\t\f\v            ​\u2028\u2029　";for(var r=0;r<o.length;r++)if(-1===n.indexOf(o.charAt(r))){o=o.substring(r);break}for(r=o.length-1;0<=r;r--)if(-1===n.indexOf(o.charAt(r))){o=o.substring(0,r+1);break}return-1===n.indexOf(o.charAt(0))?o:""}},truncate:function(e,t){var n=30,o=!1,r="...";if(e+="",t&&(t[0]&&(n=t[0]),t[1]&&(o=t[1]),t[2]&&(r=t[2])),e.length>n){if(o&&-1===(n=e.indexOf(" ",n)))return e;e=e.substr(0,n)+r}return e},slice:function(e,t){if(null!=e){if(void 0===t||t.length<1)throw new u.Error("slice filter expects at least 1 argument");var n=t[0]||0,o=1<t.length?t[1]:e.length,r=0<=n?n:Math.max(e.length+n,0);if(u.lib.is("Array",e)){for(var i=[],a=r;a<r+o&&a<e.length;a++)i.push(e[a]);return i}if(u.lib.is("String",e))return e.substr(r,o);throw new u.Error("slice filter expects value to be an array or string")}},abs:function(e){if(null!=e)return Math.abs(e)},first:function(e){if(i("Array",e))return e[0];if(i("Object",e)){if("_keys"in e)return e[e._keys[0]]}else if("string"==typeof e)return e.substr(0,1)},split:function(e,t){if(null!=e){if(void 0===t||t.length<1||2<t.length)throw new u.Error("split filter expects 1 or 2 argument");if(u.lib.is("String",e)){var n=t[0],o=t[1],r=e.split(n);if(void 0===o)return r;if(o<0)return e.split(n,r.length+o);var i=[];if(""==n)for(;0<r.length;){for(var a="",s=0;s<o&&0<r.length;s++)a+=r.shift();i.push(a)}else{for(s=0;s<o-1&&0<r.length;s++)i.push(r.shift());0<r.length&&i.push(r.join(n))}return i}throw new u.Error("split filter expects value to be a string")}},last:function(e){var t;return u.lib.is("Object",e)?e[(t=void 0===e._keys?Object.keys(e):e._keys)[t.length-1]]:e[e.length-1]},raw:function(e){return u.Markup(e)},batch:function(e,t){var n,o,r,i=t.shift(),a=t.shift();if(!u.lib.is("Array",e))throw new u.Error("batch filter expects items to be an array");if(!u.lib.is("Number",i))throw new u.Error("batch filter expects size to be a number");if(i=Math.ceil(i),n=u.lib.chunkArray(e,i),a&&e.length%i!=0){for(r=i-(o=n.pop()).length;r--;)o.push(a);n.push(o)}return n},round:function(e,t){var n=0<(t=t||[]).length?t[0]:0,o=1<t.length?t[1]:"common";if(e=parseFloat(e),n&&!u.lib.is("Number",n))throw new u.Error("round filter expects precision to be a number");if("common"===o)return u.lib.round(e,n);if(!u.lib.is("Function",Math[o]))throw new u.Error("round filter expects method to be 'floor', 'ceil', or 'common'");return Math[o](e*Math.pow(10,n))/Math.pow(10,n)}},u.filter=function(e,t,n){if(!u.filters[e])throw"Unable to find filter "+e;return u.filters[e].call(this,t,n)},u.filter.extend=function(e,t){u.filters[e]=t},u}},function(e,t){e.exports=function(i){"use strict";i.expression.operator={leftToRight:"leftToRight",rightToLeft:"rightToLeft"};var a=function(e,t){if(null==t)return null;if(void 0!==t.indexOf)return e===t||""!==e&&-1<t.indexOf(e);var n;for(n in t)if(t.hasOwnProperty(n)&&t[n]===e)return!0;return!1};return i.expression.operator.lookup=function(e,t){switch(e){case"..":t.precidence=20,t.associativity=i.expression.operator.leftToRight;break;case",":t.precidence=18,t.associativity=i.expression.operator.leftToRight;break;case"?:":case"?":case":":t.precidence=16,t.associativity=i.expression.operator.rightToLeft;break;case"or":t.precidence=14,t.associativity=i.expression.operator.leftToRight;break;case"and":t.precidence=13,t.associativity=i.expression.operator.leftToRight;break;case"b-or":t.precidence=12,t.associativity=i.expression.operator.leftToRight;break;case"b-xor":t.precidence=11,t.associativity=i.expression.operator.leftToRight;break;case"b-and":t.precidence=10,t.associativity=i.expression.operator.leftToRight;break;case"==":case"!=":t.precidence=9,t.associativity=i.expression.operator.leftToRight;break;case"<":case"<=":case">":case">=":case"not in":case"in":t.precidence=8,t.associativity=i.expression.operator.leftToRight;break;case"~":case"+":case"-":t.precidence=6,t.associativity=i.expression.operator.leftToRight;break;case"//":case"**":case"*":case"/":case"%":t.precidence=5,t.associativity=i.expression.operator.leftToRight;break;case"not":t.precidence=3,t.associativity=i.expression.operator.rightToLeft;break;default:throw new i.Error("Failed to lookup operator: "+e+" is an unknown operator.")}return t.operator=e,t},i.expression.operator.parse=function(e,t){var n,o,r;switch(i.log.trace("Twig.expression.operator.parse: ","Handling ",e),"?"===e&&(r=t.pop()),o=t.pop(),"not"!==e&&(n=t.pop()),"in"!==e&&"not in"!==e&&(n&&Array.isArray(n)&&(n=n.length),o&&Array.isArray(o)&&(o=o.length)),e){case":":break;case"?:":i.lib.boolval(n)?t.push(n):t.push(o);break;case"?":void 0===n&&(n=o,o=r,r=void 0),i.lib.boolval(n)?t.push(o):t.push(r);break;case"+":o=parseFloat(o),n=parseFloat(n),t.push(n+o);break;case"-":o=parseFloat(o),n=parseFloat(n),t.push(n-o);break;case"*":o=parseFloat(o),n=parseFloat(n),t.push(n*o);break;case"/":o=parseFloat(o),n=parseFloat(n),t.push(n/o);break;case"//":o=parseFloat(o),n=parseFloat(n),t.push(Math.floor(n/o));break;case"%":o=parseFloat(o),n=parseFloat(n),t.push(n%o);break;case"~":t.push((null!=n?n.toString():"")+(null!=o?o.toString():""));break;case"not":case"!":t.push(!i.lib.boolval(o));break;case"<":t.push(n<o);break;case"<=":t.push(n<=o);break;case">":t.push(o<n);break;case">=":t.push(o<=n);break;case"===":t.push(n===o);break;case"==":t.push(n==o);break;case"!==":t.push(n!==o);break;case"!=":t.push(n!=o);break;case"or":t.push(i.lib.boolval(n)||i.lib.boolval(o));break;case"b-or":t.push(n|o);break;case"b-xor":t.push(n^o);break;case"and":t.push(i.lib.boolval(n)&&i.lib.boolval(o));break;case"b-and":t.push(n&o);break;case"**":t.push(Math.pow(n,o));break;case"not in":t.push(!a(n,o));break;case"in":t.push(a(n,o));break;case"..":t.push(i.functions.range(n,o));break;default:throw new i.Error("Failed to parse operator: "+e+" is an unknown operator.")}},i}},function(e,t,n){e.exports=function(f){"use strict";function c(e,t,n){return t?f.expression.parseAsync.call(e,t,n):f.Promise.resolve(!1)}for(f.expression={},n(23)(f),f.expression.reservedWords=["true","false","null","TRUE","FALSE","NULL","_context","and","b-and","or","b-or","b-xor","in","not in","if"],f.expression.type={comma:"Twig.expression.type.comma",operator:{unary:"Twig.expression.type.operator.unary",binary:"Twig.expression.type.operator.binary"},string:"Twig.expression.type.string",bool:"Twig.expression.type.bool",slice:"Twig.expression.type.slice",array:{start:"Twig.expression.type.array.start",end:"Twig.expression.type.array.end"},object:{start:"Twig.expression.type.object.start",end:"Twig.expression.type.object.end"},parameter:{start:"Twig.expression.type.parameter.start",end:"Twig.expression.type.parameter.end"},subexpression:{start:"Twig.expression.type.subexpression.start",end:"Twig.expression.type.subexpression.end"},key:{period:"Twig.expression.type.key.period",brackets:"Twig.expression.type.key.brackets"},filter:"Twig.expression.type.filter",_function:"Twig.expression.type._function",variable:"Twig.expression.type.variable",number:"Twig.expression.type.number",_null:"Twig.expression.type.null",context:"Twig.expression.type.context",test:"Twig.expression.type.test"},f.expression.set={operations:[f.expression.type.filter,f.expression.type.operator.unary,f.expression.type.operator.binary,f.expression.type.array.end,f.expression.type.object.end,f.expression.type.parameter.end,f.expression.type.subexpression.end,f.expression.type.comma,f.expression.type.test],expressions:[f.expression.type._function,f.expression.type.bool,f.expression.type.string,f.expression.type.variable,f.expression.type.number,f.expression.type._null,f.expression.type.context,f.expression.type.parameter.start,f.expression.type.array.start,f.expression.type.object.start,f.expression.type.subexpression.start,f.expression.type.operator.unary]},f.expression.set.operations_extended=f.expression.set.operations.concat([f.expression.type.key.period,f.expression.type.key.brackets,f.expression.type.slice]),f.expression.fn={compile:{push:function(e,t,n){n.push(e)},push_both:function(e,t,n){n.push(e),t.push(e)}},parse:{push:function(e,t,n){t.push(e)},push_value:function(e,t,n){t.push(e.value)}}},f.expression.definitions=[{type:f.expression.type.test,regex:/^is\s+(not)?\s*([a-zA-Z_][a-zA-Z0-9_]*(\s?as)?)/,next:f.expression.set.operations.concat([f.expression.type.parameter.start]),compile:function(e,t,n){e.filter=e.match[2],e.modifier=e.match[1],delete e.match,delete e.value,n.push(e)},parse:function(n,o,e){var r=o.pop();return c(this,n.params,e).then(function(e){var t=f.test(n.filter,r,e);"not"==n.modifier?o.push(!t):o.push(t)})}},{type:f.expression.type.comma,regex:/^,/,next:f.expression.set.expressions.concat([f.expression.type.array.end,f.expression.type.object.end]),compile:function(e,t,n){var o,r=t.length-1;for(delete e.match,delete e.value;0<=r;r--){if((o=t.pop()).type===f.expression.type.object.start||o.type===f.expression.type.parameter.start||o.type===f.expression.type.array.start){t.push(o);break}n.push(o)}n.push(e)}},{type:f.expression.type.number,regex:/^\-?\d+(\.\d+)?/,next:f.expression.set.operations,compile:function(e,t,n){e.value=Number(e.value),n.push(e)},parse:f.expression.fn.parse.push_value},{type:f.expression.type.operator.binary,regex:/(^\?\:|^(b\-and)|^(b\-or)|^(b\-xor)|^[\+\-~%\?]|^[\:](?!\d\])|^[!=]==?|^[!<>]=?|^\*\*?|^\/\/?|^(and)[\(|\s+]|^(or)[\(|\s+]|^(in)[\(|\s+]|^(not in)[\(|\s+]|^\.\.)/,next:f.expression.set.expressions,transform:function(e,t){switch(e[0]){case"and(":case"or(":case"in(":case"not in(":return t[t.length-1].value=e[2],e[0];default:return""}},compile:function(e,t,n){delete e.match,e.value=e.value.trim();var o=e.value,r=f.expression.operator.lookup(o,e);for(f.log.trace("Twig.expression.compile: ","Operator: ",r," from ",o);0<t.length&&(t[t.length-1].type==f.expression.type.operator.unary||t[t.length-1].type==f.expression.type.operator.binary)&&(r.associativity===f.expression.operator.leftToRight&&r.precidence>=t[t.length-1].precidence||r.associativity===f.expression.operator.rightToLeft&&r.precidence>t[t.length-1].precidence);){var i=t.pop();n.push(i)}if(":"===o){if(!t[t.length-1]||"?"!==t[t.length-1].value){var a=n.pop();if(a.type===f.expression.type.string||a.type===f.expression.type.variable)e.key=a.value;else if(a.type===f.expression.type.number)e.key=a.value.toString();else{if(!a.expression||a.type!==f.expression.type.parameter.end&&a.type!=f.expression.type.subexpression.end)throw new f.Error("Unexpected value before ':' of "+a.type+" = "+a.value);e.params=a.params}return void n.push(e)}}else t.push(r)},parse:function(t,n,o){if(t.key)n.push(t);else{if(t.params)return f.expression.parseAsync.call(this,t.params,o).then(function(e){t.key=e,n.push(t),o.loop||delete t.params});f.expression.operator.parse(t.value,n)}}},{type:f.expression.type.operator.unary,regex:/(^not\s+)/,next:f.expression.set.expressions,compile:function(e,t,n){delete e.match,e.value=e.value.trim();var o=e.value,r=f.expression.operator.lookup(o,e);for(f.log.trace("Twig.expression.compile: ","Operator: ",r," from ",o);0<t.length&&(t[t.length-1].type==f.expression.type.operator.unary||t[t.length-1].type==f.expression.type.operator.binary)&&(r.associativity===f.expression.operator.leftToRight&&r.precidence>=t[t.length-1].precidence||r.associativity===f.expression.operator.rightToLeft&&r.precidence>t[t.length-1].precidence);){var i=t.pop();n.push(i)}t.push(r)},parse:function(e,t,n){f.expression.operator.parse(e.value,t)}},{type:f.expression.type.string,regex:/^(["'])(?:(?=(\\?))\2[\s\S])*?\1/,next:f.expression.set.operations_extended,compile:function(e,t,n){var o=e.value;delete e.match,o='"'===o.substring(0,1)?o.replace('\\"','"'):o.replace("\\'","'"),e.value=o.substring(1,o.length-1).replace(/\\n/g,"\n").replace(/\\r/g,"\r"),f.log.trace("Twig.expression.compile: ","String value: ",e.value),n.push(e)},parse:f.expression.fn.parse.push_value},{type:f.expression.type.subexpression.start,regex:/^\(/,next:f.expression.set.expressions.concat([f.expression.type.subexpression.end]),compile:function(e,t,n){e.value="(",n.push(e),t.push(e)},parse:f.expression.fn.parse.push},{type:f.expression.type.subexpression.end,regex:/^\)/,next:f.expression.set.operations_extended,validate:function(e,t){for(var n=t.length-1,o=!1,r=!1,i=0;!o&&0<=n;){var a=t[n];(o=a.type===f.expression.type.subexpression.start)&&r&&(o=r=!1),a.type===f.expression.type.parameter.start?i++:a.type===f.expression.type.parameter.end?i--:a.type===f.expression.type.subexpression.end&&(r=!0),n--}return o&&0===i},compile:function(e,t,n){var o,r=e;for(o=t.pop();0<t.length&&o.type!=f.expression.type.subexpression.start;)n.push(o),o=t.pop();for(var i=[];e.type!==f.expression.type.subexpression.start;)i.unshift(e),e=n.pop();i.unshift(e),void 0===(o=t[t.length-1])||o.type!==f.expression.type._function&&o.type!==f.expression.type.filter&&o.type!==f.expression.type.test&&o.type!==f.expression.type.key.brackets?(r.expression=!0,i.pop(),i.shift(),r.params=i,n.push(r)):(r.expression=!1,o.params=i)},parse:function(e,t,n){if(e.expression)return f.expression.parseAsync.call(this,e.params,n).then(function(e){t.push(e)});throw new f.Error("Unexpected subexpression end when token is not marked as an expression")}},{type:f.expression.type.parameter.start,regex:/^\(/,next:f.expression.set.expressions.concat([f.expression.type.parameter.end]),validate:function(e,t){var n=t[t.length-1];return n&&f.indexOf(f.expression.reservedWords,n.value.trim())<0},compile:f.expression.fn.compile.push_both,parse:f.expression.fn.parse.push},{type:f.expression.type.parameter.end,regex:/^\)/,next:f.expression.set.operations_extended,compile:function(e,t,n){var o,r=e;for(o=t.pop();0<t.length&&o.type!=f.expression.type.parameter.start;)n.push(o),o=t.pop();for(var i=[];e.type!==f.expression.type.parameter.start;)i.unshift(e),e=n.pop();i.unshift(e),void 0===(e=n[n.length-1])||e.type!==f.expression.type._function&&e.type!==f.expression.type.filter&&e.type!==f.expression.type.test&&e.type!==f.expression.type.key.brackets?(r.expression=!0,i.pop(),i.shift(),r.params=i,n.push(r)):(r.expression=!1,e.params=i)},parse:function(e,t,n){var o=[],r=!1,i=null;if(e.expression)return f.expression.parseAsync.call(this,e.params,n).then(function(e){t.push(e)});for(;0<t.length;){if((i=t.pop())&&i.type&&i.type==f.expression.type.parameter.start){r=!0;break}o.unshift(i)}if(!r)throw new f.Error("Expected end of parameter set.");t.push(o)}},{type:f.expression.type.slice,regex:/^\[(\d*\:\d*)\]/,next:f.expression.set.operations_extended,compile:function(e,t,n){var o=e.match[1].split(":"),r=o[0]?parseInt(o[0]):void 0,i=o[1]?parseInt(o[1]):void 0;e.value="slice",e.params=[r,i],i||(e.params=[r]),n.push(e)},parse:function(e,t,n){var o=t.pop(),r=e.params;t.push(f.filter.call(this,e.value,o,r))}},{type:f.expression.type.array.start,regex:/^\[/,next:f.expression.set.expressions.concat([f.expression.type.array.end]),compile:f.expression.fn.compile.push_both,parse:f.expression.fn.parse.push},{type:f.expression.type.array.end,regex:/^\]/,next:f.expression.set.operations_extended,compile:function(e,t,n){for(var o,r=t.length-1;0<=r&&(o=t.pop()).type!==f.expression.type.array.start;r--)n.push(o);n.push(e)},parse:function(e,t,n){for(var o=[],r=!1,i=null;0<t.length;){if((i=t.pop()).type&&i.type==f.expression.type.array.start){r=!0;break}o.unshift(i)}if(!r)throw new f.Error("Expected end of array.");t.push(o)}},{type:f.expression.type.object.start,regex:/^\{/,next:f.expression.set.expressions.concat([f.expression.type.object.end]),compile:f.expression.fn.compile.push_both,parse:f.expression.fn.parse.push},{type:f.expression.type.object.end,regex:/^\}/,next:f.expression.set.operations_extended,compile:function(e,t,n){for(var o,r=t.length-1;0<=r&&(!(o=t.pop())||o.type!==f.expression.type.object.start);r--)n.push(o);n.push(e)},parse:function(e,t,n){for(var o={},r=!1,i=null,a=!1,s=null;0<t.length;){if((i=t.pop())&&i.type&&i.type===f.expression.type.object.start){r=!0;break}if(i&&i.type&&(i.type===f.expression.type.operator.binary||i.type===f.expression.type.operator.unary)&&i.key){if(!a)throw new f.Error("Missing value for key '"+i.key+"' in object definition.");o[i.key]=s,void 0===o._keys&&(o._keys=[]),o._keys.unshift(i.key),s=null,a=!1}else a=!0,s=i}if(!r)throw new f.Error("Unexpected end of object.");t.push(o)}},{type:f.expression.type.filter,regex:/^\|\s?([a-zA-Z_][a-zA-Z0-9_\-]*)/,next:f.expression.set.operations_extended.concat([f.expression.type.parameter.start]),compile:function(e,t,n){e.value=e.match[1],n.push(e)},parse:function(t,n,e){var o=this,r=n.pop();return c(this,t.params,e).then(function(e){return f.filter.call(o,t.value,r,e)}).then(function(e){n.push(e)})}},{type:f.expression.type._function,regex:/^([a-zA-Z_][a-zA-Z0-9_]*)\s*\(/,next:f.expression.type.parameter.start,validate:function(e,t){return e[1]&&f.indexOf(f.expression.reservedWords,e[1])<0},transform:function(e,t){return"("},compile:function(e,t,n){var o=e.match[1];e.fn=o,delete e.match,delete e.value,n.push(e)},parse:function(e,t,n){var o,r=this,i=e.fn;return c(this,e.params,n).then(function(e){if(f.functions[i])o=f.functions[i].apply(r,e);else{if("function"!=typeof n[i])throw new f.Error(i+" function does not exist and is not defined in the context");o=n[i].apply(n,e)}return o}).then(function(e){t.push(e)})}},{type:f.expression.type.variable,regex:/^[a-zA-Z_][a-zA-Z0-9_]*/,next:f.expression.set.operations_extended.concat([f.expression.type.parameter.start]),compile:f.expression.fn.compile.push,validate:function(e,t){return f.indexOf(f.expression.reservedWords,e[0])<0},parse:function(e,t,n){return f.expression.resolveAsync.call(this,n[e.value],n).then(function(e){t.push(e)})}},{type:f.expression.type.key.period,regex:/^\.([a-zA-Z0-9_]+)/,next:f.expression.set.operations_extended.concat([f.expression.type.parameter.start]),compile:function(e,t,n){e.key=e.match[1],delete e.match,delete e.value,n.push(e)},parse:function(e,t,n,o){var r,i=this,a=e.key,s=t.pop();return c(this,e.params,n).then(function(e){if(null==s){if(i.options.strict_variables)throw new f.Error("Can't access a key "+a+" on an null or undefined object.");r=void 0}else{var t=function(e){return e.substr(0,1).toUpperCase()+e.substr(1)};r="object"==typeof s&&a in s?s[a]:void 0!==s["get"+t(a)]?s["get"+t(a)]:void 0!==s["is"+t(a)]?s["is"+t(a)]:void 0}return f.expression.resolveAsync.call(i,r,n,e,o,s)}).then(function(e){t.push(e)})}},{type:f.expression.type.key.brackets,regex:/^\[([^\]\:]*)\]/,next:f.expression.set.operations_extended.concat([f.expression.type.parameter.start]),compile:function(e,t,n){var o=e.match[1];delete e.value,delete e.match,e.stack=f.expression.compile({value:o}).stack,n.push(e)},parse:function(t,n,o,r){var i,a,s=this,u=null;return c(this,t.params,o).then(function(e){return u=e,f.expression.parseAsync.call(s,t.stack,o)}).then(function(e){if(null!==(i=n.pop())&&void 0!==i)return a="object"==typeof i&&e in i?i[e]:null,f.expression.resolveAsync.call(s,a,i,u,r);if(s.options.strict_variables)throw new f.Error("Can't access a key "+e+" on an null or undefined object.");return null}).then(function(e){n.push(e)})}},{type:f.expression.type._null,regex:/^(null|NULL|none|NONE)/,next:f.expression.set.operations,compile:function(e,t,n){delete e.match,e.value=null,n.push(e)},parse:f.expression.fn.parse.push_value},{type:f.expression.type.context,regex:/^_context/,next:f.expression.set.operations_extended.concat([f.expression.type.parameter.start]),compile:f.expression.fn.compile.push,parse:function(e,t,n){t.push(n)}},{type:f.expression.type.bool,regex:/^(true|TRUE|false|FALSE)/,next:f.expression.set.operations,compile:function(e,t,n){e.value="true"===e.match[0].toLowerCase(),delete e.match,n.push(e)},parse:f.expression.fn.parse.push_value}],f.expression.resolveAsync=function(t,n,e,o,r){if("function"!=typeof t)return f.Promise.resolve(t);var i=f.Promise.resolve(e);return o&&o.type===f.expression.type.parameter.end&&(i=i.then(function(){return o.params&&f.expression.parseAsync.call(this,o.params,n,!0)}).then(function(e){return o.cleanup=!0,e})),i.then(function(e){return t.apply(r||n,e||[])})},f.expression.resolve=function(e,t,n,o,r){return f.async.potentiallyAsync(this,!1,function(){return f.expression.resolveAsync.call(this,e,t,n,o,r)})},f.expression.handler={},f.expression.extendType=function(e){f.expression.type[e]="Twig.expression.type."+e},f.expression.extend=function(e){if(!e.type)throw new f.Error("Unable to extend logic definition. No type provided for "+e);f.expression.handler[e.type]=e};0<f.expression.definitions.length;)f.expression.extend(f.expression.definitions.shift());return f.expression.tokenize=function(e){var o,t,n,r,i,a,s=[],u=0,c=null,l=[];for(a=function(){for(var e=arguments.length-2,t=new Array(e);0<e--;)t[e]=arguments[e];if(f.log.trace("Twig.expression.tokenize","Matched a ",o," regular expression of ",t),c&&f.indexOf(c,o)<0)return l.push(o+" cannot follow a "+s[s.length-1].type+" at template:"+u+" near '"+t[0].substring(0,20)+"...'"),t[0];var n=f.expression.handler[o];return n.validate&&!n.validate(t,s)?t[0]:(l=[],s.push({type:o,value:t[0],match:t}),i=!0,c=r,u+=t[0].length,n.transform?n.transform(t,s):"")},f.log.debug("Twig.expression.tokenize","Tokenizing expression ",e);0<e.length;){for(o in e=e.trim(),f.expression.handler){if(r=f.expression.handler[o].next,t=f.expression.handler[o].regex,f.log.trace("Checking type ",o," on ",e),i=!1,f.lib.isArray(t))for(n=t.length;0<n--;)e=e.replace(t[n],a);else e=e.replace(t,a);if(i)break}if(!i)throw 0<l.length?new f.Error(l.join(" OR ")):new f.Error("Unable to parse '"+e+"' at template position"+u)}return f.log.trace("Twig.expression.tokenize","Tokenized to ",s),s},f.expression.compile=function(e){var t=e.value,n=f.expression.tokenize(t),o=null,r=[],i=[],a=null;for(f.log.trace("Twig.expression.compile: ","Compiling ",t);0<n.length;)o=n.shift(),a=f.expression.handler[o.type],f.log.trace("Twig.expression.compile: ","Compiling ",o),a.compile&&a.compile(o,i,r),f.log.trace("Twig.expression.compile: ","Stack is",i),f.log.trace("Twig.expression.compile: ","Output is",r);for(;0<i.length;)r.push(i.pop());return f.log.trace("Twig.expression.compile: ","Final output is",r),e.stack=r,delete e.value,e},f.expression.parse=function(i,a,o,e){var s=this;f.lib.isArray(i)||(i=[i]);var u=[],c=[],l=f.expression.type.operator.binary;return f.async.potentiallyAsync(this,e,function(){return f.async.forEach(i,function(e,t){var n,o=null,r=null;if(!e.cleanup)return i.length>t+1&&(r=i[t+1]),(o=f.expression.handler[e.type]).parse&&(n=o.parse.call(s,e,u,a,r)),e.type===l&&a.loop&&c.push(e),n}).then(function(){for(var e=c.length,t=null;0<e--;)(t=c[e]).params&&t.key&&delete t.key;if(o){var n=u.splice(0);u.push(n)}return u.pop()})})},f}},function(e,t){e.exports=function(i){return i.compiler={module:{}},i.compiler.compile=function(e,t){var n,o=JSON.stringify(e.tokens),r=e.id;if(t.module){if(void 0===i.compiler.module[t.module])throw new i.Error("Unable to find module type "+t.module);n=i.compiler.module[t.module](r,o,t.twig)}else n=i.compiler.wrap(r,o);return n},i.compiler.module={amd:function(e,t,n){return'define(["'+n+'"], function (Twig) {\n\tvar twig, templates;\ntwig = Twig.twig;\ntemplates = '+i.compiler.wrap(e,t)+"\n\treturn templates;\n});"},node:function(e,t){return'var twig = require("twig").twig;\nexports.template = '+i.compiler.wrap(e,t)},cjs2:function(e,t,n){return'module.declare([{ twig: "'+n+'" }], function (require, exports, module) {\n\tvar twig = require("twig").twig;\n\texports.template = '+i.compiler.wrap(e,t)+"\n});"}},i.compiler.wrap=function(e,t){return'twig({id:"'+e.replace('"','\\"')+'", data:'+t+", precompiled: true});\n"},i}},function(e,t){e.exports=function(g){"use strict";function f(e,t){if(e.options.rethrow)throw"string"==typeof t&&(t=new g.Error(t)),"TwigException"!=t.type||t.file||(t.file=e.id),t;if(g.log.error("Error parsing twig template "+e.id+": "),t.stack?g.log.error(t.stack):g.log.error(t.toString()),g.debug)return t.toString()}return g.trace=!1,g.debug=!1,g.cache=!0,g.noop=function(){},g.placeholders={parent:"{{|PARENT|}}"},g.hasIndexOf=Array.prototype.hasOwnProperty("indexOf"),g.indexOf=function(e,t){if(g.hasIndexOf)return e.indexOf(t);if(null==e)throw new TypeError;var n=Object(e),o=n.length>>>0;if(0===o)return-1;var r=0;if(0<arguments.length&&((r=Number(t))!=r?r=0:0!==r&&r!==1/0&&r!==-1/0&&(r=(0<r||-1)*Math.floor(Math.abs(r)))),o<=r)return-1;for(var i=0<=r?r:Math.max(o-Math.abs(r),0);i<o;i++)if(i in n&&n[i]===t)return i;return e==t?0:-1},g.forEach=function(e,t,n){if(Array.prototype.forEach)return e.forEach(t,n);var o,r;if(null==e)throw new TypeError(" this is null or not defined");var i=Object(e),a=i.length>>>0;if("[object Function]"!={}.toString.call(t))throw new TypeError(t+" is not a function");for(n&&(o=n),r=0;r<a;){var s;r in i&&(s=i[r],t.call(o,s,r,i)),r++}},g.merge=function(t,n,o){return g.forEach(Object.keys(n),function(e){(!o||e in t)&&(t[e]=n[e])}),t},g.attempt=function(e,t){try{return e()}catch(e){return t(e)}},g.Error=function(e,t){this.message=e,this.name="TwigException",this.type="TwigException",this.file=t},g.Error.prototype.toString=function(){return this.name+": "+this.message},g.log={trace:function(){g.trace&&console&&console.log(Array.prototype.slice.call(arguments))},debug:function(){g.debug&&console&&console.log(Array.prototype.slice.call(arguments))}},"undefined"!=typeof console?void 0!==console.error?g.log.error=function(){console.error.apply(console,arguments)}:void 0!==console.log&&(g.log.error=function(){console.log.apply(console,arguments)}):g.log.error=function(){},g.ChildContext=function(e){return g.lib.copy(e)},g.token={},g.token.type={output:"output",logic:"logic",comment:"comment",raw:"raw",output_whitespace_pre:"output_whitespace_pre",output_whitespace_post:"output_whitespace_post",output_whitespace_both:"output_whitespace_both",logic_whitespace_pre:"logic_whitespace_pre",logic_whitespace_post:"logic_whitespace_post",logic_whitespace_both:"logic_whitespace_both"},g.token.definitions=[{type:g.token.type.raw,open:"{% raw %}",close:"{% endraw %}"},{type:g.token.type.raw,open:"{% verbatim %}",close:"{% endverbatim %}"},{type:g.token.type.output_whitespace_pre,open:"{{-",close:"}}"},{type:g.token.type.output_whitespace_post,open:"{{",close:"-}}"},{type:g.token.type.output_whitespace_both,open:"{{-",close:"-}}"},{type:g.token.type.logic_whitespace_pre,open:"{%-",close:"%}"},{type:g.token.type.logic_whitespace_post,open:"{%",close:"-%}"},{type:g.token.type.logic_whitespace_both,open:"{%-",close:"-%}"},{type:g.token.type.output,open:"{{",close:"}}"},{type:g.token.type.logic,open:"{%",close:"%}"},{type:g.token.type.comment,open:"{#",close:"#}"}],g.token.strings=['"',"'"],g.token.findStart=function(e){var t,n,o,r,i={position:null,def:null},a=null,s=g.token.definitions.length;for(t=0;t<s;t++)n=g.token.definitions[t],o=e.indexOf(n.open),r=e.indexOf(n.close),g.log.trace("Twig.token.findStart: ","Searching for ",n.open," found at ",o),0<=o&&n.open.length!==n.close.length&&r<0||(0<=o&&(null===i.position||o<i.position)?(i.position=o,i.def=n,a=r):0<=o&&null!==i.position&&o===i.position&&(n.open.length>i.def.open.length?(i.position=o,i.def=n,a=r):n.open.length===i.def.open.length&&(n.close.length,i.def.close.length,0<=r&&r<a&&(i.position=o,i.def=n,a=r))));return i},g.token.findEnd=function(e,t,n){for(var o,r,i=null,a=!1,s=0,u=null,c=null,l=null,f=null,p=null,h=null;!a;){if(c=u=null,!(0<=(l=e.indexOf(t.close,s))))throw new g.Error("Unable to find closing bracket '"+t.close+"' opened near template position "+n);if(i=l,a=!0,t.type===g.token.type.comment)break;if(t.type===g.token.type.raw)break;for(r=g.token.strings.length,o=0;o<r;o+=1)0<(p=e.indexOf(g.token.strings[o],s))&&p<l&&(null===u||p<u)&&(u=p,c=g.token.strings[o]);if(null!==u)for(f=u+1,i=null,a=!1;;){if((h=e.indexOf(c,f))<0)throw"Unclosed string in template";if("\\"!==e.substr(h-1,1)){s=h+1;break}f=h+1}}return i},g.tokenize=function(e){for(var t=[],n=0,o=null,r=null;0<e.length;)if(o=g.token.findStart(e),g.log.trace("Twig.tokenize: ","Found token: ",o),null!==o.position){if(0<o.position&&t.push({type:g.token.type.raw,value:e.substring(0,o.position)}),e=e.substr(o.position+o.def.open.length),n+=o.position+o.def.open.length,r=g.token.findEnd(e,o.def,n),g.log.trace("Twig.tokenize: ","Token ends at ",r),t.push({type:o.def.type,value:e.substring(0,r).trim()}),"\n"===e.substr(r+o.def.close.length,1))switch(o.def.type){case"logic_whitespace_pre":case"logic_whitespace_post":case"logic_whitespace_both":case"logic":r+=1}e=e.substr(r+o.def.close.length),n+=r+o.def.close.length}else t.push({type:g.token.type.raw,value:e}),e="";return t},g.compile=function(m){var _=this;return g.attempt(function(){for(var t=[],n=[],o=[],e=null,r=null,i=null,a=null,s=null,u=null,c=null,l=null,f=null,p=null,h=null,d=null,y=function(e){g.expression.compile.call(_,e),0<n.length?o.push(e):t.push(e)},v=function(e){if(r=g.logic.compile.call(_,e),p=r.type,h=g.logic.handler[p].open,d=g.logic.handler[p].next,g.log.trace("Twig.compile: ","Compiled logic token to ",r," next is: ",d," open is : ",h),void 0!==h&&!h){if(a=n.pop(),c=g.logic.handler[a.type],g.indexOf(c.next,p)<0)throw new Error(p+" not expected after a "+a.type);a.output=a.output||[],a.output=a.output.concat(o),o=[],f={type:g.token.type.logic,token:a},0<n.length?o.push(f):t.push(f)}void 0!==d&&0<d.length?(g.log.trace("Twig.compile: ","Pushing ",r," to logic stack."),0<n.length&&((a=n.pop()).output=a.output||[],a.output=a.output.concat(o),n.push(a),o=[]),n.push(r)):void 0!==h&&h&&(f={type:g.token.type.logic,token:r},0<n.length?o.push(f):t.push(f))};0<m.length;){switch(e=m.shift(),s=t[t.length-1],u=o[o.length-1],l=m[0],g.log.trace("Compiling token ",e),e.type){case g.token.type.raw:0<n.length?o.push(e):t.push(e);break;case g.token.type.logic:v.call(_,e);break;case g.token.type.comment:break;case g.token.type.output:y.call(_,e);break;case g.token.type.logic_whitespace_pre:case g.token.type.logic_whitespace_post:case g.token.type.logic_whitespace_both:case g.token.type.output_whitespace_pre:case g.token.type.output_whitespace_post:case g.token.type.output_whitespace_both:switch(e.type!==g.token.type.output_whitespace_post&&e.type!==g.token.type.logic_whitespace_post&&(s&&s.type===g.token.type.raw&&(t.pop(),null===s.value.match(/^\s*$/)&&(s.value=s.value.trim(),t.push(s))),u&&u.type===g.token.type.raw&&(o.pop(),null===u.value.match(/^\s*$/)&&(u.value=u.value.trim(),o.push(u)))),e.type){case g.token.type.output_whitespace_pre:case g.token.type.output_whitespace_post:case g.token.type.output_whitespace_both:y.call(_,e);break;case g.token.type.logic_whitespace_pre:case g.token.type.logic_whitespace_post:case g.token.type.logic_whitespace_both:v.call(_,e)}e.type!==g.token.type.output_whitespace_pre&&e.type!==g.token.type.logic_whitespace_pre&&l&&l.type===g.token.type.raw&&(m.shift(),null===l.value.match(/^\s*$/)&&(l.value=l.value.trim(),m.unshift(l)))}g.log.trace("Twig.compile: "," Output: ",t," Logic Stack: ",n," Pending Output: ",o)}if(0<n.length)throw i=n.pop(),new Error("Unable to find an end tag for "+i.type+", expecting one of "+i.next);return t},function(e){if(_.options.rethrow)throw"TwigException"!=e.type||e.file||(e.file=_.id),e;g.log.error("Error compiling twig template "+_.id+": "),e.stack?g.log.error(e.stack):g.log.error(e.toString())})},g.parse=function(e,t,n){var o,r=this,i=[],a=null,s=!0,u=!0;function c(e){i.push(e)}function l(e){void 0!==e.chain&&(u=e.chain),void 0!==e.context&&(t=e.context),void 0!==e.output&&i.push(e.output)}if(o=g.async.forEach(e,function(e){switch(g.log.debug("Twig.parse: ","Parsing token: ",e),e.type){case g.token.type.raw:i.push(g.filters.raw(e.value));break;case g.token.type.logic:return g.logic.parseAsync.call(r,e.token,t,u).then(l);case g.token.type.comment:break;case g.token.type.output_whitespace_pre:case g.token.type.output_whitespace_post:case g.token.type.output_whitespace_both:case g.token.type.output:return g.log.debug("Twig.parse: ","Output token: ",e.stack),g.expression.parseAsync.call(r,e.stack,t).then(c)}}).then(function(){return i=g.output.call(r,i),s=!1,i}).catch(function(e){n&&f(r,e),a=e}),n)return o;if(null!==a)return f(this,a);if(s)throw new g.Error("You are using Twig.js in sync mode in combination with async extensions.");return i},g.prepare=function(e){var t,n;return g.log.debug("Twig.prepare: ","Tokenizing ",e),n=g.tokenize.call(this,e),g.log.debug("Twig.prepare: ","Compiling ",n),t=g.compile.call(this,n),g.log.debug("Twig.prepare: ","Compiled ",t),t},g.output=function(e){var t=this.options.autoescape;if(!t)return e.join("");var n="string"==typeof t?t:"html",o=0,r=e.length,i="",a=new Array(r);for(o=0;o<r;o++)(i=e[o])&&!0!==i.twig_markup&&i.twig_markup!=n&&(i=g.filters.escape(i,[n])),a[o]=i;return a.length<1?"":g.Markup(a.join(""),!0)},g.Templates={loaders:{},parsers:{},registry:{}},g.validateId=function(e){if("prototype"===e)throw new g.Error(e+" is not a valid twig identifier");if(g.cache&&g.Templates.registry.hasOwnProperty(e))throw new g.Error("There is already a template with the ID "+e);return!0},g.Templates.registerLoader=function(e,t,n){if("function"!=typeof t)throw new g.Error("Unable to add loader for "+e+": Invalid function reference given.");n&&(t=t.bind(n)),this.loaders[e]=t},g.Templates.unRegisterLoader=function(e){this.isRegisteredLoader(e)&&delete this.loaders[e]},g.Templates.isRegisteredLoader=function(e){return this.loaders.hasOwnProperty(e)},g.Templates.registerParser=function(e,t,n){if("function"!=typeof t)throw new g.Error("Unable to add parser for "+e+": Invalid function regerence given.");n&&(t=t.bind(n)),this.parsers[e]=t},g.Templates.unRegisterParser=function(e){this.isRegisteredParser(e)&&delete this.parsers[e]},g.Templates.isRegisteredParser=function(e){return this.parsers.hasOwnProperty(e)},g.Templates.save=function(e){if(void 0===e.id)throw new g.Error("Unable to save template with no id");g.Templates.registry[e.id]=e},g.Templates.load=function(e){return g.Templates.registry.hasOwnProperty(e)?g.Templates.registry[e]:null},g.Templates.loadRemote=function(e,t,n,o){var r=void 0===t.id?e:t.id,i=g.Templates.registry[r];return g.cache&&void 0!==i?("function"==typeof n&&n(i),i):(t.parser=t.parser||"twig",t.id=r,void 0===t.async&&(t.async=!0),(this.loaders[t.method]||this.loaders.fs).call(this,e,t,n,o))},g.Template=function(e){var t,n,o=e.data,r=e.id,i=e.blocks,a=e.macros||{},s=e.base,u=e.path,c=e.url,l=e.name,f=e.method,p=e.options;this.id=r,this.method=f,this.base=s,this.path=u,this.url=c,this.name=l,this.macros=a,this.options=p,this.reset(i),t=o,n=Object.prototype.toString.call(t).slice(8,-1),this.tokens=null!=t&&"String"===n?g.prepare.call(this,o):o,void 0!==r&&g.Templates.save(this)},g.Template.prototype.reset=function(e){g.log.debug("Twig.Template.reset","Reseting template "+this.id),this.blocks={},this.importedBlocks=[],this.originalBlockTokens={},this.child={blocks:e||{}},this.extend=null,this.parseStack=[]},g.Template.prototype.render=function(e,o,t){var r=this;return this.context=e||{},this.reset(),o&&o.blocks&&(this.blocks=o.blocks),o&&o.macros&&(this.macros=o.macros),g.async.potentiallyAsync(this,t,function(){return g.parseAsync.call(this,this.tokens,this.context).then(function(e){var t,n;return r.extend?(r.options.allowInlineIncludes&&(t=g.Templates.load(r.extend))&&(t.options=r.options),t||(n=g.path.parsePath(r,r.extend),t=g.Templates.loadRemote(n,{method:r.getLoaderMethod(),base:r.base,async:!1,id:n,options:r.options})),r.parent=t,r.parent.renderAsync(r.context,{blocks:r.blocks})):o?"blocks"==o.output?r.blocks:"macros"==o.output?r.macros:e:e})})},g.Template.prototype.importFile=function(e){var t,n;if(this.url||!this.options.allowInlineIncludes)return t=g.path.parsePath(this,e),n=g.Templates.loadRemote(t,{method:this.getLoaderMethod(),base:this.base,async:!1,options:this.options,id:t});if(e=this.path?g.path.parsePath(this,e):e,!(n=g.Templates.load(e))&&!(n=g.Templates.loadRemote(t,{id:e,method:this.getLoaderMethod(),async:!1,path:e,options:this.options})))throw new g.Error("Unable to find the template "+e);return n.options=this.options,n},g.Template.prototype.importBlocks=function(e,t){var n=this.importFile(e),o=this.context,r=this;t=t||!1,n.render(o),g.forEach(Object.keys(n.blocks),function(e){(t||void 0===r.blocks[e])&&(r.blocks[e]=n.blocks[e],r.importedBlocks.push(e))})},g.Template.prototype.importMacros=function(e){var t=g.path.parsePath(this,e);return g.Templates.loadRemote(t,{method:this.getLoaderMethod(),async:!1,id:t})},g.Template.prototype.getLoaderMethod=function(){return this.path?"fs":this.url?"ajax":this.method||"fs"},g.Template.prototype.compile=function(e){return g.compiler.compile(this,e)},g.Markup=function(e,t){if("string"!=typeof e||e.length<1)return e;var n=new String(e);return n.twig_markup=void 0===t||t,n},g}},function(e,t,n){var o={VERSION:"1.12.0"};n(26)(o),n(25)(o),n(24)(o),n(22)(o),n(21)(o),n(20)(o),n(11)(o),n(10)(o),n(8)(o),n(7)(o),n(6)(o),n(5)(o),n(4)(o),n(3)(o),n(2)(o),e.exports=o.exports}])}).call(this,n(34),"/")},function(e,c,t){(function(r){function i(e,t){for(var n=0,o=e.length-1;0<=o;o--){var r=e[o];"."===r?e.splice(o,1):".."===r?(e.splice(o,1),n++):n&&(e.splice(o,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}var t=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,a=function(e){return t.exec(e).slice(1)};function s(e,t){if(e.filter)return e.filter(t);for(var n=[],o=0;o<e.length;o++)t(e[o],o,e)&&n.push(e[o]);return n}c.resolve=function(){for(var e="",t=!1,n=arguments.length-1;-1<=n&&!t;n--){var o=0<=n?arguments[n]:r.cwd();if("string"!=typeof o)throw new TypeError("Arguments to path.resolve must be strings");o&&(e=o+"/"+e,t="/"===o.charAt(0))}return(t?"/":"")+(e=i(s(e.split("/"),function(e){return!!e}),!t).join("/"))||"."},c.normalize=function(e){var t=c.isAbsolute(e),n="/"===o(e,-1);return(e=i(s(e.split("/"),function(e){return!!e}),!t).join("/"))||t||(e="."),e&&n&&(e+="/"),(t?"/":"")+e},c.isAbsolute=function(e){return"/"===e.charAt(0)},c.join=function(){var e=Array.prototype.slice.call(arguments,0);return c.normalize(s(e,function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},c.relative=function(e,t){function n(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;0<=n&&""===e[n];n--);return n<t?[]:e.slice(t,n-t+1)}e=c.resolve(e).substr(1),t=c.resolve(t).substr(1);for(var o=n(e.split("/")),r=n(t.split("/")),i=Math.min(o.length,r.length),a=i,s=0;s<i;s++)if(o[s]!==r[s]){a=s;break}var u=[];for(s=a;s<o.length;s++)u.push("..");return(u=u.concat(r.slice(a))).join("/")},c.sep="/",c.delimiter=":",c.dirname=function(e){var t=a(e),n=t[0],o=t[1];return n||o?(o&&(o=o.substr(0,o.length-1)),n+o):"."},c.basename=function(e,t){var n=a(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},c.extname=function(e){return a(e)[3]};var o="b"==="ab".substr(-1)?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return t<0&&(t=e.length+t),e.substr(t,n)}}).call(this,t(83))},function(e,t){},function(e,t,n){e.exports=n(409)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(410);Object.defineProperty(t,"createCanvas",{enumerable:!0,get:function(){return o.createCanvas}});var r=n(411);Object.defineProperty(t,"getType",{enumerable:!0,get:function(){return r.getType}});var i=n(161);Object.defineProperty(t,"isElement",{enumerable:!0,get:function(){return i.isElement}});var a=n(412);Object.defineProperty(t,"isMediaElement",{enumerable:!0,get:function(){return a.isMediaElement}});var s=n(413);Object.defineProperty(t,"isNodeList",{enumerable:!0,get:function(){return s.isNodeList}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createCanvas=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:window.innerWidth,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:window.innerHeight,n=document.createElement("canvas");return n.width=e,n.height=t,n.style.width=e+"px",n.style.height=t+"px",n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getType=function(e){return{}.toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isMediaElement=function(e){for(var t=(0,u.isElement)(e),n=["HTMLImageElement","HTMLAudioElement","HTMLVideoElement"],o=["IMG","AUDIO","VIDEO"],r=0,i=n.length;r<i;r++)if(t&&n[r]in window&&e instanceof window[n[r]])return!0;for(var a=0,s=o.length;a<s;a++)return t&&e.nodeName===o[a]};var u=n(161)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isNodeList=function(e){return!(!e||e.constructor!==window.NodeList)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(415);Object.defineProperty(t,"getURLFileExtension",{enumerable:!0,get:function(){return o.getURLFileExtension}});var r=n(162);Object.defineProperty(t,"isArray",{enumerable:!0,get:function(){return r.isArray}});var i=n(416);Object.defineProperty(t,"isCorsSupported",{enumerable:!0,get:function(){return i.isCorsSupported}});var a=n(417);Object.defineProperty(t,"isObject",{enumerable:!0,get:function(){return a.isObject}});var s=n(418);Object.defineProperty(t,"scope",{enumerable:!0,get:function(){return s.scope}});var u=n(419);Object.defineProperty(t,"uuid",{enumerable:!0,get:function(){return u.uuid}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getURLFileExtension=function(e){if(!e)return null;var t=e,n="";{if(-1===(t=(t=(t=t.substr(1+t.lastIndexOf("/"))).split("?")[0]).split("#")[0]).lastIndexOf("."))return null;n=t.substring(t.lastIndexOf(".")+1)}return n.toLowerCase()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isCorsSupported=function(){return"withCredentials"in new window.XMLHttpRequest}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isObject=function(e){return e===Object(e)&&!(0,o.isArray)(e)};var o=n(162)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scope=function(e,t){for(var n=0,o=t.length;n<o;n++)e[t[n]]=e[t[n]].bind(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uuid=function(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+(e()+e()+e())}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.walk=function(e,t){var n=Array.prototype.slice;"length"in e||(e=[e]);e=n.call(e);for(;e.length;){var o=e.shift(),r=t(o);r||o.childNodes&&o.childNodes.length&&(e=n.call(o.childNodes).concat(e))}};t.startsWith=function(e,t){return 0===e.indexOf(t)}},function(f,e,p){(function(e){for(var o=p(422),t="undefined"==typeof window?e:window,n=["moz","webkit"],r="AnimationFrame",i=t["request"+r],a=t["cancel"+r]||t["cancelRequest"+r],s=0;!i&&s<n.length;s++)i=t[n[s]+"Request"+r],a=t[n[s]+"Cancel"+r]||t[n[s]+"CancelRequest"+r];if(!i||!a){var u=0,c=0,l=[];i=function(e){if(0===l.length){var t=o(),n=Math.max(0,1e3/60-(t-u));u=n+t,setTimeout(function(){for(var e=l.slice(0),t=l.length=0;t<e.length;t++)if(!e[t].cancelled)try{e[t].callback(u)}catch(e){setTimeout(function(){throw e},0)}},Math.round(n))}return l.push({handle:++c,callback:e,cancelled:!1}),c},a=function(e){for(var t=0;t<l.length;t++)l[t].handle===e&&(l[t].cancelled=!0)}}f.exports=function(e){return i.call(t,e)},f.exports.cancel=function(){a.apply(t,arguments)},f.exports.polyfill=function(e){e||(e=t),e.requestAnimationFrame=i,e.cancelAnimationFrame=a}}).call(this,p(34))},function(s,e,t){(function(a){(function(){var e,t,n,o,r,i;"undefined"!=typeof performance&&null!==performance&&performance.now?s.exports=function(){return performance.now()}:null!=a&&a.hrtime?(s.exports=function(){return(e()-r)/1e6},t=a.hrtime,o=(e=function(){var e;return 1e9*(e=t())[0]+e[1]})(),i=1e9*a.uptime(),r=o-i):n=Date.now?(s.exports=function(){return Date.now()-n},Date.now()):(s.exports=function(){return(new Date).getTime()-n},(new Date).getTime())}).call(this)}).call(this,t(83))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(424),r=new o.Logger;r.plugin("namespace",o.plugins.namespace,{name:"quark-raf"}),t.default=r,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.plugins=t.Logger=void 0;var o=i(n(425)),r=i(n(426));function i(e){return e&&e.__esModule?e:{default:e}}t.Logger=o.default,t.plugins=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},r=function(){function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}}(),p=n(163);function h(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._enabled=!0,this._defaultsLevels={log:{},info:{},warn:{},error:{}},this._levels={log:{},info:{},warn:{},error:{}},this._commands=["group","time"],this._plugins={},this._logHandler=null,this._bindLevels(),this._bindCommands()}return r(e,[{key:"on",value:function(){return this._enabled=!0,this}},{key:"off",value:function(){return this._enabled=!1,this}},{key:"reset",value:function(){this._levels={log:{},info:{},warn:{},error:{}},this._plugins={},this._bindLevels()}},{key:"br",value:function(){return this._print("log",{},""),this}},{key:"level",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return"string"!=typeof e?this._printError("Logger.level() : 'name' argument is required"):(void 0!==this._levels[e]?this._levels[e]=a({},this._levels[e],t):this._levels[e]=t,this._bindLevel(e,t),this)}},{key:"plugin",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return"string"!=typeof e?this._printError("Logger.plugin() : 'name' argument is required"):void 0!==this._plugins[e]&&"object"===(void 0===t?"undefined":o(t))&&null!==t?(this._plugins[e].options=a({},this._plugins[e].options,t),this):"function"!=typeof t?this._printError("Logger.plugin() : 'fn' argument must be a function"):(this._plugins[e]={fn:t.bind(this),options:a({enabled:!0},n)},this)}},{key:"setHandler",value:function(e){return this._logHandler=e,this}},{key:"_bindLevels",value:function(){for(var e in this._levels){var t=this._levels[e];this._bindLevel(e,t)}}},{key:"_bindLevel",value:function(o,r){var i=this;this[o]=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return i._levelCallback(o,r,t)}}},{key:"_levelCallback",value:function(e,t,n){if(this._enabled){var o=n;null!==this._logHandler&&this._logHandler(o);var r=this._applyPlugins(e,t,o),i=r.msgs,a=r.before,s=r.after,u=r.styles;return this._print(e,t,i,a,s,u)}}},{key:"_bindCommands",value:function(){for(var o=this,e=function(e,t){var n=o._commands[e];o[n]=function(e){return console[n](e)},o[n+"End"]=function(e){return console[n+"End"](e)}},t=0,n=this._commands.length;t<n;t++)e(t)}},{key:"_applyPlugins",value:function(e,t,n){var o=[],r=[],i=[];for(var a in this._plugins){var s=this._plugins[a],u={name:e,options:t};if(s.options.enabled){var c=s.fn(n,s.options,u),l=c.msgs,f=c.before,p=c.after,h=c.styles;l&&(n=l),f&&(r=r.concat("<styles>"+f+"</styles>")),p&&(i=i.concat(p)),o=o.concat(h||{})}}return{msgs:n,before:r,after:i,styles:o}}},{key:"_print",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[],o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:[],r=4<arguments.length&&void 0!==arguments[4]?arguments[4]:[],i=5<arguments.length&&void 0!==arguments[5]?arguments[5]:{},a=[],s=[];t.styles&&(i=this._mergeStyles(t.styles,i)),i=this._parsePluginsStyles(i),s=s.concat(i),t.styles&&(s.push(this._parseStyles(t.styles)),s.push("")),o.length&&a.push(this._parseMsgTags(o).join(" "));var u=this._sortMsgs(n),c=u.stringMsgs,l=u.othersMsgs;t.styles&&(c[0]="<styles>"+c[0],c[c.length-1]+="</styles>"),a.push(this._parseMsgTags(c).join(" ")),r.length&&a.push(this._parseMsgTags(r).join(" ")),a=a.join(" "),(0,p.isBrowser)()||(a=a.replace(/%c/g,""));var f=[a];return(0,p.isBrowser)()?f.push.apply(f,h(s).concat(h(l))):f.push.apply(f,h(l)),"undefined"==typeof console?this:(void 0!==this._defaultsLevels[e]?console[e].apply(console,f):console.log.apply(console,f),"error"!==e&&"warn"!==e)}},{key:"_mergeStyles",value:function(e,t){for(var n=[],o=0,r=t.length;o<r;o++){var i=t[o];n.push(a({},i,e))}return n}},{key:"_parseStyles",value:function(e){var t="";for(var n in e){var o=e[n];t+=(0,p.camelToKebab)(n)+": "+o+";"}return t}},{key:"_parsePluginsStyles",value:function(e){for(var t=[],n=0,o=e.length;n<o;n++){var r=e[n];t.push(this._parseStyles(r)),t.push("")}return t}},{key:"_parseMsgTags",value:function(e){for(var t=0,n=e.length;t<n;t++)"string"==typeof e[t]&&(e[t]=e[t].replace(/<(\/)?styles>/gi,"%c"));return e}},{key:"_sortMsgs",value:function(e){for(var t=[],n=[],o=0,r=e.length;o<r;o++){var i=e[o];"string"==typeof i?t.push(i):n.push(i)}return{stringMsgs:t,othersMsgs:n}}},{key:"_printError",value:function(e){this.reset(),this.error(e)}}]),e}();t.default=i,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(427)),r=i(n(428));function i(e){return e&&e.__esModule?e:{default:e}}t.default={time:o.default,namespace:r.default},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var o=new Date,r=s(o.getHours()),i=s(o.getMinutes()),a=s(o.getSeconds());return{before:"["+r+":"+i+":"+a+"]"}};var s=function(e){return("0"+e).slice(-2)};e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e};t.default=function(e,t,n){var o=t.name,r=void 0===o?null:o,i=t.capitalize,a=void 0!==i&&i,s=t.styles,u=void 0===s?{}:s,c="",l={};r&&(a&&(r=(0,p.capitalize)(r)),c="["+r+"]",l=f({},h,d[n.name],u||{}));return{before:c,styles:l}};var p=n(163);var h={color:"white",background:"#000000",padding:"3px 5px"},d={log:{background:"#000000"},info:{background:"#219bff"},warn:{background:"#ffea2d",color:"inherit"},error:{background:"#e52d34"}};e.exports=t.default},function(t,n,o){var r;!function(e){"use strict";void 0===(r=function(e){var a=o(121),r=o(164);function s(e,t,n,o){return a.setTimer(function(){e(n,o,t)},t)}return function(e){function n(e,t,n){s(o,e,t,n)}function o(e,t){t.resolve(e)}function i(e,t,n){var o=void 0===e?new r("timed out after "+n+"ms"):e;t.reject(o)}return e.prototype.delay=function(e){var t=this._beget();return this._handler.fold(n,e,void 0,t._handler),t},e.prototype.timeout=function(e,t){var n=this._beget(),o=n._handler,r=s(i,e,t,n._handler);return this._handler.visit(o,function(e){a.clearTimer(r),this.resolve(e)},function(e){a.clearTimer(r),this.reject(e)},o.notify),n},e}}.call(n,o,n,t))||(t.exports=r)}(o(25))},function(e,t){},function(t,n,o){var r;!function(e){"use strict";void 0===(r=function(e){var c=o(165),l=o(166);return function(h){var r=l(h),n=h.resolve,o=h.all,i=Array.prototype.reduce,a=Array.prototype.reduceRight,s=Array.prototype.slice;return h.any=function(e){for(var t,n,o=h._defer(),r=o._handler,i=e.length>>>0,a=i,s=[],u=0;u<i;++u)if(void 0!==(n=e[u])||u in e){if(0<(t=h._handler(n)).state()){r.become(t),h._visitRemaining(e,u,t);break}t.visit(r,c,l)}else--a;0===a&&r.reject(new RangeError("any(): array must not be empty"));return o;function c(e){s=null,this.resolve(e)}function l(e){this.resolved||(s.push(e),0==--a&&this.reject(s))}},h.some=function(e,t){var n,o,r,i=h._defer(),a=i._handler,s=[],u=[],c=e.length>>>0,l=0;for(r=0;r<c;++r)(void 0!==(o=e[r])||r in e)&&++l;t=Math.max(t,0),n=l-t+1,(l=Math.min(t,l))<t?a.reject(new RangeError("some(): array must contain at least "+t+" item(s), but had "+l)):0===l&&a.resolve(s);for(r=0;r<c;++r)(void 0!==(o=e[r])||r in e)&&h._handler(o).visit(a,f,p,a.notify);return i;function f(e){this.resolved||(s.push(e),0==--l&&(u=null,this.resolve(s)))}function p(e){this.resolved||(u.push(e),0==--n&&(s=null,this.reject(u)))}},h.settle=function(e){return o(e.map(t))},h.map=function(e,t){return h._traverse(t,e)},h.filter=function(e,t){var n=s.call(e);return h._traverse(t,n).then(function(e){return function(e,t){for(var n=t.length,o=new Array(n),r=0,i=0;r<n;++r)t[r]&&(o[i++]=h._handler(e[r]).value);return o.length=i,o}(n,e)})},h.reduce=function(e,t){return 2<arguments.length?i.call(e,u(t),arguments[2]):i.call(e,u(t))},h.reduceRight=function(e,t){return 2<arguments.length?a.call(e,u(t),arguments[2]):a.call(e,u(t))},h.prototype.spread=function(t){return this.then(o).then(function(e){return t.apply(this,e)})},h;function t(e){var t;return e instanceof h&&(t=e._handler.join()),t&&0===t.state()||!t?n(e).then(c.fulfilled,c.rejected):(t._unreport(),c.inspect(t))}function u(o){return function(e,t,n){return r(o,void 0,[e,t,n])}}}}.call(n,o,n,t))||(t.exports=r)}(o(25))},function(t,n,o){var r;!function(e){"use strict";void 0===(r=function(){return function(e){var u=e.resolve,a=e.reject,t=e.prototype.catch;function n(e,t,n,o){var r,i,a,s=e.call(t);return"object"!=typeof(a=s)&&"function"!=typeof a||null===a?n(o):(r=n,i=o,u(s).then(function(){return r(i)}))}return e.prototype.done=function(e,t){this._handler.visit(this._handler.receiver,e,t)},e.prototype.catch=e.prototype.otherwise=function(e){return arguments.length<2?t.call(this,e):"function"!=typeof e?this.ensure(o):t.call(this,(r=arguments[1],i=e,function(e){return t=e,((o=n=i)===Error||null!=o&&o.prototype instanceof Error?t instanceof n:n(t))?r.call(this,e):a(e);var t,n,o}));var r,i},e.prototype.finally=e.prototype.ensure=function(t){return"function"!=typeof t?this:this.then(function(e){return n(t,this,r,e)},function(e){return n(t,this,a,e)})},e.prototype.else=e.prototype.orElse=function(e){return this.then(void 0,function(){return e})},e.prototype.yield=function(e){return this.then(function(){return e})},e.prototype.tap=function(e){return this.then(e).yield(this)},e};function o(){throw new TypeError("catch predicate must be a function")}function r(e){return e}}.call(n,o,n,t))||(t.exports=r)}(o(25))},function(t,n,o){var r;!function(e){"use strict";void 0===(r=function(){return function(r){return r.prototype.fold=function(o,e){var t=this._beget();return this._handler.fold(function(e,t,n){r._handler(e).fold(function(e,t,n){n.resolve(o.call(this,t,e))},t,this,n)},e,t._handler.receiver,t._handler),t},r}}.call(n,o,n,t))||(t.exports=r)}(o(25))},function(t,n,o){var r;!function(e){"use strict";void 0===(r=function(e){var t=o(165).inspect;return function(e){return e.prototype.inspect=function(){return t(e._handler(this))},e}}.call(n,o,n,t))||(t.exports=r)}(o(25))},function(t,n,o){var r;!function(e){"use strict";void 0===(r=function(){return function(e){var a=e.resolve;return e.iterate=function(t,e,n,o){return s(function(e){return[e,t(e)]},e,n,o)},e.unfold=s,e;function s(n,o,r,e){return a(e).then(function(t){return a(o(t)).then(function(e){return e?t:a(n(t)).spread(i)})});function i(e,t){return a(r(e)).then(function(){return s(n,o,r,t)})}}}}.call(n,o,n,t))||(t.exports=r)}(o(25))},function(t,n,o){var r;!function(e){"use strict";void 0===(r=function(){return function(e){return e.prototype.progress=function(e){return this.then(void 0,void 0,e)},e}}.call(n,o,n,t))||(t.exports=r)}(o(25))},function(t,n,o){var r;!function(e){"use strict";void 0===(r=function(){return function(e){return e.prototype.with=e.prototype.withThis=function(e){var t=this._beget(),n=t._handler;return n.receiver=e,this._handler.chain(n,e),t},e}}.call(n,o,n,t))||(t.exports=r)}(o(25))},function(t,n,o){var r;!function(e){"use strict";void 0===(r=function(e){var f=o(121).setTimer,p=o(439);return function(e){var t,n=d,o=d;"undefined"!=typeof console&&(t=console,n=void 0!==t.error?function(e){t.error(e)}:function(e){t.log(e)},o=void 0!==t.info?function(e){t.info(e)}:function(e){t.log(e)}),e.onPotentiallyUnhandledRejection=function(e){c(s,e)},e.onPotentiallyUnhandledRejectionHandled=function(e){c(u,e)},e.onFatalRejection=function(e){c(h,e.value)};var r=[],i=[],a=null;function s(e){e.handled||(i.push(e),n("Potentially unhandled rejection ["+e.id+"] "+p.formatError(e.value)))}function u(e){var t=i.indexOf(e);0<=t&&(i.splice(t,1),o("Handled previous rejection ["+e.id+"] "+p.formatObject(e.value)))}function c(e,t){r.push(e,t),null===a&&(a=f(l,0))}function l(){for(a=null;0<r.length;)r.shift()(r.shift())}return e};function h(e){throw e}function d(){}}.call(n,o,n,t))||(t.exports=r)}(o(25))},function(t,n,o){var r;!function(e){"use strict";void 0===(r=function(){return{formatError:function(e){var t="object"==typeof e&&null!==e&&(e.stack||e.message)?e.stack||e.message:n(e);return e instanceof Error?t:t+" (WARNING: non-Error used)"},formatObject:n,tryStringify:o};function n(e){var t=String(e);return"[object Object]"===t&&"undefined"!=typeof JSON&&(t=o(e,t)),t}function o(e,t){try{return JSON.stringify(e)}catch(e){return t}}}.call(n,o,n,t))||(t.exports=r)}(o(25))},function(t,n,o){var r;!function(e){"use strict";void 0===(r=function(e){return o(441)({scheduler:new(o(442))(o(121).asap)})}.call(n,o,n,t))||(t.exports=r)}(o(25))},function(n,o,r){(function(I){var t;!function(e){"use strict";void 0===(t=function(){return function(e){var n=e.scheduler,t=function(){{if(null!=I&&"function"==typeof I.emit)return function(e,t){return"unhandledRejection"===e?I.emit(e,t.value,t):I.emit(e,t)};if("undefined"!=typeof self&&function(){if("function"==typeof CustomEvent)try{var e=new CustomEvent("unhandledRejection");return e instanceof CustomEvent}catch(e){}return!1}())return i=self,a=CustomEvent,function(e,t){var n=new a(e,{detail:{reason:t.value,key:t},bubbles:!1,cancelable:!0});return!i.dispatchEvent(n)};if("undefined"!=typeof self&&function(){if("undefined"!=typeof document&&"function"==typeof document.createEvent)try{var e=document.createEvent("CustomEvent");return e.initCustomEvent("eventType",!1,!0,{}),!0}catch(e){}return!1}())return o=self,r=document,function(e,t){var n=r.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!0,{reason:t.value,key:t}),!o.dispatchEvent(n)}}var o,r;var i,a;return H}(),o=Object.create||function(e){function t(){}return t.prototype=e,new t};function l(e,t){this._handler=e===d?t:function(e){var t=new m;try{e(function(e){t.resolve(e)},n,function(e){t.notify(e)})}catch(e){n(e)}return t;function n(e){t.reject(e)}}(e)}function r(e){return C(e)?e:new l(d,new _(p(e)))}function i(e){return new l(d,new _(new O(e)))}function a(){return E}function s(o,r,i){for(var e,t="function"==typeof r?function(e,t,n){n.resolved||f(i,c,e,o(r,t,e),n)}:c,n=new m,a=i.length>>>0,s=new Array(a),u=0;u<i.length&&!n.resolved;++u)void 0!==(e=i[u])||u in i?f(i,t,u,e,n):--a;return 0===a&&n.become(new b(s)),new l(d,n);function c(e,t,n){s[e]=t,0==--a&&n.become(new b(s))}}function f(e,t,n,o,r){if(R(o)){var i=C(s=o)?s._handler.join():h(s),a=i.state();0===a?i.fold(t,n,void 0,r):0<a?t(n,i.value,r):(r.become(i),u(e,n+1,i))}else t(n,o,r);var s}function u(e,t,n){for(var o=t;o<e.length;++o)c(p(e[o]),n)}function c(e,t){if(e!==t){var n=e.state();0===n?e.visit(e,void 0,e._unreport):n<0&&e._unreport()}}function p(e){return C(e)?e._handler.join():R(e)?h(e):new b(e)}function h(e){try{var t=e.then;return"function"==typeof t?new g(t,e):new b(e)}catch(e){return new O(e)}}function d(){}function y(){}l.resolve=r,l.reject=i,l.never=a,l._defer=function(){return new l(d,new m)},l._handler=p,l.prototype.then=function(e,t,n){var o=this._handler,r=o.join().state();if("function"!=typeof e&&0<r||"function"!=typeof t&&r<0)return new this.constructor(d,o);var i=this._beget(),a=i._handler;return o.chain(a,o.receiver,e,t,n),i},l.prototype.catch=function(e){return this.then(void 0,e)},l.prototype._beget=function(){return e=this._handler,t=this.constructor,n=new m(e.receiver,e.join().context),new t(d,n);var e,t,n},l.all=function(e){return s(z,null,e)},l.race=function(e){return"object"==typeof e&&null!==e?0===e.length?a():1===e.length?r(e[0]):function(e){var t,n,o,r=new m;for(t=0;t<e.length;++t)if(void 0!==(n=e[t])||t in e){if(0!==(o=p(n)).state()){r.become(o),u(e,t+1,o);break}o.visit(r,r.resolve,r.reject)}return new l(d,r)}(e):i(new TypeError("non-iterable passed to race()"))},l._traverse=function(e,t){return s(L,e,t)},l._visitRemaining=u,d.prototype.when=d.prototype.become=d.prototype.notify=d.prototype.fail=d.prototype._unreport=d.prototype._report=H,d.prototype._state=0,d.prototype.state=function(){return this._state},d.prototype.join=function(){for(var e=this;void 0!==e.handler;)e=e.handler;return e},d.prototype.chain=function(e,t,n,o,r){this.when({resolver:e,receiver:t,fulfilled:n,rejected:o,progress:r})},d.prototype.visit=function(e,t,n,o){this.chain(v,e,t,n,o)},d.prototype.fold=function(e,t,n,o){this.when(new j(e,t,n,o))},D(d,y),y.prototype.become=function(e){e.fail()};var v=new y;function m(e,t){l.createContext(this,t),this.consumers=void 0,this.receiver=e,this.handler=void 0,this.resolved=!1}function _(e){this.handler=e}function g(e,t){m.call(this),n.enqueue(new S(e,t,this))}function b(e){l.createContext(this),this.value=e}D(d,m),m.prototype._state=0,m.prototype.resolve=function(e){this.become(p(e))},m.prototype.reject=function(e){this.resolved||this.become(new O(e))},m.prototype.join=function(){if(!this.resolved)return this;for(var e=this;void 0!==e.handler;)if((e=e.handler)===this)return this.handler=new O(new TypeError("Promise cycle"));return e},m.prototype.run=function(){var e=this.consumers,t=this.handler;this.handler=this.handler.join(),this.consumers=void 0;for(var n=0;n<e.length;++n)t.when(e[n])},m.prototype.become=function(e){this.resolved||(this.resolved=!0,this.handler=e,void 0!==this.consumers&&n.enqueue(this),void 0!==this.context&&e._report(this.context))},m.prototype.when=function(e){this.resolved?n.enqueue(new P(e,this.handler)):void 0===this.consumers?this.consumers=[e]:this.consumers.push(e)},m.prototype.notify=function(e){this.resolved||n.enqueue(new T(e,this))},m.prototype.fail=function(e){var t=void 0===e?this.context:e;this.resolved&&this.handler.join().fail(t)},m.prototype._report=function(e){this.resolved&&this.handler.join()._report(e)},m.prototype._unreport=function(){this.resolved&&this.handler.join()._unreport()},D(d,_),_.prototype.when=function(e){n.enqueue(new P(e,this))},_.prototype._report=function(e){this.join()._report(e)},_.prototype._unreport=function(){this.join()._unreport()},D(m,g),D(d,b),b.prototype._state=1,b.prototype.fold=function(e,t,n,o){!function(e,t,n,o,r){if("function"!=typeof e)return r.become(n);l.enterContext(n),function(e,t,n,o,r){try{e.call(o,t,n,r)}catch(e){r.become(new O(e))}}(e,t,n.value,o,r),l.exitContext()}(e,t,this,n,o)},b.prototype.when=function(e){M(e.fulfilled,this,e.receiver,e.resolver)};var w=0;function O(e){l.createContext(this),this.id=++w,this.value=e,this.handled=!1,this.reported=!1,this._report()}function x(e,t){this.rejection=e,this.context=t}function k(e){this.rejection=e}D(d,O),O.prototype._state=-1,O.prototype.fold=function(e,t,n,o){o.become(this)},O.prototype.when=function(e){"function"==typeof e.rejected&&this._unreport(),M(e.rejected,this,e.receiver,e.resolver)},O.prototype._report=function(e){n.afterQueue(new x(this,e))},O.prototype._unreport=function(){this.handled||(this.handled=!0,n.afterQueue(new k(this)))},O.prototype.fail=function(e){this.reported=!0,t("unhandledRejection",this),l.onFatalRejection(this,void 0===e?this.context:e)},x.prototype.run=function(){this.rejection.handled||this.rejection.reported||(this.rejection.reported=!0,t("unhandledRejection",this.rejection)||l.onPotentiallyUnhandledRejection(this.rejection,this.context))},k.prototype.run=function(){this.rejection.reported&&(t("rejectionHandled",this.rejection)||l.onPotentiallyUnhandledRejectionHandled(this.rejection))},l.createContext=l.enterContext=l.exitContext=l.onPotentiallyUnhandledRejection=l.onPotentiallyUnhandledRejectionHandled=l.onFatalRejection=H;var E=new l(d,new d);function P(e,t){this.continuation=e,this.handler=t}function T(e,t){this.handler=t,this.value=e}function S(e,t,n){this._then=e,this.thenable=t,this.resolver=n}function j(e,t,n,o){this.f=e,this.z=t,this.c=n,this.to=o,this.resolver=v,this.receiver=this}function C(e){return e instanceof l}function R(e){return("object"==typeof e||"function"==typeof e)&&null!==e}function M(e,t,n,o){if("function"!=typeof e)return o.become(t);l.enterContext(t),function(e,t,n,o){try{o.become(p(e.call(n,t)))}catch(e){o.become(new O(e))}}(e,t.value,n,o),l.exitContext()}function A(e,t,n,o,r){if("function"!=typeof e)return r.notify(t);l.enterContext(n),function(e,t,n,o){try{o.notify(e.call(n,t))}catch(e){o.notify(e)}}(e,t,o,r),l.exitContext()}function L(e,t,n){try{return e(t,n)}catch(e){return i(e)}}function D(e,t){t.prototype=o(e.prototype),t.prototype.constructor=t}function z(e,t){return t}function H(){}return P.prototype.run=function(){this.handler.join().when(this.continuation)},T.prototype.run=function(){var e=this.handler.consumers;if(void 0!==e)for(var t,n=0;n<e.length;++n)A((t=e[n]).progress,this.value,this.handler,t.receiver,t.resolver)},S.prototype.run=function(){var t=this.resolver;!function(e,t,n,o,r){try{e.call(t,n,o,r)}catch(e){o(e)}}(this._then,this.thenable,function(e){t.resolve(e)},function(e){t.reject(e)},function(e){t.notify(e)})},j.prototype.fulfilled=function(e){this.f.call(this.c,this.z,e,this.to)},j.prototype.rejected=function(e){this.to.reject(e)},j.prototype.progress=function(e){this.to.notify(e)},l}}.call(o,r,o,n))||(n.exports=t)}(r(25))}).call(this,r(83))},function(t,n,o){var r;!function(e){"use strict";void 0===(r=function(){function e(e){this._async=e,this._running=!1,(this._queue=this)._queueLen=0,this._afterQueue={},this._afterQueueLen=0;var t=this;this.drain=function(){t._drain()}}return e.prototype.enqueue=function(e){this._queue[this._queueLen++]=e,this.run()},e.prototype.afterQueue=function(e){this._afterQueue[this._afterQueueLen++]=e,this.run()},e.prototype.run=function(){this._running||(this._running=!0,this._async(this.drain))},e.prototype._drain=function(){for(var e=0;e<this._queueLen;++e)this._queue[e].run(),this._queue[e]=void 0;for(this._queueLen=0,this._running=!1,e=0;e<this._afterQueueLen;++e)this._afterQueue[e].run(),this._afterQueue[e]=void 0;this._afterQueueLen=0},e}.call(n,o,n,t))||(t.exports=r)}(o(25))},function(e,t,n){"use strict";e.exports=n(444)},function(e,t,n){"use strict";e.exports=n(69),n(445),n(446),n(447),n(448),n(450)},function(e,t,n){"use strict";var o=n(69);(e.exports=o).prototype.done=function(e,t){(arguments.length?this.then.apply(this,arguments):this).then(null,function(e){setTimeout(function(){throw e},0)})}},function(e,t,n){"use strict";var o=n(69);(e.exports=o).prototype.finally=function(t){return this.then(function(e){return o.resolve(t()).then(function(){return e})},function(e){return o.resolve(t()).then(function(){throw e})})}},function(e,t,n){"use strict";var u=n(69);e.exports=u;var o=l(!0),r=l(!1),i=l(null),a=l(void 0),s=l(0),c=l("");function l(e){var t=new u(u._n);return t._i=1,t._j=e,t}u.resolve=function(e){if(e instanceof u)return e;if(null===e)return i;if(void 0===e)return a;if(!0===e)return o;if(!1===e)return r;if(0===e)return s;if(""===e)return c;if("object"==typeof e||"function"==typeof e)try{var t=e.then;if("function"==typeof t)return new u(t.bind(e))}catch(n){return new u(function(e,t){t(n)})}return l(e)},u.all=function(e){var s=Array.prototype.slice.call(e);return new u(function(o,r){if(0===s.length)return o([]);var i=s.length;function a(t,e){if(e&&("object"==typeof e||"function"==typeof e)){if(e instanceof u&&e.then===u.prototype.then){for(;3===e._i;)e=e._j;return 1===e._i?a(t,e._j):(2===e._i&&r(e._j),void e.then(function(e){a(t,e)},r))}var n=e.then;if("function"==typeof n)return void new u(n.bind(e)).then(function(e){a(t,e)},r)}s[t]=e,0==--i&&o(s)}for(var e=0;e<s.length;e++)a(e,s[e])})},u.reject=function(n){return new u(function(e,t){t(n)})},u.race=function(e){return new u(function(t,n){e.forEach(function(e){u.resolve(e).then(t,n)})})},u.prototype.catch=function(e){return this.then(null,e)}},function(e,t,n){"use strict";var i=n(69),r=n(449);(e.exports=i).denodeify=function(e,t){return"number"==typeof t&&t!==1/0?function(e,t){for(var n=[],o=0;o<t;o++)n.push("a"+o);var r=["return function ("+n.join(",")+") {","var self = this;","return new Promise(function (rs, rj) {","var res = fn.call(",["self"].concat(n).concat([a]).join(","),");","if (res &&",'(typeof res === "object" || typeof res === "function") &&','typeof res.then === "function"',") {rs(res);}","});","};"].join("");return Function(["Promise","fn"],r)(i,e)}(e,t):function(e){for(var t=Math.max(e.length-1,3),n=[],o=0;o<t;o++)n.push("a"+o);var r=["return function ("+n.join(",")+") {","var self = this;","var args;","var argLength = arguments.length;","if (arguments.length > "+t+") {","args = new Array(arguments.length + 1);","for (var i = 0; i < arguments.length; i++) {","args[i] = arguments[i];","}","}","return new Promise(function (rs, rj) {","var cb = "+a+";","var res;","switch (argLength) {",n.concat(["extra"]).map(function(e,t){return"case "+t+":res = fn.call("+["self"].concat(n.slice(0,t)).concat("cb").join(",")+");break;"}).join(""),"default:","args[argLength] = cb;","res = fn.apply(self, args);","}","if (res &&",'(typeof res === "object" || typeof res === "function") &&','typeof res.then === "function"',") {rs(res);}","});","};"].join("");return Function(["Promise","fn"],r)(i,e)}(e)};var a="function (err, res) {if (err) { rj(err); } else { rs(res); }}";i.nodeify=function(n){return function(){var e=Array.prototype.slice.call(arguments),t="function"==typeof e[e.length-1]?e.pop():null,o=this;try{return n.apply(this,arguments).nodeify(t,o)}catch(n){if(null==t)return new i(function(e,t){t(n)});r(function(){t.call(o,n)})}}},i.prototype.nodeify=function(t,n){if("function"!=typeof t)return this;this.then(function(e){r(function(){t.call(n,null,e)})},function(e){r(function(){t.call(n,e)})})}},function(e,t,n){"use strict";var o=n(167),r=[],i=[],a=o.makeRequestCallFromTimer(function(){if(i.length)throw i.shift()});function s(e){var t;(t=r.length?r.pop():new u).task=e,o(t)}function u(){this.task=null}e.exports=s,u.prototype.call=function(){try{this.task.call()}catch(e){s.onerror?s.onerror(e):(i.push(e),a())}finally{this.task=null,r[r.length]=this}}},function(e,t,n){"use strict";var o=n(69);(e.exports=o).enableSynchronous=function(){o.prototype.isPending=function(){return 0==this.getState()},o.prototype.isFulfilled=function(){return 1==this.getState()},o.prototype.isRejected=function(){return 2==this.getState()},o.prototype.getValue=function(){if(3===this._i)return this._j.getValue();if(!this.isFulfilled())throw new Error("Cannot get a value of an unfulfilled promise.");return this._j},o.prototype.getReason=function(){if(3===this._i)return this._j.getReason();if(!this.isRejected())throw new Error("Cannot get a rejection reason of a non-rejected promise.");return this._j},o.prototype.getState=function(){return 3===this._i?this._j.getState():-1===this._i||-2===this._i?0:this._i}},o.disableSynchronous=function(){o.prototype.isPending=void 0,o.prototype.isFulfilled=void 0,o.prototype.isRejected=void 0,o.prototype.getValue=void 0,o.prototype.getReason=void 0,o.prototype.getState=void 0}},function(e,t){e.exports=s,e.exports.parse=i,e.exports.compile=function(e,t){return n(i(e,t))},e.exports.tokensToFunction=n,e.exports.tokensToRegExp=a;var P="/",T="./",S=new RegExp(["(\\\\.)","(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?"].join("|"),"g");function i(e,t){for(var n,o,r=[],i=0,a=0,s="",u=t&&t.delimiter||P,c=t&&t.delimiters||T,l=!1;null!==(n=S.exec(e));){var f=n[0],p=n[1],h=n.index;if(s+=e.slice(a,h),a=h+f.length,p)s+=p[1],l=!0;else{var d="",y=e[a],v=n[2],m=n[3],_=n[4],g=n[5];if(!l&&s.length){var b=s.length-1;-1<c.indexOf(s[b])&&(d=s[b],s=s.slice(0,b))}s&&(r.push(s),s="",l=!1);var w=""!==d&&void 0!==y&&y!==d,O="+"===g||"*"===g,x="?"===g||"*"===g,k=d||u,E=m||_;r.push({name:v||i++,prefix:d,delimiter:k,optional:x,repeat:O,partial:w,pattern:E?(o=E,o.replace(/([=!:$/()])/g,"\\$1")):"[^"+j(k)+"]+?"})}}return(s||a<e.length)&&r.push(s+e.substr(a)),r}function n(c){for(var l=new Array(c.length),e=0;e<c.length;e++)"object"==typeof c[e]&&(l[e]=new RegExp("^(?:"+c[e].pattern+")$"));return function(e,t){for(var n="",o=t&&t.encode||encodeURIComponent,r=0;r<c.length;r++){var i=c[r];if("string"!=typeof i){var a,s=e?e[i.name]:void 0;if(Array.isArray(s)){if(!i.repeat)throw new TypeError('Expected "'+i.name+'" to not repeat, but got array');if(0===s.length){if(i.optional)continue;throw new TypeError('Expected "'+i.name+'" to not be empty')}for(var u=0;u<s.length;u++){if(a=o(s[u],i),!l[r].test(a))throw new TypeError('Expected all "'+i.name+'" to match "'+i.pattern+'"');n+=(0===u?i.prefix:i.delimiter)+a}}else if("string"!=typeof s&&"number"!=typeof s&&"boolean"!=typeof s){if(!i.optional)throw new TypeError('Expected "'+i.name+'" to be '+(i.repeat?"an array":"a string"));i.partial&&(n+=i.prefix)}else{if(a=o(String(s),i),!l[r].test(a))throw new TypeError('Expected "'+i.name+'" to match "'+i.pattern+'", but got "'+a+'"');n+=i.prefix+a}}else n+=i}return n}}function j(e){return e.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function d(e){return e&&e.sensitive?"":"i"}function a(e,t,n){for(var o=(n=n||{}).strict,r=!1!==n.start,i=!1!==n.end,a=j(n.delimiter||P),s=n.delimiters||T,u=[].concat(n.endsWith||[]).map(j).concat("$").join("|"),c=r?"^":"",l=0===e.length,f=0;f<e.length;f++){var p=e[f];if("string"==typeof p)c+=j(p),l=f===e.length-1&&-1<s.indexOf(p[p.length-1]);else{var h=p.repeat?"(?:"+p.pattern+")(?:"+j(p.delimiter)+"(?:"+p.pattern+"))*":p.pattern;t&&t.push(p),p.optional?p.partial?c+=j(p.prefix)+"("+h+")?":c+="(?:"+j(p.prefix)+"("+h+"))?":c+=j(p.prefix)+"("+h+")"}}return i?(o||(c+="(?:"+a+")?"),c+="$"===u?"$":"(?="+u+")"):(o||(c+="(?:"+a+"(?="+u+"))?"),l||(c+="(?="+a+"|"+u+")")),new RegExp(c,d(n))}function s(e,t,n){return e instanceof RegExp?function(e,t){if(!t)return e;var n=e.source.match(/\((?!\?)/g);if(n)for(var o=0;o<n.length;o++)t.push({name:o,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,pattern:null});return e}(e,t):Array.isArray(e)?function(e,t,n){for(var o=[],r=0;r<e.length;r++)o.push(s(e[r],t,n).source);return new RegExp("(?:"+o.join("|")+")",d(n))}(e,t,n):(o=t,a(i(e,r=n),o,r));var o,r}},function(e,_t,t){(function(e,t){var n="Expected a function",o="__lodash_hash_undefined__",m=1,b=2,u=1/0,r=9007199254740991,c=17976931348623157e292,l=NaN,_="[object Arguments]",g="[object Array]",w="[object Boolean]",O="[object Date]",x="[object Error]",i="[object Function]",a="[object GeneratorFunction]",k="[object Map]",E="[object Number]",P="[object Object]",s="[object Promise]",T="[object RegExp]",S="[object Set]",j="[object String]",C="[object Symbol]",f="[object WeakMap]",R="[object ArrayBuffer]",M="[object DataView]",p=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,h=/^\w*$/,d=/^\./,y=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,v=/^\s+|\s+$/g,A=/\\(\\)?/g,L=/^[-+]0x[0-9a-f]+$/i,D=/^0b[01]+$/i,z=/^\[object .+?Constructor\]$/,H=/^0o[0-7]+$/i,I=/^(?:0|[1-9]\d*)$/,F={};F["[object Float32Array]"]=F["[object Float64Array]"]=F["[object Int8Array]"]=F["[object Int16Array]"]=F["[object Int32Array]"]=F["[object Uint8Array]"]=F["[object Uint8ClampedArray]"]=F["[object Uint16Array]"]=F["[object Uint32Array]"]=!0,F[_]=F[g]=F[R]=F[w]=F[M]=F[O]=F[x]=F[i]=F[k]=F[E]=F[P]=F[T]=F[S]=F[j]=F[f]=!1;var N=parseInt,U="object"==typeof e&&e&&e.Object===Object&&e,B="object"==typeof self&&self&&self.Object===Object&&self,V=U||B||Function("return this")(),G=_t&&!_t.nodeType&&_t,$=G&&"object"==typeof t&&t&&!t.nodeType&&t,q=$&&$.exports===G&&U.process,W=function(){try{return q&&q.binding("util")}catch(e){}}(),Y=W&&W.isTypedArray;function K(e,t){for(var n=-1,o=e?e.length:0;++n<o;)if(t(e[n],n,e))return!0;return!1}function X(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}function J(e){var n=-1,o=Array(e.size);return e.forEach(function(e,t){o[++n]=[t,e]}),o}function Z(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}var Q,ee,te,ne=Array.prototype,oe=Function.prototype,re=Object.prototype,ie=V["__core-js_shared__"],ae=(Q=/[^.]+$/.exec(ie&&ie.keys&&ie.keys.IE_PROTO||""))?"Symbol(src)_1."+Q:"",se=oe.toString,ue=re.hasOwnProperty,ce=re.toString,le=RegExp("^"+se.call(ue).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),fe=V.Symbol,pe=V.Uint8Array,he=re.propertyIsEnumerable,de=ne.splice,ye=(ee=Object.keys,te=Object,function(e){return ee(te(e))}),ve=Math.max,me=We(V,"DataView"),_e=We(V,"Map"),ge=We(V,"Promise"),be=We(V,"Set"),we=We(V,"WeakMap"),Oe=We(Object,"create"),xe=tt(me),ke=tt(_e),Ee=tt(ge),Pe=tt(be),Te=tt(we),Se=fe?fe.prototype:void 0,je=Se?Se.valueOf:void 0,Ce=Se?Se.toString:void 0;function Re(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function Me(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function Ae(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function Le(e){var t=-1,n=e?e.length:0;for(this.__data__=new Ae;++t<n;)this.add(e[t])}function De(e){this.__data__=new Me(e)}function ze(e,t){var n=st(e)||at(e)?function(e,t){for(var n=-1,o=Array(e);++n<e;)o[n]=t(n);return o}(e.length,String):[],o=n.length,r=!!o;for(var i in e)!t&&!ue.call(e,i)||r&&("length"==i||Ke(i,o))||n.push(i);return n}function He(e,t){for(var n=e.length;n--;)if(it(e[n][0],t))return n;return-1}function Ie(e,t){for(var n=0,o=(t=Xe(t,e)?[t]:Ge(t)).length;null!=e&&n<o;)e=e[et(t[n++])];return n&&n==o?e:void 0}function Fe(e,t){return null!=e&&t in Object(e)}function Ne(e,t,n,o,r){return e===t||(null==e||null==t||!ft(e)&&!pt(t)?e!=e&&t!=t:function(e,t,n,o,r,i){var a=st(e),s=st(t),u=g,c=g;a||(u=(u=Ye(e))==_?P:u);s||(c=(c=Ye(t))==_?P:c);var l=u==P&&!X(e),f=c==P&&!X(t),p=u==c;if(p&&!l)return i||(i=new De),a||yt(e)?$e(e,t,n,o,r,i):function(e,t,n,o,r,i,a){switch(n){case M:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case R:return!(e.byteLength!=t.byteLength||!o(new pe(e),new pe(t)));case w:case O:case E:return it(+e,+t);case x:return e.name==t.name&&e.message==t.message;case T:case j:return e==t+"";case k:var s=J;case S:var u=i&b;if(s||(s=Z),e.size!=t.size&&!u)return!1;var c=a.get(e);if(c)return c==t;i|=m,a.set(e,t);var l=$e(s(e),s(t),o,r,i,a);return a.delete(e),l;case C:if(je)return je.call(e)==je.call(t)}return!1}(e,t,u,n,o,r,i);if(!(r&b)){var h=l&&ue.call(e,"__wrapped__"),d=f&&ue.call(t,"__wrapped__");if(h||d){var y=h?e.value():e,v=d?t.value():t;return i||(i=new De),n(y,v,o,r,i)}}return!!p&&(i||(i=new De),function(e,t,n,o,r,i){var a=r&b,s=vt(e),u=s.length,c=vt(t).length;if(u!=c&&!a)return!1;for(var l=u;l--;){var f=s[l];if(!(a?f in t:ue.call(t,f)))return!1}var p=i.get(e);if(p&&i.get(t))return p==t;var h=!0;i.set(e,t),i.set(t,e);for(var d=a;++l<u;){f=s[l];var y=e[f],v=t[f];if(o)var m=a?o(v,y,f,t,e,i):o(y,v,f,e,t,i);if(!(void 0===m?y===v||n(y,v,o,r,i):m)){h=!1;break}d||(d="constructor"==f)}if(h&&!d){var _=e.constructor,g=t.constructor;_!=g&&"constructor"in e&&"constructor"in t&&!("function"==typeof _&&_ instanceof _&&"function"==typeof g&&g instanceof g)&&(h=!1)}return i.delete(e),i.delete(t),h}(e,t,n,o,r,i))}(e,t,Ne,n,o,r))}function Ue(e){return!(!ft(e)||(t=e,ae&&ae in t))&&(ct(e)||X(e)?le:z).test(tt(e));var t}function Be(e){return"function"==typeof e?e:null==e?mt:"object"==typeof e?st(e)?function(u,c){if(Xe(u)&&Je(c))return Ze(et(u),c);return function(e){var t,n,o,r,i,a,s=(n=u,void 0===(r=null==(t=e)?void 0:Ie(t,n))?o:r);return void 0===s&&s===c?(a=u,null!=(i=e)&&function(e,t,n){t=Xe(t,e)?[t]:Ge(t);for(var o,r=-1,i=t.length;++r<i;){var a=et(t[r]);if(!(o=null!=e&&n(e,a)))break;e=e[a]}return o||!!(i=e?e.length:0)&&lt(i)&&Ke(a,i)&&(st(e)||at(e))}(i,a,Fe)):Ne(c,s,void 0,m|b)}}(e[0],e[1]):function(t){var n=function(e){var t=vt(e),n=t.length;for(;n--;){var o=t[n],r=e[o];t[n]=[o,r,Je(r)]}return t}(t);if(1==n.length&&n[0][2])return Ze(n[0][0],n[0][1]);return function(e){return e===t||function(e,t,n,o){var r=n.length,i=r,a=!o;if(null==e)return!i;for(e=Object(e);r--;){var s=n[r];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++r<i;){var u=(s=n[r])[0],c=e[u],l=s[1];if(a&&s[2]){if(void 0===c&&!(u in e))return!1}else{var f=new De;if(o)var p=o(c,l,u,e,t,f);if(!(void 0===p?Ne(l,c,o,m|b,f):p))return!1}}return!0}(e,t,n)}}(e):Xe(t=e)?(o=et(t),function(e){return null==e?void 0:e[o]}):(n=t,function(e){return Ie(e,n)});var t,n,o}function Ve(e){if(n=(t=e)&&t.constructor,o="function"==typeof n&&n.prototype||re,t!==o)return ye(e);var t,n,o,r=[];for(var i in Object(e))ue.call(e,i)&&"constructor"!=i&&r.push(i);return r}function Ge(e){return st(e)?e:Qe(e)}function $e(e,t,n,o,r,i){var a=r&b,s=e.length,u=t.length;if(s!=u&&!(a&&s<u))return!1;var c=i.get(e);if(c&&i.get(t))return c==t;var l=-1,f=!0,p=r&m?new Le:void 0;for(i.set(e,t),i.set(t,e);++l<s;){var h=e[l],d=t[l];if(o)var y=a?o(d,h,l,t,e,i):o(h,d,l,e,t,i);if(void 0!==y){if(y)continue;f=!1;break}if(p){if(!K(t,function(e,t){if(!p.has(t)&&(h===e||n(h,e,o,r,i)))return p.add(t)})){f=!1;break}}else if(h!==d&&!n(h,d,o,r,i)){f=!1;break}}return i.delete(e),i.delete(t),f}function qe(e,t){var n,o,r=e.__data__;return("string"==(o=typeof(n=t))||"number"==o||"symbol"==o||"boolean"==o?"__proto__"!==n:null===n)?r["string"==typeof t?"string":"hash"]:r.map}function We(e,t){var n,o,r=(o=t,null==(n=e)?void 0:n[o]);return Ue(r)?r:void 0}Re.prototype.clear=function(){this.__data__=Oe?Oe(null):{}},Re.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},Re.prototype.get=function(e){var t=this.__data__;if(Oe){var n=t[e];return n===o?void 0:n}return ue.call(t,e)?t[e]:void 0},Re.prototype.has=function(e){var t=this.__data__;return Oe?void 0!==t[e]:ue.call(t,e)},Re.prototype.set=function(e,t){return this.__data__[e]=Oe&&void 0===t?o:t,this},Me.prototype.clear=function(){this.__data__=[]},Me.prototype.delete=function(e){var t=this.__data__,n=He(t,e);return!(n<0||(n==t.length-1?t.pop():de.call(t,n,1),0))},Me.prototype.get=function(e){var t=this.__data__,n=He(t,e);return n<0?void 0:t[n][1]},Me.prototype.has=function(e){return-1<He(this.__data__,e)},Me.prototype.set=function(e,t){var n=this.__data__,o=He(n,e);return o<0?n.push([e,t]):n[o][1]=t,this},Ae.prototype.clear=function(){this.__data__={hash:new Re,map:new(_e||Me),string:new Re}},Ae.prototype.delete=function(e){return qe(this,e).delete(e)},Ae.prototype.get=function(e){return qe(this,e).get(e)},Ae.prototype.has=function(e){return qe(this,e).has(e)},Ae.prototype.set=function(e,t){return qe(this,e).set(e,t),this},Le.prototype.add=Le.prototype.push=function(e){return this.__data__.set(e,o),this},Le.prototype.has=function(e){return this.__data__.has(e)},De.prototype.clear=function(){this.__data__=new Me},De.prototype.delete=function(e){return this.__data__.delete(e)},De.prototype.get=function(e){return this.__data__.get(e)},De.prototype.has=function(e){return this.__data__.has(e)},De.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Me){var o=n.__data__;if(!_e||o.length<199)return o.push([e,t]),this;n=this.__data__=new Ae(o)}return n.set(e,t),this};var Ye=function(e){return ce.call(e)};function Ke(e,t){return!!(t=null==t?r:t)&&("number"==typeof e||I.test(e))&&-1<e&&e%1==0&&e<t}function Xe(e,t){if(st(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!ht(e))||(h.test(e)||!p.test(e)||null!=t&&e in Object(t))}function Je(e){return e==e&&!ft(e)}function Ze(t,n){return function(e){return null!=e&&(e[t]===n&&(void 0!==n||t in Object(e)))}}(me&&Ye(new me(new ArrayBuffer(1)))!=M||_e&&Ye(new _e)!=k||ge&&Ye(ge.resolve())!=s||be&&Ye(new be)!=S||we&&Ye(new we)!=f)&&(Ye=function(e){var t=ce.call(e),n=t==P?e.constructor:void 0,o=n?tt(n):void 0;if(o)switch(o){case xe:return M;case ke:return k;case Ee:return s;case Pe:return S;case Te:return f}return t});var Qe=rt(function(e){var t;e=null==(t=e)?"":function(e){if("string"==typeof e)return e;if(ht(e))return Ce?Ce.call(e):"";var t=e+"";return"0"==t&&1/e==-u?"-0":t}(t);var r=[];return d.test(e)&&r.push(""),e.replace(y,function(e,t,n,o){r.push(n?o.replace(A,"$1"):t||e)}),r});function et(e){if("string"==typeof e||ht(e))return e;var t=e+"";return"0"==t&&1/e==-u?"-0":t}function tt(e){if(null!=e){try{return se.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var nt,ot=(nt=function(e,t,n){var o=e?e.length:0;if(!o)return-1;var r,i,a,s=null==n?0:(r=(a=n)?(a=function(e){if("number"==typeof e)return e;if(ht(e))return l;if(ft(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=ft(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(v,"");var n=D.test(e);return n||H.test(e)?N(e.slice(2),n?2:8):L.test(e)?l:+e}(a))!==u&&a!==-u?a==a?a:0:(a<0?-1:1)*c:0===a?a:0,i=r%1,r==r?i?r-i:r:0);return s<0&&(s=ve(o+s,0)),function(e,t,n,o){for(var r=e.length,i=n+(o?1:-1);o?i--:++i<r;)if(t(e[i],i,e))return i;return-1}(e,Be(t),s)},function(e,t,n){var o=Object(e);if(!ut(e)){var r=Be(t);e=vt(e),t=function(e){return r(o[e],e,o)}}var i=nt(e,t,n);return-1<i?o[r?e[i]:i]:void 0});function rt(r,i){if("function"!=typeof r||i&&"function"!=typeof i)throw new TypeError(n);var a=function(){var e=arguments,t=i?i.apply(this,e):e[0],n=a.cache;if(n.has(t))return n.get(t);var o=r.apply(this,e);return a.cache=n.set(t,o),o};return a.cache=new(rt.Cache||Ae),a}function it(e,t){return e===t||e!=e&&t!=t}function at(e){return pt(t=e)&&ut(t)&&ue.call(e,"callee")&&(!he.call(e,"callee")||ce.call(e)==_);var t}rt.Cache=Ae;var st=Array.isArray;function ut(e){return null!=e&&lt(e.length)&&!ct(e)}function ct(e){var t=ft(e)?ce.call(e):"";return t==i||t==a}function lt(e){return"number"==typeof e&&-1<e&&e%1==0&&e<=r}function ft(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function pt(e){return!!e&&"object"==typeof e}function ht(e){return"symbol"==typeof e||pt(e)&&ce.call(e)==C}var dt,yt=Y?(dt=Y,function(e){return dt(e)}):function(e){return pt(e)&&lt(e.length)&&!!F[ce.call(e)]};function vt(e){return ut(e)?ze(e):Ve(e)}function mt(e){return e}t.exports=ot}).call(this,t(34),t(168)(e))},function(e,Fe,t){(function(e,t){var o="__lodash_hash_undefined__",r=9007199254740991,n="[object Arguments]",i="[object AsyncFunction]",a="[object Function]",s="[object GeneratorFunction]",u="[object Null]",O="[object Object]",c="[object Proxy]",l="[object Undefined]",f=/^\[object .+?Constructor\]$/,p=/^(?:0|[1-9]\d*)$/,h={};h["[object Float32Array]"]=h["[object Float64Array]"]=h["[object Int8Array]"]=h["[object Int16Array]"]=h["[object Int32Array]"]=h["[object Uint8Array]"]=h["[object Uint8ClampedArray]"]=h["[object Uint16Array]"]=h["[object Uint32Array]"]=!0,h[n]=h["[object Array]"]=h["[object ArrayBuffer]"]=h["[object Boolean]"]=h["[object DataView]"]=h["[object Date]"]=h["[object Error]"]=h[a]=h["[object Map]"]=h["[object Number]"]=h[O]=h["[object RegExp]"]=h["[object Set]"]=h["[object String]"]=h["[object WeakMap]"]=!1;var d="object"==typeof e&&e&&e.Object===Object&&e,y="object"==typeof self&&self&&self.Object===Object&&self,v=d||y||Function("return this")(),m=Fe&&!Fe.nodeType&&Fe,_=m&&"object"==typeof t&&t&&!t.nodeType&&t,g=_&&_.exports===m,b=g&&d.process,w=function(){try{return b&&b.binding&&b.binding("util")}catch(e){}}(),x=w&&w.isTypedArray;function k(e,t){return"__proto__"==t?void 0:e[t]}var E,P,T,S=Array.prototype,j=Function.prototype,C=Object.prototype,R=v["__core-js_shared__"],M=j.toString,A=C.hasOwnProperty,L=(E=/[^.]+$/.exec(R&&R.keys&&R.keys.IE_PROTO||""))?"Symbol(src)_1."+E:"",D=C.toString,z=M.call(Object),H=RegExp("^"+M.call(A).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),I=g?v.Buffer:void 0,F=v.Symbol,N=v.Uint8Array,U=I?I.allocUnsafe:void 0,B=(P=Object.getPrototypeOf,T=Object,function(e){return P(T(e))}),V=Object.create,G=C.propertyIsEnumerable,$=S.splice,q=F?F.toStringTag:void 0,W=function(){try{var e=me(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),Y=I?I.isBuffer:void 0,K=Math.max,X=Date.now,J=me(v,"Map"),Z=me(Object,"create"),Q=function(){function n(){}return function(e){if(!Re(e))return{};if(V)return V(e);n.prototype=e;var t=new n;return n.prototype=void 0,t}}();function ee(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function te(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function ne(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function oe(e){var t=this.__data__=new te(e);this.size=t.size}function re(e,t){var n=Pe(e),o=!n&&Ee(e),r=!n&&!o&&Se(e),i=!n&&!o&&!r&&Le(e),a=n||o||r||i,s=a?function(e,t){for(var n=-1,o=Array(e);++n<e;)o[n]=t(n);return o}(e.length,String):[],u=s.length;for(var c in e)!t&&!A.call(e,c)||a&&("length"==c||r&&("offset"==c||"parent"==c)||i&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||_e(c,u))||s.push(c);return s}function ie(e,t,n){(void 0===n||ke(e[t],n))&&(void 0!==n||t in e)||se(e,t,n)}function ae(e,t){for(var n=e.length;n--;)if(ke(e[n][0],t))return n;return-1}function se(e,t,n){"__proto__"==t&&W?W(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}ee.prototype.clear=function(){this.__data__=Z?Z(null):{},this.size=0},ee.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},ee.prototype.get=function(e){var t=this.__data__;if(Z){var n=t[e];return n===o?void 0:n}return A.call(t,e)?t[e]:void 0},ee.prototype.has=function(e){var t=this.__data__;return Z?void 0!==t[e]:A.call(t,e)},ee.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Z&&void 0===t?o:t,this},te.prototype.clear=function(){this.__data__=[],this.size=0},te.prototype.delete=function(e){var t=this.__data__,n=ae(t,e);return!(n<0||(n==t.length-1?t.pop():$.call(t,n,1),--this.size,0))},te.prototype.get=function(e){var t=this.__data__,n=ae(t,e);return n<0?void 0:t[n][1]},te.prototype.has=function(e){return-1<ae(this.__data__,e)},te.prototype.set=function(e,t){var n=this.__data__,o=ae(n,e);return o<0?(++this.size,n.push([e,t])):n[o][1]=t,this},ne.prototype.clear=function(){this.size=0,this.__data__={hash:new ee,map:new(J||te),string:new ee}},ne.prototype.delete=function(e){var t=ve(this,e).delete(e);return this.size-=t?1:0,t},ne.prototype.get=function(e){return ve(this,e).get(e)},ne.prototype.has=function(e){return ve(this,e).has(e)},ne.prototype.set=function(e,t){var n=ve(this,e),o=n.size;return n.set(e,t),this.size+=n.size==o?0:1,this},oe.prototype.clear=function(){this.__data__=new te,this.size=0},oe.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},oe.prototype.get=function(e){return this.__data__.get(e)},oe.prototype.has=function(e){return this.__data__.has(e)},oe.prototype.set=function(e,t){var n=this.__data__;if(n instanceof te){var o=n.__data__;if(!J||o.length<199)return o.push([e,t]),this.size=++n.size,this;n=this.__data__=new ne(o)}return n.set(e,t),this.size=n.size,this};var ue,ce=function(e,t,n){for(var o=-1,r=Object(e),i=n(e),a=i.length;a--;){var s=i[ue?a:++o];if(!1===t(r[s],s,r))break}return e};function le(e){return null==e?void 0===e?l:u:q&&q in Object(e)?function(e){var t=A.call(e,q),n=e[q];try{var o=!(e[q]=void 0)}catch(e){}var r=D.call(e);o&&(t?e[q]=n:delete e[q]);return r}(e):(t=e,D.call(t));var t}function fe(e){return Me(e)&&le(e)==n}function pe(e){return!(!Re(e)||(t=e,L&&L in t))&&(je(e)?H:f).test(function(e){if(null!=e){try{return M.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e));var t}function he(e){if(!Re(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=ge(e),n=[];for(var o in e)("constructor"!=o||!t&&A.call(e,o))&&n.push(o);return n}function de(o,r,i,a,s){o!==r&&ce(r,function(e,t){if(Re(e))s||(s=new oe),function(e,t,n,o,r,i,a){var s=k(e,n),u=k(t,n),c=a.get(u);if(c)return ie(e,n,c);var l=i?i(s,u,n+"",e,t,a):void 0,f=void 0===l;if(f){var p=Pe(u),h=!p&&Se(u),d=!p&&!h&&Le(u);l=u,p||h||d?l=Pe(s)?s:Me(w=s)&&Te(w)?function(e,t){var n=-1,o=e.length;t||(t=Array(o));for(;++n<o;)t[n]=e[n];return t}(s):h?function(e,t){if(t)return e.slice();var n=e.length,o=U?U(n):new e.constructor(n);return e.copy(o),o}(u,!(f=!1)):d?(m=u,_=!(f=!1)?(g=m.buffer,b=new g.constructor(g.byteLength),new N(b).set(new N(g)),b):m.buffer,new m.constructor(_,m.byteOffset,m.length)):[]:function(e){if(!Me(e)||le(e)!=O)return!1;var t=B(e);if(null===t)return!0;var n=A.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&M.call(n)==z}(u)||Ee(u)?Ee(l=s)?l=function(e,t,n,o){var r=!n;n||(n={});for(var i,a,s,u,c=-1,l=t.length;++c<l;){var f=t[c],p=o?o(n[f],e[f],f,n,e):void 0;void 0===p&&(p=e[f]),r?se(n,f,p):(s=p,u=(i=n)[a=f],A.call(i,a)&&ke(u,s)&&(void 0!==s||a in i)||se(i,a,s))}return n}(v=s,De(v)):(!Re(s)||o&&je(s))&&(l="function"!=typeof(y=u).constructor||ge(y)?{}:Q(B(y))):f=!1}var y;var v;var m,_,g,b;var w;f&&(a.set(u,l),r(l,u,o,i,a),a.delete(u));ie(e,n,l)}(o,r,t,i,de,a,s);else{var n=a?a(k(o,t),e,t+"",o,r,s):void 0;void 0===n&&(n=e),ie(o,t,n)}},De)}function ye(e,t){return xe((i=e,s=Ie,a=K(void 0===(a=t)?i.length-1:a,0),function(){for(var e=arguments,t=-1,n=K(e.length-a,0),o=Array(n);++t<n;)o[t]=e[a+t];t=-1;for(var r=Array(a+1);++t<a;)r[t]=e[t];return r[a]=s(o),function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}(i,this,r)}),e+"");var i,a,s}function ve(e,t){var n,o,r=e.__data__;return("string"==(o=typeof(n=t))||"number"==o||"symbol"==o||"boolean"==o?"__proto__"!==n:null===n)?r["string"==typeof t?"string":"hash"]:r.map}function me(e,t){var n,o,r=(o=t,null==(n=e)?void 0:n[o]);return pe(r)?r:void 0}function _e(e,t){var n=typeof e;return!!(t=null==t?r:t)&&("number"==n||"symbol"!=n&&p.test(e))&&-1<e&&e%1==0&&e<t}function ge(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||C)}var be,we,Oe,xe=(be=W?function(e,t){return W(e,"toString",{configurable:!0,enumerable:!1,value:(n=t,function(){return n}),writable:!0});var n}:Ie,Oe=we=0,function(){var e=X(),t=16-(e-Oe);if(Oe=e,0<t){if(800<=++we)return arguments[0]}else we=0;return be.apply(void 0,arguments)});function ke(e,t){return e===t||e!=e&&t!=t}var Ee=fe(function(){return arguments}())?fe:function(e){return Me(e)&&A.call(e,"callee")&&!G.call(e,"callee")},Pe=Array.isArray;function Te(e){return null!=e&&Ce(e.length)&&!je(e)}var Se=Y||function(){return!1};function je(e){if(!Re(e))return!1;var t=le(e);return t==a||t==s||t==i||t==c}function Ce(e){return"number"==typeof e&&-1<e&&e%1==0&&e<=r}function Re(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Me(e){return null!=e&&"object"==typeof e}var Ae,Le=x?(Ae=x,function(e){return Ae(e)}):function(e){return Me(e)&&Ce(e.length)&&!!h[le(e)]};function De(e){return Te(e)?re(e,!0):he(e)}var ze,He=(ze=function(e,t,n){de(e,t,n)},ye(function(e,t){var n=-1,o=t.length,r=1<o?t[o-1]:void 0,i=2<o?t[2]:void 0;for(r=3<ze.length&&"function"==typeof r?(o--,r):void 0,i&&function(e,t,n){if(!Re(n))return!1;var o=typeof t;return!!("number"==o?Te(n)&&_e(t,n.length):"string"==o&&t in n)&&ke(n[t],e)}(t[0],t[1],i)&&(r=o<3?void 0:r,o=1),e=Object(e);++n<o;){var a=t[n];a&&ze(e,a,n,r)}return e}));function Ie(e){return e}t.exports=He}).call(this,t(34),t(168)(e))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=t.startsWith=function(e,t){return 0===e.indexOf(t)},r=t.endsWith=function(e,t){return 0<=e.indexOf(t,e.length-t.length)};t.addLeadingSlash=function(e){return"/"===e.charAt(0)?e:"/"+e},t.stripLeadingSlash=function(e){return o(e,"/")?e.slice(1):e},t.stripTrailingSlash=function(e){return r(e,"/")?e.slice(0,-1):e},t.stripSlashes=function(e){return e.replace(/\\/g,"")},t.isString=function(e){return"string"==typeof e||e instanceof String},t.getHashPath=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:window.location.href,t=e.indexOf("#");return-1===t?"":e.substring(t+1)},t.generateSpaces=function(e){return new Array(e.length).fill(" ").join("")},t.supportsBrowserHistory=function(){return!("undefined"==typeof window||!window.history||!window.history.pushState)},t.supportsScrollRestoration=function(){return!("undefined"==typeof window||!window.history||!window.history.scrollRestoration)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"localStorage",t=String(e).replace(/storage$/i,"").toLowerCase();if("local"===t)return i("localStorage");if("session"===t)return i("sessionStorage");if("cookie"===t)return(0,o.hasCookies)();if("memory"!==t)throw new Error("Storage method `"+e+"` is not available.\n    Please use one of the following: localStorage, sessionStorage, cookieStorage, memoryStorage.");return!0};var o=n(169),r="__test";function i(e){try{var t=window[e];return t.setItem(r,"1"),t.removeItem(r),!0}catch(e){return!1}}},function(e,t,n){"use strict";t.parse=function(e,t){if("string"!=typeof e)throw new TypeError("argument str must be a string");for(var n={},o=t||{},r=e.split(p),i=o.decode||f,a=0;a<r.length;a++){var s=r[a],u=s.indexOf("=");if(!(u<0)){var c=s.substr(0,u).trim(),l=s.substr(++u,s.length).trim();'"'==l[0]&&(l=l.slice(1,-1)),null==n[c]&&(n[c]=h(l,i))}}return n},t.serialize=function(e,t,n){var o=n||{},r=o.encode||c;if("function"!=typeof r)throw new TypeError("option encode is invalid");if(!l.test(e))throw new TypeError("argument name is invalid");var i=r(t);if(i&&!l.test(i))throw new TypeError("argument val is invalid");var a=e+"="+i;if(null!=o.maxAge){var s=o.maxAge-0;if(isNaN(s))throw new Error("maxAge should be a Number");a+="; Max-Age="+Math.floor(s)}if(o.domain){if(!l.test(o.domain))throw new TypeError("option domain is invalid");a+="; Domain="+o.domain}if(o.path){if(!l.test(o.path))throw new TypeError("option path is invalid");a+="; Path="+o.path}if(o.expires){if("function"!=typeof o.expires.toUTCString)throw new TypeError("option expires is invalid");a+="; Expires="+o.expires.toUTCString()}o.httpOnly&&(a+="; HttpOnly");o.secure&&(a+="; Secure");if(o.sameSite){var u="string"==typeof o.sameSite?o.sameSite.toLowerCase():o.sameSite;switch(u){case!0:a+="; SameSite=Strict";break;case"lax":a+="; SameSite=Lax";break;case"strict":a+="; SameSite=Strict";break;default:throw new TypeError("option sameSite is invalid")}}return a};var f=decodeURIComponent,c=encodeURIComponent,p=/; */,l=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function h(t,e){try{return e(t)}catch(e){return t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}}();var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._data={}}return o(e,[{key:"getItem",value:function(e){return this._data.hasOwnProperty(e)?this._data[e]:null}},{key:"setItem",value:function(e,t){return this._data[e]=String(t)}},{key:"removeItem",value:function(e){return delete this._data[e]}},{key:"clear",value:function(){return this._data={}}}]),e}();t.default=r},function(e,t,n){"use strict";t.__esModule=!0;var o,r=n(170),i=(o=r)&&o.__esModule?o:{default:o};t.default=function(e,t){for(var n in t){var o=t[n];o.configurable=o.enumerable=!0,"value"in o&&(o.writable=!0),(0,i.default)(e,n,o)}return e}},function(e,t,n){n(460);var o=n(59).Object;e.exports=function(e,t,n){return o.defineProperty(e,t,n)}},function(e,t,n){var o=n(84);o(o.S+o.F*!n(61),"Object",{defineProperty:n(60).f})},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){n(463),e.exports=n(98).Object.assign},function(e,t,n){var o=n(464);o(o.S+o.F,"Object",{assign:n(474)})},function(e,t,n){var y=n(97),v=n(98),m=n(174),_=n(471),g=n(472),b="prototype",w=function(e,t,n){var o,r,i,a,s=e&w.F,u=e&w.G,c=e&w.S,l=e&w.P,f=e&w.B,p=u?y:c?y[t]||(y[t]={}):(y[t]||{})[b],h=u?v:v[t]||(v[t]={}),d=h[b]||(h[b]={});for(o in u&&(n=t),n)i=((r=!s&&p&&void 0!==p[o])?p:n)[o],a=f&&r?g(i,y):l&&"function"==typeof i?g(Function.call,i):i,p&&_(p,o,i,e&w.U),h[o]!=i&&m(h,o,a),l&&d[o]!=i&&(d[o]=i)};y.core=v,w.F=1,w.G=2,w.S=4,w.P=8,w.B=16,w.W=32,w.U=64,w.R=128,e.exports=w},function(e,t,n){var o=n(466),r=n(467),i=n(469),a=Object.defineProperty;t.f=n(124)?Object.defineProperty:function(e,t,n){if(o(e),t=i(t,!0),o(n),r)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){var o=n(123);e.exports=function(e){if(!o(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){e.exports=!n(124)&&!n(125)(function(){return 7!=Object.defineProperty(n(468)("div"),"a",{get:function(){return 7}}).a})},function(e,t,n){var o=n(123),r=n(97).document,i=o(r)&&o(r.createElement);e.exports=function(e){return i?r.createElement(e):{}}},function(e,t,n){var r=n(123);e.exports=function(e,t){if(!r(e))return e;var n,o;if(t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;if("function"==typeof(n=e.valueOf)&&!r(o=n.call(e)))return o;if(!t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){var i=n(97),a=n(174),s=n(175),u=n(176)("src"),o="toString",r=Function[o],c=(""+r).split(o);n(98).inspectSource=function(e){return r.call(e)},(e.exports=function(e,t,n,o){var r="function"==typeof n;r&&(s(n,"name")||a(n,"name",t)),e[t]!==n&&(r&&(s(n,u)||a(n,u,e[t]?""+e[t]:c.join(String(t)))),e===i?e[t]=n:o?e[t]?e[t]=n:a(e,t,n):(delete e[t],a(e,t,n)))})(Function.prototype,o,function(){return"function"==typeof this&&this[u]||r.call(this)})},function(e,t,n){var i=n(473);e.exports=function(o,r,e){if(i(o),void 0===r)return o;switch(e){case 1:return function(e){return o.call(r,e)};case 2:return function(e,t){return o.call(r,e,t)};case 3:return function(e,t,n){return o.call(r,e,t,n)}}return function(){return o.apply(r,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){"use strict";var p=n(475),h=n(485),d=n(486),y=n(487),v=n(178),r=Object.assign;e.exports=!r||n(125)(function(){var e={},t={},n=Symbol(),o="abcdefghijklmnopqrst";return e[n]=7,o.split("").forEach(function(e){t[e]=e}),7!=r({},e)[n]||Object.keys(r({},t)).join("")!=o})?function(e,t){for(var n=y(e),o=arguments.length,r=1,i=h.f,a=d.f;r<o;)for(var s,u=v(arguments[r++]),c=i?p(u).concat(i(u)):p(u),l=c.length,f=0;f<l;)a.call(u,s=c[f++])&&(n[s]=u[s]);return n}:r},function(e,t,n){var o=n(476),r=n(484);e.exports=Object.keys||function(e){return o(e,r)}},function(e,t,n){var a=n(175),s=n(177),u=n(478)(!1),c=n(481)("IE_PROTO");e.exports=function(e,t){var n,o=s(e),r=0,i=[];for(n in o)n!=c&&a(o,n)&&i.push(n);for(;t.length>r;)a(o,n=t[r++])&&(~u(i,n)||i.push(n));return i}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var u=n(177),c=n(479),l=n(480);e.exports=function(s){return function(e,t,n){var o,r=u(e),i=c(r.length),a=l(n,i);if(s&&t!=t){for(;a<i;)if((o=r[a++])!=o)return!0}else for(;a<i;a++)if((s||a in r)&&r[a]===t)return s||a||0;return!s&&-1}}},function(e,t,n){var o=n(180),r=Math.min;e.exports=function(e){return 0<e?r(o(e),9007199254740991):0}},function(e,t,n){var o=n(180),r=Math.max,i=Math.min;e.exports=function(e,t){return(e=o(e))<0?r(e+t,0):i(e,t)}},function(e,t,n){var o=n(482)("keys"),r=n(176);e.exports=function(e){return o[e]||(o[e]=r(e))}},function(e,t,n){var o=n(98),r=n(97),i="__core-js_shared__",a=r[i]||(r[i]={});(e.exports=function(e,t){return a[e]||(a[e]=void 0!==t?t:{})})("versions",[]).push({version:o.version,mode:n(483)?"pure":"global",copyright:"© 2018 Denis Pushkarev (zloirock.ru)"})},function(e,t){e.exports=!1},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,n){var o=n(179);e.exports=function(e){return Object(o(e))}},function(e,t,n){"use strict";t.__esModule=!0,t.default=function(){var e=Date.now();function t(){}function n(){return{value:1,defaultValue:1,linearRampToValueAtTime:t,setValueAtTime:t,exponentialRampToValueAtTime:t,setTargetAtTime:t,setValueCurveAtTime:t,cancelScheduledValues:t}}function o(){return{connect:t,disconnect:t,frequencyBinCount:0,smoothingTimeConstant:0,fftSize:0,minDecibels:0,maxDecibels:0,getByteTimeDomainData:t,getByteFrequencyData:t,getFloatTimeDomainData:t,getFloatFrequencyData:t,gain:n(),panningModel:0,setPosition:t,setOrientation:t,setVelocity:t,distanceModel:0,refDistance:0,maxDistance:0,rolloffFactor:0,coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,type:0,frequency:n(),Q:n(),detune:n(),delayTime:n(),buffer:0,threshold:n(),knee:n(),ratio:n(),attack:n(),release:n(),reduction:n(),oversample:0,curve:0,sampleRate:1,length:0,duration:0,numberOfChannels:0,getChannelData:function(){return[]},copyFromChannel:t,copyToChannel:t,dopplerFactor:0,speedOfSound:0,start:t}}window.Uint8Array||(window.Uint8Array=window.Float32Array=Array);return{isFake:!0,activeSourceCount:0,createAnalyser:o,createBuffer:o,createBufferSource:o,createMediaElementSource:o,createMediaStreamSource:o,createBiquadFilter:o,createChannelMerger:o,createChannelSplitter:o,createDynamicsCompressor:o,createConvolver:o,createDelay:o,createGain:o,createOscillator:o,createPanner:o,createScriptProcessor:o,createWaveShaper:o,decodeAudioData:t,destination:o,listener:o(),sampleRate:44100,state:"",get currentTime(){return(Date.now()-e)/1e3}}}},function(e,t,n){e.exports={default:n(490),__esModule:!0}},function(e,t,n){n(491),n(502),e.exports=n(137).f("iterator")},function(e,t,n){"use strict";var o=n(492)(!0);n(184)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=o(t,n),this._i+=e.length,{value:e,done:!1})})},function(e,t,n){var u=n(128),c=n(129);e.exports=function(s){return function(e,t){var n,o,r=String(c(e)),i=u(t),a=r.length;return i<0||a<=i?s?"":void 0:(n=r.charCodeAt(i))<55296||56319<n||i+1===a||(o=r.charCodeAt(i+1))<56320||57343<o?s?r.charAt(i):n:s?r.slice(i,i+2):o-56320+(n-55296<<10)+65536}}},function(e,t,n){"use strict";var o=n(131),r=n(96),i=n(136),a={};n(70)(a,n(73)("iterator"),function(){return this}),e.exports=function(e,t,n){e.prototype=o(a,{next:r(1,n)}),i(e,t+" Iterator")}},function(e,t,n){var a=n(60),s=n(85),u=n(132);e.exports=n(61)?Object.defineProperties:function(e,t){s(e);for(var n,o=u(t),r=o.length,i=0;i<r;)a.f(e,n=o[i++],t[n]);return e}},function(e,t,n){var o=n(187);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==o(e)?e.split(""):Object(e)}},function(e,t,n){var u=n(72),c=n(497),l=n(498);e.exports=function(s){return function(e,t,n){var o,r=u(e),i=c(r.length),a=l(n,i);if(s&&t!=t){for(;a<i;)if((o=r[a++])!=o)return!0}else for(;a<i;a++)if((s||a in r)&&r[a]===t)return s||a||0;return!s&&-1}}},function(e,t,n){var o=n(128),r=Math.min;e.exports=function(e){return 0<e?r(o(e),9007199254740991):0}},function(e,t,n){var o=n(128),r=Math.max,i=Math.min;e.exports=function(e,t){return(e=o(e))<0?r(e+t,0):i(e,t)}},function(e,t,n){var o=n(47).document;e.exports=o&&o.documentElement},function(e,t,n){var o=n(62),r=n(501),i=n(133)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=r(e),o(e,i)?e[i]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},function(e,t,n){var o=n(129);e.exports=function(e){return Object(o(e))}},function(e,t,n){n(503);for(var o=n(47),r=n(70),i=n(130),a=n(73)("toStringTag"),s="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),u=0;u<s.length;u++){var c=s[u],l=o[c],f=l&&l.prototype;f&&!f[a]&&r(f,a,c),i[c]=i.Array}},function(e,t,n){"use strict";var o=n(504),r=n(505),i=n(130),a=n(72);e.exports=n(184)(Array,"Array",function(e,t){this._t=a(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,r(1)):r(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])},"values"),i.Arguments=i.Array,o("keys"),o("values"),o("entries")},function(e,t){e.exports=function(){}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){e.exports={default:n(507),__esModule:!0}},function(e,t,n){n(508),n(513),n(514),n(515),e.exports=n(59).Symbol},function(e,t,n){"use strict";var o=n(47),a=n(62),r=n(61),i=n(84),s=n(185),u=n(509).KEY,c=n(95),l=n(134),f=n(136),p=n(101),h=n(73),d=n(137),y=n(138),v=n(510),m=n(511),_=n(85),g=n(71),b=n(72),w=n(122),O=n(96),x=n(131),k=n(512),E=n(190),P=n(60),T=n(132),S=E.f,j=P.f,C=k.f,R=o.Symbol,M=o.JSON,A=M&&M.stringify,L="prototype",D=h("_hidden"),z=h("toPrimitive"),H={}.propertyIsEnumerable,I=l("symbol-registry"),F=l("symbols"),N=l("op-symbols"),U=Object[L],B="function"==typeof R,V=o.QObject,G=!V||!V[L]||!V[L].findChild,$=r&&c(function(){return 7!=x(j({},"a",{get:function(){return j(this,"a",{value:7}).a}})).a})?function(e,t,n){var o=S(U,t);o&&delete U[t],j(e,t,n),o&&e!==U&&j(U,t,o)}:j,q=function(e){var t=F[e]=x(R[L]);return t._k=e,t},W=B&&"symbol"==typeof R.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof R},Y=function(e,t,n){return e===U&&Y(N,t,n),_(e),t=w(t,!0),_(n),a(F,t)?(n.enumerable?(a(e,D)&&e[D][t]&&(e[D][t]=!1),n=x(n,{enumerable:O(0,!1)})):(a(e,D)||j(e,D,O(1,{})),e[D][t]=!0),$(e,t,n)):j(e,t,n)},K=function(e,t){_(e);for(var n,o=v(t=b(t)),r=0,i=o.length;r<i;)Y(e,n=o[r++],t[n]);return e},X=function(e){var t=H.call(this,e=w(e,!0));return!(this===U&&a(F,e)&&!a(N,e))&&(!(t||!a(this,e)||!a(F,e)||a(this,D)&&this[D][e])||t)},J=function(e,t){if(e=b(e),t=w(t,!0),e!==U||!a(F,t)||a(N,t)){var n=S(e,t);return!n||!a(F,t)||a(e,D)&&e[D][t]||(n.enumerable=!0),n}},Z=function(e){for(var t,n=C(b(e)),o=[],r=0;n.length>r;)a(F,t=n[r++])||t==D||t==u||o.push(t);return o},Q=function(e){for(var t,n=e===U,o=C(n?N:b(e)),r=[],i=0;o.length>i;)!a(F,t=o[i++])||n&&!a(U,t)||r.push(F[t]);return r};B||(s((R=function(){if(this instanceof R)throw TypeError("Symbol is not a constructor!");var t=p(0<arguments.length?arguments[0]:void 0),n=function(e){this===U&&n.call(N,e),a(this,D)&&a(this[D],t)&&(this[D][t]=!1),$(this,t,O(1,e))};return r&&G&&$(U,t,{configurable:!0,set:n}),q(t)})[L],"toString",function(){return this._k}),E.f=J,P.f=Y,n(189).f=k.f=Z,n(139).f=X,n(188).f=Q,r&&!n(100)&&s(U,"propertyIsEnumerable",X,!0),d.f=function(e){return q(h(e))}),i(i.G+i.W+i.F*!B,{Symbol:R});for(var ee="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),te=0;ee.length>te;)h(ee[te++]);for(var ne=T(h.store),oe=0;ne.length>oe;)y(ne[oe++]);i(i.S+i.F*!B,"Symbol",{for:function(e){return a(I,e+="")?I[e]:I[e]=R(e)},keyFor:function(e){if(!W(e))throw TypeError(e+" is not a symbol!");for(var t in I)if(I[t]===e)return t},useSetter:function(){G=!0},useSimple:function(){G=!1}}),i(i.S+i.F*!B,"Object",{create:function(e,t){return void 0===t?x(e):K(x(e),t)},defineProperty:Y,defineProperties:K,getOwnPropertyDescriptor:J,getOwnPropertyNames:Z,getOwnPropertySymbols:Q}),M&&i(i.S+i.F*(!B||c(function(){var e=R();return"[null]"!=A([e])||"{}"!=A({a:e})||"{}"!=A(Object(e))})),"JSON",{stringify:function(e){for(var t,n,o=[e],r=1;arguments.length>r;)o.push(arguments[r++]);if(n=t=o[1],(g(t)||void 0!==e)&&!W(e))return m(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!W(t))return t}),o[1]=t,A.apply(M,o)}}),R[L][z]||n(70)(R[L],z,R[L].valueOf),f(R,"Symbol"),f(Math,"Math",!0),f(o.JSON,"JSON",!0)},function(e,t,n){var o=n(101)("meta"),r=n(71),i=n(62),a=n(60).f,s=0,u=Object.isExtensible||function(){return!0},c=!n(95)(function(){return u(Object.preventExtensions({}))}),l=function(e){a(e,o,{value:{i:"O"+ ++s,w:{}}})},f=e.exports={KEY:o,NEED:!1,fastKey:function(e,t){if(!r(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!i(e,o)){if(!u(e))return"F";if(!t)return"E";l(e)}return e[o].i},getWeak:function(e,t){if(!i(e,o)){if(!u(e))return!0;if(!t)return!1;l(e)}return e[o].w},onFreeze:function(e){return c&&f.NEED&&u(e)&&!i(e,o)&&l(e),e}}},function(e,t,n){var s=n(132),u=n(188),c=n(139);e.exports=function(e){var t=s(e),n=u.f;if(n)for(var o,r=n(e),i=c.f,a=0;r.length>a;)i.call(e,o=r[a++])&&t.push(o);return t}},function(e,t,n){var o=n(187);e.exports=Array.isArray||function(e){return"Array"==o(e)}},function(e,t,n){var o=n(72),r=n(189).f,i={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return a&&"[object Window]"==i.call(e)?function(e){try{return r(e)}catch(e){return a.slice()}}(e):r(o(e))}},function(e,t){},function(e,t,n){n(138)("asyncIterator")},function(e,t,n){n(138)("observable")},function(e,t,n){e.exports={default:n(517),__esModule:!0}},function(e,t,n){n(518),e.exports=n(59).Object.setPrototypeOf},function(e,t,n){var o=n(84);o(o.S,"Object",{setPrototypeOf:n(519).set})},function(e,t,r){var n=r(71),o=r(85),i=function(e,t){if(o(e),!n(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,n,o){try{(o=r(171)(Function.call,r(190).f(Object.prototype,"__proto__").set,2))(e,[]),n=!(e instanceof Array)}catch(e){n=!0}return function(e,t){return i(e,t),n?e.__proto__=t:o(e,t),e}}({},!1):void 0),check:i}},function(e,t,n){e.exports={default:n(521),__esModule:!0}},function(e,t,n){n(522);var o=n(59).Object;e.exports=function(e,t){return o.create(e,t)}},function(e,t,n){var o=n(84);o(o.S,"Object",{create:n(131)})},function(e,t){function o(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function u(e){return"function"==typeof e}function c(e){return"object"==typeof e&&null!==e}function l(e){return void 0===e}((e.exports=o).EventEmitter=o).prototype._events=void 0,o.prototype._maxListeners=void 0,o.defaultMaxListeners=10,o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},o.prototype.emit=function(e){var t,n,o,r,i,a;if(this._events||(this._events={}),"error"===e&&(!this._events.error||c(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var s=new Error('Uncaught, unspecified "error" event. ('+t+")");throw s.context=t,s}if(l(n=this._events[e]))return!1;if(u(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:r=Array.prototype.slice.call(arguments,1),n.apply(this,r)}else if(c(n))for(r=Array.prototype.slice.call(arguments,1),o=(a=n.slice()).length,i=0;i<o;i++)a[i].apply(this,r);return!0},o.prototype.on=o.prototype.addListener=function(e,t){var n;if(!u(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,u(t.listener)?t.listener:t),this._events[e]?c(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,c(this._events[e])&&!this._events[e].warned&&(n=l(this._maxListeners)?o.defaultMaxListeners:this._maxListeners)&&0<n&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},o.prototype.once=function(e,t){if(!u(t))throw TypeError("listener must be a function");var n=!1;function o(){this.removeListener(e,o),n||(n=!0,t.apply(this,arguments))}return o.listener=t,this.on(e,o),this},o.prototype.removeListener=function(e,t){var n,o,r,i;if(!u(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(r=(n=this._events[e]).length,o=-1,n===t||u(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(c(n)){for(i=r;0<i--;)if(n[i]===t||n[i].listener&&n[i].listener===t){o=i;break}if(o<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(o,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},o.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(u(n=this._events[e]))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},o.prototype.listeners=function(e){return this._events&&this._events[e]?u(this._events[e])?[this._events[e]]:this._events[e].slice():[]},o.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(u(t))return 1;if(t)return t.length}return 0},o.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,n){"use strict";t.__esModule=!0,t.default=function(e){var t="sono "+e.VERSION,n="Supported:"+e.isSupported+" WebAudioAPI:"+e.hasWebAudio+" TouchLocked:"+e.isTouchLocked+" State:"+(e.context&&e.context.state)+" Extensions:"+e.file.extensions;if(-1<navigator.userAgent.indexOf("Chrome")){var o=["%c ♫ "+t+" ♫ %c "+n+" ","color: #FFFFFF; background: #379F7A","color: #1F1C0D; background: #E0FBAC"];console.log.apply(console,o)}else window.console&&window.console.log.call&&console.log.call(console,t+" "+n)}},function(e,t,n){"use strict";t.__esModule=!0,t.default=function(e,t){var n=!1,o=null,r=null;void 0!==document.hidden?(o="hidden",r="visibilitychange"):void 0!==document.mozHidden?(o="mozHidden",r="mozvisibilitychange"):void 0!==document.msHidden?(o="msHidden",r="msvisibilitychange"):void 0!==document.webkitHidden&&(o="webkitHidden",r="webkitvisibilitychange");function i(){document[o]?e():t()}function a(e){(n=e)?document.addEventListener(r,i,!1):document.removeEventListener(r,i)}void 0!==r&&a(!0);return{get enabled(){return n},set enabled(e){a(e)}}}},function(e,t,n){"use strict";t.__esModule=!0;var r=b(n(86)),i=b(n(142)),a=b(n(140)),s=b(n(141)),u=b(n(99)),c=b(n(527)),l=b(n(126)),o=b(n(193)),f=b(n(183)),p=b(n(528)),h=b(n(194)),d=b(n(195)),y=b(n(192)),v=b(n(529)),m=b(n(530)),_=b(n(531)),g=b(n(532));function b(e){return e&&e.__esModule?e:{default:e}}var w=function(n){function o(e){(0,r.default)(this,o);var t=(0,a.default)(this,n.call(this));return t.id=e.id||null,t._context=e.context||u.default,t._destination=e.destination||t._context.destination,t._effects=new l.default(t._context),t._gain=t._context.createGain(),t._config=e,t._data=null,t._fadeTimeout=null,t._isTouchLocked=!1,t._loader=null,t._loop=!1,t._offset=0,t._playbackRate=1,t._playWhenReady=null,t._source=null,t._wave=null,t._userData={},t._effects.setDestination(t._gain),t._gain.connect(t._destination),t._onEnded=t._onEnded.bind(t),t._onLoad=t._onLoad.bind(t),t._onLoadError=t._onLoadError.bind(t),t}return(0,s.default)(o,n),o.prototype.prepare=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=!(1<arguments.length&&void 0!==arguments[1]&&arguments[1])&&!this._source&&!!this._config.deferLoad;if(e){var n=f.default.getSrc(e),o=f.default.getSupportedFile(n)||this._config.src;this._config=Object.assign(this._config,e,{src:o})}return this._source&&this._data&&this._data.tagName?this._source.load(this._config.src):(this._loader=new y.default(this._config.src,t),this._loader.audioContext=this._config.asMediaElement||this._context.isFake?null:this._context,this._loader.isTouchLocked=this._isTouchLocked,this._loader.once("loaded",this._onLoad),this._loader.once("error",this._onLoadError)),this},o.prototype.load=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;return this.stop(),this._source=null,!e||f.default.containsURL(e)?(this._loader&&this._loader.destroy(),this.prepare(e,!0),this._loader.start()):this.data=e.data||e,this},o.prototype.play=function(e,t){var n=this;return!this._source||this._isTouchLocked?(this._playWhenReady=function(){n._source&&n.play(e,t)},this._config.deferLoad&&(this._loader||this.prepare(null,!0),this._loader.start(!0))):(this._playWhenReady=null,this._effects.setSource(this._source.sourceNode),this._offset&&void 0===t&&(t=this._offset,this._offset=0),this._source.play(e,t),this._source.hasOwnProperty("volume")&&(this._source.volume=this._gain.gain.value),this._source.hasOwnProperty("loop")&&(this._source.loop=this._loop),this.emit("play",this)),this},o.prototype.pause=function(){return this._source&&this._source.pause(),this.emit("pause",this),this},o.prototype.stop=function(e){return this._source&&this._source.stop(e||0),this.emit("stop",this),this},o.prototype.seek=function(e){return this.currentTime=e,this},o.prototype.fade=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;if(!this._source)return this;var n=this._gain.gain;if(!this._context||this._context.isFake||p.default)this._fadePolyfill(e,t);else{var o=this._context.currentTime;n.cancelScheduledValues(o),n.setValueAtTime(n.value,o),n.linearRampToValueAtTime(e,o+t)}return this.emit("fade",this,e),this},o.prototype._fadePolyfill=function(e,t){var o=this;return window.clearTimeout(this._fadeTimeout),function e(t,n){o._fadeTimeout=window.setTimeout(function(){o.volume=o.volume+.2*(t-o.volume),.05<Math.abs(o.volume-t)?e(t,n):o.volume=t},1e3*n)}(e,t/10),this},o.prototype.unload=function(){this._source&&this._source.destroy(),this._loader&&this._loader.destroy(),this._data=null,this._playWhenReady=null,this._source=null,this._loader=null,this._config.deferLoad=!0,this.emit("unload",this)},o.prototype.reload=function(){return this.load(null,!0)},o.prototype.destroy=function(){this._source&&this._source.destroy(),this._effects&&this._effects.destroy(),this._gain&&this._gain.disconnect(),this._loader&&(this._loader.off("loaded"),this._loader.off("error"),this._loader.destroy()),this._gain=null,this._context=null,this._destination=null,this._data=null,this._playWhenReady=null,this._source=null,this._effects=null,this._loader=null,this._config=null,this.emit("destroy",this),this.off()},o.prototype.waveform=function(e){var t=this;return this._wave||(this._wave=h.default.waveform()),this._data||this.once("ready",function(){return t._wave(t._data,e)}),this._wave(this._data,e)},o.prototype._createSource=function(e){var t=f.default.isAudioBuffer(e);if(t||f.default.isMediaElement(e)){var n=t?c.default:m.default;this._source=new v.default(n,e,this._context,this._onEnded),this._source.singlePlay=!!this._config.singlePlay,this._source.playbackRate=this._playbackRate,this._source.currentTime=this._offset}else if(f.default.isMediaStream(e))this._source=new _.default(e,this._context);else{if(!f.default.isOscillatorType(e&&e.type||e))throw new Error("Cannot detect data type: "+e);this._source=new g.default(e.type||e,this._context)}this._effects.setSource(this._source.sourceNode),this.emit("ready",this),this._playWhenReady&&this._playWhenReady()},o.prototype._onEnded=function(){this.emit("ended",this)},o.prototype._onLoad=function(e){this._data=e,this.emit("loaded",this),this._createSource(e)},o.prototype._onLoadError=function(e){this.listenerCount("error")?this.emit("error",this,e):console.error("Sound load error",this._loader.url)},(0,i.default)(o,[{key:"context",get:function(){return this._context}},{key:"currentTime",get:function(){return this._source?this._source.currentTime:this._offset},set:function(e){if(this._source){var t=this._source.playing;this._source.stop(),this._source.currentTime=e,t&&this.play(0,e)}else this._offset=e}},{key:"data",get:function(){return this._data},set:function(e){e&&(this._data=e,this._createSource(e))}},{key:"duration",get:function(){return this._source?this._source.duration:0}},{key:"effects",get:function(){return this._effects._nodes},set:function(e){this._effects.removeAll().add(e)}},{key:"fx",get:function(){return this.effects},set:function(e){this.effects=e}},{key:"ended",get:function(){return!!this._source&&this._source.ended}},{key:"frequency",get:function(){return this._source?this._source.frequency:0},set:function(e){this._source&&this._source.hasOwnProperty("frequency")&&(this._source.frequency=e)}},{key:"gain",get:function(){return this._gain}},{key:"groupVolume",get:function(){return this._source.groupVolume},set:function(e){this._source&&this._source.hasOwnProperty("groupVolume")&&(this._source.groupVolume=e)}},{key:"isTouchLocked",set:function(e){this._isTouchLocked=e,this._loader&&(this._loader.isTouchLocked=e),!e&&this._playWhenReady&&this._playWhenReady()}},{key:"loader",get:function(){return this._loader}},{key:"loop",get:function(){return this._loop},set:function(e){this._loop=!!e,this._source&&this._source.hasOwnProperty("loop")&&this._source.loop!==this._loop&&(this._source.loop=this._loop)}},{key:"singlePlay",get:function(){return this._config.singlePlay},set:function(e){this._config.singlePlay=e,this._source.singlePlay=e}},{key:"config",get:function(){return this._config}},{key:"paused",get:function(){return!!this._source&&this._source.paused}},{key:"playing",get:function(){return!!this._source&&this._source.playing}},{key:"playbackRate",get:function(){return this._playbackRate},set:function(e){this._playbackRate=e,this._source&&(this._source.playbackRate=e)}},{key:"progress",get:function(){return this._source&&this._source.progress||0}},{key:"sourceInfo",get:function(){return this._source&&this._source.info?this._source.info:{}}},{key:"sourceNode",get:function(){return this._source?this._source.sourceNode:null}},{key:"volume",get:function(){return this._gain.gain.value},set:function(e){if((0,d.default)(e)){window.clearTimeout(this._fadeTimeout),e=Math.min(Math.max(e,0),1);var t=this._gain.gain,n=this._context.currentTime;t.cancelScheduledValues(n),t.value=e,p.default||t.setValueAtTime(e,n),this._source&&this._source.hasOwnProperty("volume")&&(this._source.volume=e)}}},{key:"userData",get:function(){return this._userData}}]),o}(o.default);(t.default=w).__source={BufferSource:c.default,MediaSource:m.default,MicrophoneSource:_.default,OscillatorSource:g.default}},function(e,t,n){"use strict";t.__esModule=!0,t.default=function(e,n,t){var o={},r=!1,i=!1,a=!1,s=0,u=1,c=!1,l=null,f=0;function p(){return!l&&n&&((l=n.createBufferSource()).buffer=e),l}function h(){if(l){l.onended=null;try{l.disconnect(),l.stop(0)}catch(e){}l=null}c=a=!1,f=s=0}function d(){h(),r=!0,"function"==typeof t&&t(o)}return Object.defineProperties(o,{play:{value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(!c){for(e=e?n.currentTime+e:0,t&&(s=0),s&&(t=s);t>o.duration;)t%=o.duration;p(),l.onended=d,l.start(e,t),l.loop=i,l.playbackRate.value=u,f=n.currentTime-t,a=r=!1,c=!(s=0)}}},pause:{value:function(){var e=n.currentTime-f;h(),s=e,a=!(c=!1)}},stop:{value:h},destroy:{value:function(){h(),l=t=n=e=null}},currentTime:{get:function(){if(s)return s;if(f){for(var e=n.currentTime-f;e>o.duration;)e%=o.duration;return e}return 0},set:function(e){s=e}},duration:{get:function(){return e?e.duration:0}},ended:{get:function(){return r}},loop:{get:function(){return i},set:function(e){i=!!e,l&&(l.loop=i)}},paused:{get:function(){return a}},playbackRate:{get:function(){return u},set:function(e){u=e,l&&(l.playbackRate.value=u)}},playing:{get:function(){return c}},progress:{get:function(){return o.duration?o.currentTime/o.duration:0}},sourceNode:{get:function(){return p()}}}),Object.freeze(o)}},function(e,t,n){"use strict";t.__esModule=!0,t.default=navigator&&/Firefox/i.test(navigator.userAgent)},function(e,t,n){"use strict";t.__esModule=!0,t.default=function(t,o,n,r){var i=n.createGain(),a=h(o),e={},s=[],u=[],c=0,l=!1;function f(e){e.stop(),l||s.push(e)}function p(e){if(e!==a&&u.length){var t=u.indexOf(e);u.splice(t,1),f(e)}r()}function h(e){return new t(e,n,p)}function d(){for(a.stop();u.length;)f(u.pop())}return Object.defineProperties(e,{play:{value:function(e,t){var n=l||!a.playing?a:0<s.length?s.pop():(c++,o.tagName?h(o.cloneNode()):h(o));i&&n.sourceNode.connect(i),n!==a&&u.push(n),n.play(e,t)}},pause:{value:function(){a.pause(),u.forEach(function(e){return e.pause()})}},stop:{value:d},load:{value:function(e){d(),s.length=0,a.load(e)}},destroy:{value:function(){for(a.destroy();u.length;)u.pop().destroy();for(;s.length;)s.pop().destroy();i.disconnect()}},currentTime:{get:function(){return a.currentTime||0},set:function(t){a.currentTime=t,u.forEach(function(e){return e.currentTime=t})}},duration:{get:function(){return a.duration||0}},ended:{get:function(){return a.ended&&u.every(function(e){return e.ended})}},info:{get:function(){return{pooled:s.length,active:u.length+1,created:c+1}}},loop:{get:function(){return a.loop},set:function(t){a.loop=!!t,u.forEach(function(e){return e.loop=!!t})}},paused:{get:function(){return a.paused}},playbackRate:{get:function(){return a.playbackRate},set:function(t){a.playbackRate=t,u.forEach(function(e){return e.playbackRate=t})}},playing:{get:function(){return a.playing}},progress:{get:function(){return a.progress}},singlePlay:{get:function(){return l},set:function(e){l=e}},sourceNode:{get:function(){return i}},volume:{get:function(){return a.volume},set:function(t){a.hasOwnProperty("volume")&&(a.volume=t,u.forEach(function(e){return e.volume=t}))}},groupVolume:{get:function(){return a.groupVolume},set:function(t){a.hasOwnProperty("groupVolume")&&(a.groupVolume=t,u.forEach(function(e){return e.groupVolume=t}))}}}),Object.freeze(e)}},function(e,t,n){"use strict";t.__esModule=!0,t.default=function(o,e,t){var n={},r=!1,i=t,a=null,s=!1,u=!1,c=1,l=!1,f=null,p=1,h=1;function d(){o.removeEventListener("canplaythrough",d),l&&o.play()}function y(){if(s)return(o.currentTime=0)<o.currentTime&&o.load(),void o.play();l=u=!(r=!0),"function"==typeof i&&i(n)}function v(){if(clearTimeout(a),o){o.pause();try{(o.currentTime=0)<o.currentTime&&o.load()}catch(e){}u=l=!1}}return Object.defineProperties(n,{play:{value:function e(t,n){clearTimeout(a),o.volume=h*p,o.playbackRate=c,n&&(o.currentTime=n),t?a=setTimeout(e,t):o.play(),l=!(u=r=!1),o.removeEventListener("ended",y),o.addEventListener("ended",y,!1),o.readyState<1&&(o.removeEventListener("canplaythrough",d),o.addEventListener("canplaythrough",d,!1),o.play())}},pause:{value:function(){clearTimeout(a),o&&(o.pause(),u=!(l=!1))}},stop:{value:v},load:{value:function(e){o.src=e,o.load(),l=u=r=!1}},destroy:{value:function(){o.removeEventListener("ended",y),o.removeEventListener("canplaythrough",d),v(),f=i=e=o=null}},currentTime:{get:function(){return o?o.currentTime:0},set:function(e){o&&(o.currentTime=e)}},duration:{get:function(){return o?o.duration:0}},ended:{get:function(){return r}},loop:{get:function(){return s},set:function(e){s=!!e}},paused:{get:function(){return u}},playbackRate:{get:function(){return c},set:function(e){c=e,o&&(o.playbackRate=c)}},playing:{get:function(){return l}},progress:{get:function(){return o&&o.duration?o.currentTime/o.duration:0}},sourceNode:{get:function(){return!f&&e&&(f=e.createMediaElementSource(o)),f}},volume:{get:function(){return h},set:function(e){h=e,o&&(o.volume=h*p)}},groupVolume:{get:function(){return p},set:function(e){p=e,o&&(o.volume=h*p)}}}),Object.freeze(n)}},function(e,t,n){"use strict";t.__esModule=!0,t.default=function(e,t){var n=!1,o=!1,r=0,i=!1,a=null,s=0;function u(){return!a&&t&&(a=t.createMediaStreamSource(e),navigator.mozGetUserMedia&&(window.mozHack=a)),a}function c(){if(a){try{a.stop(0)}catch(e){}a=null}i=o=!(n=!0),s=r=0}var l={play:function(e){e=e?t.currentTime+e:0,u(),a.start(e),s=t.currentTime-r,i=!0,o=n=!1,r=0},pause:function(){var e=t.currentTime-s;c(),r=e,i=!1,o=!0},stop:c,destroy:function(){c(),e=a=t=null,window.mozHack=null},duration:0,progress:0};return Object.defineProperties(l,{currentTime:{get:function(){return r||(s?t.currentTime-s:0)},set:function(e){r=e}},ended:{get:function(){return n}},paused:{get:function(){return o}},playing:{get:function(){return i}},sourceNode:{get:function(){return u()}}}),Object.freeze(l)}},function(e,t,n){"use strict";t.__esModule=!0,t.default=function(e,t){var n=!1,o=!1,r=0,i=!1,a=null,s=0,u=200,c=null;function l(){return!a&&t&&((a=t.createOscillator()).type=e,a.frequency.value=u),a}function f(){if(a){try{a.stop(0)}catch(e){}a=null}i=o=!(n=!0),s=r=0}return c={play:function(e){(e=e||0)&&(e=t.currentTime+e),l(),a.start(e),s=r?t.currentTime-r:t.currentTime,o=n=!(i=!0),r=0},pause:function(){var e=t.currentTime-s;f(),r=e,o=!(i=!1)},stop:f,destroy:function(){f(),a=t=null}},Object.defineProperties(c,{currentTime:{get:function(){return r||(s?t.currentTime-s:0)},set:function(e){r=e}},duration:{value:0},ended:{get:function(){return n}},frequency:{get:function(){return u},set:function(e){u=e,a&&(a.frequency.value=e)}},paused:{get:function(){return o}},playing:{get:function(){return i}},progress:{value:0},sourceNode:{get:function(){return l()}}}),Object.freeze(c)}},function(e,t,n){"use strict";t.__esModule=!0,t.default=function(e,t){var n=new l.default(e,t),o=n.sounds,r=1,i=!1,a=void 0;function s(){o.length&&(a=o.slice(0).sort(function(e,t){return t.duration-e.duration})[0])}var u=n.add;n.add=function(e){return u(e),s(),n};var c=n.remove;return n.remove=function(e){return c(e),s(),n},Object.defineProperties(n,{currentTime:{get:function(){return a?a.currentTime:0},set:function(e){this.stop(),this.play(0,e)}},duration:{get:function(){return a?a.duration:0}},loop:{get:function(){return i},set:function(e){i=!!e,o.forEach(function(e){e.loop=i})}},paused:{get:function(){return!!a&&a.paused}},progress:{get:function(){return a?a.progress:0}},playbackRate:{get:function(){return r},set:function(e){r=e,o.forEach(function(e){e.playbackRate=r})}},playing:{get:function(){return!!a&&a.playing}}}),n};var o,r=n(191),l=(o=r)&&o.__esModule?o:{default:o}},function(e,t,n){"use strict";t.__esModule=!0,t.default=function(e,t){var n=a.default;function o(){e&&"suspended"===e.state?e.resume().then(function(){(0,s.default)(e),r()}):r()}function r(){document.body.removeEventListener("touchstart",o),document.body.removeEventListener("touchend",o),t()}function i(){document.body.addEventListener("touchstart",o,!1),document.body.addEventListener("touchend",o,!1)}n&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",i):i());return n};var a=o(n(182)),s=o(n(181));function o(e){return e&&e.__esModule?e:{default:e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(196);Object.defineProperty(t,"clamp",{enumerable:!0,get:function(){return o.clamp}});var r=n(536);Object.defineProperty(t,"clampNorm",{enumerable:!0,get:function(){return r.clampNorm}});var i=n(537);Object.defineProperty(t,"diagonal",{enumerable:!0,get:function(){return i.diagonal}});var a=n(538);Object.defineProperty(t,"distance",{enumerable:!0,get:function(){return a.distance}});var s=n(539);Object.defineProperty(t,"isEven",{enumerable:!0,get:function(){return s.isEven}});var u=n(540);Object.defineProperty(t,"isOdd",{enumerable:!0,get:function(){return u.isOdd}});var c=n(541);Object.defineProperty(t,"lerp",{enumerable:!0,get:function(){return c.lerp}});var l=n(542);Object.defineProperty(t,"lightenDarkenColor",{enumerable:!0,get:function(){return l.lightenDarkenColor}});var f=n(543);Object.defineProperty(t,"map",{enumerable:!0,get:function(){return f.map}});var p=n(544);Object.defineProperty(t,"modAbs",{enumerable:!0,get:function(){return p.modAbs}});var h=n(545);Object.defineProperty(t,"normalize",{enumerable:!0,get:function(){return h.normalize}});var d=n(546);Object.defineProperty(t,"parabola",{enumerable:!0,get:function(){return d.parabola}});var y=n(547);Object.defineProperty(t,"randomFloat",{enumerable:!0,get:function(){return y.randomFloat}});var v=n(548);Object.defineProperty(t,"randomHexColor",{enumerable:!0,get:function(){return v.randomHexColor}});var m=n(549);Object.defineProperty(t,"randomInt",{enumerable:!0,get:function(){return m.randomInt}});var _=n(550);Object.defineProperty(t,"smoothstep",{enumerable:!0,get:function(){return _.smoothstep}});var g=n(551);Object.defineProperty(t,"toRadians",{enumerable:!0,get:function(){return g.toRadians}}),Object.defineProperty(t,"degToRad",{enumerable:!0,get:function(){return g.toRadians}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clampNorm=function(e){return e<0?0:1<e?1:e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.diagonal=function(e,t){return Math.sqrt(e*e+t*t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.distance=function(e,t,n,o){var r=e-n,i=t-o;return Math.sqrt(r*r+i*i)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isEven=function(e){return!(1&e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isOdd=function(e){return!!(1&e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lerp=function(e,t,n){return t+(n-t)*e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lightenDarkenColor=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=!1;"#"===e[0]&&(e=e.slice(1),n=!0);var o=parseInt(e,16),r=(o>>16)+t;r=(0,u.clamp)(r,0,255);var i=(o>>8&255)+t;i=(0,u.clamp)(i,0,255);var a=(255&o)+t,s=(a=(0,u.clamp)(a,0,255))|i<<8|r<<16;0===r&&0===a&&0===i&&0!==t&&(s="000000");return(n?"#":"")+s.toString(16)};var u=n(196)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.map=function(e,t,n,o,r){return(e-t)/(n-t)*(r-o)+o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.modAbs=function(e,t){e<0&&(e=t+e%t);if(t<=e)return e%t;return e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.normalize=function(e,t,n){return(e-t)/(n-t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parabola=function(e,t){return Math.pow(4*t*(1-t),e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomFloat=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:2;return parseFloat(Math.min(e+Math.random()*(t-e),t).toFixed(n))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomHexColor=function(){return"#"+("00000"+(Math.random()*(1<<24)|0).toString(16)).slice(-6)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomInt=function(e,t){return Math.floor(Math.random()*(t-e+1)+e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.smoothstep=function(e,t,n){var o=Math.max(0,Math.min(1,(e-t)/(n-t)));return o*o*(3-2*o)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toRadians=function(e){return e*Math.PI/180}},function(e,t,n){"use strict";function c(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:new Map,o=n.get(e);if(o)return o;if(Array.isArray(e)){var r=[];n.set(e,r);for(var i=0;i<e.length;i++)r[i]=c(e[i],t,n);return r}if(e instanceof Date)return new Date(e.valueOf());if(!(e instanceof Object))return e;var a={};n.set(e,a);for(var s=Object.keys(e),u=0;u<s.length;u++){a[t?t(s[u]):s[u]]=c(e[s[u]],t,n)}return a}function o(t){return function(e){return c(e,t)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=c,t.formatKeys=o,c.formatKeys=o},function(e,t,n){"use strict";t.__esModule=!0;var o=a(n(86)),r=a(n(142)),i=a(n(99));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(){function t(e){(0,o.default)(this,t),this._node=this._in=this._out=e}return t.prototype.connect=function(e){this._node.connect(e._in||e)},t.prototype.disconnect=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];this._node.disconnect(t)},t.prototype.update=function(){throw new Error("update must be overridden")},(0,r.default)(t,[{key:"context",get:function(){return i.default}},{key:"numberOfInputs",get:function(){return 1}},{key:"numberOfOutputs",get:function(){return 1}},{key:"channelCount",get:function(){return 1}},{key:"channelCountMode",get:function(){return"max"}},{key:"channelInterpretation",get:function(){return"speakers"}}]),t}();t.default=s},function(e,t,n){"use strict";t.__esModule=!0,t.default=function(e){return void 0!==e}},function(e,t){e.exports='<div class="preloader">\n  <span class="preloader__text" data-el="text">loading</span>\n  <div class="preloader__bar" data-el="bar"></div>\n</div>\n'},function(e,t){e.exports='<div class="gl">\n</div>\n'},function(e,t){e.exports='{% set qualities = [\'low\', \'medium\', \'high\'] %}\n<div class="quality quality--is-hidden">\n  <div class="quality__title" data-el="title">Select the quality</div>\n\n  <div class="quality__levels">\n  {% for level in levels %}\n    <div\n      class="quality__level quality__level--{{ qualities[loop.index0] | lower }}"\n      data-index="{{ loop.index0 }}"\n      data-el="levels"\n    >\n      <div class="quality__level-wrapper" data-el="wrappers"> \n        <div class="quality__level-name" data-el="names">{{ qualities[loop.index0] }}</div>\n      </div>\n    </div>\n  {% endfor %}\n  </div>\n</div>\n'},function(e,t){e.exports='<ul class="toast-msg"></ul>\n'},function(e,t){e.exports='<div class="instructions">\n  <p class="instructions__text" data-el="text"></p>\n</div>\n'},function(e,t){e.exports='<div class="sound-bars sound-bars--is-active sound-bars--is-visible">\n  {% for row in 1..4 %}\n    <div class="sound-bars__el"><div class="sound-bars__bg"></div></div>\n  {% endfor %}\n</div>\n'},function(e,t){e.exports='<div class="fullscreen fullscreen--is-visible">\n  <div class="fullscreen__container">\n    <div class="fullscreen__arrow fullscreen__arrow--tl"></div>\n    <div class="fullscreen__arrow fullscreen__arrow--tr"></div>\n    <div class="fullscreen__arrow fullscreen__arrow--bl"></div>\n    <div class="fullscreen__arrow fullscreen__arrow--br"></div>\n    <div class="fullscreen__screen"></div>\n  </div>\n</div>\n'},function(e,t){e.exports='<div class="gamepad-infos">\n  <div class="gamepad-infos__icon" data-el="icon">\n    <img class="gamepad-infos__img" src="./assets/images/gamepad.png" data-el="img">\n  </div>\n  <div class="gamepad-infos__msg">\n    <span data-el="msg">Gamepad connected</span>\n  </div>\n</div>\n'},function(e,t){e.exports='<div class="speedrun">\n  <div class="speedrun__text" data-el="text">00:00:00:00</div>\n</div>\n'},function(e,t){e.exports='<div class="subtitles subtitles--{{ pageName }}">\n  <div class="subtitles__text" data-el="text"></div>\n</div>\n'},function(e,t){e.exports='{% set name = \'home\' %}\n<div class="page {{name}} {{name}}--animation-in {{name}}--animation-in-timing">\n \n  <div class="home__bg"></div>\n\n  <div class="home__intro">\n    <video class="home__video" preload src="./assets/videos/intro.mp4" data-el="video"></video>\n\n    <span class="home__intro-skip" data-el="skip">skip</span>\n  </div>\n\n  <a class="home__cta" data-el="cta">\n    <span class="home__cta-text">play</span>\n  </a>\n\n  <div class="home__cta-deco home__cta-deco--left" data-el="decoLeft"><span>*</span></div>\n  <div class="home__cta-deco home__cta-deco--right" data-el="decoRight"><span>*</span></div>\n\n  <a class="home__xmas" href="https://christmasexperiments.com/" data-el="xmas" target="_blank">\n    December 1st of\n    <img class="home__xmas-svg" src="./assets/images/xmas-white.svg">\n  </a>\n\n  <div class="home__gamepad" data-el="gamepad">\n    <img class="home__gamepad-img" src="./assets/images/gamepad.png">\n    <span class="home__gamepad-text">For more fun use your gamepad</span>\n  </div>\n\n  <div data-component="Subtitles"></div>\n\n</div>\n'},function(e,t){e.exports='{% set name = \'fallback\' %}\n<div class="page {{name}} {{name}}--animation-in {{name}}--animation-in-timing">\n  <div class="fallback__msg" data-el="msg">\n    We are sorry<br>\n    This experiment is desktop-only<br>\n    Merry chrystmas\n  </div>\n</div>\n'},function(e,t){e.exports='<div class="credits">\n  <ul class="credits-list">\n    <li class="credits-el credits-el--dev" data-el="creditEls">\n      <div class="credits-el-c">\n        <strong class="credits-role">Developers</strong> \n        <div class="credits-sep" data-el="smallStrokes"></div>\n        <ul class="credits-names">\n          <li class="credits-name">\n            <a href="https://twitter.com/FabMotte" target="blank">Fabien Motte</a>\n          </li>\n          <li class="credits-name">\n            <a href="https://twitter.com/Pat_Hg" target="blank">Patrick Heng</a>\n          </li>\n        </ul>\n      </div>\n    </li>\n    <li class="credits-el credits-el--des" data-el="creditEls">\n      <div class="credits-el-c">\n        <strong class="credits-role">Designers</strong> \n        <div class="credits-sep" data-el="smallStrokes"></div>\n        <ul class="credits-names">\n          <li class="credits-name">\n            <a href="https://twitter.com/alexlesubmarine" target="blank">Alexandre Delalleau</a>\n          </li>\n          <li class="credits-name">\n            <a href="https://www.instagram.com/3dpointless/" target="blank">Nicolas Mathis</a>\n          </li>\n        </ul>\n      </div>\n    </li>\n    <li class="credits-el credits-el--music" data-el="creditEls">\n      <div class="credits-el-c">\n        <strong class="credits-role">Musics</strong> \n        <div class="credits-sep" data-el="smallStrokes"></div>\n        <ul class="credits-names">\n          <li class="credits-name">\n            <a href="https://twitter.com/GabAndLou" target="blank">Louis-Gabriel Gonzalez</a>\n          </li>\n          <li class="credits-name">\n            <a href="https://soundcloud.com/mohave-2" target="blank">Mohave</a>\n          </li>\n        </ul>\n      </div>\n    </li>\n  </ul>\n</div>'},function(e,t){e.exports='<a class="xmas-love" href="https://christmasexperiments.com/" data-el="xmas" target="_blank">\n  Made with <span class="xmas-love__heart"></span> for\n  <img class="xmas-love__svg" src="./assets/images/xmas-white.svg">\n</a>\n'},function(e,t){e.exports='<div class="pause">\n  <div class="pause__bg"></div>\n\n  <div class="pause__big-underline" data-el="bigUnderline"></div>\n\n  <div class="pause__title" data-el="title">\n    <span>Game paused</span>\n  </div>\n\n  <div class="pause__keyboard" data-el="keyboard">\n    <span class="pause__keyboard-title">KEYBOARD OPTION</span><br>\n    <span class="pause__keyboard-checkbox"></span>\n    <span class="pause__keyboard-type">QWERTY</span>\n  </div>\n\n  <div class="pause__deco" data-el="deco">*</div>\n\n  <div class="pause__instructions">\n    <h2 class="pause__instructions-title pause__instructions-title--gamepad" data-el="gamepadTitle">Gamepad Controls</h2>\n    <div class="pause__instruction pause__instruction--gamepad" data-el="instructionL">\n\n      <svg data-el="svgs" class="pause__svg pause__svg--gamepad" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n          viewBox="0 0 1245.4 1192" style="enable-background:new 0 0 1245.4 1192;" xml:space="preserve">\n        <polyline class="st0" points="985.9,622.9 898.2,395 748.4,338.5 714,361.3 528.2,361.3 493.8,347 380.5,363 342.8,406.5 \n          266.5,595.5 244.2,801 308.1,870.3 491.6,735.4 728.9,737.4 929.9,883.7 998.4,775.2 "/>\n        <polygon class="st1" points="828,412 849.1,412 862.8,426.7 862.8,444.6 849.2,458.2 829.9,458.2 816.7,445 816.7,422.8 "/>\n        <polygon class="st1" points="828,518.7 849.1,518.7 862.8,533.4 862.8,551.3 849.2,565 829.9,565 816.7,551.7 816.7,529.5 "/>\n        <polygon class="st1" points="881.2,465.5 902.3,465.5 916,480.2 916,498.1 902.4,511.7 883.1,511.7 869.9,498.5 869.9,476.3 "/>\n        <polygon class="st1" points="774.3,465.5 795.4,465.5 809.2,480.2 809.2,498.1 795.5,511.7 776.3,511.7 763,498.5 763,476.3 "/>\n        <polygon class="st1" points="672.2,465.5 693.3,465.5 707,480.2 707,498.1 693.4,511.7 674.1,511.7 660.9,498.5 660.9,476.3 "/>\n        <polygon class="st1" points="559.3,465.5 580.4,465.5 594.2,480.2 594.2,498.1 580.5,511.7 561.3,511.7 548,498.5 548,476.3 "/>\n        <polygon class="st1" points="386.5,446.1 425.8,446.1 451.4,473.4 451.4,506.7 426,532.1 390.2,532.1 365.5,507.5 365.5,466.2 "/>\n        <polygon class="st1" points="704.9,579.5 744.2,579.5 769.8,606.8 769.8,640.1 744.4,665.5 708.6,665.5 683.9,640.9 683.9,599.6 "/>\n        <polygon class="st1" points="543.9,604.6 543.9,565 501.7,565 501.7,604.6 469.7,604.6 469.7,644.5 499,644.5 499,680 548,680 \n          548,642.1 579.1,642.1 579.1,604.6 "/>\n        <polyline class="st2" points="726.9,665.5 726.9,1081.1 508.6,1081.1 "/>\n        <text transform="matrix(1 0 0 1 422.139 1159.5193)" class="st3 st4">MOVE CAMERA</text>\n        <line class="st2" x1="364.1" y1="489.1" x2="13.3" y2="489.1"/>\n        <text transform="matrix(1 0 0 1 14.0386 475.5477)" class="st3 st4">MOVE </text>\n        <text transform="matrix(1 0 0 1 465.3706 178.3926)" class="st3 st4">PAUSE</text>\n        <text transform="matrix(1 0 0 1 1110.3706 529.124)" class="st3 st4">JUMP</text>\n        <text transform="matrix(1 0 0 1 785.1212 178.3926)" class="st3 st4">JUMP FORWARD</text>\n        <polyline class="st2" points="683.9,465.5 683.9,190.4 465.4,190.4 "/>\n        <polyline class="st2" points="786.1,465.5 786.1,190.4 998.4,190.4 "/>\n        <line class="st2" x1="862.8" y1="541.8" x2="1226.4" y2="541.8"/>\n      </svg>\n\n    </div>\n\n    <h2 class="pause__instructions-title pause__instructions-title--keyboard" data-el="keyboardTitle">Keyboard Controls</h2>\n\n    <div class="pause__instruction pause__instruction--keyboard" data-el="instructionR">\n      <svg data-el="svgs" class="pause__svg pause__svg--keyboard" version="1.1"  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n        viewBox="0 0 1104 1110" style="enable-background:new 0 0 1104 1110;" xml:space="preserve"><polygon class="st0" points="509.6,375.9 596.8,374.5 586.3,458.4 506.8,459.8 \t"/>\n      <polygon class="st0" points="83.4,376.3 210.7,376.3 207.2,458.9 83.4,458.9 \t"/>\n      <polygon class="st0" points="80.4,733 610,713.9 603.7,808.9 88.3,808.9 \t"/>\n      <polygon class="st0" points="995.8,723.6 999,814.1 910.5,808.9 915.6,723.6 \t"/>\n      <polygon class="st0" points="888.9,723.6 889,808.9 803.6,814.1 808.1,720.2 \t"/>\n      <polygon class="st0" points="702.9,808.9 698.6,723.6 787.8,723.6 783.9,808.9 \t"/>\n      <polygon class="st0" points="803.7,704.1 803.7,624.8 889,618.8 889,708.9 \t"/>\n      <polygon class="st0" points="503.8,563.9 502.1,650.7 416.8,652.6 418.1,567.2 \t"/>\n      <polygon class="st0" points="392.3,567.4 395.2,652.6 308.4,652.6 309.8,565.4 \t"/>\n      <polygon class="st0" points="204.9,650.7 203.3,562.3 290.2,565.4 287.1,649.1 \t"/>\n      <polygon class="st0" points="312.4,544.1 310,460.5 392.8,460.5 395.3,545.8 \t"/>\n      <polygon class="st0" points="970.4,534.9 961.4,418.5 939.3,362 870.7,325.7 847.6,324.5 785.8,338.9 743.7,389.8 725.3,488.8 \n        724,534.9 "/>\n      <text transform="matrix(1 0 0 1 293.2852 794.2471)" class="st1 st2 st3 st4">SPACE</text>\n      <text transform="matrix(1 0 0 1 343.0938 640.8096)" class="st1 st2 st5 st6">S</text>\n      <text transform="matrix(1 0 0 1 338.0879 534.9444)" class="st1 st2 st5 st6">W</text>\n      <text transform="matrix(1 0 0 1 103.5859 447.2061)" class="st1 st2 st7 st4">esc</text>\n      <text transform="matrix(1 0 0 1 234.8857 634.9932)" class="st1 st2 st8 st6">q</text>\n      <text transform="matrix(1 0 0 1 445.2871 637.9991)" class="st1 st2 st8 st6">d</text>\n      <text transform="matrix(1 0 0 1 535.2871 448.9424)" class="st1 st2 st8 st6">e</text>\n      <polygon class="st1" points="849.1,641.3 864.8,695.8 870.7,693.3 851.6,634.2 846.6,634.2 823.8,682.6 830.6,683.9 "/>\n      <polygon class="st1" points="845.4,790 829.7,735.5 823.8,738 842.9,797.1 847.8,797.1 870.7,748.7 863.8,747.4 "/>\n      <polygon class="st1" points="976.9,768.2 922.3,783.8 924.8,789.8 984,770.6 984,765.7 935.6,742.8 934.3,749.7 "/>\n      <polygon class="st1" points="717.5,764.4 772.1,748.7 769.6,742.8 710.4,762 710.4,766.9 758.9,789.8 760.2,782.9 "/>\n      <polygon class="st1" points="847.2,348.5 840.5,355.3 840.5,395.1 847.2,404.1 854,395.1 854,355.3 "/>\n      <polyline class="st9" points="28.8,262.8 197.8,262.8 197.8,376.3 "/>\n      <polyline class="st9" points="356.6,118.1 524.9,118.1 524.9,412.2 "/>\n      <polyline class="st9" points="953.2,101.5 785.6,101.5 785.6,379 "/>\n      <line class="st9" x1="650.5" y1="597.2" x2="491.7" y2="597.2"/>\n      <polyline class="st9" points="119.6,767.9 119.6,952.9 250,952.9 "/>\n      <polyline class="st9" points="981.2,789.8 981.2,981.3 821.2,981.3 "/>\n      <text transform="matrix(1 0 0 1 821.1968 1059.8052)" class="st2 st10">MOVE</text>\n      <text transform="matrix(1 0 0 1 134.0644 1030.8073)" class="st2 st10">JUMP</text>\n      <text transform="matrix(1 0 0 1 540.2876 583.167)" class="st2 st10">MOVE</text>\n      <text transform="matrix(1 0 0 1 26.7475 249.2663)" class="st2 st10">PAUSE</text>\n      <text transform="matrix(1 0 0 1 188.5826 105.3511)" class="st2 st10">JUMP FORWARD</text>\n      <text transform="matrix(1 0 0 1 780.4905 86.9612)" class="st2 st10">MOVE CAMERA</text>\n     </svg>\n     \n    </div>\n  </div>\n\n  <div data-component="Credits"></div>\n  <div data-component="XmasLove"></div>\n\n</div>\n'},function(e,t){e.exports='<div class="pause-btn">\n  <div class="pause-btn__bg" data-el="bg"></div>\n  <div class="pause-btn__part pause-btn__part--l" data-el="part"></div>\n  <div class="pause-btn__part pause-btn__part--r" data-el="part"></div>\n</div>\n'},function(e,t){e.exports='<div class="death-overlay">\n\n  <div class="death-overlay__title" data-el="title">\n    <span data-el="titleContent">Wasted</span>\n  </div>\n\n  <p class="death-overlay__desc" data-el="desc">\n  </p>\n</div>\n'},function(e,t){e.exports='<div class="key-counter">\n  <div class="key-counter__bg" data-el="bg"></div>\n  <div class="key-counter__current" data-el="current"></div>\n  <div class="key-counter__slash" data-el="slash">/</div>\n  <div class="key-counter__total" data-el="total">3</div>\n  <div class="key-counter__key" data-el="key"></div>\n</div>\n'},function(e,t){e.exports='{% set name = \'lobby\' %}\n<div class="page {{name}} {{name}}--animation-in {{name}}--animation-in-timing">\n  <div data-component="PauseBtn"></div>\n  <div data-component="Pause"></div>\n  <div data-component="DeathOverlay"></div>\n  <div data-component="KeyCounter"></div>\n\n  <p class="lobby__msg" data-el="msg">\n    <span class="lobby__msg-text">This portal seems locked.<br>It\'s written that I need 3 keys to cross it.</span>\n  </p>\n\n</div>\n'},function(e,t){e.exports='{% set name = \'level\' %}\n<div class="page {{name}} {{sceneName}} {{name}}--animation-in {{name}}--animation-in-timing">\n  <div data-component="PauseBtn"></div>\n  <div data-component="Pause"></div>\n  <div data-component="DeathOverlay"></div>\n  <div data-component="KeyCounter"></div>\n</div>\n'},function(e,t){e.exports='{% set name = \'outro\' %}\n<div class="page {{name}} {{name}}--animation-in {{name}}--animation-in-timing">\n  <div class="outro__cine">\n    <video class="outro__video" preload src="./assets/videos/outro.mp4" data-el="video"></video>\n    <div data-component="Subtitles"></div>\n  </div>\n\n  <div class="outro__ending">\n    <div class="outro__bg" data-el="bg"></div>\n    <h1 class="outro__title" data-el="title">Merry Christmas!</h1>\n    <p class="outro__desc" data-el="desc">We wish you a mery christmas to you and your family</p>\n    <div class="outro__ctas">\n      <a class="outro__cta outro__cta--back" data-el="ctas" rel="internal" href="/"><span>Back to home</span></a>\n      <a class="outro__cta outro__cta--xp" data-el="ctas" href="https://christmasexperiments.com" target="_blank"><span>Other xps</span></a>\n    </div>\n\n    <div data-component="Credits"></div>\n    <div data-component="XmasLove"></div>\n  </div>\n\n</div>\n'},function(e,t){e.exports='<div id="application" class="cursor-loading">\n\n  <div data-component="Preloader" data-ref="preloader"></div>\n\n  <div data-component="Quality" data-ref="quality"></div>\n\n  <div data-component="GL" data-ref="gl" data-scene-name="main"></div>\n\n  <div data-component="Instructions"></div>\n\n  <div data-component="ToastMsg"></div>\n  \n  <div id="router-view" data-el="router"></div>\n\n  <div data-component="SoundBars"></div>\n\n  <div data-component="Fullscreen"></div>\n\n  <div data-component="GamepadInfos"></div>\n  \n  \x3c!-- Konami code for speed run ;) --\x3e\n  <div data-component="Speedrun"></div>\n\n</div>\n'},function(e,t,n){"use strict";n.r(t);var o=n(27),j=n.n(o),r=n(102),C=n.n(r);function h(e){return"/"===e.charAt(0)}function d(e,t){for(var n=t,o=n+1,r=e.length;o<r;n+=1,o+=1)e[n]=e[o];e.pop()}var i=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",n=e&&e.split("/")||[],o=t&&t.split("/")||[],r=e&&h(e),i=t&&h(t),a=r||i;if(e&&h(e)?o=n:n.length&&(o.pop(),o=o.concat(n)),!o.length)return"/";var s=void 0;if(o.length){var u=o[o.length-1];s="."===u||".."===u||""===u}else s=!1;for(var c=0,l=o.length;0<=l;l--){var f=o[l];"."===f?d(o,l):".."===f?(d(o,l),c++):c&&(d(o,l),c--)}if(!a)for(;c--;c)o.unshift("..");!a||""===o[0]||o[0]&&h(o[0])||o.unshift("");var p=o.join("/");return s&&"/"!==p.substr(-1)&&(p+="/"),p},u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var a=function n(t,o){if(t===o)return!0;if(null==t||null==o)return!1;if(Array.isArray(t))return Array.isArray(o)&&t.length===o.length&&t.every(function(e,t){return n(e,o[t])});var e=void 0===t?"undefined":u(t);if(e!==(void 0===o?"undefined":u(o)))return!1;if("object"!==e)return!1;var r=t.valueOf(),i=o.valueOf();if(r!==t||i!==o)return n(r,i);var a=Object.keys(t),s=Object.keys(o);return a.length===s.length&&a.every(function(e){return n(t[e],o[e])})},R=function(e){return"/"===e.charAt(0)?e:"/"+e},s=function(e){return"/"===e.charAt(0)?e.substr(1):e},M=function(e,t){return new RegExp("^"+t+"(\\/|\\?|#|$)","i").test(e)},A=function(e,t){return M(e,t)?e.substr(t.length):e},L=function(e){return"/"===e.charAt(e.length-1)?e.slice(0,-1):e},c=function(e){var t=e||"/",n="",o="",r=t.indexOf("#");-1!==r&&(o=t.substr(r),t=t.substr(0,r));var i=t.indexOf("?");return-1!==i&&(n=t.substr(i),t=t.substr(0,i)),{pathname:t,search:"?"===n?"":n,hash:"#"===o?"":o}},D=function(e){var t=e.pathname,n=e.search,o=e.hash,r=t||"/";return n&&"?"!==n&&(r+="?"===n.charAt(0)?n:"?"+n),o&&"#"!==o&&(r+="#"===o.charAt(0)?o:"#"+o),r},l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},z=function(e,t,n,o){var r=void 0;"string"==typeof e?(r=c(e)).state=t:(void 0===(r=l({},e)).pathname&&(r.pathname=""),r.search?"?"!==r.search.charAt(0)&&(r.search="?"+r.search):r.search="",r.hash?"#"!==r.hash.charAt(0)&&(r.hash="#"+r.hash):r.hash="",void 0!==t&&void 0===r.state&&(r.state=t));try{r.pathname=decodeURI(r.pathname)}catch(e){throw e instanceof URIError?new URIError('Pathname "'+r.pathname+'" could not be decoded. This is likely caused by an invalid percent-encoding.'):e}return n&&(r.key=n),o?r.pathname?"/"!==r.pathname.charAt(0)&&(r.pathname=i(r.pathname,o.pathname)):r.pathname=o.pathname:r.pathname||(r.pathname="/"),r},S=function(e,t){return e.pathname===t.pathname&&e.search===t.search&&e.hash===t.hash&&e.key===t.key&&a(e.state,t.state)},H=function(){var i=null,o=[];return{setPrompt:function(e){return j()(null==i,"A history supports only one prompt at a time"),i=e,function(){i===e&&(i=null)}},confirmTransitionTo:function(e,t,n,o){if(null!=i){var r="function"==typeof i?i(e,t):i;"string"==typeof r?"function"==typeof n?n(r,o):(j()(!1,"A history needs a getUserConfirmation function in order to use a prompt message"),o(!0)):o(!1!==r)}else o(!0)},appendListener:function(e){var t=!0,n=function(){t&&e.apply(void 0,arguments)};return o.push(n),function(){t=!1,o=o.filter(function(e){return e!==n})}},notifyListeners:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];o.forEach(function(e){return e.apply(void 0,t)})}}},I=!("undefined"==typeof window||!window.document||!window.document.createElement),F=function(e,t,n){return e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)},N=function(e,t,n){return e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent("on"+t,n)},U=function(e,t){return t(window.confirm(e))},B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},V=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},G="hashchange",$=function(){try{return window.history.state||{}}catch(e){return{}}},f=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};C()(I,"Browser history needs a DOM");var t,s=window.history,u=(-1===(t=window.navigator.userAgent).indexOf("Android 2.")&&-1===t.indexOf("Android 4.0")||-1===t.indexOf("Mobile Safari")||-1!==t.indexOf("Chrome")||-1!==t.indexOf("Windows Phone"))&&window.history&&"pushState"in window.history,n=!(-1===window.navigator.userAgent.indexOf("Trident")),o=e.forceRefresh,c=void 0!==o&&o,r=e.getUserConfirmation,l=void 0===r?U:r,i=e.keyLength,a=void 0===i?6:i,f=e.basename?L(R(e.basename)):"",p=function(e){var t=e||{},n=t.key,o=t.state,r=window.location,i=r.pathname+r.search+r.hash;return j()(!f||M(i,f),'You are attempting to use a basename on a page whose URL path does not begin with the basename. Expected path "'+i+'" to begin with "'+f+'".'),f&&(i=A(i,f)),z(i,o,n)},h=function(){return Math.random().toString(36).substr(2,a)},d=H(),y=function(e){V(S,e),S.length=s.length,d.notifyListeners(S.location,S.action)},v=function(e){void 0===e.state&&-1===navigator.userAgent.indexOf("CriOS")||g(p(e.state))},m=function(){g(p($()))},_=!1,g=function(t){_?(_=!1,y()):d.confirmTransitionTo(t,"POP",l,function(e){e?y({action:"POP",location:t}):b(t)})},b=function(e){var t=S.location,n=O.indexOf(t.key);-1===n&&(n=0);var o=O.indexOf(e.key);-1===o&&(o=0);var r=n-o;r&&(_=!0,k(r))},w=p($()),O=[w.key],x=function(e){return f+D(e)},k=function(e){s.go(e)},E=0,P=function(e){1===(E+=e)?(F(window,"popstate",v),n&&F(window,G,m)):0===E&&(N(window,"popstate",v),n&&N(window,G,m))},T=!1,S={length:s.length,action:"POP",location:w,createHref:x,push:function(e,t){j()(!("object"===(void 0===e?"undefined":B(e))&&void 0!==e.state&&void 0!==t),"You should avoid providing a 2nd state argument to push when the 1st argument is a location-like object that already has state; it is ignored");var a=z(e,t,h(),S.location);d.confirmTransitionTo(a,"PUSH",l,function(e){if(e){var t=x(a),n=a.key,o=a.state;if(u)if(s.pushState({key:n,state:o},null,t),c)window.location.href=t;else{var r=O.indexOf(S.location.key),i=O.slice(0,-1===r?0:r+1);i.push(a.key),O=i,y({action:"PUSH",location:a})}else j()(void 0===o,"Browser history cannot push state in browsers that do not support HTML5 history"),window.location.href=t}})},replace:function(e,t){j()(!("object"===(void 0===e?"undefined":B(e))&&void 0!==e.state&&void 0!==t),"You should avoid providing a 2nd state argument to replace when the 1st argument is a location-like object that already has state; it is ignored");var i=z(e,t,h(),S.location);d.confirmTransitionTo(i,"REPLACE",l,function(e){if(e){var t=x(i),n=i.key,o=i.state;if(u)if(s.replaceState({key:n,state:o},null,t),c)window.location.replace(t);else{var r=O.indexOf(S.location.key);-1!==r&&(O[r]=i.key),y({action:"REPLACE",location:i})}else j()(void 0===o,"Browser history cannot replace state in browsers that do not support HTML5 history"),window.location.replace(t)}})},go:k,goBack:function(){return k(-1)},goForward:function(){return k(1)},block:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=d.setPrompt(e);return T||(P(1),T=!0),function(){return T&&(T=!1,P(-1)),t()}},listen:function(e){var t=d.appendListener(e);return P(1),function(){P(-1),t()}}};return S},q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},W="hashchange",Y={hashbang:{encodePath:function(e){return"!"===e.charAt(0)?e:"!/"+s(e)},decodePath:function(e){return"!"===e.charAt(0)?e.substr(1):e}},noslash:{encodePath:s,decodePath:R},slash:{encodePath:R,decodePath:R}},K=function(){var e=window.location.href,t=e.indexOf("#");return-1===t?"":e.substring(t+1)},X=function(e){var t=window.location.href.indexOf("#");window.location.replace(window.location.href.slice(0,0<=t?t:0)+"#"+e)},p=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};C()(I,"Hash history needs a DOM");var t=window.history,n=-1===window.navigator.userAgent.indexOf("Firefox"),o=e.getUserConfirmation,i=void 0===o?U:o,r=e.hashType,a=void 0===r?"slash":r,s=e.basename?L(R(e.basename)):"",u=Y[a],c=u.encodePath,l=u.decodePath,f=function(){var e=l(K());return j()(!s||M(e,s),'You are attempting to use a basename on a page whose URL path does not begin with the basename. Expected path "'+e+'" to begin with "'+s+'".'),s&&(e=A(e,s)),z(e)},p=H(),h=function(e){q(T,e),T.length=t.length,p.notifyListeners(T.location,T.action)},d=!1,y=null,v=function(){var e=K(),t=c(e);if(e!==t)X(t);else{var n=f(),o=T.location;if(!d&&S(o,n))return;if(y===D(n))return;y=null,m(n)}},m=function(t){d?(d=!1,h()):p.confirmTransitionTo(t,"POP",i,function(e){e?h({action:"POP",location:t}):_(t)})},_=function(e){var t=T.location,n=O.lastIndexOf(D(t));-1===n&&(n=0);var o=O.lastIndexOf(D(e));-1===o&&(o=0);var r=n-o;r&&(d=!0,x(r))},g=K(),b=c(g);g!==b&&X(b);var w=f(),O=[D(w)],x=function(e){j()(n,"Hash history go(n) causes a full page reload in this browser"),t.go(e)},k=0,E=function(e){1===(k+=e)?F(window,W,v):0===k&&N(window,W,v)},P=!1,T={length:t.length,action:"POP",location:w,createHref:function(e){return"#"+c(s+D(e))},push:function(e,t){j()(void 0===t,"Hash history cannot push state; it is ignored");var a=z(e,void 0,void 0,T.location);p.confirmTransitionTo(a,"PUSH",i,function(e){if(e){var t,n=D(a),o=c(s+n);if(K()!==o){y=n,t=o,window.location.hash=t;var r=O.lastIndexOf(D(T.location)),i=O.slice(0,-1===r?0:r+1);i.push(n),O=i,h({action:"PUSH",location:a})}else j()(!1,"Hash history cannot PUSH the same path; a new entry will not be added to the history stack"),h()}})},replace:function(e,t){j()(void 0===t,"Hash history cannot replace state; it is ignored");var r=z(e,void 0,void 0,T.location);p.confirmTransitionTo(r,"REPLACE",i,function(e){if(e){var t=D(r),n=c(s+t);K()!==n&&(y=t,X(n));var o=O.indexOf(D(T.location));-1!==o&&(O[o]=t),h({action:"REPLACE",location:r})}})},go:x,goBack:function(){return x(-1)},goForward:function(){return x(1)},block:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=p.setPrompt(e);return P||(E(1),P=!0),function(){return P&&(P=!1,E(-1)),t()}},listen:function(e){var t=p.appendListener(e);return E(1),function(){E(-1),t()}}};return T},v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},_=function(e,t,n){return Math.min(Math.max(e,t),n)},y=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.getUserConfirmation,t=e.initialEntries,n=void 0===t?["/"]:t,o=e.initialIndex,i=void 0===o?0:o,a=e.keyLength,s=void 0===a?6:a,u=H(),c=function(e){m(y,e),y.length=y.entries.length,u.notifyListeners(y.location,y.action)},l=function(){return Math.random().toString(36).substr(2,s)},f=_(i,0,n.length-1),p=n.map(function(e){return z(e,void 0,"string"==typeof e?l():e.key||l())}),h=D,d=function(e){var t=_(y.index+e,0,y.entries.length-1),n=y.entries[t];u.confirmTransitionTo(n,"POP",r,function(e){e?c({action:"POP",location:n,index:t}):c()})},y={length:p.length,action:"POP",location:p[f],index:f,entries:p,createHref:h,push:function(e,t){j()(!("object"===(void 0===e?"undefined":v(e))&&void 0!==e.state&&void 0!==t),"You should avoid providing a 2nd state argument to push when the 1st argument is a location-like object that already has state; it is ignored");var o=z(e,t,l(),y.location);u.confirmTransitionTo(o,"PUSH",r,function(e){if(e){var t=y.index+1,n=y.entries.slice(0);n.length>t?n.splice(t,n.length-t,o):n.push(o),c({action:"PUSH",location:o,index:t,entries:n})}})},replace:function(e,t){j()(!("object"===(void 0===e?"undefined":v(e))&&void 0!==e.state&&void 0!==t),"You should avoid providing a 2nd state argument to replace when the 1st argument is a location-like object that already has state; it is ignored");var n=z(e,t,l(),y.location);u.confirmTransitionTo(n,"REPLACE",r,function(e){e&&(y.entries[y.index]=n,c({action:"REPLACE",location:n}))})},go:d,goBack:function(){return d(-1)},goForward:function(){return d(1)},canGo:function(e){var t=y.index+e;return 0<=t&&t<y.entries.length},block:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];return u.setPrompt(e)},listen:function(e){return u.appendListener(e)}};return y};n.d(t,"createBrowserHistory",function(){return f}),n.d(t,"createHashHistory",function(){return p}),n.d(t,"createMemoryHistory",function(){return y}),n.d(t,"createLocation",function(){return z}),n.d(t,"locationsAreEqual",function(){return S}),n.d(t,"parsePath",function(){return c}),n.d(t,"createPath",function(){return D})}]);