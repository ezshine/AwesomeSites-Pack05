System.register("chunks:///cosmos.js",["./relative-camera-925721c5.js","./index-44e09375.js","cc"],(function(){var t,e,i,n,a,o,r,s,l,c,u,h,d,p,f,_,g,m,v,b,y,w,C,S,L,A,T,E,I,k,R,P,O,N,z,D,x,M,F,G,V,B,H,U,Z,W,q,Y,j,K,X,J,Q,$,tt,et,it,nt,at,ot,rt,st,lt,ct,ut,ht,dt,pt,ft,_t,gt,mt,vt,bt,yt,wt,Ct,St,Lt,At,Tt,Et,It,kt,Rt,Pt,Ot,Nt,zt,Dt,xt,Mt,Ft,Gt,Vt,Bt,Ht,Ut,Zt,Wt,qt,Yt,jt,Kt,Xt,Jt,Qt,$t,te,ee,ie,ne,ae,oe,re,se,le,ce,ue,he,de,pe,fe,_e,ge,me,ve,be,ye,we;return{setters:[function(dt){t=dt.a,e=dt.u,i=dt.s,n=dt.C,a=dt.b,o=dt.G,r=dt.S,s=dt.L,l=dt.c,c=dt.U,u=dt.t,h=dt.K,d=dt.R,p=dt.d,f=dt.v,_=dt.p,g=dt.e,m=dt.f,v=dt.V,b=dt.g,y=dt.T,w=dt.h,C=dt.i,S=dt.j,L=dt.k,A=dt.l,T=dt.m,E=dt.n,I=dt.F,k=dt.o,R=dt.q,P=dt.r,O=dt.w,N=dt.x,z=dt.y,D=dt.z,x=dt.A,M=dt.B,F=dt.D,G=dt.P,V=dt.E,B=dt.H,H=dt.I,U=dt.J,Z=dt.M,W=dt.N,q=dt.O,Y=dt.Q,j=dt.W,K=dt.X,X=dt.Y,J=dt.Z,Q=dt._,$=dt.$,tt=dt.a0,et=dt.a1,it=dt.a2,nt=dt.a3,at=dt.a4,ot=dt.a5,rt=dt.a6,st=dt.a7,lt=dt.a8,ct=dt.a9,ut=dt.aa,ht=dt.ab},function(t){dt=t.a,pt=t.g,ft=t._,_t=t.b,gt=t.c,mt=t.h,vt=t.i,bt=t.M,yt=t.j,wt=t.T,Ct=t.d,St=t.k,Lt=t.l,At=t.I,Tt=t.N,Et=t.t,It=t.s,kt=t.C,Rt=t.e,Pt=t.f,Ot=t.m},function(t){Nt=t.cclegacy,zt=t._decorator,Dt=t.MeshRenderer,xt=t.Color,Mt=t.Vec4,Ft=t.Component,Gt=t.Label,Vt=t.Node,Bt=t.Slider,Ht=t.BlockInputEvents,Ut=t.Sprite,Zt=t.Toggle,Wt=t.Vec3,qt=t.Layout,Yt=t.Button,jt=t.UITransform,Kt=t.ToggleContainer,Xt=t.Tween,Jt=t.tween,Qt=t.profiler,$t=t.Widget,te=t.Vec2,ee=t.Camera,ie=t.gfx,ne=t.UIOpacity,ae=t.screen,oe=t.geometry,re=t.PhysicsSystem,se=t.view,le=t.Animation,ce=t.sys,ue=t.ScrollView,he=t.Prefab,de=t.JsonAsset,pe=t.instantiate,fe=t.Material,_e=t.ParticleSystem,ge=t.macro,me=t.resources,ve=t.Texture2D,be=t.GeometryRenderer,ye=t.Mat4,we=t.game}],execute:function(){var Ce;Nt._RF.push({},"bb51306QqFC2p/BV9HW/3my","cylinder-scope",void 0);(0,zt.ccclass)("cocosmos.CylinderScope")(Ce=function(o){function r(){for(var t,e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return(t=o.call.apply(o,[this].concat(i))||this)._mat=void 0,t._mat_line=void 0,t._handle_line=void 0,t._title=void 0,t._desc=void 0,t._color=new xt,t}dt(r,o);var s=r.prototype;return s.onLoad=function(){this._init()._loadParams()},s.lateUpdate=function(){var i=this.node.worldScale,n=(i.x+i.y+i.z)/3,a=t(n,xe);this._lineStrength(a),e.showNotes&&a>0&&n<1.2?(this._title.target=this._desc.target=this.node,this._title.alpha=this._desc.alpha=a):this._title.target=this._desc.target=null},s.onDisable=function(){this._title.target=this._desc.target=null},s._init=function(){this._mat=this.getComponent(Dt).material,this._mat_line=this.node.getChildByName("lines").getComponent(Dt).material,this._handle_line=this._mat_line.passes[0].getHandle("mainColor"),this._title=i(n.claim("ruler","scope.title"),"ruler","title"),this._desc=i(n.claim("ruler","scope.desc"),"ruler");var t=pt(Re,Pe);return[this._title,this._desc].forEach((function(e){return e.camera=t})),this._title.setOffset(0,.65*this.node.scale.y,0),this._desc.setOffset(0,.55*this.node.scale.y,0),this},s._loadParams=function(){var t,e,i=this.node.parent.name,n=a.Scopes[i],o=null!=(t=n[3])?t:[1,1,1],r=o[0],s=o[1],l=o[2];if(this.node.setScale(r,s,l),null!=n&&n[4]){var c=n[4],u=c.x,h=c.y,d=c.z;this.node.setPosition(u,h,d)}this.node.name="Scope of "+i,this._color.set(null!=(e=De[i])?e:xt.WHITE),this._mat.setProperty("mainColor",this._setAlpha(ze)),this._mat.setProperty("scaleAtte",Ne.set.apply(Ne,xe)),this._lineStrength(0),this._title.key="scopes@"+i+"-title",this._desc.key="scopes@"+i+"-desc"},s._lineStrength=function(t){this._mat_line.passes[0].setUniform(this._handle_line,this._setAlpha(t))},s._setAlpha=function(t){return Oe.set(this._color),Oe.r*=t,Oe.g*=t,Oe.b*=t,Oe},r}(Ft));var Se,Le,Ae,Te,Ee,Ie,ke,Re=r.COSMOS,Pe=r.Cameras.MAIN,Oe=new xt,Ne=new Mt,ze=.3,De=o.ScopeColor,xe=o.ScopeAtt;Nt._RF.pop(),Nt._RF.push({},"18388yY1EJEmItjmwXkbDe3","foot-bar",void 0);var Me,Fe,Ge,Ve,Be,He,Ue,Ze,We,qe,Ye,je,Ke,Xe,Je,Qe=zt.ccclass,$e=zt.property,ti=(Se=Qe("cocosmos.foot-bar"),Le=$e(Gt),Ae=$e(s),Se((Ie=ft((Ee=function(t){function i(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return e=t.call.apply(t,[this].concat(n))||this,_t(e,"lensVel",Ie,gt(e)),_t(e,"escVel",ke,gt(e)),e._rc=void 0,e}dt(i,t);var n=i.prototype;return n.onLoad=function(){this._init(),this._listen()},n.start=function(){this._updateStates()},n.update=function(t){var e=l.pow10;if(this.lensVel.node.activeInHierarchy&&(this.lensVel.string=this._cameraAbsoluteVelocity),this.escVel.node.activeInHierarchy){var i=ii.findIndex((function(t){return e<t}));this.escVel.string="bars@cv-"+i,this.escVel.getComponent(Gt).color=ni[i]}},n.onLensPanelParams=function(){this._updateStates()},n._init=function(){this._rc=mt(ei,ti).getComponent("cocosmos.relative-camera")},n._listen=function(){this.on(c.LENS_PARAMS,this.onLensPanelParams)},n._updateStates=function(){this.lensVel.node.parent.active=e.showLensVel,this.escVel.node.parent.active=e.showEscVel},vt(i,[{key:"_cameraAbsoluteVelocity",get:function(){var t,e=l.pow10,i=l.delta,n=this._rc.angularVelocity,a=Math.parseRadian(n),o=Math.abs(10*i),r=Math.sqrt(Math.sumSqr(a,o)),s=(Math.pow(10,e)*r*h).toExponential().split("e"),c=s[0],d=s[1],p=c.replace(".",""),f=p.length,_=+d;if(_<3)return"0km/s";if(f>_)t=p.substring(0,_+1);else{var g=_+1-f;t=p+(Math.random()+"").replace(".","").substring(0,g)}return u(t)+" km/s"}}]),i}(bt)).prototype,"lensVel",[Le],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ke=ft(Ee.prototype,"escVel",[Ae],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Te=Ee)),r.COSMOS),ei=r.Cameras.MAIN,ii=[-99,-8,-6.5,-4,-1,4,7,99],ni=[xt.GRAY,new xt(197,197,197,255),new xt(132,233,186,255),new xt(0,255,32,255),new xt(255,162,0,255),new xt(255,102,102,255),new xt(255,105,236,255),new xt(136,161,255,255)];Nt._RF.pop(),Nt._RF.push({},"aa7ecVAk9tB/6qro99UtAc6","left-menu",void 0);var ai,oi,ri,si,li,ci,ui,hi,di,pi,fi,_i,gi,mi,vi,bi,yi,wi,Ci,Si=yt,Li=Lt,Ai=zt.ccclass,Ti=(zt.property,Me=Ai("cocosmos.left-menu"),Fe=Si("Scale","",Vt),Ge=Si("Scale","",Bt),Ve=Si("Scale","",Vt),Be=Si("Scale","",Ht),He=Si("Intro","",Vt),Ue=Si("Intro","",s),Me((qe=ft((We=function(t){function i(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return e=t.call.apply(t,[this].concat(n))||this,_t(e,"scaleGroup",qe,gt(e)),_t(e,"scalar",Ye,gt(e)),_t(e,"visibleList",je,gt(e)),_t(e,"blocker",Ke,gt(e)),_t(e,"introGroup",Xe,gt(e)),_t(e,"introName",Je,gt(e)),e._scaleBar=null,e._twsScale=void 0,e._twsIntro=void 0,e._map=new Map,e._reducing=!1,e._lang=null,e._prefix=void 0,e._actual=void 0,e}dt(i,t);var n=i.prototype;return n.onLoad=function(){this._init(),this._listen()},n.start=function(){this.scaleGroup.active=this.introGroup.active=!1,this._initToggleStates()},n.update=function(t){this._reducing&&this.scalar.progress>0&&(this.scalar.progress-=t/Oi,this.scalar.progress<=0&&(this.scalar.progress=0,this._reducing=!1),this.notify(Ti.RATIO,this.scalar.progress)),this.scaleGroup.active=l.underSolar},n._init=function(){var t,e,i=this;this._scaleBar=Li(Ut,this.scalar,"Bar"),this._twsScale=this.scaleGroup.getComponent(wt),this._twsIntro=this.introGroup.getComponent(wt),this._prefix=null!=(t=Ct.res.getConfigItem(d.Configs.I18N,"diameter"))?t:{},this._actual=null!=(e=Ct.res.getConfigItem(d.Configs.I18N,"actual"))?e:{},this.visibleList.children.forEach((function(t,e){i._map.set(t.name,{toggle:t.getComponent(Zt),disable:t.getComponent(Ut),ratio:Li(Gt,t,"Ratio"),title:Li(Gt,t,"Title"),hidden:Li(Gt,t,"Hidden"),type:Pi[e]})}))},n._initToggleStates=function(){var t=this;this.visibleList.children.forEach((function(e){var i=t._map.get(e.name).toggle,n=!!p.getStateByName(e.name);i.setIsCheckedWithoutNotify(n),t.toggleVisibility(i,!1)})),this.scalar.progress=p.magnifyRatio},n._listen=function(){this.on(ki.ZOOM_START,this.onVisitStart),this.on(ki.VISIT_OVER,this.onVisitOver),this.on(Ri.RATIO_CHANGE,this.onRatioChanged),this.on(Ei.CLOSE,this.onPanelClosed),this.on(c.VISIBLE,this.onVisibleChanged)},n.onVisitStart=function(){this.scaleGroup.activeInHierarchy&&(this.blocker.enabled=!0,this._reducing=!0,this._twsScale.hideDelay=this.scalar.progress*Oi,this._twsScale.hide()),this.introGroup.activeInHierarchy&&this._twsIntro.hide(!0)},n.onVisitOver=function(){var t=f.inSolar,e=f.inPlanetary,i=f.inSatellite,n=f.centerName;if(t&&(this.blocker.enabled=!1,this._twsScale.show()),e||i){var a=_.unbelt?n:_.centerName;this._twsIntro.show(!0),this.introName.string="celestial@"+a}},n.onVisibleChanged=function(t,e,i){if(i&&this.visibleList.getChildByName(t)){var n=this._map.get(t).toggle;n.setIsCheckedWithoutNotify(e),this.toggleVisibility(n,!1)}},n.toggleVisibility=function(t,e){void 0===e&&(e=!0);var i=t.node.name,n=t.isChecked,a=this._map.get(i),o=a.disable,r=a.ratio,s=a.title,l=a.hidden;o.enabled=!n,s.color=n?g:m,r.node.active=n,l.node.active=!n;var c=Ti.SUN.split(".").head+"."+i;e&&this.notify(c,n),e&&this.notify(Ii,i,n)},n.openIntroPanel=function(){this._twsIntro.hide(!0),this.notify(Ei.OPEN,d.Prefabs.INTRO_PANEL,"bottom")},n.onPanelClosed=function(t,e){t===d.Prefabs.INTRO_PANEL&&e&&this._twsIntro.show(!0)},n.slideScalar=function(){var t=this.scalar.progress;this.notify(Ti.RATIO,t)},n.onRatioChanged=function(t){for(var e,i=this._prefix[this._lang],n=this._actual[this._lang],a=null!=t?t:this.scalar.progress,o=St(this._map);!(e=o()).done;){var r=e.value[1];r.ratio.string=a<0?n:i+" × "+Math.round(p.getMagnified(r.type))}this._scaleBar.fillRange=a},n.lateUpdate=function(){e.language!=this._lang&&(this._lang=e.language,this.onRatioChanged())},i}(bt)).prototype,"scaleGroup",[Fe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ye=ft(We.prototype,"scalar",[Ge],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),je=ft(We.prototype,"visibleList",[Ve],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ke=ft(We.prototype,"blocker",[Be],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Xe=ft(We.prototype,"introGroup",[He],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Je=ft(We.prototype,"introName",[Ue],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ze=We)),c.Solar),Ei=c.Panels,Ii=c.VISIBLE,ki=v.Transform,Ri=v.Scale,Pi=["sun","planet","dwarf","minor","comet","belts"],Oi=2;Nt._RF.pop(),Nt._RF.push({},"b5c67k7D2BM75u2I9ENZUoY","right-menu",void 0);var Ni,zi,Di,xi,Mi,Fi=zt.ccclass,Gi=zt.property,Vi=(ai=Fi("cocosmos.right-menu"),oi=Gi(Vt),ri=Gi(Vt),si=Gi(Vt),li=Gi(Vt),ci=Gi(Vt),ui=Gi(Vt),hi=Gi(Vt),di=Gi(Vt),ai((_i=ft((fi=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return e=t.call.apply(t,[this].concat(n))||this,_t(e,"localLine",_i,gt(e)),_t(e,"btnTideLock",gi,gt(e)),_t(e,"btnLunar",mi,gt(e)),_t(e,"btnEquatorial",vi,gt(e)),_t(e,"btnEcliptic",bi,gt(e)),_t(e,"btnMagnetics",yi,gt(e)),_t(e,"btnDiameter",wi,gt(e)),_t(e,"btnAxis",Ci,gt(e)),e._tws=void 0,e}dt(e,t);var i=e.prototype;return i.onLoad=function(){this._init(),this._listen()},i.start=function(){this.localLine.active=!1,this._initToggleEventAndStates()},i._init=function(){this._tws=this.localLine.getComponent(wt)},i._listen=function(){this.on(Vi.ZOOM_START,this.onVisitStart),this.on(Vi.VISIT_OVER,this.onVisitOver)},i.onVisitStart=function(){this._tws.hide(!0)},i.onVisitOver=function(){this._resetUIByScope(),this._tws.show(!0)},i._resetUIByScope=function(){var t=f.inPlanet,e=f.inPlanetary,i=f.inSatellite,n=f.centerName,a=f.inType;this.btnAxis.active=this.btnDiameter.active=e&&"belts"!==a&&"comet"!==a||i,this.btnMagnetics.active=this.btnEcliptic.active=this.btnEquatorial.active=t,this.btnLunar.active=t&&"Earth"===n,this.btnTideLock.active=!1},i.toggleInList=function(t){var e=t.isChecked;t.getComponent(Ut).enabled=!e;var i=t.node.name,n=Bi.AXIS.split(".").head+"."+i;this.notify(n,e)},i._initToggleEventAndStates=function(){var t=this;this.localLine.getComponentsInChildren(Zt).forEach((function(e){var i=_.getStateByName(e.node.name);e.setIsCheckedWithoutNotify(i),e.getComponent(Ut).enabled=!i,e.node.on(Zt.EventType.TOGGLE,t.toggleInList,t)}))},e}(bt)).prototype,"localLine",[oi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),gi=ft(fi.prototype,"btnTideLock",[ri],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),mi=ft(fi.prototype,"btnLunar",[si],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),vi=ft(fi.prototype,"btnEquatorial",[li],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),bi=ft(fi.prototype,"btnEcliptic",[ci],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),yi=ft(fi.prototype,"btnMagnetics",[ui],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),wi=ft(fi.prototype,"btnDiameter",[hi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ci=ft(fi.prototype,"btnAxis",[di],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),pi=fi)),v.Transform),Bi=c.Local;Nt._RF.pop(),Nt._RF.push({},"03df6rkHf5JPolu3HaR7nl/","scale-bar",void 0);var Hi,Ui,Zi,Wi,qi,Yi,ji,Ki,Xi,Ji,Qi,$i=zt.ccclass,tn=zt.property,en=(Ni=$i("cocosmos.scale-bar"),zi=tn(Vt),Ni((Mi=ft((xi=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return e=t.call.apply(t,[this].concat(n))||this,_t(e,"handle",Mi,gt(e)),e}dt(e,t);var i=e.prototype;return i.start=function(){an.set(this.handle.position)},i.update=function(){an.y=l.pow10*en+nn,this.handle.setPosition(an)},e}(bt)).prototype,"handle",[zi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Di=xi)),-18.5),nn=-41,an=new Wt;Nt._RF.pop(),Nt._RF.push({},"581d9A7IQlJ4Ys55vjVk5Na","setting-menu",void 0);var on,rn,sn,ln,cn,un,hn,dn,pn,fn,_n,gn,mn,vn=zt.ccclass,bn=zt.property,yn=(Hi=vn("cocosmos.setting-menu"),Ui=bn(Vt),Zi=bn(Vt),Wi=bn(Vt),qi=bn(wt),Hi((Ki=ft((ji=function(t){function i(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return e=t.call.apply(t,[this].concat(n))||this,_t(e,"settingTgl",Ki,gt(e)),_t(e,"settingList",Xi,gt(e)),_t(e,"subList",Ji,gt(e)),_t(e,"topLine",Qi,gt(e)),e._twn_list=void 0,e._btn_list=void 0,e._twn_tgl=void 0,e}dt(i,t);var n=i.prototype;return n.onLoad=function(){this._init(),this._listen()},n.toggleLanguage=function(t){this.notify(c.LANGUAGE,t.isChecked?"en":"cn")},n.toggleFullscreen=function(t){var e=t.isChecked;t.getComponent(Ut).enabled=!e,this.notify(c.FULL_SCREEN,e),Ct.root.fullScreen=e},n.start=function(){this.settingList.active=!1,this.settingList.getComponent(qt).enabled=!1,this._initToggleEventAndStates(),this._initTimerEventAndStates(),this._initLabelsEventAndStates(),this._setToggleDefault(this.settingList.getChildByName("语言").getComponent(Zt),"en"===e.language)},n._init=function(){var t=this;this._twn_list=this.settingList.getComponentsInChildren(wt),this._btn_list=this.settingList.getComponentsInChildren(Yt),this._twn_list.forEach((function(t,e){t.showDistance=t.hideDistance=e*yn,t.showDuration=t.hideDuration=wn})),this._twn_tgl=this.settingTgl.getComponent(wt),this.scheduleOnce((function(){return t.settingList.getComponent(jt).convertToNodeSpaceAR(t.settingTgl.worldPosition,Cn)}))},n._listen=function(){var t=this;this.settingList.getComponentsInChildren(Zt).forEach((function(e){return e.node.on(Zt.EventType.TOGGLE,t.toggleSetting,t)}))},n.toggleList=function(t){var e=this;t.getComponent(Ut).enabled=!t.isChecked,this.unscheduleAllCallbacks(),t.isChecked?(this.settingList.active=!0,this._shows(this._twn_list,wt.EffectType.FADE_SLIDE)):(this.scheduleOnce((function(){return e.settingList.active=!1}),wn),this._hides(this._twn_list,wt.EffectType.FADE_SLIDE))},n._checkCultTexTask=function(t){"星际"!==t||b.LoadTexTaskLaunched||(b.LoadTexTaskLaunched=!0,this.notify(y.Load.DYNAMIC_TEX,w.TEX_CONST_NORTH),this.notify(y.Load.DYNAMIC_TEX,w.TEX_CONST_SOUTH))},n.toggleSetting=function(t){t.getComponent(Ut).enabled=!t.isChecked;var e=this.subList.children.find((function(e){return e.name===t.node.name}));if(e){var i=this._twn_list.copy().remove(t.getComponent(wt)),n=this._btn_list.copy().remove(t.getComponent(Yt));t.isChecked?(this.subList.children.forEach((function(t){return t.active=!1})),this._twn_tgl.hide(),this._hides(i,wt.EffectType.FADE),this._interactable(n,!1),this._slide(t,!0),e.getComponent(wt).show(!0),this._checkCultTexTask(t.node.name)):(this._twn_tgl.show(),this._interactable(n,!0),this._shows(i,wt.EffectType.FADE),this._slide(t,!1),e.getComponent(wt).hide(!0))}},n.toggleStarNameType=function(t){t.getComponent(Ut).enabled=!t.isChecked;var e=+t.node.name,i=c.Labels.STAR_NAME_TYPE;t.isChecked&&(console.log("=>",i,e),this.notify(i,e))},n.toggleStarNameLevel=function(t){t.getComponent(Ut).enabled=!t.isChecked;var e=+t.node.name,i=c.Labels.STAR_NAME_LEVEL;t.isChecked?(console.log("=>",i,e),this.notify(i,e)):t.node.parent.getComponent(Kt).anyTogglesChecked()||(console.log("=>",i,C.NONE),this.notify(i,C.NONE))},n.openLensPanel=function(){this.notify(c.Panels.OPEN,d.Prefabs.LENS_PANEL)},n.onTimer=function(t){t.getComponent(Ut).enabled=!t.isChecked;var e=t.node.name;S.accelerate(+e)},n._interactable=function(t,e){t.forEach((function(t){return t.interactable=e}))},n._slide=function(t,e){Xt.stopAllByTarget(t.node),e?(Sn.x=t.node.position.x,Jt(t.node).to(wn,{position:Cn},{easing:"sineOut"}).start()):Jt(t.node).to(wn,{position:Sn},{easing:"sineOut"}).start()},n._shows=function(t,e,i){isNullish(e)||t.forEach((function(t){return t.showType=e})),i&&t.forEach((function(t){var e=t.getComponent(Yt);e&&(e.interactable=!0)})),t.forEach((function(t){return t.show()}))},n._hides=function(t,e,i){isNullish(e)||t.forEach((function(t){return t.hideType=e})),t.forEach((function(t){return t.hide()}))},n.toggleMusic=function(t){var e=!t.isChecked;t.getComponent(Ut).enabled=e,Ct.audio.mute=e},n.toggleStats=function(t){var e=!t.isChecked;t.getComponent(Ut).enabled=e,e?Qt.hideStats():Qt.showStats()},n.clickGuide=function(){this.notify(c.Panels.OPEN,d.Prefabs.GUIDE_PANEL)},n.clickBorders=function(){this.notify(c.Popups.TIP_LINE,"todos@dev")},n.clickSync=function(){this.notify(c.Popups.TIP_LINE,"todos@dev")},n.clickStory=function(){this.notify(c.Popups.TIP_LINE,"todos@stories")},n.toggleInSubList=function(t){t.getComponent(Ut).enabled=!t.isChecked;var e=t.isChecked,i=t.node,n=i.name,a=i.parent.name;"天球"===n&&this._relate(t,"时角",!1),"时角"===n&&this._relate(t,"天球",!1);var o="UI:"+a+"."+n;console.log("=>",o,e),this.notify(o,e)},n.clickStars=function(t){var e=t.target.getComponent(Zt),i=!e.isChecked;i&&L.showConstLines?this._relate(e,"连线",!0):!i&&L.showConstLines&&this._relate(e,"连线",!1)},n.clickLines=function(t){var e=t.target.getComponent(Zt);!e.isChecked&&!L.showStars&&(this.notify(c.Stellar.STARS,!0),this._relate(e,"恒星",!0))},n._initLabelsEventAndStates=function(){var t=this,i=this.subList.getChildByName("名称");i.children.forEach((function(i){var n=i.getComponent(Zt);n&&t._setToggleDefault(n,e.getStateByName(n.node.name),!0)}));var n=i.getChildByName("命名");n.getComponentsInChildren(Zt).forEach((function(i){i.node.on(Zt.EventType.TOGGLE,t.toggleStarNameType,t),t._setToggleDefault(i,+i.node.name==e.starNameType)})),n.getComponent(Kt).allowSwitchOff=!1,i.getChildByName("星等").getComponentsInChildren(Zt).forEach((function(i){i.node.on(Zt.EventType.TOGGLE,t.toggleStarNameLevel,t),t._setToggleDefault(i,+i.node.name==e.starNameLevel)}))},n._initTimerEventAndStates=function(){var t=this,e=this.subList.getChildByName("时间");e.getComponentsInChildren(Zt).forEach((function(e){var i=+e.node.name;t._setToggleDefault(e.getComponent(Zt),S.timer===i),e.node.on(Zt.EventType.TOGGLE,t.onTimer,t)})),e.getComponent(Kt).allowSwitchOff=!1},n._initToggleEventAndStates=function(){this._initToggleEventsAndState("标尺",A),this._initToggleEventsAndState("坐标",A),this._initToggleEventsAndState("星际",L)},n._initToggleEventsAndState=function(t,e){var i=this;this.subList.getChildByName(t).getComponentsInChildren(Zt).forEach((function(t){i._setToggleDefault(t,e.getStateByName(t.node.name),!0)}))},n._relate=function(t,e,i){var n,a=null==(n=t.node.parent)||null==(n=n.getChildByName(e))?void 0:n.getComponent(Zt);a&&(a.setIsCheckedWithoutNotify(i),a.getComponent(Ut).enabled=!i)},n._setToggleDefault=function(t,e,i){void 0===i&&(i=!1),t.setIsCheckedWithoutNotify(e),t.getComponent(Ut).enabled=!e,i&&t.node.on(Zt.EventType.TOGGLE,this.toggleInSubList,this)},i}(bt)).prototype,"settingTgl",[Ui],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Xi=ft(ji.prototype,"settingList",[Zi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ji=ft(ji.prototype,"subList",[Wi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Qi=ft(ji.prototype,"topLine",[qi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Yi=ji)),100),wn=.3,Cn=new Wt,Sn=new Wt;Nt._RF.pop(),Nt._RF.push({},"1b31f9mVQJGZqIhr4zHJI4A","state-bar",void 0);var Ln,An,Tn,En,In,kn,Rn,Pn,On,Nn,zn,Dn,xn,Mn,Fn,Gn,Vn,Bn,Hn,Un,Zn,Wn,qn,Yn,jn,Kn=zt.ccclass,Xn=zt.property;on=Kn("cocosmos.state-bar"),rn=Xn(Vt),sn=Xn(Vt),ln=Xn(Vt),cn=Xn(Vt),un=Xn(Vt),on((pn=ft((dn=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return e=t.call.apply(t,[this].concat(n))||this,_t(e,"lensHover",pn,gt(e)),_t(e,"lensPitch",fn,gt(e)),_t(e,"lensZoom",_n,gt(e)),_t(e,"lensLock",gn,gt(e)),_t(e,"listLens",mn,gt(e)),e}dt(e,t);var i=e.prototype;return i.onLoad=function(){this._init()},i._init=function(){this.on(c.LENS_PARAMS,this.onLensPanelParams),this.listLens.children.forEach((function(t){return t.active=!1}))},i.start=function(){T(this.listLens)},i.onLensPanelParams=function(t){var e=t.hover,i=t.pitch,n=t.zoom,a=t.lock;this.lensHover.active=e,this.lensPitch.active=i,this.lensZoom.active=n,this.lensLock.active=a,T(this.listLens)},e}(bt)).prototype,"lensHover",[rn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),fn=ft(dn.prototype,"lensPitch",[sn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_n=ft(dn.prototype,"lensZoom",[ln],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),gn=ft(dn.prototype,"lensLock",[cn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),mn=ft(dn.prototype,"listLens",[un],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),hn=dn));Nt._RF.pop(),Nt._RF.push({},"7e2dbsv/yZIyYuToaoovapp","visit-menu",void 0);var Jn,Qn,$n,ta,ea,ia,na,aa,oa,ra,sa,la,ca,ua,ha,da,pa,fa,_a,ga,ma,va,ba,ya,wa,Ca,Sa,La,Aa,Ta,Ea,Ia,ka,Ra,Pa,Oa,Na,za=yt,Da=(Ln=(0,zt.ccclass)("cocosmos.visit-menu"),An=za("Left","",Vt),Tn=za("Left","",Yt),En=za("Right","",Vt),In=za("Right","",E),kn=za("Right","",E),Rn=za("Right","",Zt),Pn=za("Right","",Zt),On=za("Right","",Zt),Nn=za("Right","",Vt),zn=za("Right","",Vt),Dn=za("Right","",Vt),Ln((Fn=ft((Mn=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return e=t.call.apply(t,[this].concat(n))||this,_t(e,"leftGroup",Fn,gt(e)),_t(e,"visitBtn",Gn,gt(e)),_t(e,"rightGroup",Vn,gt(e)),_t(e,"sunIcon",Bn,gt(e)),_t(e,"planetIcon",Hn,gt(e)),_t(e,"planetExpander",Un,gt(e)),_t(e,"dwarfExpander",Zn,gt(e)),_t(e,"satelliteExpander",Wn,gt(e)),_t(e,"planetList",qn,gt(e)),_t(e,"dwarfList",Yn,gt(e)),_t(e,"satelliteList",jn,gt(e)),e._start=!1,e._scopes=void 0,e._expanders=[],e._satIcons=void 0,e._transf=void 0,e._layoutR=void 0,e._widgetR=void 0,e._twsL=void 0,e._twsR=void 0,e._lists=[],e}dt(e,t);var i=e.prototype;return i.onLoad=function(){this._init(),this._listen()},i.start=function(){this.leftGroup.active=this.rightGroup.active=!1},i.update=function(){var t=l.pow10,e=f.inSolar,i=f.inPlanetary,n=f.inSatellite;this._scopes.forEach((function(e){var a,o=e.node.name,r=Za[o],s=r[0],l=r[1];e.node.active=s<=t&&t<=l,"Planetary"===o&&(a=e.node).active&&(a.active=i&&_.unbelt||n)})),this.sunIcon.node.active=!e||t>-4.5,this.planetIcon.node.active=n,this.rightGroup.active=this._start&&l.underSolar},i._init=function(){this._scopes=this.leftGroup.getComponentsInChildren(Yt).slice(1),this._expanders=[this.planetExpander,this.dwarfExpander,this.satelliteExpander],this._lists=[this.planetList,this.dwarfList,this.satelliteList],this._transf=this.rightGroup.getComponent(jt),this._widgetR=this.rightGroup.getComponent($t),this._layoutR=this.rightGroup.getComponent(qt),this.rightGroup.children.forEach((function(t){return Ba.set(t,{last:!1,from:new Wt,to:new Wt})})),this._twsL=this.leftGroup.getComponent(wt),this._twsR=this.rightGroup.getComponent(wt),this._satIcons=this.satelliteList.getComponent(At),this._loadFixedIcons()},i._loadFixedIcons=function(){this.sunIcon.onDataUpdated(I.SUN),this.planetList.getComponent(At).updateList(I.PLANETS),this.dwarfList.getComponent(At).updateList(I.DWARFS)},i._listen=function(){this.on(Da.ZOOM_START,this.onVisitStart),this.on(Da.VISIT_OVER,this.onVisitOver)},i.clickSearch=function(){this.notify(c.Panels.OPEN,d.Prefabs.VISIT_PANEL)},i.clickScope=function(t){var e=t.target.name,i=xa[e];l.zoomToBy(i,Ma,Math.randomBool()),this.notify(v.Lens.ANGLE_ADDED,0,Fa),this._popHeadingInfo(i,e)},i.onVisitStart=function(){this._twsL.hide(!0),this._twsR.hide()},i.onVisitOver=function(){this._start=!0,this._resetUIByScope(),this._twsL.show(!0),this._twsR.show()},i.expandList=function(t){t.getComponent(Ut).enabled=!t.isChecked;var e=this.rightGroup.getChildByName(t.node.name.replace("Expander:expand","List")),i=this._transf.width;this._record(!0),t.isChecked?(this._foldOthers(t,e),e.active=!0,e.getComponent(qt).updateLayout()):e.active=!1,this._layoutR.updateLayout(),this._widgetR.updateAlignment(),this._record(!1);var n=this._transf.width;Va.x=(n-i)/2,this.rightGroup.children.forEach((function(t){var e=Ba.get(t);if(t.active)if(e.last){var i=e.from,n=e.to;Jt(t).set({position:i.add(Va)}).to(Ga,{position:n},{easing:"sineOut"}).start()}else{var a;null==(a=t.getComponent(wt))||a.resetOrigin().show(!0)}}))},i._popHeadingInfo=function(t,e){Math.abs(t-l.pow10)>Ua&&this.notify(c.Popups.INFO_LINE,"scopes@goto-"+e)},i.clickSolar=function(){var t=p.systemScope;f.inSolar?(l.zoomToBy(t,Ma,Math.randomBool()),this.notify(v.Lens.ANGLE_CHANGE,0,20)):(this.notify(c.VISIT,"Sun","sun",t),this.notify(c.IGNORE_TARGET_ONCE)),this._popHeadingInfo(t,"solar")},i.clickPlanetary=function(){var t=_.centerName,e=_.center,i=e.cat,n=e.rotator,a=_.systemScope,o=f.inPlanetary,r=f.inSatellite;if(o){l.zoomToBy(a,.5);var s=Wt.normalize(Ha,n.up),u=s.x,h=s.y,d=s.z,p=Math.parseDegree(Math.atan2(u,d)),g=Math.parseDegree(Math.atan(h));this.notify(v.Lens.ANGLE_CHANGE,p,g)}else r&&this.notify(c.VISIT,t,i,a);this._popHeadingInfo(a,"planetary")},i.clickSunIcon=function(){f.inSolar?l.zoomToBy(f.center.suggest,.5):this.notify(c.VISIT,"Sun","sun")},i.clickPlanetIcon=function(){var t=f.inPlanetary,e=f.inSatellite,i=_.centerName,n=_.center,a=n.cat,o=n.suggest;t?l.zoomToBy(o,1):e&&this.notify(c.VISIT,i,a)},i._resetUIByScope=function(){var t=f.inSolar,e=f.inPlanetary,i=f.inSatellite;if(this.visitBtn.node.active=t,this.satelliteExpander.node.active=!1,e||i){var n=_.satellites,a=_.center.cat,o=_.unbelt,r=_.centerName;n.length>0&&(this.satelliteExpander.node.active=!0),o&&this.planetIcon.onDataUpdated({into:a,name:r,label:r}),this._reloadSatellitesList()}this.planetExpander.node.active=this.dwarfExpander.node.active=t||e,this.planetList.active=this.dwarfList.active=this.satelliteList.active=!1,this._foldOthers(null)},i._reloadSatellitesList=function(){var t=_.satellites;this._satIcons.updateList(t.map((function(t){return{into:"satellite",name:t}}))),this.satelliteList.getComponent(qt).updateLayout()},i._record=function(t){this.rightGroup.children.forEach((function(e){var i=Ba.get(e);t?(i.from.set(e.position),i.last=e.active):i.to.set(e.position)}))},i._foldOthers=function(t,e){this._expanders.forEach((function(e){e!==t&&e.isChecked&&(e.getComponent(Ut).enabled=!0,e.setIsCheckedWithoutNotify(!1))})),e&&this._lists.forEach((function(t){t!==e&&(t.active=!1)}))},e}(bt)).prototype,"leftGroup",[An],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Gn=ft(Mn.prototype,"visitBtn",[Tn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Vn=ft(Mn.prototype,"rightGroup",[En],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Bn=ft(Mn.prototype,"sunIcon",[In],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Hn=ft(Mn.prototype,"planetIcon",[kn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Un=ft(Mn.prototype,"planetExpander",[Rn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Zn=ft(Mn.prototype,"dwarfExpander",[Pn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Wn=ft(Mn.prototype,"satelliteExpander",[On],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),qn=ft(Mn.prototype,"planetList",[Nn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Yn=ft(Mn.prototype,"dwarfList",[zn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),jn=ft(Mn.prototype,"satelliteList",[Dn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),xn=Mn)),v.Transform),xa=a.Bases,Ma=a.TRANS_SPEED,Fa=a.TRANS_HIGHT,Ga=.3,Va=new Wt,Ba=new Map,Ha=new Wt,Ua=.5,Za={Planetary:[-99,-3],Solar:[-99,0],Helio:[-4,3],Stellar:[-1,5.3],MilkyWay:[1.8,7.8],LocalGG:[3.8,9.8],VirgoSC:[4.9,10.9],Laniakea:[5.6,11.3],Observable:[8,99]};Nt._RF.pop(),Nt._RF.push({},"bc154rb6spMiplIEweTcvBS","sun-flare",void 0);var Wa=zt.ccclass,qa=zt.requireComponent,Ya=yt,ja=function(){return this.useCustomSpotColor},Ka=(Jn=Wa("cocosmos.sun-flare"),Qn=qa(Ut),$n=qa($t),ta=Ya("主参数.A","主相机（3D相机）",ee),ea=Ya("主参数.A","太阳节点（发光源）",Vt),ia=Ya("遮挡设置.B","出屏隐藏"),na=Ya("遮挡设置.B","出屏容忍度",["unit","pixel"],(function(){return this.autoHideOutScreen})),aa=Ya("遮挡设置.B","遮挡隐藏"),oa=Ya("遮挡设置.B","触发器遮挡",(function(){return this.autoHideOcclusive})),ra=Ya("发光设置.C","中心光耀强度",[0,2,.01]),sa=Ya("发光设置.C","周围光晕强度",[0,2,.01]),la=Ya("发光设置.C","散射光斑强度",[0,2,.01]),ca=Ya("发光设置.C","中心光耀大小",[0]),ua=Ya("发光设置.C","周围光晕大小",[0]),ha=Ya("发光设置.C","光晕旋转角度",[0,360,.1]),da=Ya("发光设置.C","散射光斑大小",[0,2,.01]),pa=Ya("发光设置.C","指定光斑渐变色"),fa=Ya("发光设置.C","光斑颜色开始",ja),_a=Ya("发光设置.C","光斑颜色结束",ja),Jn(ga=Qn(ga=$n((va=ft((ma=function(e){function i(){for(var t,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return t=e.call.apply(e,[this].concat(n))||this,_t(t,"mainCamera",va,gt(t)),_t(t,"sun",ba,gt(t)),_t(t,"autoHideOutScreen",ya,gt(t)),_t(t,"tolerance",wa,gt(t)),_t(t,"autoHideOcclusive",Ca,gt(t)),_t(t,"triggerOcclude",Sa,gt(t)),_t(t,"flareStrength",La,gt(t)),_t(t,"haloStrength",Aa,gt(t)),_t(t,"spotsStrength",Ta,gt(t)),_t(t,"flareSize",Ea,gt(t)),_t(t,"haloSize",Ia,gt(t)),_t(t,"haloAngle",ka,gt(t)),_t(t,"spotsScale",Ra,gt(t)),_t(t,"useCustomSpotColor",Pa,gt(t)),_t(t,"spotColorFrom",Oa,gt(t)),_t(t,"spotColorTo",Na,gt(t)),t._consume=!1,t._material=void 0,t._pass0=void 0,t._handleArgs0=0,t._handleArgs1zw=0,t._handleArgs2=0,t._handleHAngle=0,t._handleColorA=0,t._handleColorB=0,t._strength=0,t._starlight=0,t._star=void 0,t}dt(i,e);var n=i.prototype;return n.onLoad=function(){this._init()._listen()},n.onDestroy=function(){Ct.unload(this)},n._init=function(){var t;return this.mainCamera=null!=(t=this.mainCamera)?t:pt(),this._material=this.getComponent(Ut).material,this._pass0=this._material.passes[0],this._handleArgs0=this._pass0.getHandle("args0"),this._handleArgs1zw=this._pass0.getHandle("args1",2,ie.Type.FLOAT2),this._handleArgs2=this._pass0.getHandle("args2"),this._handleHAngle=this._pass0.getHandle("hAngle"),this._handleColorA=this._pass0.getHandle("spotColorA"),this._handleColorB=this._pass0.getHandle("spotColorB"),this._star=this.node.getChildByName("Star").getComponent(ne),this},n._listen=function(){var t=this;io(),ae.on("window-resize",(function(){t.getComponent($t).updateAlignment(),io()})),Ct.on(Tt.Time.POST_TICK,this.onTick,this),Ct.on(v.Transform.FACE_OVER,(function(){return t._consume=!0}))},n.start=function(){var t=Lt(k,po,fo);this.sun=t.sun.node},n._attenuate=function(e){this.sun.inverseTransformPoint(Xa,this.mainCamera.node.worldPosition);var i=Xa.length(),n=t(i,[3,20,2e3,1e4],!1),a=t(i,[0,1,500,1e3],!1);this._starlight=Math.lerp(this._starlight,f.inSolar?0:a,e),this._strength=Math.lerp(this._strength,n,e)},n._assign=function(t,e){this.flareStrength=this.haloStrength=this.spotsStrength=this._strength,this.flareSize=320*this._strength+32,this.haloSize=400*this._strength+40,this.haloAngle=this.mainCamera.node.eulerAngles.y,this._star.node.setPosition(t,e),this._star.opacity=191*this._starlight},n.onTick=function(t,e){if(this.invalid)return this.node.active=this._consume=!1;if(!l.solar||!p.showSun)return this.node.active=this._consume=!1;var i=this.sun.worldPosition,n=this.mainCamera.node,a=n.forward,o=n.worldPosition;if(Wt.dot(a,Wt.subtract(Xa,i,o))<0)return this.node.active=this._consume=!1;this.mainCamera.convertToUINode(i,this.node.parent,Xa);var r=this._consume?Ja:Xa,s=r.x,c=r.y;if((Ja.set(Xa),this._consume=!1,this.autoHideOutScreen)&&(Math.abs(s)>to+this.tolerance||Math.abs(c)>eo+this.tolerance))return this.node.active=!1;Qa.z=s,Qa.w=c,this._pass0.setUniform(this._handleArgs0,Qa),this.autoHideOcclusive&&this._occlusiveCheck()?this._strength=Math.lerp(this._strength,0,2*t):this._attenuate(t),this._assign(s,c),Ka.set(this.flareSize,this.haloSize),this._pass0.setUniform(this._handleArgs1zw,Ka),this._pass0.setUniform(this._handleHAngle,this.haloAngle),$a.set(this.flareStrength,this.haloStrength,this.spotsStrength,this.spotsScale),this._pass0.setUniform(this._handleArgs2,$a),this.useCustomSpotColor&&(this._pass0.setUniform(this._handleColorA,this.spotColorFrom),this._pass0.setUniform(this._handleColorB,this.spotColorTo)),this.node.active=!0},n._occlusiveCheck=function(){var t=new oe.Ray;oe.Ray.fromPoints(t,this.mainCamera.node.worldPosition,this.sun.worldPosition);var e=this.triggerOcclude;return!!re.instance.raycast(t,4294967295,100,e)&&notEmptyArr(re.instance.raycastResults)},vt(i,[{key:"invalid",get:function(){return!this.node.parent||!this.mainCamera||!this.sun}}]),i}(Ft)).prototype,"mainCamera",[ta],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ba=ft(ma.prototype,"sun",[ea],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ya=ft(ma.prototype,"autoHideOutScreen",[ia],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),wa=ft(ma.prototype,"tolerance",[na],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 50}}),Ca=ft(ma.prototype,"autoHideOcclusive",[aa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Sa=ft(ma.prototype,"triggerOcclude",[oa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),La=ft(ma.prototype,"flareStrength",[ra],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Aa=ft(ma.prototype,"haloStrength",[sa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Ta=ft(ma.prototype,"spotsStrength",[la],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Ea=ft(ma.prototype,"flareSize",[ca],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 320}}),Ia=ft(ma.prototype,"haloSize",[ua],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 400}}),ka=ft(ma.prototype,"haloAngle",[ha],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Ra=ft(ma.prototype,"spotsScale",[da],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Pa=ft(ma.prototype,"useCustomSpotColor",[pa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Oa=ft(ma.prototype,"spotColorFrom",[fa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new xt(255,255,0,255)}}),Na=ft(ma.prototype,"spotColorTo",[_a],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new xt(255,125,0,127)}}),ga=ma))||ga)||ga),new te),Xa=new Wt,Ja=new Wt,Qa=new Mt,$a=new Mt,to=0,eo=0;function io(){var t=se.getVisibleSize(),e=t.width,i=t.height;to=e/2,eo=i/2,Qa.x=e,Qa.y=i}var no,ao,oo,ro,so,lo,co,uo,ho,po=r.COSMOS,fo=r.SOLAR;Nt._RF.pop(),Nt._RF.push({},"58480t3AupG7a7abhO8Dakq","target-indicator",void 0);var _o,go=zt.ccclass,mo=zt.property,vo=(no=go("target-indicator"),ao=mo(ee),oo=mo(Vt),ro=mo(Gt),no((co=ft((lo=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return e=t.call.apply(t,[this].concat(n))||this,_t(e,"mainCamera",co,gt(e)),_t(e,"circles",uo,gt(e)),_t(e,"distance",ho,gt(e)),e._forgive=!1,e._ignore=!1,e._anim=void 0,e._playing=!1,e}dt(e,t);var i=e.prototype;return i.onLoad=function(){this._init()},i.start=function(){this.circles.active=!1},i._init=function(){var t=this;this._anim=this.circles.getComponent(le),this._anim.on(le.EventType.FINISHED,this._playOver,this),Ct.on(v.Transform.ZOOM_OVER,this._playAnim,this),Ct.on(v.Transform.FACE_OVER,(function(){return t._forgive=!0})),Ct.on(c.IGNORE_TARGET_ONCE,(function(){return t._ignore=!0}))},i.onDestroy=function(){Ct.unload(this)},i._playAnim=function(){var t=f.transInfo.transEnum;this._ignore?this._ignore=!1:bo.contains(t)&&(this._playing=!0,this.circles.active=!0,this._anim.play())},i._playOver=function(){this._playing=!1,this.circles.active=!1},i.lateUpdate=function(t){if(this.distance.node.active=!1,this._playing){var e=f.transInfo.target,i=A.showTarget;if(!e||!i)return this.circles.active=!1;if(this._forgive)this.circles.active=!0;else{var n=e.node.worldPosition,a=this.mainCamera.node,o=a.forward,r=a.worldPosition;if(Wt.dot(o,Wt.subtract(vo,n,r))<0)return this.circles.active=!1;var s=Math.pow(10,l.pow10)*vo.length()*h;this.distance.string=s.toFixed(0)+" km",this.distance.node.active=!0,this.circles.active=!0,this.mainCamera.convertToUINode(n,this.node.parent,vo),this.circles.setPosition(vo)}}this._forgive=!1},e}(Ft)).prototype,"mainCamera",[ao],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),uo=ft(lo.prototype,"circles",[oo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ho=ft(lo.prototype,"distance",[ro],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),so=lo)),new Wt),bo=[R.SUN_2_PLN,R.SUN_2_SAT,R.PLN_2_PLN,R.PLN_2_SUN,R.SAT_2_SUN,R.SUN_2_STR,R.STR_2_SUN];Nt._RF.pop(),Nt._RF.push({},"662ebfxPh5NTqZdN7woSvur","welcome",void 0);var yo,wo=zt.ccclass;zt.property,wo("cocosmos.welcome")(_o=function(t){function e(){return t.apply(this,arguments)||this}return dt(e,t),e.prototype.onHide=function(){this.node.destroy()},e}(Ft));Nt._RF.pop(),Nt._RF.push({},"0ed87zlcGBP+4hFbVeWdGIH","intro-line",void 0);var Co,So,Lo,Ao,To,Eo,Io,ko,Ro,Po=zt.ccclass,Oo=Lt,No=Po("cocosmos.intro-line")(yo=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return(e=t.call.apply(t,[this].concat(n))||this)._pad=null,e._tag=null,e._description=null,e._tagUit=null,e._descUit=null,e}dt(e,t);var i=e.prototype;return i.onLoad=function(){this._pad=this.getComponent(Ut),this._tag=Oo(s,this,"Tag"),this._description=Oo(s,this,"Description"),this._tagUit=this._tag.getComponent(jt),this._descUit=this._description.getComponent(jt)},i.onDataUpdated=function(t){var e=t.tag,i=t.desc,n=!!e,a=!!i;if(this._tag.node.active=n,this._tagUit.width=a?xo:Vo,this._tag.node.setPosition(a?Mo:0,0),this._description.node.active=a,this._descUit.width=n?Fo:Vo,this._description.node.setPosition(n?Go:0,0),n&&(this._tag.string=(e.length<=1?"phys@":"tags@")+e),a){var o=Do.excludes(i);o&&n&&zo.includes(e)?(this._description.enabled=!1,this._description.getComponent(Gt).string=i):(this._description.enabled=!0,this._description.string=(o?"":"misc@")+i)}this._pad.enabled=this.node.parent.children.indexOf(this.node)%2==0,this.adjustHeight()},i.adjustHeight=function(){var t=this;this.scheduleOnce((function(){return t.node.getComponent(jt).height=Math.max(t._tag.node.active?t._tagUit.height:0,t._description.node.active?t._descUit.height:0)}))},e}(Ft))||yo,zo=["seq","diam","date","ksn","aid","cid","radius","lon","obl","ecc","prd","agl","nra","nd","_obl","_prd","max","total","weight","distances","s","v","m","d","g","e","r","t","a","p","h","x","z","n","c","b"],Do=["bh","sync","true","false"],xo=120,Mo=-115,Fo=230,Go=60,Vo=340;Nt._RF.pop(),Nt._RF.push({},"d3b2cjrSnVCjIxvzQuF6WhB","pop-info-line",void 0);var Bo,Ho,Uo,Zo,Wo,qo,Yo,jo=zt.ccclass,Ko=It,Xo=Et,Jo=(Co=jo("cocosmos.pop-info-line"),So=Xo("内容文本",s),Lo=Xo("保持时间",["unit","sec"]),Ao=Xo("留边宽高"),Co((Io=ft((Eo=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return e=t.call.apply(t,[this].concat(n))||this,_t(e,"i18n",Io,gt(e)),_t(e,"duration",ko,gt(e)),_t(e,"_margins",Ro,gt(e)),e._tws=void 0,e._label=void 0,e}dt(e,t);var i=e.prototype;return i.onLoad=function(){var t,e;this._tws=null!=(t=null!=(e=this.getComponent(wt))?e:this.getComponentInChildren(wt))?t:this.addComponent(wt),this._label=this.i18n.getComponent(Gt),Ct.on(c.Popups.INFO_LINE,this.onPopInfo,this),Ct.on(c.Popups.TIP_LINE,this.onTipInfo,this)},i.start=function(){this._tws.node.active=!1},i.onDestroy=function(){Ct.unload(this)},i.onPopInfo=function(t,e){this._label.color=xt.WHITE,this.show(t,e)},i.onTipInfo=function(t,e){this._label.color=Jo,this.show(t,e)},i.show=function(t,e){var i=this;this.unscheduleAllCallbacks(),this.i18n.string=t;var n=null!=e?e:this.duration;this._tws.show(!0),this.scheduleOnce((function(){return i._tws.hide(!0)}),n)},vt(e,[{key:"margins",get:function(){return this._margins},set:function(t){var e=this;this._margins=t,this.scheduleOnce((function(){var t,i=e._margins,n=i.x,a=i.y,o=e.i18n.getComponent(jt).contentSize,r=o.width,s=o.height;null==(t=e.i18n.node)||null==(t=t.parent)||t.getComponent(jt).setContentSize(r+n,s+a)}))}}]),e}(Ft)).prototype,"i18n",[So],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ko=ft(Eo.prototype,"duration",[Lo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Ro=ft(Eo.prototype,"_margins",[Ko],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new te(20,10)}}),ft(Eo.prototype,"margins",[Ao],Object.getOwnPropertyDescriptor(Eo.prototype,"margins"),Eo.prototype),To=Eo)),new xt(153,153,63));Nt._RF.pop(),Nt._RF.push({},"e77cenBuGhHboMlW5u17l0g","tab-card",void 0);var Qo,$o,tr,er,ir,nr,ar,or,rr,sr,lr,cr,ur,hr,dr,pr,fr,_r,gr,mr,vr,br,yr,wr,Cr,Sr=zt.ccclass,Lr=zt.property,Ar=(Bo=Sr("cocosmos.tab-card"),Ho=Lr(s),Uo=Lr(At),Bo((qo=ft((Wo=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return e=t.call.apply(t,[this].concat(n))||this,_t(e,"title",qo,gt(e)),_t(e,"grids",Yo,gt(e)),e}dt(e,t);var i=e.prototype;return i.updateData=function(t,e){this.title.string=t,this.grids.updateList(e),this._updateUI(e.length)},i._updateUI=function(t){var e=Math.ceil(t/Tr)*Er+kr+Rr;this.node.getComponent(jt).setContentSize(Ir,e),this.title.getComponent($t).updateAlignment()},i.clear=function(){this.grids.freeAll()},e}(Ft)).prototype,"title",[Ho],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Yo=ft(Wo.prototype,"grids",[Uo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Zo=Wo))||Zo),Tr=8,Er=90,Ir=Tr*Er+20,kr=25,Rr=7;Nt._RF.pop(),Nt._RF.push({},"1e9a24k/A5PdY6aOmGqwpxZ","guide-panel",void 0);var Pr,Or,Nr,zr,Dr,xr,Mr,Fr,Gr,Vr,Br,Hr,Ur,Zr=zt.ccclass,Wr=zt.property,qr=(Qo=Zr("cocosmos.guide-panel"),$o=Wr(Vt),tr=Wr(Vt),er=Wr(Vt),ir=Wr(Vt),nr=Wr(Vt),ar=Wr(Vt),or=Wr(Vt),rr=Wr(Vt),sr=Wr(Vt),lr=Wr(Gt),cr=Wr([Ut]),Qo((dr=ft((hr=function(t){function i(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return e=t.call.apply(t,[this].concat(n))||this,_t(e,"steps",dr,gt(e)),_t(e,"screenshot",pr,gt(e)),_t(e,"overTip",fr,gt(e)),_t(e,"mask",_r,gt(e)),_t(e,"btnNext",gr,gt(e)),_t(e,"btnSkip",mr,gt(e)),_t(e,"langChoose",vr,gt(e)),_t(e,"skipDialog",br,gt(e)),_t(e,"title",yr,gt(e)),_t(e,"labelStep",wr,gt(e)),_t(e,"langSprites",Cr,gt(e)),e._idx=-1,e._ss_anim=null,e}dt(i,t);var n=i.prototype;return n.onLoad=function(){this._ss_anim=this.screenshot.getComponent(le),this._ss_anim.on(qr,this.onStepStart,this)},n.start=function(){this._adapt()},n.onEnable=function(){var t=this;this._toggleSkip(!1)._toggleNext(!1),this.langChoose.active=this.steps.active=this.overTip.active=!1,this.steps.children.forEach((function(e){return e.active=e===t.title})),this.labelStep.string="",this.screenshot.getComponentsInChildren(ne).forEach((function(t){return t.opacity=0})),P.guided?this._startSteps():(this._darkenMask=!1,this.langChoose.active=!0,this.langChoose.getComponent(le).play())},n.chooseLang=function(t,e){this.notify(c.LANGUAGE,e),this.langChoose.active=!1,this._startSteps()},n._startSteps=function(){this.changeSpriteLang(),this.steps.active=this.screenshot.active=!0,this._darkenMask=!0,this._idx=0,this._playNextStep()},n.clickNext=function(){this._idx>=Yr?this._playOverTip():this._playNextStep()},n.clickSkip=function(){this.skipDialog.active=!0,this.skipDialog.getComponent(le).play()},n.clickConfirm=function(){this.skipDialog.active=!1,this._playOverTip()},n.clickCancel=function(){this.skipDialog.active=!1},n.changeSpriteLang=function(){var t=e.language,i=d.Sheets.UI_POPS,n="en"===t;this.langSprites.forEach((function(t){return O(t,i,"en",n)}))},n._playOverTip=function(){P.updateGuided(),this.steps.active=!1,this.overTip.active=!0,this._toggleNext(!1)._toggleSkip(!1),this.getComponent(le).play("over-tip")},n.onOverTipCompete=function(){Ct.audio.bgmVolume=.5,this.notify(c.Panels.CLOSE,d.Prefabs.GUIDE_PANEL)},n._playNextStep=function(){this._toggleStep(!1),this._idx++,this._toggleNext(!1),this.labelStep.string="（"+this._idx+"/"+Yr+"）";var t="shot-"+this._idx;this._ss_anim.clips.find((function(e){return e.name===t}))?this._ss_anim.play(t):this.onStepStart()},n.onStepStart=function(){this._toggleStep(!0);var t=this._step.getComponent(ne);t.opacity=0,this.scheduleOnce((function(){return t.opacity=255}));var e=this._step.getComponent(le);e.once(qr,this.onStepOver,this),e.play()},n.onStepOver=function(){1===this._idx&&this._toggleSkip(!0),this._toggleNext(!0)},n._toggleNext=function(t){return this.btnNext.active=t,this},n._adapt=function(){var t=this.steps.getChildByName("step-10"),e=ce.isMobile?"mb":"pc";t.children.forEach((function(t){var i=t.getChildByName("pad");i&&(i.active=t.name.includes(e))}))},n._toggleSkip=function(t){return this.btnSkip.active=t,this},n._toggleStep=function(t){var e=this._step;return e&&(e.active=t),this},vt(i,[{key:"_darkenMask",set:function(t){this.mask.getComponent(ne).opacity=t?232:0}},{key:"_step",get:function(){return this.steps.getChildByName("step-"+this._idx)}}]),i}(bt)).prototype,"steps",[$o],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),pr=ft(hr.prototype,"screenshot",[tr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),fr=ft(hr.prototype,"overTip",[er],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_r=ft(hr.prototype,"mask",[ir],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),gr=ft(hr.prototype,"btnNext",[nr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),mr=ft(hr.prototype,"btnSkip",[ar],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),vr=ft(hr.prototype,"langChoose",[or],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),br=ft(hr.prototype,"skipDialog",[rr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),yr=ft(hr.prototype,"title",[sr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),wr=ft(hr.prototype,"labelStep",[lr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Cr=ft(hr.prototype,"langSprites",[cr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ur=hr)),le.EventType.FINISHED),Yr=10;Nt._RF.pop(),Nt._RF.push({},"14b7eLRw6JJQoNimwvalatR","intro-panel",void 0);var jr,Kr,Xr,Jr,Qr,$r,ts,es,is,ns,as,os,rs,ss,ls,cs,us,hs,ds,ps,fs,_s,gs,ms,vs,bs,ys,ws,Cs,Ss,Ls,As,Ts,Es,Is,ks,Rs=zt.ccclass,Ps=zt.property,Os=(Pr=Rs("cocosmos.intro-panel"),Or=Ps(s),Nr=Ps(At),zr=Ps(At),Dr=Ps(Vt),xr=Ps(Vt),Pr((Gr=ft((Fr=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return e=t.call.apply(t,[this].concat(n))||this,_t(e,"title",Gr,gt(e)),_t(e,"mainList",Vr,gt(e)),_t(e,"cardList",Br,gt(e)),_t(e,"arrowLeft",Hr,gt(e)),_t(e,"arrowRight",Ur,gt(e)),e._lastName=void 0,e._mainData=[],e._descData=[],e._astData=[],e._phyData=[],e._strData=[],e._cards=[],e._showAt=0,e._assembler=[],e}dt(e,t);var i=e.prototype;return i.onLoad=function(){this._init(),this._listen()},i.start=function(){},i._init=function(){var t=this;this.on(c.LANGUAGE,(function(){return t._updateListLayout(!0)}))},i._updateListLayout=function(t){var e=this;t&&(this.mainList.getComponentsInChildren(No).forEach((function(t){return t.adjustHeight()})),this.cardList.getComponentsInChildren(No).forEach((function(t){return t.adjustHeight()}))),this.scheduleOnce((function(){e.mainList.getComponent(qt).updateLayout(),e.cardList.getComponent(qt).updateLayout()}),.1)},i._listen=function(){this.on(Os.ZOOM_START,this.onVisitStart),this.on(c.FULL_SCREEN,this.onFullScreen)},i.onEnable=function(){this._updateData()},i.onClickLeft=function(){this._showDataAt(this._showAt-1)},i.onClickRight=function(){this._showDataAt(this._showAt+1)},i.onVisitStart=function(){this.notify(c.Panels.CLOSE,this.node.name)},i.onFullScreen=function(){this.node.active&&this.notify(c.Panels.CLOSE,this.node.name,!0)},i.clickFold=function(){this.notify(c.Panels.CLOSE,this.node.name,!0)},i._updateData=function(){var t=f.center,e=t.cat,i=t.config,n=_.centerName,a=_.unbelt;if(n!==this._lastName){if(this._lastName=n,this._cards.length=this._mainData.length=this._descData.length=this._astData.length=this._phyData.length=this._strData.length=0,this._assembler=this._mainData,a){var o=i.nick,r=i.diam,s=i.date,l=i.desc,c=i.disc,u=i.orbiter,h=i.physical,d=i,p=d.belongs,g=d.seq,m=d.sphere,v=d.aid,b=i.ksn,y="satellite"===e?1e6:1e8;this._add("categories@"+e,"cat")._add(o,"nick")._add(p,"belongs")._add(g,"seq")._add(v,"aid")._add(r,"diam",(r*y).toFixed(0)+" km")._add(m,"sphere")._add(s,"date")._add(c,"disc")._add(b,"ksn"),this._reloadDesc(l),this._reloadAst(u,y),this._reloadPhy(h),this._reloadStr()}else{var w,C,S=null!=(w=null==(C=f.center)?void 0:C.configs[n])?w:{},L=S.max,A=S.total,T=S.weight,E=S.distances,I=S.desc;this._add("categories@"+e,"cat")._add(L,"max")._add(A,"total")._add(T,"weight")._add(E,"distances"),this._reloadDesc(I),this._reloadStr()}this._updateRender()}},i._reloadDesc=function(t){if(this._descData.push({tag:"overview"}),notEmptyArr(t)){this._assembler=this._descData,this._cards.push(this._descData);for(var e=t[0],i=t[1],n=0;n<i;n++)this._descData.push({desc:e+"_"+n})}},i._reloadAst=function(t,e){if(this._astData.push({tag:"astronomical"}),t){var i=t.orbital,n=t.rotate;if(this._assembler=this._astData,this._cards.push(this._astData),i){var a=i.radius,o=i.lon,r=i.obliquity,s=i.eccentricity,l=i.period;this._add(a,"radius",(a*e).toFixed(0)+" km")._add(o,"lon",o+"°")._add(r,"obl",r+"°")._add(s,"ecc")._add(l,"prd")}if(n){var c=n.nra,u=n.nd,h=n.obliquity,d=n.period;this._add(c,"nra",c+"°")._add(u,"nd",u+"°")._add(h,"_obl",h+"°")._add(d,"_prd")}}},i._reloadPhy=function(t){var e=this;(this._phyData.push({tag:"physical"}),t)&&(this._assembler=this._phyData,this._cards.push(this._phyData),t.split(",").forEach((function(t){var i=t.split(":"),n=i[0],a=i[1];e._add(n,n,a)})))},i._reloadStr=function(){this._assembler=this._strData,this._cards.push(this._strData),this._strData.push({tag:"structure"},{desc:"todos@dev"})},i._add=function(t,e,i){return isNullish(t)||this._assembler.push({tag:e,desc:null!=i?i:t+""}),this},i._updateRender=function(){this.title.string="celestial@"+this._lastName,this.mainList.updateList(this._mainData),this._showDataAt(0),this._updateListLayout(!1)},i.onHide=function(){this.node.removeFromParent()},i._showDataAt=function(t){this.arrowLeft.active=t>0,this.arrowRight.active=t<this._cards.length-1;var e=this._cards[t];this.cardList.updateList(e),this._showAt=t},e}(bt)).prototype,"title",[Or],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Vr=ft(Fr.prototype,"mainList",[Nr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Br=ft(Fr.prototype,"cardList",[zr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Hr=ft(Fr.prototype,"arrowLeft",[Dr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ur=ft(Fr.prototype,"arrowRight",[xr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Mr=Fr)),v.Transform);Nt._RF.pop(),Nt._RF.push({},"b3adaVu5K5NiLXcoZqhEWsf","lens-panel",void 0);var Ns,zs,Ds,xs,Ms,Fs,Gs,Vs,Bs,Hs,Us,Zs,Ws,qs,Ys,js,Ks,Xs,Js,Qs,$s,tl,el,il,nl,al,ol,rl,sl,ll,cl,ul=zt.ccclass,hl=zt.property,dl=(jr=ul("cocosmos.lens-panel"),Kr=hl(Zt),Xr=hl(Zt),Jr=hl(Zt),Qr=hl(Zt),$r=hl(Zt),ts=hl(Zt),es=hl(Zt),is=hl(Bt),ns=hl(Bt),as=hl(Bt),os=hl(Bt),rs=hl(Bt),ss=hl(Ut),ls=hl(Ut),cs=hl(Ut),us=hl(Vt),jr((ps=ft((ds=function(t){function i(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return e=t.call.apply(t,[this].concat(n))||this,_t(e,"autoHover",ps,gt(e)),_t(e,"autoPitch",fs,gt(e)),_t(e,"autoZoom",_s,gt(e)),_t(e,"lensLock",gs,gt(e)),_t(e,"showLensVel",ms,gt(e)),_t(e,"showEscVel",vs,gt(e)),_t(e,"showCivLvl",bs,gt(e)),_t(e,"azSlider",ys,gt(e)),_t(e,"haSlider",ws,gt(e)),_t(e,"haMinSlider",Cs,gt(e)),_t(e,"haMaxSlider",Ss,gt(e)),_t(e,"zoomSlider",Ls,gt(e)),_t(e,"title",As,gt(e)),_t(e,"confirm",Ts,gt(e)),_t(e,"cancel",Es,gt(e)),_t(e,"content",Is,gt(e)),e._lines=new Map,e._sliders=new Map,e}dt(i,t);var n=i.prototype;return n.onLoad=function(){this._init()},n.onEnable=function(){this.changeSpriteLang()},n.start=function(){this._setDefaults()},n._init=function(){var t=this;this.content.children.forEach((function(e){var i,n=e.getComponentInChildren(Zt);t._lines.set(e,{toggle:n,unchecked:n.getComponent(Ut),titles:n.getComponentsInChildren(Gt),sliders:e.getComponentsInChildren(Bt),block:null!=(i=e.getComponentInChildren(Ht))?i:null})})),this.content.getComponentsInChildren(Bt).forEach((function(e){t._sliders.set(e,{bar:e.node.getChildByName("Bar").getComponent(Ut),sprites:e.getComponentsInChildren(Ut),value:e.getComponentInChildren(Gt),range:dl[e.node.name]})}))},n._setDefaults=function(){var t=this;this.content.getComponentsInChildren(Zt).forEach((function(t){"Toggle"!==t.node.name&&(t.setIsCheckedWithoutNotify(e.getStateByName(t.node.name)),t.node.name+=":check")})),this.content.getComponentsInChildren(Zt).forEach((function(e){return t.toggleUsage(e)})),this.content.getComponentsInChildren(Bt).forEach((function(e){e.progress=t._sliders.get(e).range[3],t.slideDegree(e)})),this.changeSpriteLang()},n.changeSpriteLang=function(){var t=e.language,i=d.Sheets.UI_POPS,n="en"===t;O(this.title,i,"en",n),O(this.confirm,i,"en",n),O(this.cancel,i,"en",n)},n.toggleUsage=function(t){var e=this,i=t.isChecked,n=t.node.parent,a=this._lines.get(n),o=a.unchecked,r=a.titles,s=a.sliders,l=a.block;o.enabled=!i,r.forEach((function(t){return t.color=i?xt.WHITE:xt.GRAY})),s.forEach((function(t){var n=e._sliders.get(t),a=n.sprites,o=n.value;a.forEach((function(t){return O(t,d.Sheets.UI_POPS,"dis",!i)})),o.color=i?xt.WHITE:xt.GRAY})),l&&(l.enabled=!i)},n.slideDegree=function(t){var e=this._sliders.get(t),i=e.bar,n=e.value,a=e.range[2],o=Math.round(this._getValue(t));n.string=(o>=0?"+":"")+o.toFixed(0)+a,i.fillRange=t.progress},n._getValue=function(t){var e=dl[t.node.name],i=e[0],n=e[1];return Math.lerp(i,n,t.progress)},n.onApply=function(){var t={hover:this.autoHover.isChecked,pitch:this.autoPitch.isChecked,zoom:this.autoZoom.isChecked,lock:this.lensLock.isChecked,showLensVel:this.showLensVel.isChecked,showEscVel:this.showEscVel.isChecked,showCivLvl:this.showCivLvl.isChecked};t.hover&&(t.az=this._getValue(this.azSlider)),t.pitch&&(t.ha=this._getValue(this.haSlider),t.haRange=[this._getValue(this.haMinSlider),this._getValue(this.haMaxSlider)]),t.zoom&&(t.pow10=this._getValue(this.zoomSlider)/100),this.notify(c.LENS_PARAMS,t),this.notify(c.Panels.CLOSE,this.node.name)},n.onClose=function(){this.notify(c.Panels.CLOSE,this.node.name)},n.onHide=function(){this.node.removeFromParent()},i}(bt)).prototype,"autoHover",[Kr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),fs=ft(ds.prototype,"autoPitch",[Xr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_s=ft(ds.prototype,"autoZoom",[Jr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),gs=ft(ds.prototype,"lensLock",[Qr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ms=ft(ds.prototype,"showLensVel",[$r],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),vs=ft(ds.prototype,"showEscVel",[ts],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),bs=ft(ds.prototype,"showCivLvl",[es],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ys=ft(ds.prototype,"azSlider",[is],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ws=ft(ds.prototype,"haSlider",[ns],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Cs=ft(ds.prototype,"haMinSlider",[as],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ss=ft(ds.prototype,"haMaxSlider",[os],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ls=ft(ds.prototype,"zoomSlider",[rs],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),As=ft(ds.prototype,"title",[ss],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ts=ft(ds.prototype,"confirm",[ls],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Es=ft(ds.prototype,"cancel",[cs],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Is=ft(ds.prototype,"content",[us],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),hs=ds)),(ks={})["旋转"]=[-180,180,"°/s",.5],ks["推拉"]=[-50,50,"x0.01/s",.5],ks["俯仰"]=[-30,30,"°/s",.5],ks["最高"]=[-80,80,"°",.7],ks["最低"]=[-80,80,"°",.4],ks);Nt._RF.pop(),Nt._RF.push({},"c506fZ07INA67VVgp1+o0j6","visit-panel",void 0);var pl,fl=zt.ccclass,_l=zt.property,gl=(Ns=fl("cocosmos.visit-panel"),zs=_l({group:"TabSort",type:Ut}),Ds=_l({group:"TabSort",type:ue}),xs=_l({group:"TabSort",type:Vt}),Ms=_l({group:"TabSort",type:he}),Fs=_l({group:"TabSort",type:Vt}),Gs=_l({group:"Content",type:qt}),Vs=_l({group:"Content",type:ue}),Bs=_l({group:"Content",type:de}),Hs=_l({group:"Content",type:Vt}),Us=_l({group:"Content",type:Zt}),Zs=_l({group:"Dialog",type:Vt}),Ws=_l({group:"Dialog",type:s}),qs=_l({group:"Dialog",type:Ut}),Ys=_l({group:"Dialog",type:Gt}),Ns((Xs=ft((Ks=function(t){function i(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return e=t.call.apply(t,[this].concat(n))||this,_t(e,"title",Xs,gt(e)),_t(e,"scrollTab",Js,gt(e)),_t(e,"tabList",Qs,gt(e)),_t(e,"tabCardTemplate",$s,gt(e)),_t(e,"sortList",tl,gt(e)),_t(e,"contentList",el,gt(e)),_t(e,"scrollContent",il,gt(e)),_t(e,"json",nl,gt(e)),_t(e,"tipDev",al,gt(e)),_t(e,"visible",ol,gt(e)),_t(e,"popDialog",rl,gt(e)),_t(e,"tipDest",sl,gt(e)),_t(e,"cancel",ll,gt(e)),_t(e,"cd",cl,gt(e)),e._notification=null,e._into_cn=null,e._tabs=[],e._configs={},e._config=null,e._cards_pool=[],e._sorts=void 0,e._tab_checked=void 0,e._sort_checked=void 0,e._cd=3,e._dest=null,e._anim=null,e}dt(i,t);var n=i.prototype;return n.onLoad=function(){this._init()},n.onEnable=function(){this.scrollTab.scrollToLeft(),this.popDialog.active=!1},n.start=function(){this._setDefaults()},n._init=function(){this._tabs=this.tabList.getComponentsInChildren(Zt),this._tab_checked=this._tabs.head,this._configs=this.json.json,this._sorts=this.sortList.getComponentsInChildren(Zt),this._anim=this.getComponent(le),this.on(c.Popups.VISIT_CD,this.onPopVisitCD),this.popDialog.active=!1},n.onPopVisitCD=function(t,e){var i=this;this._dest={name:t,into:e},this.unscheduleAllCallbacks(),this.popDialog.active=!0,this._anim.play("visit-pop-out"),this._cd=ml,this.cd.string="("+this._cd+"s)",this.tipDest.string="celestial@"+t,this.schedule((function(){return i._countDown()}),1)},n._countDown=function(){this._cd--,this.cd.string="("+this._cd+"s)",this._cd<=0&&(this.unscheduleAllCallbacks(),this.onClose())},n.toggleTab=function(t){O(this._tab_checked.getComponent(Ut),gl,"dis",!0),O(t.getComponent(Ut),gl,"dis",!1),this._tab_checked=t,this._updateTab()},n.toggleVisible=function(t){var e=t.isChecked;O(t.getComponent(Ut),gl,"dis",!e),this._updateVisible(e)},n._setDefaults=function(){this._tabs.forEach((function(t,e){return O(t.getComponent(Ut),gl,"dis",0!==e)})),this.scrollTab.scrollToLeft(),this._updateTab()},n.changeSpriteLang=function(){var t="en"===e.language;O(this.cancel,gl,"en",t),O(this.title,gl,"en",t)},n.toggleSort=function(t){O(this._sort_checked.getComponent(Ut),gl,"dis",!0),O(t.getComponent(Ut),gl,"dis",!1),this._sort_checked=t,this._updateSort()},n.onClose=function(){this.notify(c.Panels.CLOSE,this.node.name)},n.onHide=function(){if(notEmpty(this._dest)){var t=this._dest,e=t.name,i=t.into;N.PRINT_VISIT&&console.info("=>",c.VISIT,e,i),Ct.notify(c.VISIT,e,i)}this.node.removeFromParent()},n.onCancel=function(){this.unscheduleAllCallbacks(),this._anim.play("visit-pop-in"),this._dest=null},n.onPopIn=function(){this.popDialog.active=!1},n._updateTab=function(){var t=this._into,e=wl.contains(t);if(this.tipDev.active=e,this.sortList.active=this.visible.node.active=!e,e)return this._freeCards();var i=this._configs[null!=t?t:""];i&&(this._config=i,this._resetSortToggles(),this._resetVisible(),this._updateSort())},n._updateVisible=function(t){this.notify(this._notification,t),this.notify(c.VISIBLE,this._into_cn,t,!0)},n._resetSortToggles=function(){this._sorts.forEach((function(t){return t.node.active=!1})),this._sort_checked=this._sorts.head;for(var t=0;t<this._config.sorts.length;t++){var e=this._config.sorts[t].by,i=this._sorts[t];i.node.active=!0;var n=0===t;i.getComponent(Ut).spriteFrame=Ct.res.getSheetFrame(gl,"sort_"+e+(n?"":"-dis")),i.setIsCheckedWithoutNotify(n),i.node.name=e}},n._resetVisible=function(){var t,e,i,n,a=this._into;this._notification=null!=(t=Cl[a])?t:"",this._into_cn=this._notification.split(".").tail;var o=null!=(e=null!=(i=null!=(n=p.getStateByName(this._into_cn))?n:_.getStateByName(this._into_cn))?i:L.getStateByName(this._into_cn))?e:z.getStateByName(this._into_cn);this.visible.setIsCheckedWithoutNotify(o),O(this.visible.getComponent(Ut),gl,"dis",!o)},n._updateSort=function(){var t=this._config,e=t.icons,i=t.sorts,n=this._into,a=i[this._sort_checked.node.getSiblingIndex()],o=a.by,r=a.cards,s=r.length<=1;this._freeCards();for(var l,c=St(r);!(l=c()).done;){var u=l.value,h=u.indexes,d=u.title,p=this._claim(),f=h.map((function(t,i){return{into:n,name:e[t],pop:"visit-cd",tag:s&&i<=4?"rank_"+i:""}}));this.contentList.node.addChild(p.node);var _=d?d.includes("@")?d:"sorts@"+d:"sorts@"+o;p.updateData(_,f)}this.scrollContent.scrollToTop()},n._claim=function(){var t;return null!=(t=this._cards_pool.pop())?t:pe(this.tabCardTemplate).getComponent(Ar)},n._freeCards=function(){var t=this;this.contentList.getComponentsInChildren(Ar).forEach((function(e){e.clear(),e.node.removeFromParent(),t._cards_pool.push(e)}))},vt(i,[{key:"_into",get:function(){var t;return null==(t=this._tab_checked)||null==(t=t.node)?void 0:t.name}},{key:"_sort",get:function(){var t;return null==(t=this._sort_checked)||null==(t=t.node)?void 0:t.name}}]),i}(bt)).prototype,"title",[zs],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Js=ft(Ks.prototype,"scrollTab",[Ds],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Qs=ft(Ks.prototype,"tabList",[xs],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$s=ft(Ks.prototype,"tabCardTemplate",[Ms],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),tl=ft(Ks.prototype,"sortList",[Fs],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),el=ft(Ks.prototype,"contentList",[Gs],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),il=ft(Ks.prototype,"scrollContent",[Vs],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),nl=ft(Ks.prototype,"json",[Bs],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),al=ft(Ks.prototype,"tipDev",[Hs],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ol=ft(Ks.prototype,"visible",[Us],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),rl=ft(Ks.prototype,"popDialog",[Zs],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),sl=ft(Ks.prototype,"tipDest",[Ws],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ll=ft(Ks.prototype,"cancel",[qs],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),cl=ft(Ks.prototype,"cd",[Ys],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),js=Ks)),d.Sheets.UI_POPS),ml=3,vl=c.Solar,bl=c.Local,yl=c.Stellar,wl=["star","constellation","artificial","nebula","cluster","galaxy","blackhole"],Cl={planet:vl.PLANETS,satellite:bl.SATELLITES,dwarf:vl.DWARFS,minor:vl.MINORS,comet:vl.COMETS,belts:vl.BELTS,artificial:bl.ARTIFICIAL,sun:vl.SUN,star:yl.STARS,constellation:yl.CONSTS,nebula:yl.NEBULAS,cluster:yl.CLUSTERS,galaxy:yl.GALAXIES,blackhole:yl.BLACKHOLE};Nt._RF.pop(),Nt._RF.push({},"faf21frv8hJb4tIoV5NV3qr","relative-scalar",void 0);var Sl,Ll,Al,Tl,El,Il,kl,Rl=zt.ccclass,Pl=zt.disallowMultiple,Ol=Rl("cocosmos.RelativeScalar")(pl=Pl(!0)(pl=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return(e=t.call.apply(t,[this].concat(n))||this)._scopeArgs=void 0,e._scope=void 0,e._loadTexTaskLaunched=!1,e}dt(e,t);var i=e.prototype;return i.onLoad=function(){this._init()._listen()},i.onDestroy=function(){Ct.unload(this)},i.update=function(){this._scope&&(this._scope.active=A.showScopes)},i.onTick=function(t,e){this._updateTransform(),this._checkPreloadTask()},i._init=function(){var t=this.node.name.replace(" ","");return this._scopeArgs=a.Scopes[t],this._scopeArgs||console.warn("scalar not found:",t),this._scopeArgs[3]&&(this._scope=D("Scope",x,this.node,Ct.res.getPrefab(d.Prefabs.SCOPE))),this},i._listen=function(){Ct.on(Tt.Time.TICK,this.onTick,this,-1)},i._checkPreloadTask=function(){this._loadTexTaskLaunched||l.pow10+Bl>this._scopeArgs[0]&&(this._loadTexTaskLaunched=!0,Ct.notify(y.Load.APPROACH_SCOPE,this.node.name))},i._updateTransform=function(){var t=this._scopeArgs,e=t[0],i=t[1],n=t[2],a=l.pow10,o=e<a&&a<i;this.node.active=o,o&&(this._updateScale(n-a),this._updatePosition())},i._updateScale=function(t){var e=Math.pow(10,t);this.node.name===Nl&&(e=Math.min(1,e)),this.node.setWorldScale(e,e,e)},i._updatePosition=function(){var t=f.center,e=f.inPlanetary,i=f.inSatellite;if(t){var n=this.node,a=n.worldScale.x,o=n.name;if(o===zl||o==Dl)if(e)this.node.setWorldPosition(o===zl?Wt.multiplyScalar(Vl,t.node.position,-a):Wt.ZERO);else if(i){if(o===zl){var r=t.belong;Wt.multiplyScalar(Vl,r.node.position,-a),Wt.scaleAndAdd(Vl,Vl,t.node.position,-a*Gl)}else Wt.multiplyScalar(Vl,t.node.position,-a);this.node.setWorldPosition(Vl)}else this.node.setWorldPosition(Wt.ZERO)}},e}(Ft))||pl)||pl,Nl=r.STELLAR,zl=r.SOLAR,Dl=r.PLANETARY,xl=a.Scopes,Ml=xl.Solar,Fl=xl.Planetary,Gl=Math.pow(10,Fl[2]-Ml[2]),Vl=new Wt,Bl=.5;Nt._RF.pop(),Nt._RF.push({},"38299FSPflJsp7AXEBjq5ki","cosmos-controller",void 0);var Hl,Ul=yt,Zl=Lt,Wl=(Sl=(0,zt.ccclass)("cocosmos.CosmosController"),Ll=Ul("Views","深空相机",ee),Al=Ul("Views","相对相机",ee),Sl((Il=ft((El=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return e=t.call.apply(t,[this].concat(n))||this,_t(e,"deepSkyCamera",Il,gt(e)),_t(e,"mainCamera",kl,gt(e)),e._transforming=!1,e._looking=!1,e._autoPow10=null,e._locked=!1,e._relCam=void 0,e._solar=void 0,e._planetary=void 0,e}dt(e,t);var i=e.prototype;return i.onLoad=function(){this._init()._listen()},i.start=function(){var t,e;null==(t=this.mainCamera)||null==(t=t.camera)||t.initGeometryRenderer(),null==(e=this.deepSkyCamera)||null==(e=e.camera)||e.initGeometryRenderer()},i.update=function(t){this._relCam.autoAA2nd=l.autoAA2nd,!this._transforming&&isNum(this._autoPow10)&&this.notify(c.Zoom,this._autoPow10*t),this._relCam.interactable=!this._looking&&!this._locked,this._updateStarsBox()},i._updateStarsBox=function(){var t=L.showStars,e=Jl[0],i=Jl[1],n=t?Math.lerp(0,.8,M(i,e,l.pow10)):0;this.scene.globals.ambient.skyIllum=n;var a=n<=0;this.deepSkyCamera.clearFlags=a?ee.ClearFlag.SOLID_COLOR:ee.ClearFlag.SKYBOX,this.scene.globals.skybox.enabled=!a},i.onZoomStart=function(){this._transforming=!0,this._loadTransMediator(),this._loadTransTarget();var t=F(f.transInfo),e=t[0],i=t[1],n=t[2],a=l.pow10;this._looking=!0,this._relCam.scrollSmoothing=1,this._relCam.azimuthAngle=i,this._relCam.heightAngle=n*ql,l.zoomToBy(Math.max(a,e),1,!1,Kl.ZOOM_OVER)},i.onZoomOver=function(){this._checkPlanetaryReload(),this._startFacingTo()},i.onAngleChange=function(t,e){this._relCam.azimuthAngle=t,this._relCam.heightAngle=e},i.onLensPanelParams=function(t){var e=t.lock,i=t.az,n=t.ha,a=t.pow10,o=t.haRange;isNum(i)||isNum(n)?this._relCam.startAutoRotating(null!=i?i:0,null!=n?n:0,null,o):this._relCam.stopAutoRotating(),this._autoPow10=null!=a?a:null,this._locked=e},i._init=function(){return this._planetary=Zl(G,this,jl),this._solar=Zl(k,this,Yl),this._relCam=this.mainCamera.getComponent(V),this},i._listen=function(){var t=this;return this.on(Kl.ZOOM_START,this.onZoomStart,99),this.on(Kl.ZOOM_OVER,this.onZoomOver),this.on(Kl.VISIT_OVER,(function(){return t._transforming=!1})),this.on(Xl.ANGLE_CHANGE,this.onAngleChange),this.on(Xl.ANGLE_ADDED,this.onAngleAdded),this.on(c.LENS_PARAMS,this.onLensPanelParams),this},i.onAngleAdded=function(t,e){this._relCam.azimuthAngle+=t,isNum(e)&&(this._relCam.heightAngle=e)},i._checkPlanetaryReload=function(){f.transInfo.transEnum===R.PLN_2_PLN&&(this._planetary.freeSystem(),this._planetary.loadSystem())},i._startFacingTo=function(){var t=Rt(Pt().mark((function t(){var e,i,n,a=this;return Pt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=f.transInfo.target,i=Wt.distance(this.mainCamera.node.worldPosition,e.node.worldPosition),n=Math.log10(i/this._relCam.fixedSphereRadius),t.next=5,this._relCam.facingTo(e.node,1,(function(){var t;"Sun"===f.transInfo.name&&a._planetary.freeSystem(),a._looking=!1,a._relCam.scrollSmoothing=.5,l.addPow10(n),f.visit(e),l.zoomToBy(null!=(t=f.point)?t:e.suggest,.5,Math.randomBool(),Kl.VISIT_OVER)}));case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),i._loadTransMediator=function(){var t=f.transInfo,e=t.name;if(t.transEnum===R.SUN_2_SAT){var i,n,a,o=null!=(i=null==(n=Ct.res.getConfigItem(d.Configs.PLANETARY_SATELLITES,e))?void 0:n.belongs)?i:"",r=null!=(a=this._solar.getCelestial(o,"planet"))?a:this._solar.getCelestial(o,"dwarf");r||console.error("[loadTransMediator]","sun2sat no mediator!",e),f.transInfo.mediator=r}},i._loadTransTarget=function(){var t,e=f.transInfo,i=e.name,n=e.transEnum,a=e.into;if(B.contains(n))f.transInfo.target=this._solar.getCelestial(i,a),n===R.SUN_2_PLN&&this._planetary.loadSystem();else if(H.contains(n))f.transInfo.target=this._solar.getCelestial(i);else if(U.contains(n)){var o=n===R.SUN_2_SAT;o&&this._planetary.loadSystem(),f.transInfo.target=this._planetary.getSatellite(i),o&&_.reloadOrbiterParams(f.transInfo.target)}Function.invoke(null==f||null==(t=f.transInfo.target)?void 0:t.preloadRes,f.transInfo.target)},vt(e,[{key:"deepRenderer",get:function(){var t;return null==(t=this.deepSkyCamera)||null==(t=t.camera)?void 0:t.geometryRenderer}},{key:"mainRenderer",get:function(){var t;return null==(t=this.mainCamera)||null==(t=t.camera)?void 0:t.geometryRenderer}},{key:"center",get:function(){return this.node}},{key:"scalars",get:function(){return this.getComponentsInChildren(Ol)}}]),e}(kt)).prototype,"deepSkyCamera",[Ll],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),kl=ft(El.prototype,"mainCamera",[Al],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Tl=El))||Tl),ql=a.TRANS_HIGHT,Yl=r.SOLAR,jl=r.PLANETARY,Kl=v.Transform,Xl=v.Lens,Jl=[-3,0];Nt._RF.pop(),Nt._RF.push({},"65858f6PI5IGJJwDiZnWHZb","deep-sky-camera",void 0);(0,zt.ccclass)("cocosmos.DeepSkyCamera")(Hl=function(t){function e(){return t.apply(this,arguments)||this}return dt(e,t),e.prototype.lateUpdate=function(t){var e=l.pow10,i=Ct.getController(Wl).mainCamera.node;this.node.setWorldPosition(e<=cc?Wt.ZERO:e>=uc?i.worldPosition:Wt.multiplyScalar(dc,i.worldPosition,(e-cc)/hc)),this.node.setWorldRotation(i.worldRotation)},e}(Ft));var Ql,$l,tc,ec,ic,nc,ac,oc,rc,sc,lc,cc=0,uc=1,hc=Math.abs(uc-cc),dc=new Wt;Nt._RF.pop(),Nt._RF.push({},"3db43NryTVHircAih4eED6u","gradient-pervasion",void 0);var pc,fc,_c,gc,mc,vc=zt.ccclass,bc=zt.property,yc=(Ql=vc("cocosmos.GradientPervasion"),$l=bc(he),tc=bc(he),ec=bc(he),ic=bc(fe),Ql((oc=ft((ac=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return e=t.call.apply(t,[this].concat(n))||this,_t(e,"SuperClusters",oc,gt(e)),_t(e,"Stars",rc,gt(e)),_t(e,"Galaxies",sc,gt(e)),_t(e,"TestMat",lc,gt(e)),e._stars=null,e._galaxies=null,e._clusters=null,e._c_mat=null,e._c_handle=void 0,e}dt(e,t);var i=e.prototype;return i.onLoad=function(){this._init()},i.update=function(){this._updateSuperClusters()},i._updateSuperClusters=function(){if(l.super){this._clusters.children.length<=0&&this._createSuperClusters();var t=l.pow10,e=t-yc[0],i=yc[1]-t,n=e/(e+i);if(i<=0){var a=Math.pow(10,i);this._clusters.setScale(a,a,a)}else this._gradient(this._clusters),this._clusters.setScale(1,1,1);Cc.x=Cc.y=n+1,Cc.z=.7*Math.clamp01(e),Cc.w=Math.lerp(.5,.1,Math.clamp01(n)),this._c_mat.passes[0].setUniform(this._c_handle,Cc),this._clusters.active=!0}else this._clusters.active=!1},i._updateStarClusters=function(){l.local?(this._stars.children.length<=0&&this._createStarClusters(),this._gradient(this._stars,1),this._stars.active=!0):this._stars.active=!1},i._gradient=function(t,e){void 0===e&&(e=0);var i=l.pow10,n=Math.log2(Math.pow(10,i));t.children.forEach((function(t,i){var a=i-n;a%=5;var o=Math.pow(2,a+e);t.setScale(o,o,o)}))},i._createSuperClusters=function(){for(var t=W/wc,e=0;e<wc;e++){var i,n=pe(this.SuperClusters);if(n.setRotationFromEuler(0,e*t,e*t/2),n.parent=this._clusters,0===e)this._c_mat=n.getComponent(Dt).sharedMaterial,this._c_handle=null==(i=this._c_mat.passes[0])?void 0:i.getHandle("clusters")}},i._createStarClusters=function(){for(var t=0;t<wc;t++){var e=pe(this.Stars);e.parent=this._stars,e.getComponent(_e).setMaterial(this.TestMat,0)}},i._init=function(){this._stars=D("Pervasive Stars",Z,this.node),this._galaxies=D("Pervasive Galaxies",Z,this.node),this._clusters=D("Pervasive Clusters",Z,this.node)},e}(Ft)).prototype,"SuperClusters",[$l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),rc=ft(ac.prototype,"Stars",[tc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),sc=ft(ac.prototype,"Galaxies",[ec],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),lc=ft(ac.prototype,"TestMat",[ic],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),nc=ac)),[8.5,10]),wc=5,Cc=new Mt;Nt._RF.pop(),Nt._RF.push({},"97813pmXeJAFYJr1GuemrJ0","particle-gradients",void 0);var Sc,Lc,Ac,Tc=zt.ccclass,Ec=zt.property,Ic=(pc=Tc("cocosmos.ParticleGradients"),fc=Ec(he),pc((mc=ft((gc=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return e=t.call.apply(t,[this].concat(n))||this,_t(e,"Particles",mc,gt(e)),e._viewer=void 0,e}dt(e,t);var i=e.prototype;return i.onLoad=function(){this._viewer=mt(Ic,kc);for(var t=0;t<5;t++)pe(this.Particles).parent=this.node},i.update=function(){var t=Math.log2(Math.pow(10,l.pow10));this.node.children.forEach((function(e,i){var n=i-t;n%=5;var a=Math.pow(2,n+1);e.setScale(a,a,a)}))},e}(Ft)).prototype,"Particles",[fc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_c=gc)),new Wt,r.Cameras.MAIN),kc=r.COSMOS;Nt._RF.pop(),Nt._RF.push({},"27b16gkG7FI3Y+O3XmkJC8C","enter-controller",void 0);var Rc,Pc,Oc,Nc,zc,Dc,xc,Mc=zt.ccclass,Fc=zt.property;Mc("cocosmos.EnterController")((Ac=ft((Lc=function(t){function i(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return e=t.call.apply(t,[this].concat(n))||this,_t(e,"useGuide",Ac,gt(e)),e}dt(i,t);var n=i.prototype;return n.start=function(){Qt.hideStats(),this._playBgm(),this._localize(),this.useGuide&&this._tryGuide()},n._tryGuide=function(){P.guided||this.notify(c.Panels.OPEN,d.Prefabs.GUIDE_PANEL)},n._playBgm=function(){Ct.audio.bgmVolume=P.guided?.5:.25,Ct.audio.playBgm()},n._localize=function(){P.language&&e.localizeLanguage(P.language)},i}(bt)).prototype,"useGuide",[Fc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Sc=Lc));Nt._RF.pop(),Nt._RF.push({},"5f2c9YVt+tGR7UrXG4bmcZQ","deep-sky-builder",void 0);var Gc,Vc,Bc,Hc,Uc,Zc=zt.ccclass,Wc=zt.property,qc=(Rc=Zc("cocosmos.DeepSkyBuilder"),Pc=Wc(de),Oc=Wc(he),Rc((Dc=ft((zc=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return e=t.call.apply(t,[this].concat(n))||this,_t(e,"json",Dc,gt(e)),_t(e,"DeepSkyFixed",xc,gt(e)),e.deepMap=new Map,e.nebulas=[],e.clusters=[],e.inners=[],e.galaxies=[],e.locals=[],e.virgos=[],e._nebulas=void 0,e._clusters=void 0,e._localGalaxies=void 0,e._virgoGalaxies=void 0,e._csc=void 0,e}dt(e,t);var i=e.prototype;return i.onLoad=function(){this._init()},i.start=function(){this._buildDeepSkyObjects()},i.lateUpdate=function(){!q.LoadTexTaskLaunched&&l.pow10>=a.Scopes.MilkyWay[0]&&(q.LoadTexTaskLaunched=!0,this.notify(y.Load.DYNAMIC_TEX,w.TEX_MSR_INNERS),this.notify(y.Load.DYNAMIC_TEX,w.TEX_MSR_GALAXIES))},i._buildDeepSkyObjects=function(){var t=this._csc.mainCamera.node;for(var e in this.json.json){var i=this.json.json[e],n=pe(this.DeepSkyFixed).getComponent(q);if(n.viewer=t,n.loadConfig(e,i))switch(!0){case n.nebular:this.nebulas.push(n),this.inners.push(n),n.node.parent=this._nebulas;break;case n.clustered:this.clusters.push(n),this.inners.push(n),n.node.parent=this._clusters;break;case n.local:this.locals.push(n),this.galaxies.push(n),n.node.parent=this._localGalaxies;break;default:this.virgos.push(n),this.galaxies.push(n),n.node.parent=this._virgoGalaxies}else console.error(e)}},i._init=function(){var t=this.node.parent.getChildByName("MilkyWay"),e=this.node.parent.getChildByName("LocalGG"),i=this.node.parent.getChildByName("VirgoSC");this._nebulas=D("Nebulas",Y,t),this._clusters=D("Clusters",Y,t),this._localGalaxies=D("Galaxies",Y,e),this._virgoGalaxies=D("Galaxies",Y,i),this._csc=Ct.getController(Wl)},e}(bt)).prototype,"json",[Pc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),xc=ft(zc.prototype,"DeepSkyFixed",[Oc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Nc=zc))||Nc);Nt._RF.pop(),Nt._RF.push({},"144caQIZIFB4YJvWyOK7eMP","hud-builder",void 0);var Yc,jc,Kc,Xc,Jc,Qc,$c,tu,eu,iu,nu,au,ou,ru,su,lu,cu,uu,hu,du,pu,fu,_u,gu=mt,mu=zt.ccclass,vu=zt.property;Gc=mu("cocosmos.HudBuilder"),Vc=vu(he),Gc((Uc=ft((Hc=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return e=t.call.apply(t,[this].concat(n))||this,_t(e,"CelLabel",Uc,gt(e)),e}dt(e,t);var i=e.prototype;return i.onLoad=function(){n.template=this.CelLabel,this._buildLayers()},i._buildLayers=function(){this._addLayer("coord",!1)._addLayer("const",!1)._addLayer("stars",!1)._addLayer("planetary",!0)._addLayer("solar",!0)._addLayer("cluster",!0)._addLayer("nebula",!0)._addLayer("milky",!0)._addLayer("galaxy",!0)._addLayer("ruler",!0)._addLayer("struct",!0)},i._addLayer=function(t,e){var i=new Vt(t.charAt(0).toUpperCase()+t.substring(1)+" Layer");i.addComponent(jt),n.Containers[t]=j(i,e?K:X);var a=e?"Front":"Back";return i.parent=gu(a+" HUD","Canvas "+a),this},e}(bt)).prototype,"CelLabel",[Vc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Bc=Hc));Nt._RF.pop(),Nt._RF.push({},"363a1nqHuVOA4yeG3SGIFaE","layers-mediator",void 0);var bu=zt.ccclass,yu=zt.property,wu=yt,Cu=Ot;function Su(){return this.useGB}var Lu,Au,Tu,Eu,Iu,ku,Ru,Pu,Ou,Nu,zu,Du,xu,Mu,Fu,Gu,Vu,Bu;Yc=bu("cocosmos.layers-mediator"),jc=yu(Vt),Kc=wu("Base","",Vt),Xc=wu("Base","",[he]),Jc=wu("Panel","",Vt),Qc=wu("Panel","",[he]),$c=wu("Panel","启用自动回收"),tu=wu("Panel","",Su,[0,100,.1]),eu=wu("Panel","",[he],Su),iu=wu("Popup","",Vt),nu=wu("Popup","",[he]),Yc((ru=ft((ou=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return e=t.call.apply(t,[this].concat(n))||this,_t(e,"screenMask",ru,gt(e)),_t(e,"baseLayer",su,gt(e)),_t(e,"baseTemplates",lu,gt(e)),_t(e,"panelLayer",cu,gt(e)),_t(e,"panelTemplates",uu,gt(e)),_t(e,"useGB",hu,gt(e)),_t(e,"intervalGB",du,gt(e)),_t(e,"largePanels",pu,gt(e)),_t(e,"popupLayer",fu,gt(e)),_t(e,"popupTemplates",_u,gt(e)),e._panels=[],e._popups=[],e}dt(e,t);var i=e.prototype;return i.onLoad=function(){this._init(),this._listen()},i._init=function(){var t=this;this.baseTemplates.forEach((function(e){return t.baseLayer.addChild(pe(e))})),this.popupTemplates.forEach((function(e){return t.popupLayer.addChild(pe(e))}))},i._listen=function(){this.on(c.Panels.OPEN,this.onOpenPanel),this.on(c.Panels.CLOSE,this.onClosePanel),this.on(c.FULL_SCREEN,this.onFullscreen)},i.onOpenPanel=function(t,e){var i=this._panels.find((function(e){return e.name===t}));if(!i){var n=this.panelTemplates.find((function(e){return e.name===t}));if(!n)return console.warn("[layers-mediator]","template not exist for:",t);i=pe(n),this._panels.push(i)}if(!i.activeInHierarchy){i.parent=this.panelLayer,"bottom"===e&&Cu(i);var a=i.getComponent(le),o=null==a?void 0:a.clips.find((function(t){return t.name.includes("show")}));a&&o&&a.play(o.name)}},i.onClosePanel=function(t){var e=this.panelLayer.getChildByName(t);if(e){var i=e.getComponent(le),n=null==i?void 0:i.clips.find((function(t){return t.name.includes("hide")}));i&&n?i.play(n.name):e.removeFromParent()}},i.onFullscreen=function(t){this.screenMask.active=!t,this.baseLayer.children.forEach((function(e){return e.children.forEach((function(e){var i;return null==(i=e.getComponent(wt))?void 0:i.play(!t,!0)}))}))},i._tryGarbageCollection=function(){if(!(this._panels.length<=0))for(var t,e=this.largePanels.map((function(t){return t.name})),i=St(this._panels);!(t=i()).done;){var n=t.value;if(e.contains(n.name)&&!n.activeInHierarchy)return this._panels.remove(n),void n.destroy()}},i.start=function(){var t=this;this.useGB&&this.schedule((function(){t._tryGarbageCollection()}),this.intervalGB)},e}(bt)).prototype,"screenMask",[jc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),su=ft(ou.prototype,"baseLayer",[Kc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),lu=ft(ou.prototype,"baseTemplates",[Xc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),cu=ft(ou.prototype,"panelLayer",[Jc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),uu=ft(ou.prototype,"panelTemplates",[Qc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),hu=ft(ou.prototype,"useGB",[$c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),du=ft(ou.prototype,"intervalGB",[tu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),pu=ft(ou.prototype,"largePanels",[eu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),fu=ft(ou.prototype,"popupLayer",[iu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_u=ft(ou.prototype,"popupTemplates",[nu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),au=ou));Nt._RF.pop(),Nt._RF.push({},"eda0eo/KldOcpVDU8HpIJl5","mute-preloader",void 0);var Hu=zt.ccclass,Uu=zt.property,Zu=zt.type,Wu=(Lu=Hu("cocosmos.preload-task"),Au=Uu(fe),Lu((Iu=ft((Eu=function(){_t(this,"taskName",Iu,this),_t(this,"dynamicPath",ku,this),_t(this,"matKey",Ru,this),_t(this,"sharedMaterial",Pu,this),_t(this,"isTex",Ou,this),this.launched=!1}).prototype,"taskName",[Uu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),ku=ft(Eu.prototype,"dynamicPath",[Uu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Ru=ft(Eu.prototype,"matKey",[Uu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Pu=ft(Eu.prototype,"sharedMaterial",[Au],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ou=ft(Eu.prototype,"isTex",[Uu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Tu=Eu))||Tu);Nu=Hu("cocosmos.mute-preloader"),zu=Zu([Wu]),Du=Uu({slide:!0,range:[0,10,.1]}),xu=Uu({slide:!0,range:[0,10,.1]}),Nu((Gu=ft((Fu=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return e=t.call.apply(t,[this].concat(n))||this,_t(e,"tasks",Gu,gt(e)),_t(e,"interval",Vu,gt(e)),_t(e,"delay",Bu,gt(e)),e._texes={},e}dt(e,t);var i=e.prototype;return i.resetTimes=function(t,e){var i=this;this.unscheduleAllCallbacks(),this.interval=t,this.delay=e,this.schedule((function(){return i.doTaskOnce()}),this.interval,ge.REPEAT_FOREVER,this.delay)},i.onLoad=function(){this.on(y.Load.DYNAMIC_TEX,this.loadDynamicTexImmediately)},i.start=function(){var t=this;this._guideDilatory(),this.schedule((function(){return t.doTaskOnce()}),this.interval,ge.REPEAT_FOREVER,this.delay)},i._guideDilatory=function(){P.guided||(this.interval++,this.delay+=3)},i.doTaskOnce=function(t){var e=this,i=t;if(i||(i=this.tasks.find((function(t){return!t.launched}))),i){i.launched=!0;var n=i,a=n.isTex,o=n.dynamicPath,r=n.matKey,s=n.sharedMaterial,l=(a?"textures/":"")+o+(a?"/texture":"");me.load(l,ve,(function(t,n){t?(console.error("[load tex failed]",l),i.launched=!1):(n.addRef(),e._texes[o]=n,s&&r?(s.setProperty(r,n),N.PRINT_LOAD_TASK&&console.info("[task finished]","material-tex:",l)):N.PRINT_LOAD_TASK&&console.info("[task finished]","fetch-tex:",l))}))}else this.unscheduleAllCallbacks()},i.loadDynamicTexImmediately=function(t){var e=this.tasks.find((function(e){return e.taskName===t}));return e?e.launched?console.warn("[task already launched]",t):void this.doTaskOnce(e):console.error("[no task named]",t)},e}(bt)).prototype,"tasks",[zu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Vu=ft(Fu.prototype,"interval",[Du],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 3}}),Bu=ft(Fu.prototype,"delay",[xu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),Mu=Fu));Nt._RF.pop(),Nt._RF.push({},"1be257VbZJIUrBw0sQx2Jfv","cc",void 0);var qu=new xt,Yu=[];Object.defineProperty(be.prototype,"addTrackCurve",{configurable:!0,enumerable:!1,value:function(t,e,i,n,a,o,r,s,l,c){void 0===n&&(n=32),void 0===a&&(a=!0),void 0===o&&(o=!1),void 0===r&&(r=new ye),void 0===l&&(l=!1),void 0===c&&(c=1),Yu.length=0,qu.set(i);var u=Math.parseRadian(s)-Math.PI/2,h=t.x,d=t.y,p=t.z,f=2*Math.PI/n*c;l||(f=-f);for(var _=0;_<n+1;_++){var g=_*f-u,m=e*Math.cos(g),v=e*Math.sin(g),b=new Wt(h+m,d,p+v);o&&Wt.transformMat4(b,b,r),Yu.push(b)}for(var y=qu.a/n,w=0;w<n;w++)qu.a-=y,this.addLine(Yu[w],Yu[w+1],qu,a)}});var ju,Ku,Xu,Ju,Qu,$u=new Wt,th=new Wt,eh=new Wt;Object.defineProperty(be.prototype,"addFadeLine",{configurable:!0,enumerable:!1,value:function(t,e,i,n,a){void 0===n&&(n=32),void 0===a&&(a=!0),Yu.length=0,qu.set(i),eh.set(e).subtract(t).multiplyScalar(1/n),$u.set(t),th.set(t).add(eh);for(var o=qu.a/n,r=0;r<n;r++)this.addLine($u,th,qu,a),$u.add(eh),th.add(eh),qu.a-=o}}),Object.defineProperty(be.prototype,"addFloatingDashLine",{configurable:!0,enumerable:!1,value:function(t,e,i,n,a,o,r){void 0===n&&(n=8),void 0===a&&(a=!0),void 0===o&&(o=.75),void 0===r&&(r=1);var s=function(t){var e=we.totalTime*t/1e3;return e-Math.floor(e)}(r);qu.set(i),eh.set(e).subtract(t).multiplyScalar(1/n),this.addLine($u.set(t),Wt.scaleAndAdd(th,t,eh,s*o),qu,a),Wt.scaleAndAdd($u,t,eh,s),Wt.scaleAndAdd(th,$u,eh,o);for(var l=0;l<n;l++)l===n-1&&s>1-o?this.addLine($u,e,qu,a):this.addLine($u,th,qu,a),Wt.add($u,$u,eh),Wt.add(th,th,eh)}}),Nt._RF.pop(),Nt._RF.push({},"385cayPVaxM/YLw+snWWZWn","geo-renderer",void 0);var ih,nh=zt.ccclass,ah=zt.property,oh=(ju=nh("cocosmos.geo-renderer"),Ku=ah(he),ju((Qu=ft((Ju=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return e=t.call.apply(t,[this].concat(n))||this,_t(e,"coordinates",Qu,gt(e)),e._csc=void 0,e._equatorial=!0,e._celestial=void 0,e._ecliptic=void 0,e._galactic=void 0,e._horizontal=void 0,e._lblAxis=void 0,e._lblDiam=void 0,e}dt(e,t);var a=e.prototype;return a.onLoad=function(){var t=this;this._csc=Ct.getController(Wl),this.on(v.Transform.FACE_OVER,(function(){return t._freeDiamLabel()._freeAxisLabel()}))},a.start=function(){var t=this._csc,e=t.center,i=t.deepSkyCamera,n=t.mainRenderer;this._celestial=this._createOne("天球坐标系",e,i,n).setKeyPrefix("cel").setDivision(mh).setColors(oh.CELESTIAL,ch).setRotation(J.EQUATORIAL),this._ecliptic=this._createOne("黄道坐标系",e,i,n).setKeyPrefix("sun").setDivision(mh).setColors(oh.ECLIPTIC,uh).setRotation(J.ECLIPTIC),this._galactic=this._createOne("银道坐标系",e,i,n).setKeyPrefix("mlk").setDivision(mh).setColors(oh.GALACTIC,dh).setRotation(J.GALACTIC),this._horizontal=this._createOne("地平坐标系",e,i,n).setKeyPrefix("hor").setDivision(mh).setColors(oh.HORIZONTAL,hh).setRotation(Wt.UNIT_Y)},a.update=function(t){this._drawCoordinates(),this._drawLocalGeometries()},a._drawCoordinates=function(){var t=A.showEquatorial,e=A.showHourAngle,i=A.showEcliptic,n=A.showGalactic,a=A.showHorizontal;this._celestial&&(this._celestial.node.active=t||e,t&&!this._equatorial?(this._celestial.freeDegreesLabels(),this._celestial.setDivision(mh),this._celestial.node.name="天球坐标系",this._equatorial=!0):e&&this._equatorial&&(this._celestial.freeDegreesLabels(),this._celestial.setDivision(gh),this._celestial.node.name="时角坐标系",this._equatorial=!1)),this._ecliptic&&(this._ecliptic.node.active=i),this._galactic&&(this._galactic.node.active=n),this._horizontal&&(this._horizontal.node.active=a)},a._drawLocalGeometries=function(){var t=f.inPlanetary,e=f.inSatellite,a=f.center;if(a&&a instanceof Q&&(t||e)){var o=_.showAxis,r=_.showDiameter,s=this._csc.mainRenderer,c=a,u=c.suggest,h=Math.clamp01(u+1.3-l.pow10);if(o){var d=c.rotator.worldMatrix;if(Th.set(ph),Th.a=h*$,Wt.transformMat4(Sh,vh,d),Wt.transformMat4(Lh,bh,d),s.addLine(Sh,Lh,Th,!0),Wt.transformMat4(Sh,yh,d),Wt.transformMat4(Lh,wh,d),s.addLine(Sh,Lh,Th,!0),Wt.transformMat4(Lh,Ch,d),s.addLine(Sh,Lh,Th,!0),s.addArc(vh,.15,Th,0,300,sh,!0,!0,d),!this._lblAxis){this._lblAxis=i(n.claim("planetary","天体转轴"),"planetary","axis"),this._lblAxis.camera=this._csc.mainCamera,this._lblAxis.target=c.node;var p=c.config.orbiter.rotate.period,g=isNum(p)?p.toFixed(2)+"day":p;this._lblAxis.pure="∠"+c.rotateObliquity.toFixed(1)+"° "+g,this._lblAxis.setOffset(Wt.normalize(Sh,c.rotator.up).multiplyScalar(.75))}this._lblAxis.alpha=h}else this._freeAxisLabel();if(r){var m=c.rotator.worldScale.z/2;Th.set(fh),Th.a=h*$,s.addLine(Wt.set(Sh,0,0,-m),Wt.set(Lh,1.3*m,0,-m),Th,!0),s.addLine(Wt.set(Sh,0,0,m),Wt.set(Lh,1.3*m,0,m),Th,!0),s.addLine(Wt.set(Sh,1.2*m,0,-m),Wt.set(Lh,1.2*m,0,m),Th,!0),s.addLine(Sh,Ah.set(1.15*m,0,.9*-m),Th,!0),s.addLine(Sh,Ah.add3f(.1*m,0,0),Th,!0),s.addLine(Lh,Ah.set(1.15*m,0,.9*m),Th,!0),s.addLine(Lh,Ah.add3f(.1*m,0,0),Th,!0),this._lblDiam||(this._lblDiam=i(n.claim("planetary","天体直径"),"planetary","diameter"),this._lblDiam.camera=this._csc.mainCamera,this._lblDiam.target=c.node,this._lblDiam.string=(c.config.diam*("satellite"===c.cat?1e6:1e8)).toFixed(1)+" km",this._lblDiam.setOffset(.6,0,0)),this._lblDiam.alpha=h}else this._freeDiamLabel()}else this._freeDiamLabel()._freeAxisLabel()},a._freeDiamLabel=function(){var t;return null==(t=this._lblDiam)||t.free(),this._lblDiam=null,this},a._freeAxisLabel=function(){var t;return null==(t=this._lblAxis)||t.free(),this._lblAxis=null,this},a._createOne=function(t,e,i,n){var a=pe(this.coordinates);return this.node.addChild(a),a.name=t,a.getComponent(tt).setView(e,i,n)},e}(bt)).prototype,"coordinates",[Ku],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Xu=Ju)),o.CoordColor),rh=o.Segments,sh=rh.ARC,lh=(rh.CIRCLE,o.LineColor),ch=lh.EQUATORIAL,uh=lh.ECLIPTIC,hh=lh.HORIZONTAL,dh=lh.GALACTIC,ph=lh.LOCAL_AXIS,fh=lh.LOCAL_DIAM,_h=.7,gh=new Mt(24,18,3,2),mh=new Mt(36,18,2,2),vh=new Wt(0,_h,0),bh=new Wt(0,-.7,0),yh=new Wt(.15,_h,0),wh=new Wt(.12,_h,.04),Ch=new Wt(.17,_h,.04),Sh=new Wt,Lh=new Wt,Ah=new Wt,Th=new xt;Nt._RF.pop(),Nt._RF.push({},"b9d70trOzxD2oUEia5qf2KH","grids-renderer",void 0);(0,zt.ccclass)("cocosmos.GridsRenderer")(ih=function(a){function o(){for(var t,e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return(t=a.call.apply(a,[this].concat(i))||this)._csc=void 0,t._pass0=void 0,t._handlePow10=void 0,t._handleRatio=void 0,t._handleGridColor=void 0,t._handleCircColor=void 0,t._steps=[],t._alpha=1,t._dAlpha=0,t._ratio=1,t}dt(o,a);var r=o.prototype;return r.fade=function(t,e){void 0===e&&(e=1),this._dAlpha=(t?-1:1)/(Math.abs(e)+Number.EPSILON)},r.onLoad=function(){this._init()._listen()},r.lateUpdate=function(t){this._updateAlpha(t),this._updatePosY(),this._updatePow10(),this._updateLabels()},r._init=function(){var t;this._csc=Ct.getController(Wl);var e=null==(t=this.getComponent(Dt))?void 0:t.material;return this._pass0=e.passes[0],this._handlePow10=this._pass0.getHandle("pow10"),this._handleRatio=this._pass0.getHandle("ratio"),this._handleGridColor=this._pass0.getHandle("gridColor"),this._handleCircColor=this._pass0.getHandle("circColor"),this},r._listen=function(){this.on(v.Transform.ZOOM_OVER,this._fadeOutIn)},r._fadeOutIn=function(){var t=this;this.unscheduleAllCallbacks(),this.fade(!0,1),this.scheduleOnce((function(){return t.fade(!1,2)}),1)},r._updateAlpha=function(t){this._alpha+=this._dAlpha*t,this._alpha>=1?(this._alpha=1,this._dAlpha=0):this._alpha<=0&&(this._alpha=this._dAlpha=0)},r._updatePosY=function(){if(l.solar&&f.center&&_.unbelt){var t,e;t=null==(e=f.center)||null==(e=e.node)||null==(e=e.worldScale)?void 0:e.y}else this.node.setPosition(Wt.ZERO)},r._createLabels=function(){var t=this;Array.nature(3).forEach((function(){return t._steps.push(t._createLabel("pow10"))}))},r._createLabel=function(t,e){void 0===e&&(e="");var a=n.claim("ruler",t);return a.camera=this._csc.mainCamera,a.target=this.node,a.string=e,i(a,"ruler","unit"),a},r._updatePow10=function(){var t=l.pow10,e=A.showGrids,i=A.showRulers,n=f.inSolar,a=f.inSatellite;if(n)switch(!0){case t>Uh:this._ratio=Wh,Bh.set(Oh),Vh.set(zh);break;case t>Uh-1:var o=1+t;this._ratio=Math.lerp(Zh,Wh,o),xt.lerp(Bh,Ph,Oh,o),xt.lerp(Vh,Dh,zh,o);break;default:this._ratio=Zh,Bh.set(Ph),Vh.set(Dh)}else{if(t>Hh-1){var r=t-(Hh-1);this._ratio=Math.lerp(1,Zh,r)}else this._ratio=1;Bh.set(a?kh:Rh),Vh.set(a?Mh:xh)}this._pass0.setUniform(this._handlePow10,t),this._pass0.setUniform(this._handleRatio,this._ratio),Vh.a*=this._alpha,Bh.a*=this._alpha,e||Vh.set(xt.BLACK),i||Bh.set(xt.BLACK),this._pass0.setUniform(this._handleGridColor,Vh),this._pass0.setUniform(this._handleCircColor,Bh)},r._updateLabels=function(){var t=this;if(A.showRulers&&e.showNotes){var i,n,a=f.inSolar,o=f.inPlanetary;this._steps.length<=0&&this._createLabels();var r=l.pow10,s=Math.floor(r),c=r-s,u=null!=(i=null==(n=f.center)?void 0:n.nearest)?i:-99;this._steps.forEach((function(e,i){if(Fh.contains(s-i)||s-i<u-2)return e.alpha=0;var n=Math.pow(10,1-i-c)*t._ratio;et(e,s-i+1,a,o),t._relocateLabel(e,n,i-s,Bh)}))}else this._freeLabels()},r._relocateLabel=function(e,i,n,a){var o=this.node.worldPosition.y,r=t(i,Gh,!1);return e.alpha=r*this._alpha,Wt.set(Yh,Math.sin(n)*i,0,Math.cos(n)*i),e.setOffset(Yh),Yh.y=o,xt.copy(qh,a),qh.a*=r,this._csc.mainRenderer.addFloatingDashLine(jh.set(0,o,0),Yh,qh,10,!0,.75,.5),e},r._freeLabels=function(){this._steps.forEach((function(t){return t.free()})),this._steps.length=0},o}(bt));var Eh,Ih=o.LineColor,kh=Ih.KILO_MT_DK,Rh=Ih.KILO_METER,Ph=Ih.ASTRO_UNIT,Oh=Ih.LIGHT_YEAR,Nh=o.GridsColor,zh=Nh.GALACTIC,Dh=Nh.SOLAR,xh=Nh.PLANETARY,Mh=Nh.SATELLITE,Fh=o.RULER_IGNORES,Gh=it.NameLabelAtt,Vh=new xt,Bh=new xt,Hh=-5,Uh=0,Zh=1.496,Wh=.946,qh=new xt,Yh=new Wt,jh=new Wt;Nt._RF.pop(),Nt._RF.push({},"c3f814beHFAjJvX2i41XhmY","indicative-renderer",void 0);(0,zt.ccclass)("cocosmos.IndicativeRenderer")(Eh=function(e){function i(){for(var t,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return(t=e.call.apply(e,[this].concat(n))||this)._csc=void 0,t._deepSky=void 0,t._stellar=void 0,t._milkyWay=void 0,t._local=void 0,t._virgo=void 0,t}dt(i,e);var n=i.prototype;return n.onLoad=function(){this._init()._listen()},n.start=function(){},n.lateUpdate=function(t){var e=l.stellar,i=l.milky,n=l.local,a=l.virgo,o=A.showLines,r=L.showStars,s=L.showConstLines;e&&r&&s&&this._drawConstellationsLines(),e&&o&&this._drawStarsIndicativeLines(),i&&o&&this._drawDeepSkyIndicativeLines(),n&&o&&this._drawLocalIndicativeLines(),a&&o&&this._drawVirgoIndicativeLines(),this._updateMilkyStructures()},n._init=function(){return this._deepSky=Ct.getMediator(qc),this._stellar=mt(hd,ud).getComponent(nt),this._milkyWay=mt(dd,ud).getComponent(at),this._local=mt(pd,ud),this._virgo=mt(fd,ud),this._csc=Ct.getController(Wl),this},n._drawConstellationsLines=function(){for(var e,i=this,n=this._stellar.configs,a=this._csc.deepRenderer,o=function(){var o=e.value,r=o[0],s=o[1],l=n[r],c=l.stars,u=l.lines;if(c.length<=0)return 1;u.split(",").forEach((function(e){var n=e.split("-").map((function(t){var e=s[t];if(t.includes("@")){var n=t.split("@"),a=n[0],o=n[1];e=i._stellar.constStars.get(o)[a]}if(e)return e.node.worldPosition;console.warn(r,t,"not exist")})),o=n[0],l=n[1];if(o&&l){var c=Math.min(o.lengthSqr(),l.lengthSqr()),u=t(c,Xh,!0);u>0&&(kd.set(ad),kd.a*=ut.instance.consLineStrengthen*u,yd.set(o),wd.set(l),a.addLine(yd,wd,kd))}}))},r=St(this._stellar.constStars);!(e=r()).done;)o()},n._drawStarsIndicativeLines=function(){var t=this._stellar.stars.filter((function(t){return t.config.mag<=4}));this._drawIndicativeLines(t,Qh)},n._drawDeepSkyIndicativeLines=function(){this._drawIndicativeLines(this._deepSky.clusters,td),this._drawIndicativeLines(this._deepSky.nebulas,$h)},n._drawLocalIndicativeLines=function(){var t=this,e=gd[0],i=gd[1],n=l.pow10;if(!(n<=e||n>=i)){var a=this._deepSky.locals,o=this._local.worldScale.x;Wt.multiplyScalar(Ad,ot,o),Wt.multiplyScalar(Ld,rt,.01*o),Wt.multiplyScalar(Ed,st,o),Wt.multiplyScalar(Id,lt,o),this._drawIndicativeLine(Ld,id,!0,Ad),a.forEach((function(e){var i=e.node.worldPosition;switch(e.config.cent){case"milky":t._drawIndicativeLine(i,ed,!1,Ld);break;case"M31":t._drawIndicativeLine(i,ed,!1,Ed);break;case"M33":t._drawIndicativeLine(i,ed,!1,Id);break;default:t._drawIndicativeLine(i,id,!0,Ad)}})),this._drawScopeCenter(Ad,id,o*vd)}},n._drawVirgoIndicativeLines=function(){var t=this,e=md[0],i=md[1],n=l.pow10;if(!(n<=e||n>=i)){var a=this._deepSky.virgos,o=this._virgo.worldScale.x;Wt.multiplyScalar(Td,ct,o),this._drawIndicativeLine(Wt.ZERO,nd,!0,Td),a.forEach((function(e){return t._drawIndicativeLine(e.node.worldPosition,nd,!0,Td)})),this._drawScopeCenter(Td,nd,o*bd)}},n._drawScopeCenter=function(t,e,i,n){void 0===n&&(n=.5),Rd.set(e),Rd.a*=n;var a=this._csc.deepRenderer;Wt.copy(yd,t).add3f(0,i,0),a.addLine(yd,t,Rd),a.addDisc(yd,i,Rd,od.CIRCLE,!1),a.addDisc(t,2*i,Rd,od.CIRCLE,!1)},n._drawIndicativeLine=function(e,i,n,a){void 0===n&&(n=!0);var o=Wt.squaredDistance(e,null!=a?a:Wt.ZERO),r=t(o,n?rd:ld,!0);if(!(r<=0)){kd.set(i);var s=e.x,l=e.y,c=e.z;kd.a*=r;var u=this._csc.deepRenderer;yd.set(null!=a?a:Wt.ZERO),wd.set(s,l,c),Cd.set(s,yd.y,c),Wt.subtract(Sd,wd,yd),n?(wd.y*=.97,u.addLine(yd,Cd,kd),u.addLine(Cd,wd,kd)):(Wt.scaleAndAdd(yd,yd,Sd,.04),Wt.scaleAndAdd(wd,wd,Sd,-.02),u.addLine(yd,wd,kd))}},n._drawIndicativeLines=function(t,e,i,n){var a=this;void 0===i&&(i=!0),t.forEach((function(t){return(t.node.activeInHierarchy||t.culling)&&a._drawIndicativeLine(t.node.worldPosition,e,i,n)}))},n._updateMilkyStructures=function(){var e=_d[0],i=_d[1],n=l.pow10;if(n>e&&n<i){this._milkyWay.claimStructureLabelsIfNotExist(this._csc.deepSkyCamera);var a=this._milkyWay.node.worldScale.x,o=a*a;this._milkyWay.structureLabels.forEach((function(e,i){var n=Wt.squaredDistance(cd[i][2],Wt.ZERO)*o;e.alpha=t(n,sd,!0)}))}else this._milkyWay.freeStructureLabels()},n._listen=function(){},i}(bt));var Kh,Xh=ut.ConstLineAtt,Jh=o.LineColor,Qh=Jh.STARS,$h=Jh.NEBULA,td=Jh.CLUSTER,ed=Jh.COMPANION,id=Jh.LocalGG,nd=Jh.VirgoSC,ad=Jh.CONST_LINES,od=o.Segments,rd=it.IndicativeLineAtt,sd=it.NameLabelAtt,ld=[.03,.1,.8,1.5],cd=ht.MilkyWay.Structures,ud=r.COSMOS,hd=r.STELLAR,dd=r.MILKY,pd=r.LOCAL,fd=r.VIRGO,_d=[3,5.5],gd=[5,7.8],md=[7,9.8],vd=.1,bd=.03,yd=new Wt,wd=new Wt,Cd=new Wt,Sd=new Wt,Ld=new Wt,Ad=new Wt,Td=new Wt,Ed=new Wt,Id=new Wt,kd=new xt,Rd=new xt;Nt._RF.pop(),Nt._RF.push({},"06f52Gfwt1P7YFAcF2B5bgQ","tracks-renderer",void 0);(0,zt.ccclass)("cocosmos.TracksRenderer")(Kh=function(e){function i(){for(var t,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return(t=e.call.apply(e,[this].concat(n))||this)._csc=void 0,t._solarSys=void 0,t._planetSys=void 0,t}dt(i,e);var n=i.prototype;return n.onLoad=function(){this._init()._listen()},n.start=function(){},n.lateUpdate=function(t){if(A.showTracks){var e=l.solar,i=l.helio,n=l.planetary,a=p.showPlanets,o=p.showDwarfs,r=p.showMinors,s=p.showComets,c=_.showSatellites;n&&c&&this._drawSatellitesTracks(),e&&a&&this._drawPlanetsTracks(),e&&o&&this._drawDwarfsTracks(),e&&r&&this._drawMinorsTracks(),e&&s&&this._drawCometsTracks(),i&&this._drawHelioTracks()}},n._drawSatellitesTracks=function(){var e=this._csc.mainRenderer,i=this._planetSys,n=i.satellites,a=i.node.worldMatrix;if(f.center)for(var o,r=St(n);!(o=r()).done;){var s=o.value;if(s.node.activeInHierarchy){var l=s.orbitMat,c=s.orbitalRadius;Xd.set(Dd);var u=s===f.center,h=u?1:t(s.distSqr,Bd,!0);h<=.01||(Xd.a*=h,e.addCircle(Wt.ZERO,c,Xd,(u?5:1)*Ud,!0,!0,ye.multiply(Kd,a,l)))}}},n._drawPlanetsTracks=function(){for(var e,i=this._csc.mainRenderer,n=this._solarSys,a=n.planets,o=n.node.worldMatrix,r=f.inSatellite,s=St(a);!(e=s()).done;){var l=e.value;if(l.node.activeInHierarchy){var c=l.orbitMat,u=l.orbitalRadius,h=l.orbitAngle,d=l===f.center;if(Xd.set(xd),d||r&&f.center.belong===l){ye.multiply(Kd,o,c);var p=Math.clamp(.01,1,.001/l.node.worldScale.y);i.addTrackCurve(Wt.ZERO,u,Xd,Ud,!0,!0,Kd,h,!0,p),i.addTrackCurve(Wt.ZERO,u,Xd,Ud,!0,!0,Kd,h,!1,p)}else{var _=t(l.distSqr,Bd,!0);if(_<=.01)continue;Xd.a*=_,i.addCircle(Wt.ZERO,u,Xd,Ud,!0,!0,ye.multiply(Kd,o,c))}}}},n._drawDwarfsTracks=function(){for(var e,i=this._csc.mainRenderer,n=this._solarSys,a=(n.sun,n.dwarfs),o=n.node.worldMatrix,r=St(a);!(e=r()).done;){var s=e.value;if(s.node.activeInHierarchy){var l=s.orbitMat,c=s.orbitAngle,u=s.orbitalRadius,h=s.orbitalVelocity,d=s===f.center;Xd.set(Md);var p=d?1:t(s.distSqr,Bd,!0);if(!(p<=.01)){Xd.a*=p;var _=h>0;i.addTrackCurve(Wt.ZERO,u,Xd,Ud,!0,_,ye.multiply(Kd,o,l),c,!0,1)}}}},n._drawMinorsTracks=function(){for(var e,i=this._csc.mainRenderer,n=this._solarSys,a=(n.sun,n.minors),o=n.node.worldMatrix,r=St(a);!(e=r()).done;){var s=e.value;if(s.node.activeInHierarchy){var l=s.orbitMat,c=s.orbitalRadius,u=s.orbitAngle,h=s.orbitalVelocity,d=s===f.center;Xd.set(Fd);var p=d?1:t(s.distSqr,Bd,!0);if(!(p<=.01)){Xd.a*=p,ye.multiply(Kd,o,l);var _=h>0;i.addTrackCurve(Wt.ZERO,c,Xd,Ud,!0,_,Kd,u,!0,.8)}}}},n._drawCometsTracks=function(){for(var e,i=this._csc.mainRenderer,n=this._solarSys,a=n.sun,o=n.comets,r=n.node.worldMatrix,s=(a.node.worldPosition,St(o));!(e=s()).done;){var l=e.value;if(l.node.activeInHierarchy){var c=l.orbitMat,u=l.orbitalRadius,h=l.orbitAngle,d=l.orbitalVelocity;Xd.set(Gd);var p=f.center===l?1:t(l.distSqr,Bd,!0);if(!(p<=.01)){Xd.a*=p,ye.multiply(Kd,r,c);var _=d>0;i.addTrackCurve(Wt.ZERO,u,Xd,Ud,!1,_,Kd,h,!0,.6)}}}},n._drawHelioTracks=function(){var e=this._csc.mainRenderer,i=l.pow10;Xd.set(Vd),Xd.a*=t(i,qd,!1),e.addFadeLine(Wt.ZERO,jd.set(Wd).multiplyScalar(Yd),Xd,Zd,!0),e.addFadeLine(Wt.ZERO,jd.negative(),Xd,Zd,!0)},n._init=function(){return this._csc=Ct.getController(Wl),this._solarSys=Lt(k,Pd,Od),this._planetSys=Lt(G,Pd,Nd),this},n._listen=function(){},i}(bt));var Pd=r.COSMOS,Od=r.SOLAR,Nd=r.PLANETARY,zd=o.TrackColors,Dd=zd.SATELLITE,xd=zd.PLANET,Md=zd.DWARF,Fd=zd.MINOR,Gd=zd.COMET,Vd=zd.SOLAR,Bd=o.TrackAtt,Hd=o.Segments,Ud=Hd.CIRCLE,Zd=Hd.LINE,Wd=J.SOLAR_DIR,qd=[-2.5,-2,-.5,0],Yd=3,jd=new Wt,Kd=new ye,Xd=new xt;Nt._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/cosmos', 'chunks:///cosmos.js'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});