(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[538],{7331:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/[[...path]]",function(){return n(7972)}])},7972:function(e,t,n){"use strict";n.r(t),n.d(t,{__N_SSG:function(){return e6},default:function(){return te}});var i=n(5893),r=n(1163),a=n(8626),o=n(9646),s=n(8436),l=n(4960),c=n(4025),u=n(2064),m=n(7294),v=n(9477),x=n(1772),d=n(3262),p=n(4671),f=n(8597),y=n(3398);let h=(e,t)=>{let n=(0,s.z)(e=>e.camera),i=(0,m.useMemo)(()=>"Camera"==n.name,[n]),r=(0,m.useMemo)(()=>e.find(e=>"damasco_box_coperchioAction"===e.name),[e]),a=(0,m.useRef)(),o=(0,m.useRef)(),l=(0,m.useRef)(),[c,u]=(0,m.useState)(!1),x=(0,m.useRef)(0),d=(0,m.useRef)(0),p=(0,m.useCallback)(e=>{o.current=e.clipAction(r),l.current=(null==r?void 0:r.duration)||0,o.current.play()},[r]);(0,m.useEffect)(()=>{!c&&t.current&&i&&(a.current=new v.AnimationMixer(t.current),p(a.current),u(!0))},[t,n,i,c,p]),(0,m.useEffect)(()=>(t.current&&(t.current.visible=S.getState().visible),S.subscribe(e=>{t.current&&(t.current.visible=e.visible)})),[t]),(0,s.A)((e,t)=>{if(x.current+=t,a.current&&o.current&&l.current){d.current=v.MathUtils.damp(d.current,S.getState().animationPercentageTarget,.1,t*S.getState().lerpFactor);let e=d.current,n=e*l.current;a.current.setTime(n)}})};var g=n(5769),z=n(2329);let w={OPEN:0,CLOSED:.3,OPEN_2:1},b=(0,m.forwardRef)((e,t)=>{let n=(0,m.useRef)(null),{nodes:r,materials:o,animations:s}=(0,a.L)(x.k.dgBox),[l,c]=(0,m.useState)("white");h(s,n);let u=function(e){let t=(0,g.m)(z.b.damasco_box_diffuse_bake2),n=(0,g.m)(z.b.damasco_box_bump),i=(0,g.m)(z.b.damasco_box_metal_rough),r=(0,m.useMemo)(()=>{let e=new v.MeshStandardMaterial;return e.map=t,e.map.magFilter=v.LinearFilter,e.map.minFilter=v.LinearFilter,e.map.needsUpdate=!0,e.map.flipY=!1,e.map.needsUpdate=!0,e.bumpMap=n,e.metalnessMap=i,e.metalness=1,e.bumpMap.flipY=!1,e.bumpScale=.005,e.bumpMap.needsUpdate=!0,e.roughnessMap=i,e.roughness=1,e.roughnessMap.flipY=!1,e.roughnessMap.needsUpdate=!0,e.envMapIntensity=.3,e},[t,n,i]);return r}(0),p=(0,m.useMemo)(()=>{let e=o.box.clone();return e.map.magFilter=v.LinearFilter,e.map.minFilter=v.LinearFilter,e.map.needsUpdate=!0,e.roughnessMap=null,e.roughness=.5,e.needsUpdate=!0,e.envMapIntensity=1,e},[o.box]),f=(0,d.v)(y.selectGiftProduct),w=(0,d.v)(y.selectDataProducts);return(0,m.useEffect)(()=>{null!==f&&c(0===w[f].box?"red":"white")},[f,w]),(0,i.jsx)("group",{ref:n,...e,visible:!1,children:(0,i.jsxs)("group",{name:"Scene",children:[(0,i.jsx)("mesh",{name:"box_fondo",geometry:r.box_fondo.geometry,material:"white"===l?p:u}),(0,i.jsx)("mesh",{name:"box_coperchio",geometry:r.box_coperchio.geometry,material:"white"===l?p:u,position:[0,.438,-.157],rotation:[-Math.PI/3,0,0]})]})})});b.displayName="DGBox";let S=(0,p.Z)((0,f.mW)(e=>({visible:!1,state:"open1",animationPercentageTarget:0,lerpFactor:10,changeState:t=>e(e=>{switch(e.state=t,t){case"open1":e.animationPercentageTarget=w.OPEN;break;case"close":e.lerpFactor=6,e.animationPercentageTarget=w.CLOSED;break;case"open2":e.animationPercentageTarget=w.OPEN_2;break;default:console.warn("changeState: unknown state",t)}},!1,"changeState"),box:{position:[0,0,0],rotation:[0,0,0],scale:[1,1,1]}}),{name:"useTmpBoxStore"}));var T=n(8289),j=n(2313),P=n(4753),C=n(9104);let M=()=>{let e=(0,d.v)(j.selectSetAnimation),t=(0,d.v)(y.selectSetCurrentStep),n=()=>{S.setState({visible:!0})},i=()=>{S.setState({visible:!1})},r=()=>{e("anim1"),setTimeout(()=>{S.getState().changeState("open1")},1200)},a=(0,m.useCallback)(()=>{e("anim1"),setTimeout(()=>{t(C.h.CLOSE_BOX),e("anim2"),setTimeout(()=>{t(C.h.DISCOVER),S.getState().changeState("close")},500)},1e3*P.nL.boxEnter)},[]),o=()=>{e("anim3"),S.setState({animationPercentageTarget:.6}),setTimeout(()=>{S.getState().changeState("open2")},1e3)};return{openAnimation:r,closeAnimation:a,reopenAnimation:o,show:n,hide:i}};var _=n(4090);function E(e){let{children:t}=e,n=(0,m.useRef)(void 0),[r,a]=(0,_.I)({range:[-.075,.075]}),o=(0,l.c)(1.2),v=(0,d.v)(y.selectCurrentStep),x=(0,d.v)(T.selectMouseCameraOffsetIntensity),p=(0,l.c)(x),f=(0,m.useRef)(0),h=(0,m.useRef)(1.2);return(0,c.W)(o,"change",e=>{h.current=e}),(0,m.useEffect)(()=>{(0,u.j)(p,x,{duration:1.2,ease:[.42,0,.58,1],type:"tween",onUpdate:e=>{f.current=e}})},[x,p,v]),(0,s.A)(()=>{void 0!==n.current&&n.current.rotation.set(a.get()*f.current,0,r.get()*f.current)}),(0,i.jsx)("group",{ref:n,children:t})}let D={idle:.001,anim1:.25,anim2:.53};function R(){var e;let t=(0,s.z)(e=>e.camera),n=(0,m.useRef)(void 0),r=(0,a.L)(x.k.cameraAnimation),p=(0,d.v)(j.selectCurrentAnimation),f=(0,m.useRef)(null),h=(0,m.useRef)(null),g=(0,m.useRef)(0),z=(e=r.cameras,(0,m.useMemo)(()=>{console.assert(e.length>0,"gltfCameras is empty. Check your GLTF file");let t=e[0];if(!(t instanceof v.PerspectiveCamera))return console.error("Camera type ".concat(t.type," is not supported")),50;{let e=Math.ceil(t.fov);return e}},[e]));!function(){let e=(0,d.v)(y.selectCurrentStep),t=(0,d.v)(T.selectSetMouseCameraOffsetFactor),n=M();(0,m.useEffect)(()=>{switch(e){case C.h.INTRO:t(0);break;case C.h.INTRO_OUT:case C.h.START:t(.25);break;case C.h.ENTER_BOX:setTimeout(()=>{n.show()},1500),n.closeAnimation(),t(0);break;case C.h.DISCOVER:setTimeout(()=>{t(.3)},3400);break;case C.h.RESULTS:t(0),n.reopenAnimation();break;default:t(1.2)}},[e])}(),(0,m.useEffect)(()=>{if(f.current)return;let e=r.animations,n=e[0];"Camera"===t.name&&n&&(g.current=n.duration-.01,0===g.current&&console.error("animDuration is 0"),f.current=new v.AnimationMixer(t),h.current=f.current.clipAction(n),h.current.play(),f.current.update(.001))},[t,r]);let w=(0,l.c)(0);return(0,c.W)(w,"change",e=>{if(f.current){if(e>1||e<0)return console.warn("animationProgress should be in [0,1] range");f.current.setTime(e*g.current)}}),(0,m.useEffect)(()=>{"idle"===p||("anim1"===p?(0,u.j)(w,D.anim1,{duration:3.75,type:"tween",ease:"linear",onStop:()=>{console.warn("[CameraGltfAnimation] anim1 stopped but it should not.")}}):"anim2"===p?(0,u.j)(w,D.anim2,{duration:4.2,type:"tween",ease:"linear",onStop:()=>{console.warn("[CameraGltfAnimation] anim2 stopped but it should not.")}}):"anim3"===p&&(0,u.j)(w,1,{duration:8,type:"tween",ease:"linear",onComplete:()=>{S.setState({visible:!1})},onStop:()=>{console.warn("[CameraGltfAnimation] anim3 stopped but it should not."),S.setState({visible:!1})}}))},[p,w]),(0,i.jsx)(E,{children:(0,i.jsx)("group",{scale:100,rotation:[0,0,0],children:(0,i.jsx)(o.c,{makeDefault:!0,name:"Camera",far:4e3,fov:z,ref:e=>{e&&void 0===n.current&&(n.current=e,n.current.lookAt(new v.Vector3(0,0,0)))}})})})}let N=new v.Vector3(0,0,0);N.clone().add(new v.Vector3(0,0,-20));var L=n(6139),A=n(1077),I=n(4529);let k=(e,t)=>{let{target:n,value:i,velocity:r}=e,{stiffness:a,friction:o,delta:s,mass:l}={stiffness:100,friction:5,delta:1/60,mass:1,...t};e.velocity+=(a*(n-i)-o*r)/l*s,e.value+=r*s};var O=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"default",i=arguments.length>3?arguments[3]:void 0,{stagger:r,onComplete:a,onUpdate:o,decimalFixed:s,delta:l,initial:c,id:u,...m}={stagger:1,stiffness:20,friction:10,mass:0,delta:1/60,initial:[0],...i},v=e;void 0===v._motion&&(v._motion={}),void 0===v._motion[n]&&(v._motion[n]=Array(t.length).fill(0).map((e,t)=>({value:c&&c[t]||0,velocity:0,target:0})));let x=v._motion[n];if(x.forEach((e,n)=>{if(e.target=t[n],m.mass>0?k(e,{...m,delta:l}):e.value+=(e.target-e.value)*(1/m.friction*60)*r*l,0===m.friction&&0===m.mass&&(e.value=e.target),void 0!==s){let t=parseFloat(e.value.toFixed(s));e.value=t}}),a||o){let e=!!a&&x.every(e=>1e-4>Math.abs(e.velocity));o&&!e&&o(x),a&&e&&a()}return x.map(e=>e.value)};let V=(e,t)=>{let n=(0,m.useRef)({}),i=(0,m.useRef)(),r=(0,m.useRef)((null==e?void 0:e.initial)||[]),a=(0,m.useRef)({});(0,I.ZP)(o=>{i.current&&(r.current=O((null==e?void 0:e.element)||n.current,i.current,t,{delta:o,...e,...a.current}))});let o=(0,m.useCallback)((e,t)=>{i.current=Array.isArray(e)?e:[e],t&&(a.current=t)},[]);return[o,r]};var F=n(9838),G=n(8031),U=n(2805),X="vec4 mod289(vec4 x) {\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nfloat mod289(float x) {\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x) {\n    return mod289(((x*34.0)+1.0)*x);\n}\n\nfloat permute(float x) {\n    return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r) {\n    return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat taylorInvSqrt(float r) {\n    return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nvec4 grad4(float j, vec4 ip) {\n    const vec4 ones = vec4(1.0, 1.0, 1.0, -1.0);\n    vec4 p,s;\n\n    p.xyz = floor( fract (vec3(j) * ip.xyz) * 7.0) * ip.z - 1.0;\n    p.w = 1.5 - dot(abs(p.xyz), ones.xyz);\n    s = vec4(lessThan(p, vec4(0.0)));\n    p.xyz = p.xyz + (s.xyz*2.0 - 1.0) * s.www;\n\n    return p;\n}\n\n#define F4 0.309016994374947451\n\nvec4 simplexNoiseDerivatives (vec4 v) {\n    const vec4  C = vec4( 0.138196601125011,0.276393202250021,0.414589803375032,-0.447213595499958);\n\n    vec4 i  = floor(v + dot(v, vec4(F4)) );\n    vec4 x0 = v -   i + dot(i, C.xxxx);\n\n    vec4 i0;\n    vec3 isX = step( x0.yzw, x0.xxx );\n    vec3 isYZ = step( x0.zww, x0.yyz );\n    i0.x = isX.x + isX.y + isX.z;\n    i0.yzw = 1.0 - isX;\n    i0.y += isYZ.x + isYZ.y;\n    i0.zw += 1.0 - isYZ.xy;\n    i0.z += isYZ.z;\n    i0.w += 1.0 - isYZ.z;\n\n    vec4 i3 = clamp( i0, 0.0, 1.0 );\n    vec4 i2 = clamp( i0-1.0, 0.0, 1.0 );\n    vec4 i1 = clamp( i0-2.0, 0.0, 1.0 );\n\n    vec4 x1 = x0 - i1 + C.xxxx;\n    vec4 x2 = x0 - i2 + C.yyyy;\n    vec4 x3 = x0 - i3 + C.zzzz;\n    vec4 x4 = x0 + C.wwww;\n\n    i = mod289(i);\n    float j0 = permute( permute( permute( permute(i.w) + i.z) + i.y) + i.x);\n    vec4 j1 = permute( permute( permute( permute (\n             i.w + vec4(i1.w, i2.w, i3.w, 1.0 ))\n           + i.z + vec4(i1.z, i2.z, i3.z, 1.0 ))\n           + i.y + vec4(i1.y, i2.y, i3.y, 1.0 ))\n           + i.x + vec4(i1.x, i2.x, i3.x, 1.0 ));\n\n\n    vec4 ip = vec4(1.0/294.0, 1.0/49.0, 1.0/7.0, 0.0) ;\n\n    vec4 p0 = grad4(j0,   ip);\n    vec4 p1 = grad4(j1.x, ip);\n    vec4 p2 = grad4(j1.y, ip);\n    vec4 p3 = grad4(j1.z, ip);\n    vec4 p4 = grad4(j1.w, ip);\n\n    vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n    p0 *= norm.x;\n    p1 *= norm.y;\n    p2 *= norm.z;\n    p3 *= norm.w;\n    p4 *= taylorInvSqrt(dot(p4,p4));\n\n    vec3 values0 = vec3(dot(p0, x0), dot(p1, x1), dot(p2, x2)); //value of contributions from each corner at point\n    vec2 values1 = vec2(dot(p3, x3), dot(p4, x4));\n\n    vec3 m0 = max(0.5 - vec3(dot(x0,x0), dot(x1,x1), dot(x2,x2)), 0.0); //(0.5 - x^2) where x is the distance\n    vec2 m1 = max(0.5 - vec2(dot(x3,x3), dot(x4,x4)), 0.0);\n\n    vec3 temp0 = -6.0 * m0 * m0 * values0;\n    vec2 temp1 = -6.0 * m1 * m1 * values1;\n\n    vec3 mmm0 = m0 * m0 * m0;\n    vec2 mmm1 = m1 * m1 * m1;\n\n    float dx = temp0[0] * x0.x + temp0[1] * x1.x + temp0[2] * x2.x + temp1[0] * x3.x + temp1[1] * x4.x + mmm0[0] * p0.x + mmm0[1] * p1.x + mmm0[2] * p2.x + mmm1[0] * p3.x + mmm1[1] * p4.x;\n    float dy = temp0[0] * x0.y + temp0[1] * x1.y + temp0[2] * x2.y + temp1[0] * x3.y + temp1[1] * x4.y + mmm0[0] * p0.y + mmm0[1] * p1.y + mmm0[2] * p2.y + mmm1[0] * p3.y + mmm1[1] * p4.y;\n    float dz = temp0[0] * x0.z + temp0[1] * x1.z + temp0[2] * x2.z + temp1[0] * x3.z + temp1[1] * x4.z + mmm0[0] * p0.z + mmm0[1] * p1.z + mmm0[2] * p2.z + mmm1[0] * p3.z + mmm1[1] * p4.z;\n    float dw = temp0[0] * x0.w + temp0[1] * x1.w + temp0[2] * x2.w + temp1[0] * x3.w + temp1[1] * x4.w + mmm0[0] * p0.w + mmm0[1] * p1.w + mmm0[2] * p2.w + mmm1[0] * p3.w + mmm1[1] * p4.w;\n\n    return vec4(dx, dy, dz, dw) * 49.0;\n}\n\n\nvec3 curl( in vec3 p, in float noiseTime, in float persistence ) {\n\n    vec4 xNoisePotentialDerivatives = vec4(0.0);\n    vec4 yNoisePotentialDerivatives = vec4(0.0);\n    vec4 zNoisePotentialDerivatives = vec4(0.0);\n\n    for (int i = 0; i < 3; ++i) {\n\n        float twoPowI = pow(2.0, float(i));\n        float scale = 0.5 * twoPowI * pow(persistence, float(i));\n\n        xNoisePotentialDerivatives += simplexNoiseDerivatives(vec4(p * twoPowI, noiseTime)) * scale;\n        yNoisePotentialDerivatives += simplexNoiseDerivatives(vec4((p + vec3(123.4, 129845.6, -1239.1)) * twoPowI, noiseTime)) * scale;\n        zNoisePotentialDerivatives += simplexNoiseDerivatives(vec4((p + vec3(-9519.0, 9051.0, -123.0)) * twoPowI, noiseTime)) * scale;\n    }\n\n    return vec3(\n        zNoisePotentialDerivatives[1] - yNoisePotentialDerivatives[2],\n        xNoisePotentialDerivatives[2] - zNoisePotentialDerivatives[0],\n        yNoisePotentialDerivatives[0] - xNoisePotentialDerivatives[1]\n    );\n\n}\n",B=n(5793),Z=n(441);function W(e,t){let n=new Float32Array(4*(e*e)),i=new Z.a(t).build(),r=new v.Vector3;for(let t=0;t<e;t++)for(let a=0;a<e;a++){let o=t*e+a;i.sample(r),n[4*o]=r.x,n[4*o+1]=r.y,n[4*o+2]=r.z,n[4*o+3]=Math.random()}let a=new v.DataTexture(n,e,e,v.RGBAFormat,v.FloatType);return a.needsUpdate=!0,a}function q(e){let t,n,i;let r=new Float32Array(4*(e*e));for(let a=0;a<e;a++)for(let o=0;o<e;o++){let s=a*e+o;t=(.5+.5*Math.pow(Math.random(),.4))*50,t=.5+.5*Math.random(),n=(Math.random()-.5)*Math.PI,i=Math.random()*Math.PI*2,r[4*s]=t*Math.cos(i)*Math.cos(n)*22.5,r[4*s+1]=t*Math.sin(n)*22.5,r[4*s+2]=(o/e-.5)*22.5,r[4*s+3]=Math.random()}let a=new v.DataTexture(r,e,e,v.RGBAFormat,v.FloatType);return a.needsUpdate=!0,a}var Y="\nvoid main() {\n    vec2 vUv = gl_FragCoord.xy / resolution.xy;\n    vec4 velocity = texture2D( uCurrentVelocity, vUv );\n\n    gl_FragColor = velocity;\n}";let H=(0,U.$)({dependencies:[X],src:"uniform float uProgress;\nuniform float uGenerate;\nuniform float uInitAnimation;\nuniform float uSpeed;\nuniform float uDieSpeed;\nuniform float uAttraction;\nuniform float uRadius;\nuniform float uCurlSize;\nuniform vec3 uFollowPosition;\nuniform sampler2D uModelPosition;\nuniform sampler2D uStartPosition;\nuniform sampler2D uOriginalPosition;\nuniform float uTime;\n\nfloat rand(vec2 co){\n    return fract(sin(dot(co, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\n//\n// Description : Array and textureless GLSL 2D/3D/4D simplex\n//               noise functions.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nfloat snoise(vec3 v)\n  {\n  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\n// First corner\n  vec3 i  = floor(v + dot(v, C.yyy) );\n  vec3 x0 =   v - i + dot(i, C.xxx) ;\n\n// Other corners\n  vec3 g = step(x0.yzx, x0.xyz);\n  vec3 l = 1.0 - g;\n  vec3 i1 = min( g.xyz, l.zxy );\n  vec3 i2 = max( g.xyz, l.zxy );\n\n  //   x0 = x0 - 0.0 + 0.0 * C.xxx;\n  //   x1 = x0 - i1  + 1.0 * C.xxx;\n  //   x2 = x0 - i2  + 2.0 * C.xxx;\n  //   x3 = x0 - 1.0 + 3.0 * C.xxx;\n  vec3 x1 = x0 - i1 + C.xxx;\n  vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n  vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n\n// Permutations\n  i = mod289(i);\n  vec4 p = permute( permute( permute(\n             i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n           + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n           + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n// Gradients: 7x7 points over a square, mapped onto an octahedron.\n// The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n  float n_ = 0.142857142857; // 1.0/7.0\n  vec3  ns = n_ * D.wyz - D.xzx;\n\n  vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n\n  vec4 x_ = floor(j * ns.z);\n  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\n  vec4 x = x_ *ns.x + ns.yyyy;\n  vec4 y = y_ *ns.x + ns.yyyy;\n  vec4 h = 1.0 - abs(x) - abs(y);\n\n  vec4 b0 = vec4( x.xy, y.xy );\n  vec4 b1 = vec4( x.zw, y.zw );\n\n  //vec4 s0 = vec4(lessThan(b0,0.0))*2.0 - 1.0;\n  //vec4 s1 = vec4(lessThan(b1,0.0))*2.0 - 1.0;\n  vec4 s0 = floor(b0)*2.0 + 1.0;\n  vec4 s1 = floor(b1)*2.0 + 1.0;\n  vec4 sh = -step(h, vec4(0.0));\n\n  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n  vec3 p0 = vec3(a0.xy,h.x);\n  vec3 p1 = vec3(a0.zw,h.y);\n  vec3 p2 = vec3(a1.xy,h.z);\n  vec3 p3 = vec3(a1.zw,h.w);\n\n//Normalise gradients\n  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n  p0 *= norm.x;\n  p1 *= norm.y;\n  p2 *= norm.z;\n  p3 *= norm.w;\n\n// Mix final noise value\n  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n  m = m * m;\n  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),\n                                dot(p2,x2), dot(p3,x3) ) );\n  }\n\n\nvec3 snoiseVec3( vec3 x ){\n\n    float s  = snoise(vec3( x ));\n    float s1 = snoise(vec3( x.y - 19.1 , x.z + 33.4 , x.x + 47.2 ));\n    float s2 = snoise(vec3( x.z + 74.2 , x.x - 124.5 , x.y + 99.4 ));\n    vec3 c = vec3( s , s1 , s2 );\n    return c;\n  \n  }\n  \n  \n  vec3 curlNoise( vec3 p ){\n    \n    const float e = .1;\n    vec3 dx = vec3( e   , 0.0 , 0.0 );\n    vec3 dy = vec3( 0.0 , e   , 0.0 );\n    vec3 dz = vec3( 0.0 , 0.0 , e   );\n  \n    vec3 p_x0 = snoiseVec3( p - dx );\n    vec3 p_x1 = snoiseVec3( p + dx );\n    vec3 p_y0 = snoiseVec3( p - dy );\n    vec3 p_y1 = snoiseVec3( p + dy );\n    vec3 p_z0 = snoiseVec3( p - dz );\n    vec3 p_z1 = snoiseVec3( p + dz );\n  \n    float x = p_y1.z - p_y0.z - p_z1.y + p_z0.y;\n    float y = p_z1.x - p_z0.x - p_x1.z + p_x0.z;\n    float z = p_x1.y - p_x0.y - p_y1.x + p_y0.x;\n  \n    const float divisor = 1.0 / ( 2.0 * e );\n    return normalize( vec3( x , y , z ) * divisor );\n  \n  }\n\n\nvec2 rotate(vec2 v, float a) {\n	float s = sin(a);\n	float c = cos(a);\n	mat2 m = mat2(c, s, -s, c);\n	return m * v;\n}\n\nmat4 rotationMatrix(vec3 axis, float angle) {\n    axis = normalize(axis);\n    float s = sin(angle);\n    float c = cos(angle);\n    float oc = 1.0 - c;\n    \n    return mat4(oc * axis.x * axis.x + c,           oc * axis.x * axis.y - axis.z * s,  oc * axis.z * axis.x + axis.y * s,  0.0,\n                oc * axis.x * axis.y + axis.z * s,  oc * axis.y * axis.y + c,           oc * axis.y * axis.z - axis.x * s,  0.0,\n                oc * axis.z * axis.x - axis.y * s,  oc * axis.y * axis.z + axis.x * s,  oc * axis.z * axis.z + c,           0.0,\n                0.0,                                0.0,                                0.0,                                1.0);\n}\n\nvec3 rotate(vec3 v, vec3 axis, float angle) {\n	mat4 m = rotationMatrix(axis, angle);\n	return (m * vec4(v, 1.0)).xyz;\n}\n\nmat3 rotateY(float theta) {\n    float c = cos(theta);\n    float s = sin(theta);\n    return mat3(\n        vec3(c, 0, s),\n        vec3(0, 1, 0),\n        vec3(-s, 0, c)\n    );\n}\n\nvoid main() {\n    vec2 vUv = gl_FragCoord.xy / resolution.xy;\n    float offset = rand(vUv);\n    vec4 modelPosition = texture2D( uModelPosition, vUv );\n    vec4 position = texture2D( uCurrentPosition, vUv );\n    vec4 velocity = texture2D( uCurrentVelocity, vUv );\n    vec4 startPosition = texture2D( uStartPosition, vUv );\n    vec4 randPosition = texture2D(uOriginalPosition, vUv);\n    vec3 results = velocity.xyz;\n\n    // vec4 startPosition = vec4(0.0, 0.0, 0.0, 2.0);\n\n\n\n    // float len = length(force);\n    // float forceFactor = 1./max(1.,len*50.);\n\n    // NB:::: usare direttamente le uniforms\n    float curlSize = uCurlSize;  //0.03\n    float motionMultiplier = 1.; // amplifica movimento di followPosition\n    float rotateMultiplierStart = 0.55; // 4.0\n    float rotateMultiplierEnd = .0005; // .005\n    float attraction = uAttraction; //0.004; // valore piccolo allungo la coda\n    float radius = uRadius; // 0.84 ingradinto dopo richiesta cliente 1.34\n    float speed = uSpeed;\n\n\n    // vec3 followPosition = uFollowPosition * motionMultiplier * uInitAnimation * uProgress  + (sin(uTime *vUv.x) * 0.3 * uInitAnimation * uProgress);\n    vec3 followPosition = uFollowPosition * motionMultiplier * uInitAnimation * uProgress;\n\n\n    // forza cerso followPosition\n    // vec3 force = followPosition.xyz - position.xyz;\n    // forza respinta da followPosition\n    // vec3 force = followPosition.xyz - position.xyz;\n\n    // vec3 positionToGo = position.xyz + normalize(force) * attraction;\n    float life =  position.a - uDieSpeed;\n\n    // particelle fuori dal flusso\n    // if(startPosition.a > 1.1) {\n    //   // life = 1.0 - startPosition.a;\n    //   // results += curl(results * 0.005, uTime, 0.1 + (1.0 - life) * 0.1) * 0.009;\n    //   // life = startPosition.a;\n    // } else {  \n      startPosition = mix(modelPosition, startPosition, uProgress);\n\n      if(life < 0.0) {\n\n          results = startPosition.xyz;\n          results = startPosition.xyz * (1.0 + sin(uTime * 15.0) * 0.2 + 1.0 ) * 0.4 * radius;\n\n          // results.x *= (3.0 + offset * 0.2) * 0.4 * radius;\n          // results.y *= (3.0 + offset * 0.2) * 0.4 * radius;\n          // results.z *= (3.4 + offset * 0.2) * 0.4 * radius;\n\n          results += followPosition;\n          // if (uGenerate < 1.0) {\n          //   result.xyz = followPosition;\n          // }\n          if(uInitAnimation == 1.0) {\n            // results.xy = rotate(results.xy, rotateMultiplierStart );\n            results.xz = rotate(results.xz, rotateMultiplierStart );\n          }\n        // life = 0.5 + fract(startPosition.w * 21.4131 + uTime);\n        life = startPosition.w;\n      } else {\n          vec3 delta = followPosition - results.xyz;\n          // results += delta;\n          results.xyz += delta * (0.005 + life * 0.01) * attraction * (1.0 - smoothstep(5.0, 350.0, length(delta))) * speed;\n          results.xyz += curl(results.xyz * curlSize, uTime, 0.1 + (1.0 - life) * 0.1) * speed;\n          if(uInitAnimation == 1.0) {\n            // results.xy = rotate(results.xy, rotateMultiplierEnd );\n            results.xz = rotate(results.xz, rotateMultiplierEnd );\n          }\n      }\n          // results.xyz *= rotateY( (1.0 - uInitAnimation ) * 2.0 );\n    // }\n    // results.xy += vec2(sin(offset) * 0.2);\n    // results *= rotateY( (1.0 - uInitAnimation ) * -0.02);\n    results *= rotateY( uGenerate );\n    \n    // gl_FragColor = vec4(velocity.xyz, uInitAnimation * life);\n    gl_FragColor = vec4(results.xyz, uInitAnimation * life);\n}\n"}),K=e=>{let{}=e,t=(0,a.L)(x.k.logo),n=B.sL.getState().isMobile,i=(0,m.useMemo)(()=>({progress:0,speed:[.02,.02,.03],dieSpeed:[.001,.001,.001],radius:[0,2.2,1.77],curlSize:[0,.06,.02],attraction:[80,-23,-13],xTranslate:[0,0,0],yTranslate:[0,0,0],zTranslate:[0,0,0],zPosition:[0,100,0]}),[n]),r=(0,d.v)(y.selectCurrentStep),o=(0,m.useRef)(0),p=(0,m.useRef)(!1),f=(0,m.useRef)(null),h=(0,m.useRef)(new v.Mesh),g=(0,m.useRef)(null),z=(0,m.useRef)(null),w=(0,m.useRef)(!0),b=(0,m.useRef)(new v.Clock(!0)),{gl:S}=(0,s.z)(),T=(0,m.useMemo)(()=>new F.n(64,64,S),[S,64]),j=(0,m.useRef)({progress:i.progress[0],speed:i.speed[1],dieSpeed:i.dieSpeed[1],radius:i.radius[1],curlSize:i.curlSize[1],attraction:i.attraction[1],xTranslate:i.xTranslate[1],yTranslate:i.yTranslate[1],zTranslate:i.zTranslate[1],zPosition:i.zPosition[1]}),M=(0,m.useMemo)(()=>{h.current=t.scene.children[0];let e=h.current.geometry.clone();e.scale(100,100,100),e.rotateX(.5*Math.PI),e.computeBoundingBox();let n=new v.Mesh(e);return W(64,n)},[h,t.scene]),_=(0,m.useMemo)(()=>q(64),[64]),E=(0,m.useMemo)(()=>T.addVariable("uCurrentPosition",Y,_),[_,Y,T]),D=(0,m.useMemo)(()=>T.addVariable("uCurrentVelocity",H,_),[_,H,T]),R=(0,m.useMemo)(()=>({uPosition:{value:null},uVelocity:{value:null},uStartPosition:{value:M},uLight:{value:new v.Vector3(0,0,0)},uTime:{value:0},uProgress:{value:0},uGenerate:{value:0}}),[]),N=(0,m.useCallback)(e=>{(0,u.j)(k,e,{ease:[.41,0,.3,1],duration:1.3})},[]);(0,G.Z)(e=>{w.current=e,!1===e?b.current.stop():b.current.start()});let L=(0,l.c)(0),A=(0,l.c)(0),I=(0,l.c)(0),k=(0,l.c)(0),O=(0,l.c)(0);(0,c.W)(L,"change",e=>{z.current&&(z.current.uInitAnimation.value=e)}),(0,c.W)(A,"change",e=>{null!==f.current&&(f.current.material.uniforms.uProgress.value=e)}),(0,c.W)(I,"change",e=>{null!==f.current&&(f.current.scale.x=e,f.current.scale.y=e,f.current.scale.z=e)}),(0,c.W)(k,"change",e=>{z.current&&(z.current.uGenerate.value=e)}),(0,c.W)(O,"change",e=>{null!==f.current&&(f.current.position.z=e)});let[U]=V({stiffness:100,friction:4,mass:.1,onUpdate:e=>{let[t,n,i,r,a,o,s,l]=e;z.current&&(z.current.uSpeed.value=t.value,z.current.uDieSpeed.value=n.value,z.current.uAttraction.value=a.value,z.current.uRadius.value=i.value,z.current.uCurlSize.value=r.value,j.current.xTranslate=o.value,j.current.yTranslate=s.value,j.current.zTranslate=l.value)}});(0,m.useEffect)(()=>{r===C.h.INTRO&&((0,u.j)(L,1,{ease:P.SX.out,duration:1.4,delay:.2}),(0,u.j)(I,3.7,{ease:P.SX.inOut,duration:3.9,delay:.1}),(0,u.j)(A,1,{ease:P.SX.out,duration:.7}),N(.0035),setTimeout(()=>{N(0),U([i.speed[1],i.dieSpeed[1],i.radius[1],i.curlSize[1],i.attraction[1],0,0,0]),(0,u.j)(A,0,{ease:P.SX.out,duration:2.5,delay:1}),(0,u.j)(O,i.zPosition[1],{ease:P.SX.in,duration:3.2})},600)),r===C.h.INTRO_OUT&&(U([i.speed[0],i.dieSpeed[0],i.radius[0],i.curlSize[0],i.attraction[0],0,0,0]),(0,u.j)(L,0,{ease:P.SX.out,duration:.1}),null!==f.current&&(f.current.material.uniforms.uProgress.value=0,f.current.position.y=800),z.current&&(z.current.uInitAnimation.value=0))},[r]);let X=(0,m.useCallback)(()=>{let{speed:e,dieSpeed:t,progress:n,attraction:i,radius:r,curlSize:a}=j.current;g.current=E.material.uniforms,z.current=D.material.uniforms,g.current.uModelPosition={value:M},g.current.uOriginalPosition={value:M},z.current.uOriginalPosition={value:M},z.current.uModelPosition={value:M},z.current.uStartPosition={value:M},z.current.uFollowPosition={value:new v.Vector3(0,0,0)},z.current.uProgress={value:n},z.current.uGenerate={value:0},z.current.uInitAnimation={value:0},z.current.uSpeed={value:e},z.current.uDieSpeed={value:t},z.current.uAttraction={value:i},z.current.uRadius={value:r},z.current.uCurlSize={value:a},z.current.uTime={value:0},p.current=!0},[T,E,D]);return(0,m.useEffect)(()=>{T.setVariableDependencies(E,[E,D]),T.setVariableDependencies(D,[D,E]);let e=T.init();return null!==e&&console.error(e),X(),()=>{T.dispose()}},[S,64,T]),(0,m.useEffect)(()=>{var e;let t=new Float32Array(8192);for(let e=0;e<64;e++)for(let n=0;n<64;n++){let i=64*e+n;t[2*i+0]=e/63,t[2*i+1]=n/63}null===(e=f.current)||void 0===e||e.geometry.setAttribute("ref",new v.InstancedBufferAttribute(t,2))},[]),(0,s.A)((e,t)=>{let{gl:n}=e;t=b.current.getDelta(),p.current&&null!==f.current&&w.current&&(o.current+=t,T.compute(),z.current.uTime.value+=5e-4,f.current.material.uniforms.uTime.value=o.current,f.current.material.uniforms.uPosition.value=T.getCurrentRenderTarget(E).texture,f.current.material.uniforms.uVelocity.value=T.getCurrentRenderTarget(D).texture,f.current.material.uniforms.uLight.value.x=30*Math.cos(o.current),f.current.material.uniforms.uLight.value.y=20*Math.sin(o.current))}),{SIZE:64,iref:f,sampleRef:h,gl:S,gpuCompute:T,uniforms:R,model:t,zPosition:0}},Q={vertex:"\n      uniform float uTime;\n      uniform sampler2D uPosition;\n      uniform sampler2D uVelocity;\n      uniform vec3 uLight;\n      attribute vec2 ref;\n      varying float vLife;\n      varying vec2 vUv;\n\n      vec3 rotate3D(vec3 v, vec3 vel) {\n        vec3 newpos = v;\n        vec3 up = vec3(sin(uTime * 0.4), cos(uTime * 0.6), cos(uTime * 0.2));\n        vec3 axis = normalize(vel);\n        // float angle = acos(dot(up, normalize(vel)));\n        // float angle = max(0.0, min(rand(vUv) * 1.31, 1.31));\n        float angle = max(0.0, min(acos(dot(up, normalize(vel))), 0.9));\n        newpos = newpos * cos(angle) + axis * dot(axis, newpos) * (1. - cos(angle));\n        return newpos;\n      }\n\n      vec3 displace(vec3 point, vec3 vel) {\n        vec3 pos = texture2D(uPosition,ref).rgb;\n        vec3 copypoint = rotate3D(point, vel);\n        // NO ROtate3D Particles\n        // vec3 copypoint = point;\n        vec3 instancePosition = (instanceMatrix * vec4(copypoint, 1.)).xyz;\n        return instancePosition + pos;\n      }\n\n      void main() {\n        vec4 vel = texture2D(uVelocity,ref);\n        vec3 p = displace(position, vel.xyz);\n        vLife = vel.w;\n        vUv = ref;\n        csm_PositionRaw = projectionMatrix * modelViewMatrix * instanceMatrix * vec4(p, 1.0);\n        // non male vLife scala quelle che stanno morendo\n        float scale = abs((vLife * 2.0) - 1.0);\n        // csm_PositionRaw = projectionMatrix * modelViewMatrix * instanceMatrix * vec4(p, 1.0) * scale;\n        // csm_PositionRaw.z -= vLife;\n\n        csm_Normal = rotate3D(normal, vel.xyz);\n        // csm_Normal = rotate3D(normal, p);\n      }\n      ",fragment:"\n    uniform sampler2D uVelocity;\n    uniform sampler2D uStartPosition;\n    uniform vec3 uLight;\n    uniform float uTime;\n    uniform float uProgress;\n    varying vec2 vUv;\n    varying float vLife;\n\n    // float rand(vec2 co){\n    //     return fract(sin(dot(co, vec2(12.9898, 78.233))) * 43758.5453);\n    // }\n      void main() {\n        // OLD + Light meno nette\n        // vec4 position = texture2D( uStartPosition, vUv );\n        vec4 position = texture2D( uVelocity, vUv );\n        // csm_Emissive = vec3(0.57,0.17,0.5);  // rosa\n        vec3 color = diffuse;\n        vec3 emissiveColor = emissive;\n\n        // vec2 light1Pos = vec2(24.0 * sin(uTime * 0.5),\n        //                   12.0 * cos(uTime));\n\n        // vec2 light2Pos = vec2(30.0 * cos(uTime * 0.25),\n        //                   24.0 * sin(uTime * 0.5));\n\n        // float lightsGroup = (distance( light1Pos, position.xy ) * 0.05) * (distance( light2Pos, position.xy ) * 0.074);\n        float maxLight = 1.8;\n        float minLight = 0.5;\n        float lightsGroup = min(1., max(0., distance( position.xy, uLight.xy ) * 0.05));\n        lightsGroup *= min(maxLight - minLight, max(minLight, distance( position.xy, uLight.yx ) * 0.074));\n        // make the color go above vec3(1.0, 1.0, 1.0) so that it triggers bloom effect\n        // NEW bloom\n        float bloomAmount = pow(0.75 + 0.85 * lightsGroup, .8);\n        color.rgb += vec3((maxLight - lightsGroup));\n        // OLD bloom\n        // float bloomAmount = pow(0.5 + 0.5 * cos(uTime * 3.0 + position.x * 0.3 + position.y * 0.1) * scale, .8);\n        // color.rgb += vec3(bloomAmount * uProgress);\n\n        csm_Emissive = emissive;     //gold\n        csm_Roughness= 0.33;\n        csm_Metalness= 1.0;\n        // csm_DiffuseColor.rgb *= vec3(1.0 - vLife);\n        csm_DiffuseColor = vec4(color.xyz, uProgress);\n      }\n      "},$=e=>{let{}=e,{iref:t,sampleRef:n,SIZE:r,uniforms:a,model:o}=K({});return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("group",{position:[0,0,20],scale:1.1,frustumCulled:!1,children:[(0,i.jsx)("primitive",{ref:n,visible:!1,position:[0,0,0],object:o.scene}),(0,i.jsxs)("instancedMesh",{ref:t,args:[null,null,r*r],position:[0,0,0],scale:[0,0,0],frustumCulled:!1,children:[(0,i.jsx)("circleGeometry",{args:[.3,7]}),(0,i.jsx)(A.Z,{baseMaterial:v.MeshStandardMaterial,color:new v.Color(.7955833626088831,.5679280526392926,.12348620696030656),emissive:new v.Color(.39858561989004926,.24964921087690903,.007801537839903407),vertexShader:(0,L.kq)(Q.vertex),fragmentShader:(0,L.kq)(Q.fragment),uniforms:a,transparent:!0,toneMapped:!1})]})]})})},J=()=>(0,m.useMemo)(()=>{let e=document.createElement("canvas");e.width=256,e.height=256;let t=e.getContext("2d");t.fillStyle="#000000",t.fillRect(0,0,e.width,e.height),e.width;let n={x:.5*e.width,y:.5*e.height,r:.25*e.width},i=t.createRadialGradient(.5*e.width,.5*e.height,0,.5*e.width,.5*e.height,n.r);i.addColorStop(0,"rgba(255,255,255,0.2)"),i.addColorStop(1,"rgba(255,255,255,0.0)"),t.beginPath(),t.fillStyle=i,t.arc(n.x,n.y,n.r,0,2*Math.PI),t.fill();let r=new v.CanvasTexture(e);return r.needsUpdate=!0,r},[]),ee=()=>{let e=J();return(0,m.useMemo)(()=>{let t=new v.MeshBasicMaterial({color:0,alphaMap:e,transparent:!0,opacity:0});return t},[e])},et=()=>{let e=(0,a.L)(x.k.logo),t=B.sL.getState().isMobile,n=(0,m.useRef)(new v.Group),i=(0,d.v)(y.selectAppAssetsLoaded),r=(0,d.v)(y.selectCurrentStep),o=(0,d.v)(y.selectSetCurrentStep),s=(0,l.c)(0),p=(0,l.c)(-1*Math.PI),f=(0,l.c)(20),h=ee();(0,c.W)(s,"change",e=>{n.current&&(n.current.children[0].material.opacity=e,n.current.children[1].material.opacity=e,h.opacity=e)}),(0,c.W)(s,"animationComplete",()=>{0===n.current.children[0].material.opacity&&b([0,0,0])}),(0,c.W)(p,"change",e=>{n.current&&n.current.rotation.set(0,e,0)}),(0,c.W)(f,"change",e=>{n.current&&n.current.position.set(0,0,e)});let w=(0,g.m)(z.b.goldMatcap),[b]=V({stiffness:40,friction:15,mass:1,initial:[0,0,0],onUpdate:e=>{let[t,i,r]=e;n.current&&n.current.scale.set(t.value,i.value,r.value)}}),S=(0,m.useCallback)(()=>{o(C.h.START)},[]),T=(0,m.useCallback)(()=>{(0,u.j)(p,2*Math.PI,{ease:P.SX.out,duration:2.7}),(0,u.j)(f,0,{ease:P.SX.out,duration:1,delay:1.3}),(0,u.j)(s,0,{ease:P.SX.out,duration:.75,delay:1.3}),setTimeout(()=>S(),2e3)},[n]),j=(0,m.useCallback)(()=>{(0,u.j)(s,1,{ease:P.SX.out,duration:P.nL.fast}),b([1,1,1]),(0,u.j)(p,0,{ease:P.SX.out,duration:P.nL.default}),setTimeout(()=>o(C.h.INTRO_OUT),3500)},[n]);return(0,m.useEffect)(()=>{r===C.h.INTRO&&i&&j(),r===C.h.INTRO_OUT&&T()},[r,o,i]),{model:e,logoRef:n,goldMatcap:w,fakeShadowMaterial:h,goAway:T,isMobile:t}},en=()=>{let{logoRef:e,model:t,fakeShadowMaterial:n,goldMatcap:r,isMobile:a}=et({});return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("group",{ref:e,position:[0,0,20],rotation:[0,-1*Math.PI,0],scale:[0,0,0],children:[(0,i.jsx)("mesh",{name:"logo",geometry:t.nodes.logo_retopo.geometry,rotation:[.5*Math.PI,0,0],scale:a?60:90,position:[0,0,2.5],children:(0,i.jsx)("meshMatcapMaterial",{color:"efe8bf",matcap:r,transparent:!0,opacity:0,side:v.DoubleSide})}),(0,i.jsx)("mesh",{name:"logo2",geometry:t.nodes.logo_retopo.geometry,rotation:[.5*Math.PI,0,Math.PI],scale:a?60:90,position:[0,0,-2.5],children:(0,i.jsx)("meshMatcapMaterial",{color:"efe8bf",matcap:r,transparent:!0,opacity:0,side:v.DoubleSide})}),(0,i.jsx)("mesh",{name:"FakeShadow",scale:60,"position-y":-22,"rotation-x":-(.5*Math.PI),material:n,children:(0,i.jsx)("planeGeometry",{})})]}),(0,i.jsx)($,{})]})},ei=e=>{let{bakeShadowMaterial:t}=function(){let e=(0,d.v)(y.selectCurrentStep),t=S(e=>e.visible),n=(0,l.c)(0),i=(0,g.m)(z.b.shadow_map_inverted),r=(0,m.useMemo)(()=>{let e=new v.MeshBasicMaterial({color:0,transparent:!0,alphaMap:i});return e},[i]);return(0,m.useEffect)(()=>{e<C.h.WRAP?(0,u.j)(n,0,{duration:.1}):e===C.h.ENTER_BOX?(0,u.j)(n,1,{duration:.1,delay:1.5}):e===C.h.RESULTS&&(0,u.j)(n,0,{duration:1.5,delay:5.5})},[e,n]),(0,s.A)(()=>{r.opacity=n.get()}),{bakeShadowMaterial:r,boxVisible:t}}();return(0,i.jsx)("group",{...e,children:(0,i.jsx)("mesh",{name:"BakedShadow",position:[0,-.001,0],"rotation-x":-(.5*Math.PI),material:t,renderOrder:2,children:(0,i.jsx)("planeGeometry",{})})})};var er=n(9542),ea=n(6051),eo=n(2778),es="\nvoid main() {\n    vec2 vUv = gl_FragCoord.xy / resolution.xy;\n    vec4 velocity = texture2D( uCurrentVelocity, vUv );\n\n    gl_FragColor = velocity;\n}";let el=(0,U.$)({dependencies:[X],src:"uniform float uProgress;\nuniform float uGenerate;\nuniform float uInitAnimation;\nuniform float uSpeed;\nuniform float uDieSpeed;\nuniform float uAttraction;\nuniform float uRadius;\nuniform float uCurlSize;\nuniform vec3 uFollowPosition;\nuniform sampler2D uModelPosition;\nuniform sampler2D uStartPosition;\nuniform sampler2D uOriginalPosition;\nuniform float uTime;\n\nfloat rand(vec2 co){\n    return fract(sin(dot(co, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\n//\n// Description : Array and textureless GLSL 2D/3D/4D simplex\n//               noise functions.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nfloat snoise(vec3 v)\n  {\n  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\n// First corner\n  vec3 i  = floor(v + dot(v, C.yyy) );\n  vec3 x0 =   v - i + dot(i, C.xxx) ;\n\n// Other corners\n  vec3 g = step(x0.yzx, x0.xyz);\n  vec3 l = 1.0 - g;\n  vec3 i1 = min( g.xyz, l.zxy );\n  vec3 i2 = max( g.xyz, l.zxy );\n\n  //   x0 = x0 - 0.0 + 0.0 * C.xxx;\n  //   x1 = x0 - i1  + 1.0 * C.xxx;\n  //   x2 = x0 - i2  + 2.0 * C.xxx;\n  //   x3 = x0 - 1.0 + 3.0 * C.xxx;\n  vec3 x1 = x0 - i1 + C.xxx;\n  vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n  vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n\n// Permutations\n  i = mod289(i);\n  vec4 p = permute( permute( permute(\n             i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n           + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n           + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n// Gradients: 7x7 points over a square, mapped onto an octahedron.\n// The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n  float n_ = 0.142857142857; // 1.0/7.0\n  vec3  ns = n_ * D.wyz - D.xzx;\n\n  vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n\n  vec4 x_ = floor(j * ns.z);\n  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\n  vec4 x = x_ *ns.x + ns.yyyy;\n  vec4 y = y_ *ns.x + ns.yyyy;\n  vec4 h = 1.0 - abs(x) - abs(y);\n\n  vec4 b0 = vec4( x.xy, y.xy );\n  vec4 b1 = vec4( x.zw, y.zw );\n\n  //vec4 s0 = vec4(lessThan(b0,0.0))*2.0 - 1.0;\n  //vec4 s1 = vec4(lessThan(b1,0.0))*2.0 - 1.0;\n  vec4 s0 = floor(b0)*2.0 + 1.0;\n  vec4 s1 = floor(b1)*2.0 + 1.0;\n  vec4 sh = -step(h, vec4(0.0));\n\n  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n  vec3 p0 = vec3(a0.xy,h.x);\n  vec3 p1 = vec3(a0.zw,h.y);\n  vec3 p2 = vec3(a1.xy,h.z);\n  vec3 p3 = vec3(a1.zw,h.w);\n\n//Normalise gradients\n  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n  p0 *= norm.x;\n  p1 *= norm.y;\n  p2 *= norm.z;\n  p3 *= norm.w;\n\n// Mix final noise value\n  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n  m = m * m;\n  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),\n                                dot(p2,x2), dot(p3,x3) ) );\n  }\n\n\nvec3 snoiseVec3( vec3 x ){\n\n    float s  = snoise(vec3( x ));\n    float s1 = snoise(vec3( x.y - 19.1 , x.z + 33.4 , x.x + 47.2 ));\n    float s2 = snoise(vec3( x.z + 74.2 , x.x - 124.5 , x.y + 99.4 ));\n    vec3 c = vec3( s , s1 , s2 );\n    return c;\n  \n  }\n  \n  \n  vec3 curlNoise( vec3 p ){\n    \n    const float e = .1;\n    vec3 dx = vec3( e   , 0.0 , 0.0 );\n    vec3 dy = vec3( 0.0 , e   , 0.0 );\n    vec3 dz = vec3( 0.0 , 0.0 , e   );\n  \n    vec3 p_x0 = snoiseVec3( p - dx );\n    vec3 p_x1 = snoiseVec3( p + dx );\n    vec3 p_y0 = snoiseVec3( p - dy );\n    vec3 p_y1 = snoiseVec3( p + dy );\n    vec3 p_z0 = snoiseVec3( p - dz );\n    vec3 p_z1 = snoiseVec3( p + dz );\n  \n    float x = p_y1.z - p_y0.z - p_z1.y + p_z0.y;\n    float y = p_z1.x - p_z0.x - p_x1.z + p_x0.z;\n    float z = p_x1.y - p_x0.y - p_y1.x + p_y0.x;\n  \n    const float divisor = 1.0 / ( 2.0 * e );\n    return normalize( vec3( x , y , z ) * divisor );\n  \n  }\n\n\nvec2 rotate(vec2 v, float a) {\n	float s = sin(a);\n	float c = cos(a);\n	mat2 m = mat2(c, s, -s, c);\n	return m * v;\n}\n\nmat4 rotationMatrix(vec3 axis, float angle) {\n    axis = normalize(axis);\n    float s = sin(angle);\n    float c = cos(angle);\n    float oc = 1.0 - c;\n    \n    return mat4(oc * axis.x * axis.x + c,           oc * axis.x * axis.y - axis.z * s,  oc * axis.z * axis.x + axis.y * s,  0.0,\n                oc * axis.x * axis.y + axis.z * s,  oc * axis.y * axis.y + c,           oc * axis.y * axis.z - axis.x * s,  0.0,\n                oc * axis.z * axis.x - axis.y * s,  oc * axis.y * axis.z + axis.x * s,  oc * axis.z * axis.z + c,           0.0,\n                0.0,                                0.0,                                0.0,                                1.0);\n}\n\nvec3 rotate(vec3 v, vec3 axis, float angle) {\n	mat4 m = rotationMatrix(axis, angle);\n	return (m * vec4(v, 1.0)).xyz;\n}\n\nmat3 rotateY(float theta) {\n    float c = cos(theta);\n    float s = sin(theta);\n    return mat3(\n        vec3(c, 0, s),\n        vec3(0, 1, 0),\n        vec3(-s, 0, c)\n    );\n}\n\nvoid main() {\n    vec2 vUv = gl_FragCoord.xy / resolution.xy;\n    float offset = rand(vUv);\n    vec4 modelPosition = texture2D( uModelPosition, vUv );\n    vec4 position = texture2D( uCurrentPosition, vUv );\n    vec4 velocity = texture2D( uCurrentVelocity, vUv );\n    vec4 startPosition = texture2D( uStartPosition, vUv );\n    vec4 randPosition = texture2D(uOriginalPosition, vUv);\n    vec3 results = velocity.xyz;\n\n    // vec4 startPosition = vec4(0.0, 0.0, 0.0, 2.0);\n\n\n\n    // float len = length(force);\n    // float forceFactor = 1./max(1.,len*50.);\n\n    // NB:::: usare direttamente le uniforms\n    float curlSize = uCurlSize;  //0.03\n    float motionMultiplier = 1.; // amplifica movimento di followPosition\n    float rotateMultiplierStart = 0.55; // 4.0\n    float rotateMultiplierEnd = .0005; // .005\n    float attraction = uAttraction; //0.004; // valore piccolo allungo la coda\n    float radius = uRadius; // 0.84 ingradinto dopo richiesta cliente 1.34\n    float speed = uSpeed;\n\n\n    // vec3 followPosition = uFollowPosition * motionMultiplier * uInitAnimation * uProgress  + (sin(uTime *vUv.x) * 0.3 * uInitAnimation * uProgress);\n    vec3 followPosition = uFollowPosition * motionMultiplier * uInitAnimation * uProgress;\n\n\n    // forza cerso followPosition\n    // vec3 force = followPosition.xyz - position.xyz;\n    // forza respinta da followPosition\n    // vec3 force = followPosition.xyz - position.xyz;\n\n    // vec3 positionToGo = position.xyz + normalize(force) * attraction;\n    float life =  position.a - uDieSpeed;\n\n    // particelle fuori dal flusso\n    // if(startPosition.a > 1.1) {\n    //   // life = 1.0 - startPosition.a;\n    //   // results += curl(results * 0.005, uTime, 0.1 + (1.0 - life) * 0.1) * 0.009;\n    //   // life = startPosition.a;\n    // } else {  \n      startPosition = mix(modelPosition, startPosition, uProgress);\n\n      if(life < 0.0) {\n\n          results = startPosition.xyz;\n          results = startPosition.xyz * (1.0 + sin(uTime * 15.0) * 0.2 + 1.0 ) * 0.4 * radius;\n\n          // results.x *= (3.0 + offset * 0.2) * 0.4 * radius;\n          // results.y *= (3.0 + offset * 0.2) * 0.4 * radius;\n          // results.z *= (3.4 + offset * 0.2) * 0.4 * radius;\n\n          results += followPosition;\n          // if (uGenerate < 1.0) {\n          //   result.xyz = followPosition;\n          // }\n          if(uInitAnimation == 1.0) {\n            // results.xy = rotate(results.xy, rotateMultiplierStart );\n            results.xz = rotate(results.xz, rotateMultiplierStart );\n          }\n        // life = 0.5 + fract(startPosition.w * 21.4131 + uTime);\n        life = startPosition.w;\n      } else {\n          vec3 delta = followPosition - results.xyz;\n          // results += delta;\n          results.xyz += delta * (0.005 + life * 0.01) * attraction * (1.0 - smoothstep(5.0, 350.0, length(delta))) * speed;\n          results.xyz += curl(results.xyz * curlSize, uTime, 0.1 + (1.0 - life) * 0.1) * speed;\n          if(uInitAnimation == 1.0) {\n            // results.xy = rotate(results.xy, rotateMultiplierEnd );\n            results.xz = rotate(results.xz, rotateMultiplierEnd );\n          }\n      }\n          // results.xyz *= rotateY( (1.0 - uInitAnimation ) * 2.0 );\n    // }\n    // results.xy += vec2(sin(offset) * 0.2);\n    // results *= rotateY( (1.0 - uInitAnimation ) * -0.02);\n    results *= rotateY( uGenerate );\n    \n    // gl_FragColor = vec4(velocity.xyz, uInitAnimation * life);\n    gl_FragColor = vec4(results.xyz, uInitAnimation * life);\n}\n"}),ec=e=>{let{}=e,t=(0,a.L)(x.k.logo),n=(0,d.v)(ea.selectGPU),i=B.sL.getState().isMobile,r=(0,m.useMemo)(()=>{let e=i?64:128;return(null==n?void 0:n.tier)&&2==n.tier&&(e=64),(null==n?void 0:n.tier)&&1==n.tier&&(e=32),e},[i,n]),o=(0,m.useMemo)(()=>({progress:0,speed:[0,.02,.03,.09,.02,.02],dieSpeed:[.001,.001,.001,15e-6,.001,.001],radius:i?[0,1.2,1.2,2.3,1.2,1.3]:[0,1.77,1.77,3.3,1.77,1.3],curlSize:[0,.06,.02,.36,1.05,.51],attraction:[30,-23,-13,-1.82,.5,-25],xTranslate:[0,0,0,0,0,5],yTranslate:[0,0,0,0,0,0],zTranslate:[0,0,0,0,0,5],zPosition:[-17,i?140:220,80,120,0,0]}),[i]),p=(0,m.useMemo)(()=>({speed:[.05,.16,.12,.09,.18],radius:[.62,1.71,.32,.77,.3],curlSize:[.03,.01,.085,.045,.02],attraction:[.85,1.85,-.25,-5,2.5],xTranslate:[2,6,.5,8,15],zPosition:[20,0,10,0,50]}),[i]),f=(0,d.v)(y.selectCurrentStep),h=(0,d.v)(y.selectSetCurrentStep),g=(0,d.v)(y.selectGenerating),z=(0,d.v)(y.selectSetGenerating),w=(0,d.v)(y.selectSetCursorDown),b=(0,d.v)(y.selectCurrentProductData),S=(0,d.v)(y.selectCurrentProduct),T=(0,m.useRef)(0),j=(0,m.useRef)(0),M=(0,m.useRef)(-1),_=(0,m.useRef)(0),E=(0,m.useRef)({speed:0,radius:0,attraction:0,xTranslate:0,yTranslate:0,zTranslate:0,zPosition:0}),D=(0,m.useRef)(!1),R=(0,m.useRef)(0),N=(0,m.useRef)(new v.Vector3),L=(0,m.useRef)(null),A=(0,m.useRef)(new v.Mesh),I=(0,m.useRef)(null),k=(0,m.useRef)(null),O=(0,m.useRef)(!0),U=(0,m.useRef)(new v.Clock(!0)),{gl:X}=(0,s.z)(),Z=(0,m.useMemo)(()=>new F.n(r,r,X),[X,r]),Y=(0,m.useRef)({progress:o.progress[0],speed:o.speed[0],dieSpeed:o.dieSpeed[0],radius:o.radius[0],curlSize:o.curlSize[0],attraction:o.attraction[0],xTranslate:o.xTranslate[0],yTranslate:o.yTranslate[0],zTranslate:o.zTranslate[0],zPosition:o.zPosition[0],color:new v.Color(.7955833626088831,.5679280526392926,.12348620696030656),emissive:new v.Color(.39858561989004926,.24964921087690903,.007801537839903407)}),H=(0,m.useMemo)(()=>{A.current=t.scene.children[0];let e=A.current.geometry.clone();e.scale(70,70,70),e.rotateX(.5*Math.PI),e.computeBoundingBox();let n=new v.Mesh(e);return W(r,n)},[A,t.scene]),K=(0,m.useMemo)(()=>q(r),[r]),Q=(0,m.useMemo)(()=>q(r),[r]),$=(0,m.useMemo)(()=>Z.addVariable("uCurrentPosition",es,K),[K,es,Z]),J=(0,m.useMemo)(()=>Z.addVariable("uCurrentVelocity",el,K),[K,el,Z]),ee=(0,m.useMemo)(()=>({uPosition:{value:null},uVelocity:{value:null},uStartPosition:{value:Q},uLight:{value:new v.Vector3(0,0,0)},uTime:{value:0},uProgress:{value:0},uGenerate:{value:0}}),[]),et=(0,m.useCallback)(()=>{(0,eo.Z)({buttonclicked:"GENERATE"}),z(!1),w(!1),h(C.h.WRAP),k.current&&(E.current.speed=k.current.uSpeed.value,E.current.radius=k.current.uRadius.value,E.current.attraction=k.current.uAttraction.value,E.current.curlSize=k.current.uCurlSize.value,E.current.xTranslate=.8*Y.current.xTranslate,E.current.yTranslate=.8*Y.current.yTranslate,E.current.zTranslate=.8*Y.current.zTranslate),null!==L.current&&(E.current.zPosition=L.current.position.z),ex([E.current.speed,75e-5,E.current.radius,E.current.curlSize,E.current.attraction,E.current.xTranslate,E.current.yTranslate,E.current.zTranslate]),en(.003)},[]),en=(0,m.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,u.j)(ev,e,{ease:P.SX.out,duration:t?P.nL.fast:3})},[]);(0,G.Z)(e=>{O.current=e,!1===e?U.current.stop():U.current.start()});let ei=(0,l.c)(0),ec=(0,l.c)(0),eu=(0,l.c)(0),em=(0,l.c)(0),ev=(0,l.c)(0);(0,c.W)(ei,"change",e=>{k.current&&(k.current.uInitAnimation.value=e,null!==L.current&&(L.current.material.uniforms.uProgress.value=e,L.current.rotation.y=-((1-e)*Math.PI*.97)))}),(0,c.W)(ec,"change",e=>{k.current&&(k.current.uProgress.value=e)}),(0,c.W)(eu,"change",e=>{null!==L.current&&(L.current.position.z=e)}),(0,c.W)(em,"change",e=>{null!==L.current&&(L.current.position.y=e)}),(0,c.W)(ev,"change",e=>{k.current&&(k.current.uGenerate.value=e)});let[ex]=V({stiffness:100,friction:4,mass:.1,onUpdate:e=>{let[t,n,i,r,a,o,s,l]=e;k.current&&(k.current.uSpeed.value=t.value,k.current.uDieSpeed.value=n.value,k.current.uAttraction.value=a.value,k.current.uRadius.value=i.value,k.current.uCurlSize.value=r.value,Y.current.xTranslate=o.value,Y.current.yTranslate=s.value,Y.current.zTranslate=l.value)}});(0,m.useEffect)(()=>{if(f==C.h.ENTER_BOX||f==C.h.RESULTS||f==C.h.SELECT_GENDER||f==C.h.VOICEOVER){let e=f===C.h.RESULTS||f===C.h.ENTER_BOX,t=e?S<=_.current?.03:-.03:.06;en(t,e),setTimeout(()=>{en(0,e)},e?1e3*P.nL.fast:1200),_.current=S}},[S,f]),(0,m.useEffect)(()=>{f===C.h.INTRO_OUT&&setTimeout(()=>{ex([o.speed[1],o.dieSpeed[1],o.radius[1],o.curlSize[1],o.attraction[1],o.xTranslate[1],o.yTranslate[1],o.zTranslate[1]]),(0,u.j)(ei,1,P.FK.zoom),(0,u.j)(eu,o.zPosition[1],{ease:P.SX.inOut,duration:2.8})},300),f===C.h.START&&(0,u.j)(ec,1,{...P.FK.progressIntro,delay:1.8}),f===C.h.SELECT_GENDER&&(ex([o.speed[2],o.dieSpeed[2],o.radius[2],o.curlSize[2],o.attraction[2],o.xTranslate[2],o.yTranslate[2],o.zTranslate[2]]),(0,u.j)(eu,o.zPosition[2],P.FK.zoom)),f===C.h.VOICEOVER&&((0,u.j)(ec,0,P.FK.zoom),ex([o.speed[4],o.dieSpeed[4],o.radius[4],o.curlSize[4],o.attraction[4],o.xTranslate[4],o.yTranslate[4],o.zTranslate[4]]),(0,u.j)(eu,o.zPosition[4],P.FK.zoom)),f===C.h.GENERATE&&(0,u.j)(ec,0,P.FK.zoom),f===C.h.ENTER_BOX&&((0,u.j)(ec,1,P.FK.default),ex([o.speed[3],o.dieSpeed[3],o.radius[3],o.curlSize[3],o.attraction[3],o.xTranslate[3],o.yTranslate[3],o.zTranslate[3]]),(0,u.j)(eu,o.zPosition[3],P.FK.zoom)),f===C.h.CLOSE_BOX&&(ex([.3,.05,3.2,.03,0,0,0,0]),(0,u.j)(eu,17,P.FK.zoom),(0,u.j)(em,-19,P.FK.zoom)),f===C.h.DISCOVER&&setTimeout(()=>{ex([.1,.05,.8,.03,0,0,0,0])},2500),f===C.h.RESULTS&&setTimeout(()=>{(0,u.j)(ec,1,P.FK.default),ex([E.current.speed,75e-5,E.current.radius,E.current.curlSize,E.current.attraction,E.current.xTranslate,E.current.yTranslate,.4*E.current.zTranslate]),(0,u.j)(eu,510,{...P.FK.goAway}),(0,u.j)(em,-700,{...P.FK.goAway})},2700)},[f]),(0,m.useEffect)(()=>{g?(en(-.05),(0,u.j)(ec,1,P.FK.fast)):en(0)},[g]);let ed=(0,m.useCallback)(()=>{let{speed:e,dieSpeed:t,progress:n,attraction:i,radius:r,curlSize:a}=Y.current;I.current=$.material.uniforms,k.current=J.material.uniforms,I.current.uModelPosition={value:H},I.current.uOriginalPosition={value:K},k.current.uOriginalPosition={value:K},k.current.uModelPosition={value:H},k.current.uStartPosition={value:Q},k.current.uFollowPosition={value:new v.Vector3(0,0,0)},k.current.uProgress={value:n},k.current.uGenerate={value:0},k.current.uInitAnimation={value:0},k.current.uSpeed={value:e},k.current.uDieSpeed={value:t},k.current.uAttraction={value:i},k.current.uRadius={value:r},k.current.uCurlSize={value:a},k.current.uTime={value:0},D.current=!0},[Z,$,J]);return(0,m.useEffect)(()=>{Z.setVariableDependencies($,[$,J]),Z.setVariableDependencies(J,[J,$]);let e=Z.init();null!==e&&console.error(e),ed()},[X,r,Z]),(0,m.useEffect)(()=>{var e;let t=new Float32Array(r*r*2);for(let e=0;e<r;e++)for(let n=0;n<r;n++){let i=e*r+n;t[2*i+0]=e/(r-1),t[2*i+1]=n/(r-1)}null===(e=L.current)||void 0===e||e.geometry.setAttribute("ref",new v.InstancedBufferAttribute(t,2))},[]),(0,s.A)((e,t)=>{let{gl:n}=e;if(t=U.current.getDelta(),D.current&&null!==L.current&&O.current){if(T.current+=t,Z.compute(),g){if(j.current+=1.2*t,M.current!==Math.floor(j.current)){let e=Math.floor(j.current)%p.speed.length;ex([p.speed[e],75e-5,p.radius[e],p.curlSize[e],p.attraction[e],p.xTranslate[e],.5*p.xTranslate[e],p.xTranslate[e]]),(0,u.j)(eu,p.zPosition[e],P.FK.zoom)}M.current=Math.floor(j.current),j.current>12.5&&et()}else j.current>1.51&&et(),j.current>0&&j.current<1.51&&(ex([o.speed[4],o.dieSpeed[4],o.radius[4],o.curlSize[4],o.attraction[4],o.xTranslate[4],o.yTranslate[4],o.zTranslate[4]]),(0,u.j)(eu,o.zPosition[4],P.FK.zoom)),j.current=0,M.current=-1;let{xTranslate:e,yTranslate:n,zTranslate:i}=Y.current,r=2.001*t*k.current.uSpeed.value;r*=f>=C.h.WRAP?4.3:1,R.current+=r,N.current.set(Math.cos(R.current)*e,Math.cos(.5*R.current)*n,Math.sin(2*R.current)*i),k.current.uFollowPosition.value.lerp(N.current,.2),k.current.uTime.value+=5e-4,f===C.h.RESULTS&&L.current&&void 0!==b&&(L.current.material.color.lerp(new v.Color().setStyle(null==b?void 0:b.emissive),2.5*t),L.current.material.emissive.lerp(new v.Color().setStyle(null==b?void 0:b.color),2.5*t),L.current.rotation.x=(0,er.t7)(L.current.rotation.x,.5*Math.PI,.1*t),L.current.rotation.y=(0,er.t7)(L.current.rotation.y,0,.1*t),L.current.rotation.z=(0,er.t7)(L.current.rotation.z,0,.1*t)),L.current.material.uniforms.uTime.value=T.current,L.current.material.uniforms.uPosition.value=Z.getCurrentRenderTarget($).texture,L.current.material.uniforms.uVelocity.value=Z.getCurrentRenderTarget(J).texture,L.current.material.uniforms.uLight.value.x=30*Math.cos(T.current),L.current.material.uniforms.uLight.value.y=20*Math.sin(T.current),(f===C.h.ENTER_BOX||f===C.h.CLOSE_BOX)&&(L.current.rotation.x=(0,er.t7)(L.current.rotation.x,0,t),L.current.rotation.y=(0,er.t7)(L.current.rotation.y,.18*Math.PI,t),L.current.rotation.z=(0,er.t7)(L.current.rotation.z,0,t))}}),{SIZE:r,iref:L,sampleRef:A,gl:X,gpuCompute:Z,uniforms:ee,model:t,color:Y.current.color,emissive:Y.current.emissive,zPosition:0}},eu={vertex:"\n      uniform float uTime;\n      uniform sampler2D uPosition;\n      uniform sampler2D uVelocity;\n      uniform vec3 uLight;\n      attribute vec2 ref;\n      varying float vLife;\n      varying vec2 vUv;\n\n      vec3 rotate3D(vec3 v, vec3 vel) {\n        vec3 newpos = v;\n        vec3 up = vec3(sin(uTime * 0.4), cos(uTime * 0.6), cos(uTime * 0.2));\n        vec3 axis = normalize(vel);\n        // float angle = acos(dot(up, normalize(vel)));\n        // float angle = max(0.0, min(rand(vUv) * 1.31, 1.31));\n        float angle = max(0.0, min(acos(dot(up, normalize(vel))), 0.9));\n        newpos = newpos * cos(angle) + axis * dot(axis, newpos) * (1. - cos(angle));\n        return newpos;\n      }\n\n      vec3 displace(vec3 point, vec3 vel) {\n        vec3 pos = texture2D(uPosition,ref).rgb;\n        vec3 copypoint = rotate3D(point, vel);\n        // NO ROtate3D Particles\n        // vec3 copypoint = point;\n        vec3 instancePosition = (instanceMatrix * vec4(copypoint, 1.)).xyz;\n        return instancePosition + pos;\n      }\n\n      void main() {\n        vec4 vel = texture2D(uVelocity,ref);\n        vec3 p = displace(position, vel.xyz);\n        vLife = vel.w;\n        vUv = ref;\n        csm_PositionRaw = projectionMatrix * modelViewMatrix * instanceMatrix * vec4(p, 1.0);\n        // non male vLife scala quelle che stanno morendo\n        float scale = abs((vLife * 2.0) - 1.0);\n        // csm_PositionRaw = projectionMatrix * modelViewMatrix * instanceMatrix * vec4(p, 1.0) * scale;\n        // csm_PositionRaw.z -= vLife;\n\n        csm_Normal = rotate3D(normal, vel.xyz);\n        // csm_Normal = rotate3D(normal, p);\n      }\n      ",fragment:"\n    uniform sampler2D uVelocity;\n    uniform sampler2D uStartPosition;\n    uniform vec3 uLight;\n    uniform float uTime;\n    uniform float uProgress;\n    varying vec2 vUv;\n    varying float vLife;\n\n    // float rand(vec2 co){\n    //     return fract(sin(dot(co, vec2(12.9898, 78.233))) * 43758.5453);\n    // }\n      void main() {\n        // OLD + Light meno nette\n        // vec4 position = texture2D( uStartPosition, vUv );\n        vec4 position = texture2D( uVelocity, vUv );\n        // csm_Emissive = vec3(0.57,0.17,0.5);  // rosa\n        vec3 color = diffuse;\n\n        // vec2 light1Pos = vec2(24.0 * sin(uTime * 0.5),\n        //                   12.0 * cos(uTime));\n\n        // vec2 light2Pos = vec2(30.0 * cos(uTime * 0.25),\n        //                   24.0 * sin(uTime * 0.5));\n\n        // float lightsGroup = (distance( light1Pos, position.xy ) * 0.05) * (distance( light2Pos, position.xy ) * 0.074);\n        float maxLight = 1.8;\n        float minLight = 0.5;\n        float lightsGroup = min(1., max(0., distance( position.xy, uLight.xy ) * 0.05));\n        lightsGroup *= min(maxLight - minLight, max(minLight, distance( position.xy, uLight.yx ) * 0.074));\n        // make the color go above vec3(1.0, 1.0, 1.0) so that it triggers bloom effect\n        float scale = abs((vLife * 2.0) - 1.0);\n        // NEW bloom\n        float bloomAmount = pow(0.5 + 0.75 * lightsGroup, .8);\n        color.rgb += vec3((maxLight - lightsGroup) * uProgress);\n        // OLD bloom\n        // float bloomAmount = pow(0.5 + 0.5 * cos(uTime * 3.0 + position.x * 0.3 + position.y * 0.1) * scale, .8);\n        // color.rgb += vec3(bloomAmount * uProgress);\n\n        csm_Emissive = emissive;\n        csm_Roughness= 0.33;\n        csm_Metalness= 1.0;\n        // csm_DiffuseColor.rgb *= vec3(1.0 - vLife);\n        csm_DiffuseColor = vec4(color.xyz, max(.0, min(scale * uProgress, 1.0)));\n      }\n      "},em=e=>{let{}=e,{iref:t,sampleRef:n,SIZE:r,uniforms:a,model:o,color:s,emissive:l}=ec({});return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("group",{position:[0,0,0],scale:1.1,frustumCulled:!1,children:[(0,i.jsx)("primitive",{ref:n,visible:!1,position:[0,0,0],object:o.scene}),(0,i.jsxs)("instancedMesh",{ref:t,args:[null,null,r*r],position:[0,0,0],frustumCulled:!1,children:[(0,i.jsx)("circleGeometry",{args:[.3,7]}),(0,i.jsx)(A.Z,{baseMaterial:v.MeshStandardMaterial,color:s,emissive:l,vertexShader:(0,L.kq)(eu.vertex),fragmentShader:(0,L.kq)(eu.fragment),uniforms:a,transparent:!0,toneMapped:!1})]})]})})};var ev=n(931),ex=n(1526);let ed=e=>(0,i.jsx)(ev.m.div,{initial:{opacity:1},animate:{opacity:1},exit:{opacity:0},className:"h-full w-full",children:e.children}),ep=e=>{let{condition:t,children:n}=e,r=null;return t===C.h.GENERATE&&(t=C.h.VOICEOVER),m.Children.forEach(n,e=>{m.isValidElement(e)&&e.type===ed&&e.props.case===t&&(r=e)}),(0,i.jsx)(ex.M,{mode:"wait",children:(0,i.jsx)(ev.m.div,{className:"h-full w-full",children:r},t)})};var ef=n(9107);let ey=e=>{let{intent:t}=e,[n,i]=(0,m.useState)(t),[r,a]=(0,m.useState)(!1),o=(0,d.v)(y.selectSetCursorType),s=(0,d.v)(y.selectThemeColor);return{onCursor:o,setIsHovered:a,setCurrentIntent:i,currentIntent:n,isHovered:r,color:s}},eh=e=>{let{children:t,href:n,intent:r="primary",shape:a,disabled:o,className:s,onClick:l,...c}=e,{onCursor:u,setIsHovered:m,setCurrentIntent:v,currentIntent:x,isHovered:d,color:p}=ey({intent:r}),f=(0,ef.j)("button",{variants:{shape:{rounded:"w-[74px] h-[74px] sm:w-[54px] sm:h-[54px] sm:p-4 aspect-square rounded-full",default:"min-w-[170px] sm:min-w-[110px] py-7 sm:min-h-none rounded-[37px] px-14  sm:px-5 sm:py-5 text-base font-book tracking-[.8px]",fit:"py-7 px-[38px] rounded-[37px]"},intent:{white:"text-".concat(p," bg-white"),blurred:"before:content-[''] before:absolute before:rounded-[37px] before:inset-0 before:backdrop-blur-md before:backdrop-brightness-115 text-".concat(p),primary:"bg-".concat(p," text-white")},disabled:{true:{},false:{}}},defaultVariants:{shape:"default",intent:"primary",disabled:!1}});return(0,i.jsx)("div",{className:"pointer-events-auto flex flex-col justify-center align-middle transition-all hover:scale-105 active:scale-95",onMouseEnter:()=>{u("button_".concat(r)),m(!0),v("white"===r?"primary":"blurred")},onMouseLeave:()=>{u(!1),v(r),m(!1)},children:(0,i.jsx)("button",{className:"".concat(f({intent:x,shape:a,disabled:o,className:s})," relative flex items-center justify-center py-3 text-xs uppercase transition-all"),onClick:l,...c,children:"function"!=typeof t?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(ev.m.span,{initial:{opacity:1,y:0},animate:d?{opacity:0,y:-8}:{opacity:1,y:0,transition:{delay:.25}},children:t}),(0,i.jsx)(ev.m.span,{className:"absolute",initial:{opacity:0,y:4},animate:d?{opacity:1,y:0,transition:{delay:.25}}:{opacity:0,y:4},children:t})]}):t(x)})})};var eg=n(7827),ez=n(6597),ew=n(7803),eb=n(5875);let eS={select_gender:{en:[{track:"receiverQuestion_EN",voiceText:"Who will receive your gift?",label:"receiverQuestion"}],it:[{track:"receiverQuestion_IT",voiceText:"Chi ricever\xe0 il tuo regalo?",label:"receiverQuestion"}]},discover:{en:[{track:"giftDiscovery_EN",voiceText:"Discover the perfect Dolce&Gabbana Beauty gift.",label:"giftDiscovery"}],it:[{track:"giftDiscovery_IT",voiceText:"Scopri il regalo perfetto Dolce&Gabbana Beauty.",label:"giftDiscovery"}]},generate:{en:[{track:"introStorytelling_EN",voiceText:"Turn your gift into a special and unique gesture.",label:"introStorytelling"},{track:"onboarding1_EN",voiceText:"Discover your Dolce&Gabbana Beauty gift.",label:"onboarding1"}],it:[{track:"introStorytelling_IT",voiceText:"Trasforma il tuo dono in un gesto prezioso e unico.",label:"introStorytelling"},{track:"onboarding1_IT",voiceText:"Scopri il tuo regalo Dolce&Gabbana Beauty.",label:"onboarding1"}]},wrap:{}},eT=e=>{let{step:t,muted:n}=e,[i,r]=(0,m.useState)(0),[a,o]=(0,m.useState)(!1),[s,l]=(0,m.useState)(!1),{sound:c}=(0,ew.Pe)(),u=(0,d.v)(eb.selectLang),v=(0,d.v)(eb.selectLabels),x=(0,d.v)(y.selectGenerating),p=(0,d.v)(y.selectCurrentStep),[f,h]=(0,m.useState)(),g=(0,m.useRef)(!1),z=(0,m.useMemo)(()=>eS[t][u],[t,u]),w=(0,m.useMemo)(()=>{let e=z[i];return v&&(e.voiceText=v[e.label]),e},[i,z,v]),b=(0,m.useMemo)(()=>w.track,[w]),S=(0,m.useMemo)(()=>w.voiceText.split(" "),[w]),T=(0,m.useMemo)(()=>(null==v?void 0:v.voice)||"Voice",[v]),j=(0,m.useCallback)(()=>{(p===C.h.WRAP||p===C.h.DISCOVER)&&l(!0)},[p]);return(0,m.useEffect)(()=>{"generate"===t&&(x?g.current=!0:g.current&&(null==c||c.fade(1,0,100,f)))},[x,c,f,t]),(0,m.useEffect)(()=>{if(c&&!a&&!n){o(!0);let e=c.play(w.track);c.volume(0,e),h(e),i<eS[t][u].length-1?setTimeout(()=>{o(!1),r(e=>e+1)},(null==c?void 0:c.duration(e))*1e3+500):setTimeout(()=>j(),ez.sprite[b][1])}},[c,i,a,u,t,w.track,n]),{currentText:i,duration:ez.sprite[b][1]/1e3,splittedText:S,currentStepItems:z,title:T,hide:s}},ej=e=>{let{step:t,className:n,muted:r=!1}=e,{currentText:a,duration:o,splittedText:s,currentStepItems:l,title:c,hide:u}=eT({step:t,muted:r}),m={bottom:{opacity:0===a?1:0,rotateX:0===a?0:90,y:0===a?0:40},normal:{opacity:1,y:0,rotateX:0,transition:{duration:.6,staggerChildren:o/s.length}},top:{opacity:0,rotateX:90,y:-40,transition:{duration:.6}}},v={top:{opacity:0},normal:{opacity:1},bottom:{opacity:0}};return(0,i.jsx)(ex.M,{children:!u&&(0,i.jsx)(ev.m.div,{layout:!0,className:"mx-auto flex max-w-md flex-col gap-y-6 text-center sm:gap-y-4 ".concat(n||""),exit:{opacity:0},children:(0,i.jsxs)("div",{className:"relative flex content-center items-center",children:[l.map((e,t)=>(0,i.jsx)("div",{className:"min-w-[28rem] opacity-0 sm:min-w-[100%]",children:(0,i.jsx)(eg.Z,{className:"flex flex-wrap items-center justify-center",children:e.voiceText})},t)),(0,i.jsx)(ex.M,{children:l.map((e,t)=>a===t&&!u&&(0,i.jsxs)(ev.m.div,{variants:m,initial:"bottom",animate:"normal",exit:"top",className:"absolute w-[calc(100%+1px)] max-w-[28rem]",children:[(0,i.jsx)(eg.Z,{className:"flex flex-wrap items-center justify-center opacity-30",children:s.map((e,t)=>(0,i.jsx)(ev.m.span,{dangerouslySetInnerHTML:{__html:t!==s.length-1?"".concat(e,"&nbsp;"):e}},t))}),(0,i.jsx)(ev.m.div,{className:"absolute inset-0",transition:{duration:o},children:(0,i.jsx)(eg.Z,{className:"flex flex-wrap items-center justify-center",children:s.map((e,t)=>(0,i.jsx)(ev.m.span,{dangerouslySetInnerHTML:{__html:t!==s.length-1?"".concat(e,"&nbsp;"):e},variants:v},t))})})]},t))})]})})})},eP=(e,t)=>{let n=eS[e][t],i=n.length;return n.map(e=>ez.sprite[e.track][1]).reduce((e,t)=>e+t,(i-1)*1500)},eC=()=>{let e=(0,d.v)(eb.selectLang),t=(0,m.useMemo)(()=>({DISCOVER_BUTTON_DELAY:eP("discover",e||"en")}),[e]);return t},eM=e=>{let{}=e,t=(0,d.v)(y.selectSetCurrentStep),n=(0,d.v)(y.selectSetCursorType),i=e=>{e.preventDefault(),n(!1),(0,eo.Z)({buttonclicked:"Gift Discover"}),t(C.h.RESULTS)};return{handleDiscoverGift:i}},e_=e=>{let{}=e,{handleDiscoverGift:t}=eM({}),{DISCOVER_BUTTON_DELAY:n}=eC(),r=(0,d.v)(eb.selectLabels);return(0,i.jsxs)("div",{className:"flex h-full w-full flex-col items-center justify-end gap-y-9 sm:gap-y-8",children:[(0,i.jsx)(ej,{step:"discover"}),(0,i.jsx)(ev.m.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto",transition:{height:{delay:n/1e3,duration:.5},opacity:{delay:n/1e3+.83,duration:.33}}},children:(0,i.jsx)(eh,{className:"mb-10",onClick:e=>t(e),children:(null==r?void 0:r.giftDiscoveryCta)||"Discover the gift"})})]})};var eE=n(8522),eD=n(6652),eR=n(2698),eN=n(6492);let eL=e=>{let{}=e,t=(0,d.v)(y.selectProductSlides),n=(0,d.v)(y.selectDataProducts),i=(0,m.useMemo)(()=>{let e={};return t.map(t=>{e[t]="/images/".concat(n[t].image)}),e},[t]);return(0,eN.Z)(i),{}},eA=e=>{let{}=e,t=(0,d.v)(eb.selectLabels),{isTouch:n}=(0,B.sL)(),r=(0,d.v)(y.selectGenerating),[a,o]=(0,m.useState)(!0);return eL({}),(0,m.useEffect)(()=>{setTimeout(()=>o(!1),1e3*P.cN.TAPHOLD)},[]),(0,i.jsxs)("div",{className:"flex h-full w-full flex-col items-center justify-end",children:[(0,i.jsx)("div",{className:"flex flex-1 flex-col items-center justify-end",children:(0,i.jsx)(eE.X,{features:eD.H,children:(0,i.jsx)(ex.M,{mode:"wait",initial:!0,children:n&&!a&&!r&&(0,i.jsx)(ev.m.span,{initial:{opacity:0},animate:{opacity:1},children:(0,i.jsx)(eR.Z,{delay:P.cN.GENERATE,className:"pointer-events-auto mb-[40px] block",children:(0,i.jsx)("span",{dangerouslySetInnerHTML:{__html:(null==t?void 0:t.tapHold)||"Tap and Hold"}})})})})})}),(0,i.jsx)(eE.X,{features:eD.H,children:(0,i.jsx)(ex.M,{mode:"wait",initial:!0,children:a?(0,i.jsx)(ev.m.div,{className:"w-full",initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.8},style:{marginBottom:"18vh"},children:(0,i.jsx)(eg.Z,{variant:"subtitle",className:"mt-9 text-center sm:mt-5",children:n?null==t?void 0:t.holdCTAmobile:(null==t?void 0:t.holdCTA)||"Click & Hold"})},"clH"):(0,i.jsx)(ev.m.div,{className:"w-full",initial:{opacity:0},animate:{opacity:1,transition:{duration:.8,delay:.5}},exit:{opacity:0},children:(0,i.jsx)(ej,{className:"mb-12",step:"generate"})},"voi")})})]})};var eI=n(8661),ek=n(1664),eO=n.n(ek);let eV=e=>{let t=e.indexOf("?"),n=t>=0?e.substring(t):"";return new URLSearchParams(n).toString()},eF=e=>{let t=eV(location.href),n=""!==t.toString()?"?".concat(t.toString()):"";return"".concat(e).concat(n)},eG=e=>{let{intent:t}=e,[n,i]=(0,m.useState)(t),[r,a]=(0,m.useState)(!1),o=(0,d.v)(y.selectSetCursorType),s=(0,d.v)(y.selectThemeColor);return{onCursor:o,setIsHovered:a,setCurrentIntent:i,currentIntent:n,isHovered:r,color:s}},eU=e=>{let{children:t,href:n,intent:r="primary",shape:a,disabled:o,className:s,onClick:l,...c}=e,{onCursor:u,setIsHovered:m,setCurrentIntent:v,currentIntent:x,isHovered:d,color:p}=eG({intent:r}),f=(0,ef.j)("button",{variants:{shape:{rounded:"w-[74px] h-[74px] sm:w-[54px] sm:h-[54px] sm:p-4 aspect-square rounded-full",default:"min-w-[170px] sm:min-w-[110px] py-7 sm:min-h-none rounded-[37px] px-14 sm:px-5 sm:py-5 text-base font-book tracking-[.8px]",fit:"py-7 px-[38px] rounded-[37px]"},intent:{white:"text-".concat(p," bg-white"),blurred:"before:content-[''] before:absolute before:rounded-[37px] before:inset-0 before:backdrop-blur-md before:backdrop-brightness-115 text-".concat(p),primary:"bg-".concat(p," text-white")},disabled:{true:{},false:{}}},defaultVariants:{shape:"default",intent:"primary",disabled:!1}});return(0,i.jsx)("div",{className:"pointer-events-auto flex flex-col justify-center align-middle transition-all hover:scale-105 active:scale-95",onMouseEnter:()=>{u("button_".concat(r)),m(!0),v("white"===r?"primary":"blurred")},onMouseLeave:()=>{u(!1),v(r),m(!1)},children:(0,i.jsx)(eO(),{legacyBehavior:!0,href:n?eF(n):"",children:(0,i.jsx)("a",{target:"_blank",className:"".concat(f({intent:x,shape:a,disabled:o,className:s})," relative flex items-center justify-center py-3 text-xs uppercase transition-all"),...c,onClick:l,children:"function"!=typeof t?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(ev.m.span,{initial:{opacity:1,y:0},animate:d?{opacity:0,y:-8}:{opacity:1,y:0,transition:{delay:.25}},children:t}),(0,i.jsx)(ev.m.span,{className:"absolute",initial:{opacity:0,y:4},animate:d?{opacity:1,y:0,transition:{delay:.25}}:{opacity:0,y:4},children:t})]}):t(x)})})})};var eX=n(6978);let eB=e=>{let{}=e,t=(0,d.v)(y.selectCurrentProduct),n=(0,d.v)(y.selectSetCurrentProduct),i=(0,d.v)(y.selectDataProducts),r=(0,d.v)(y.selectProductSlides),a=(0,d.v)(y.selectSetCursorHasArrow),o=(0,d.v)(y.selectSetCurrentProductData),[s,l]=(0,m.useState)(window.innerWidth<=639),{isTouch:c}=(0,B.sL)(),u=(0,m.useCallback)(()=>s?window.innerWidth-128:window.innerWidth/3,[s]),[v,x]=(0,m.useState)(u()),p=(0,m.useCallback)(()=>{l(window.innerWidth<=639),x(u())},[u]);return(0,m.useEffect)(()=>(window.addEventListener("resize",p),()=>{window.removeEventListener("resize",p)}),[p]),(0,m.useEffect)(()=>{(0===t||t===r.length-1)&&a(0),o(i[r[t]])},[t]),{slideWidth:v,currentProduct:t,isMobile:s,marginMobile:64,setCurrentProduct:n,dataProducts:i,isTouch:c}},eZ=e=>{let{products:t}=e,{slideWidth:n,currentProduct:r,marginMobile:a,setCurrentProduct:o,dataProducts:s,isTouch:l,isMobile:c}=eB({}),u=(0,d.v)(y.selectSetCursorHasArrow);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"relative mt-9 flex h-full w-screen",style:{transform:"translateX(".concat(-n*(r-(c?0:1))+(c?a:0),"px)"),transition:"transform 0.75s cubic-bezier(0.42, 0.0, 0.58, 1.0)"},children:t.map((e,t)=>(0,i.jsx)(eq,{product:s[e],currentSlide:r,slideWidth:n,index:t},"sld_".concat(t)))}),l?(0,i.jsxs)(ex.M,{initial:!0,children:[0!==r&&(0,i.jsx)(ev.m.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed left-0 bottom-1/2 flex h-32 w-32 translate-y-1/2  -translate-x-1/2 items-center justify-center rounded-full bg-white transition-transform active:scale-90",onClick:()=>o(r-1<0?0:r-1),children:(0,i.jsx)("div",{className:"translate-x-6 rotate-180",children:(0,i.jsx)(eI.Z,{icon:eX.mJ,mobileSize:16})})},"prev_t"),r!==t.length-1&&(0,i.jsx)(ev.m.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed right-0 bottom-1/2 flex h-32 w-32 translate-y-1/2 translate-x-1/2 items-center justify-center rounded-full bg-white transition-transform active:scale-90",onClick:()=>o(r+1>t.length-1?t.length-1:r+1),children:(0,i.jsx)("div",{className:"-translate-x-6",children:(0,i.jsx)(eI.Z,{icon:eX.mJ,mobileSize:16})})},"next_t")]}):(0,i.jsxs)(ex.M,{initial:!0,children:[(0,i.jsx)(ev.m.button,{initial:{opacity:0},animate:{opacity:0!==r?1:0,pointerEvents:0!==r?"auto":"none"},exit:{opacity:0},className:"fixed top-20 -left-0 z-30 h-[80vh] w-2/5 outline-none",onMouseEnter:()=>u(2),onMouseLeave:()=>u(0)},"prev_d"),(0,i.jsx)(ev.m.button,{initial:{opacity:0},animate:{opacity:r!==t.length-1?1:0,pointerEvents:r!==t.length-1?"auto":"none"},exit:{opacity:0},className:"fixed -right-0 top-20 z-30 h-[80vh] w-2/5 outline-none",onMouseEnter:()=>u(1),onMouseLeave:()=>u(0)},"next_d")]})]})},eW=(0,ef.j)("div",{variants:{variant:{main:"",left:"-rotate-10 scale-75 -translate-x-1/2",right:"rotate-10 scale-75 translate-x-1/2"}},defaultVariants:{variant:"main"}}),eq=e=>{let{product:t,currentSlide:n,slideWidth:r,index:a}=e,o=(0,d.v)(eb.selectLang),s=(0,d.v)(y.selectThemeColor);return(0,i.jsxs)("div",{className:"".concat(eW({variant:a===n?"main":a<n?"left":"right"})," flex flex-shrink-0 flex-col items-center justify-center gap-y-9 sm:p-2"),style:{width:r,transition:"transform 0.8s ease-in-out"},children:[(0,i.jsx)("img",{src:"/images/".concat((null==t?void 0:t.image)||"default.png"),className:"mx-auto h-full max-h-[45vh] object-contain",alt:(null==t?void 0:t.name[o])||""}),(0,i.jsx)(ev.m.div,{animate:{opacity:a===n?1:0,y:a===n?0:10,transition:{delay:a===n?.8:0,ease:"easeInOut"}},className:"w-screen text-center",children:(0,i.jsx)(eg.Z,{className:"px-[20px] text-".concat(s),variant:"subtitle",children:(null==t?void 0:t.name[o])||""})})]})};var eY=n(8939),eH=n(21);let eK=e=>{let{}=e,t=(0,d.v)(y.selectCurrentProductData),n=(0,d.v)(y.selectProductSlides),i=(0,d.v)(y.selectThemeColor),a=(0,d.v)(y.selectSetThemeColor),o=(0,d.v)(y.selectSetThemeBgColor),s=(0,d.v)(y.selectSetCurrentStep),[l,c]=(0,m.useState)(!0),{isMobile:u}=(0,B.sL)(),v=(0,r.useRouter)();(0,m.useEffect)(()=>{if(null!==t){let e=setTimeout(()=>{document&&null!==document.querySelector("meta[name='theme-color']")&&(document.querySelector("meta[name='theme-color']").content=t.bgColor),a(t.color),o(t.bgColor),c(!1)},l?1e3:200);return()=>clearTimeout(e)}},[l,a,t]);let x={visible:{transition:{delayChildren:P.cN.RESULTS,staggerChildren:.5}},hidden:{}},p={visible:{opacity:1,y:"0%",rotate:"0deg",transition:P.FK.default},hidden:{opacity:0,y:"200%",rotate:"14deg",transition:P.FK.default}},f=(0,m.useCallback)((e,n)=>{e.preventDefault(),(0,eo.Z)({buttonclicked:"Share: ".concat(null!==t&&void 0!==t.name.en?t.name.en:"")}),(0,eH.ss)(i,t,n,u)},[i,t,u]),h=e=>{e.preventDefault(),s(C.h.RESTART),setTimeout(()=>{v.reload()},P.cN.RESTART)};return{captureScreenshot:f,listVariant:x,itemVariant:p,handleResetClick:h,slides:n}},eQ=e=>{let{}=e,{captureScreenshot:t,listVariant:n,itemVariant:r,handleResetClick:a,slides:o}=eK({}),s=(0,d.v)(eb.selectLabels),l=(0,d.v)(eb.selectLang),c=(0,d.v)(eY.selectInStore),u=(0,d.v)(y.selectCurrentProductData);return(0,i.jsx)(eE.X,{features:eD.H,children:(0,i.jsx)(ex.M,{children:(0,i.jsxs)(ev.m.div,{variants:n,className:"flex h-full w-full flex-col items-center justify-between gap-y-9",initial:"hidden",animate:"visible",children:[(0,i.jsx)(ev.m.div,{variants:r,style:{height:"calc(100% - 180px)",maxWidth:"100vw"},children:(0,i.jsx)(eZ,{products:o})},"wrp_psld"),(0,i.jsx)("div",{className:"z-50 mb-10 flex flex-col items-center gap-y-9",children:(0,i.jsxs)("div",{className:"flex gap-x-9 sm:gap-x-2.5",children:[(0,i.jsx)(ev.m.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0,transition:{duration:.8,delay:P.cN.RESULTS+1}},children:(0,i.jsx)(eh,{shape:"rounded",onClick:e=>a(e),children:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"primary";return(0,i.jsx)(eI.Z,{icon:eX.Bt,opposite:!0,currentIntent:e,mobileSize:20})}})}),!c&&(0,i.jsx)(ev.m.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0,transition:{duration:.8,delay:P.cN.RESULTS+.5}},children:(0,i.jsx)(eU,{intent:"white",href:(null==u?void 0:u.link)||"#",onClick:()=>(0,eo.Z)({buttonclicked:"Shop now: ".concat(null!==u&&void 0!==u.name.en?u.name.en:"")}),children:(null==s?void 0:s.shopNow)||"Shop now"})}),!c&&(0,i.jsx)(ev.m.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0,transition:{duration:.8,delay:P.cN.RESULTS+1}},children:(0,i.jsx)(eh,{shape:"rounded",onClick:e=>t(e,l),children:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"primary";return(0,i.jsx)(eI.Z,{icon:eX.$z,opposite:!0,currentIntent:e,mobileSize:20})}})})]})},"wrp_footer")]})})})};var e$=n(2066);let eJ=e=>{let{}=e,t=(0,d.v)(y.selectSetCurrentStep),n=(0,d.v)(y.selectSetCursorType),{filterGender:i}=(0,e$.Z)(),r=(0,m.useCallback)((e,r)=>{(0,eo.Z)({buttonclicked:0===r?"DOES NOT MATTER":1===r?"HIM":"HER"}),t(C.h.VOICEOVER),setTimeout(()=>{t(C.h.GENERATE)},1e3*P.cN.TAPHOLD+3e3),i(r),n(!1)},[]);return{listVariant:{visible:{transition:{when:"beforeChildren",staggerChildren:.3,type:"spring",mass:1,damping:40,stiffness:300}},hidden:{}},itemVariant:{visible:{opacity:1,transition:{duration:.5}},hidden:{opacity:0,transition:{duration:.7}}},handleGenderClick:r}},e0=e=>{let{}=e,{listVariant:t,itemVariant:n,handleGenderClick:r}=eJ({}),a=(0,d.v)(eb.selectLabels);return(0,i.jsxs)(ev.m.div,{className:"flex h-full w-full flex-col items-center justify-end",variants:t,initial:"hidden",animate:"visible",children:[(0,i.jsx)(ev.m.div,{variants:n,children:(0,i.jsx)(ej,{step:"select_gender"})}),(0,i.jsxs)(ev.m.div,{className:"mt-9 mb-10 flex flex-wrap items-center justify-center gap-x-6 gap-y-2.5 sm:mt-5 sm:gap-x-2.5 sm:gap-y-2.5",children:[(0,i.jsx)(ev.m.div,{variants:n,children:(0,i.jsx)(eh,{onClick:e=>r(e,2),children:(null==a?void 0:a.a1)||"Her"})}),(0,i.jsx)(ev.m.div,{variants:n,children:(0,i.jsx)(eh,{onClick:e=>r(e,1),children:(null==a?void 0:a.a2)||"Him"})}),(0,i.jsx)(ev.m.div,{variants:n,children:(0,i.jsx)(eh,{onClick:e=>r(e,0),children:(null==a?void 0:a.a3)||"Not sure"})})]})]})},e1=e=>{let{}=e,t=(0,d.v)(y.selectSetCurrentStep),n=(0,d.v)(eb.selectLabels),i=(0,m.useMemo)(()=>(null==n?void 0:n.homeText)||"DISCOVER THE PERFECT CREATION FOR YOUR LOVED ONE",[n]),r=(0,m.useMemo)(()=>(null==n?void 0:n.homeCta)||"Get Started",[n]),a=B.sL.getState().isMobile,{isTouch:o,orientation:s}=(0,B.sL)(),l=(0,m.useMemo)(()=>{let e=(o&&"portrait"===s?null==n?void 0:n.homeTitleMobile:null==n?void 0:n.homeTitle)||"Gift<br/>the magic";(e=e.replaceAll("<br />","<br/>")).includes("<br/>")||(e="".concat(e,"<br/>"));let t=e.split("<br/>");return t},[n,o,s]);return{animatedTitle:l,letterVariants:{hidden:e=>{let[t,n]=e;return{x:-2e3+700*t,y:400+500*t,scale:5,skewY:25,rotateX:90,opacity:1,transformOrigin:"bottom center"}},visible:e=>{let[t,n]=e;return{x:0,y:0,scale:1,skewY:0,rotateX:0,opacity:1,transformOrigin:"bottom center",transition:{delay:.05*t/Math.sqrt(t+1)+.3*n,duration:P.nL.default,ease:P.SX.out,rotateX:{delay:.05*t/Math.sqrt(t+1)+.3*n,duration:2.2,ease:P.SX.out},skewY:{delay:.05*t/Math.sqrt(t+1)+.3*n,duration:2.2,ease:P.SX.out}}}}},text:i,cta:r,setCurrentStep:t,isMobile:a,isTouch:o}},e3=e=>{let{}=e,{animatedTitle:t,letterVariants:n,text:r,cta:a,setCurrentStep:o,isMobile:s,isTouch:l}=e1({}),c=(0,m.useMemo)(()=>Math.max(...t.map(e=>e.length)),[t]);return(0,i.jsxs)("div",{className:"flex h-full w-full flex-col items-center justify-center sm:relative",children:[(0,i.jsx)(ev.m.div,{children:(0,i.jsx)(eg.Z,{variant:"title",className:"text-center",style:l?{fontSize:"min(".concat(100/c+4,"vw, 8rem)")}:{},children:t.map((e,t)=>(0,i.jsx)("div",{className:"flex items-center justify-center",children:e.split("").map((e,r)=>(0,i.jsx)(ev.m.div,{dangerouslySetInnerHTML:{__html:" "===e?"&nbsp;":e},initial:"hidden",animate:"visible",variants:n,custom:[r,t]},"".concat(e,"_").concat(r,"_").concat(t)))},t))})},"".concat(s.toString())),(0,i.jsx)(ev.m.h1,{initial:{opacity:0,y:10},animate:{opacity:1,y:0,transition:{delay:1.8,duration:.8}},children:(0,i.jsx)(eg.Z,{variant:"subtitle",className:"mt-9 text-center sm:mt-5",children:r})}),l&&(0,i.jsx)(eR.Z,{onClick:()=>{(0,eo.Z)({buttonclicked:"GET STARTED"}),o(C.h.SELECT_GENDER)},className:"pointer-events-auto mt-14 block",delay:3,children:a})]})},e2=e=>{let{}=e,t=(0,d.v)(y.selectSetCurrentStep),n=(0,d.v)(y.selectCursorDown),i=e=>{e.preventDefault(),(0,eo.Z)({buttonclicked:"Get your gift ready"}),t(C.h.ENTER_BOX)};return{cursorDown:n,handleWrapClick:i}},e4=e=>{let{}=e,{handleWrapClick:t}=e2({}),n=(0,d.v)(eb.selectLabels);return(0,i.jsx)("div",{className:"flex h-full w-full flex-col items-center justify-end gap-y-9 sm:gap-y-8",children:(0,i.jsx)(ev.m.div,{initial:{opacity:0},animate:{opacity:1},className:"flex flex-col items-center gap-y-9 sm:flex sm:gap-y-8",children:(0,i.jsx)(eh,{className:"mb-12",onClick:e=>t(e),children:(null==n?void 0:n.wrapCta)||"Wrap the magic"})})})};var e5=n(952);let e8={visible:{opacity:1,transition:{when:"beforeChildren",staggerChildren:.1,type:"spring",mass:1,damping:40,stiffness:300}},hidden:{opacity:0}};var e9=function(e){let{children:t,show:n}=e;return(0,i.jsx)(ev.m.div,{className:"absolute h-full w-full",initial:"hidden",animate:n?"visible":"hidden",exit:{opacity:0},variants:e8,children:t})};let e7=e=>{let{}=e,t=(0,r.useRouter)(),n=(0,d.v)(y.selectCurrentStep),[a]=(0,e5.w)(t.route);return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(e9,{show:!0,children:[(0,i.jsxs)(ep,{condition:n,children:[(0,i.jsx)(ed,{case:C.h.INTRO}),(0,i.jsx)(ed,{case:C.h.START,children:(0,i.jsx)(e3,{})}),(0,i.jsx)(ed,{case:C.h.SELECT_GENDER,children:(0,i.jsx)(e0,{})}),(0,i.jsx)(ed,{case:C.h.VOICEOVER,children:(0,i.jsx)(eA,{})}),(0,i.jsx)(ed,{case:C.h.WRAP,children:(0,i.jsx)(e4,{})}),(0,i.jsx)(ed,{case:C.h.DISCOVER,children:(0,i.jsx)(e_,{})}),(0,i.jsx)(ed,{case:C.h.RESULTS,children:(0,i.jsx)(eQ,{})})]}),(0,i.jsxs)(a,{children:[(0,i.jsx)(R,{},"CameraGltf"),(0,i.jsxs)("group",{"rotation-y":Math.PI,children:[(0,i.jsxs)("group",{"rotation-x":-(.5*Math.PI),children:[n<C.h.START&&(0,i.jsx)(en,{}),(0,i.jsx)(em,{})]}),(0,i.jsxs)("group",{"position-z":20,"rotation-x":0,scale:750,children:[(0,i.jsx)(ei,{}),(0,i.jsx)(b,{})]})]})]})]})})};var e6=!0,te=e7}},function(e){e.O(0,[388,774,888,179],function(){return e(e.s=7331)}),_N_E=e.O()}]);